/*
 Rangy, a cross-browser JavaScript range and selection library
 http://code.google.com/p/rangy/

 Copyright 2011, Tim Down
 Licensed under the MIT license.
 Version: 1.2.1
 Build date: 8 October 2011
 MIT License {@link http://creativecommons.org/licenses/MIT/}
 @return {String} outerHtml
 jquery.layout 1.3.0 - Release Candidate 30.51
 $Date: 2012-05-12 08:00:00 (Sat, 12 May 2012) $
 $Rev: 303005 $

 Copyright (c) 2012 
   Fabrizio Balliano (http://www.fabrizioballiano.net)
   Kevin Dalman (http://allpro.net)

 Dual licensed under the GPL (http://www.gnu.org/licenses/gpl.html)
 and MIT (http://www.opensource.org/licenses/mit-license.php) licenses.

 Changelog: http://layout.jquery-dev.net/changelog.cfm#1.3.0.rc30.5

 Docs: http://layout.jquery-dev.net/documentation.html
 Tips: http://layout.jquery-dev.net/tips.html
 Help: http://groups.google.com/group/jquery-ui-layout
 RequireJS i18n 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/i18n for details
*/
(function(){function ya(j,f){var a,d;d=j||{};this.jQuery=f||{};this.config={};this.config.elements=d.elements?d.elements:[];this.config.attributes=d.attributes?d.attributes:{};this.config.attributes[ya.ALL]=this.config.attributes[ya.ALL]?this.config.attributes[ya.ALL]:[];this.config.allow_comments=d.allow_comments?d.allow_comments:!1;this.allowed_elements={};this.config.protocols=d.protocols?d.protocols:{};this.config.add_attributes=d.add_attributes?d.add_attributes:{};this.dom=d.dom?d.dom:document;
for(a=0;a<this.config.elements.length;a++)this.allowed_elements[this.config.elements[a]]=!0;this.config.remove_element_contents={};this.config.remove_all_contents=!1;if(d.remove_contents)if(d.remove_contents instanceof Array)for(a=0;a<d.remove_contents.length;a++)this.config.remove_element_contents[d.remove_contents[a]]=!0;else this.config.remove_all_contents=!0;this.transformers=d.transformers?d.transformers:[];this.filters=d.filters?d.filters:[]}var ka;ka||(ka={});(function(){function j(a){return 10>
a?"0"+a:a}function f(a){c.lastIndex=0;return c.test(a)?'"'+a.replace(c,function(a){var b=m[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(k,e){var c,m,d,q,u=b,t,j=e[k];j&&("object"===typeof j&&"function"===typeof j.toJSON)&&(j=j.toJSON(k));"function"===typeof g&&(j=g.call(e,k,j));switch(typeof j){case "string":return f(j);case "number":return isFinite(j)?""+j:"null";case "boolean":case "null":return""+j;case "object":if(!j)return"null";
b+=l;t=[];if("[object Array]"===Object.prototype.toString.apply(j)){q=j.length;for(c=0;c<q;c+=1)t[c]=a(c,j)||"null";d=0===t.length?"[]":b?"[\n"+b+t.join(",\n"+b)+"\n"+u+"]":"["+t.join(",")+"]";b=u;return d}if(g&&"object"===typeof g){q=g.length;for(c=0;c<q;c+=1)"string"===typeof g[c]&&(m=g[c],(d=a(m,j))&&t.push(f(m)+(b?": ":":")+d))}else for(m in j)Object.prototype.hasOwnProperty.call(j,m)&&(d=a(m,j))&&t.push(f(m)+(b?": ":":")+d);d=0===t.length?"{}":b?"{\n"+b+t.join(",\n"+b)+"\n"+u+"}":"{"+t.join(",")+
"}";b=u;return d}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+j(this.getUTCMonth()+1)+"-"+j(this.getUTCDate())+"T"+j(this.getUTCHours())+":"+j(this.getUTCMinutes())+":"+j(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b,l,m={"":"\\b","\t":"\\t","\n":"\\n","":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g;"function"!==typeof ka.stringify&&(ka.stringify=function(k,e,c){var m;l=b="";if(typeof c==="number")for(m=0;m<c;m=m+1)l=l+" ";else typeof c==="string"&&(l=c);if((g=e)&&typeof e!=="function"&&(typeof e!=="object"||typeof e.length!=="number"))throw Error("JSON.stringify");return a("",{"":k})});
"function"!==typeof ka.parse&&(ka.parse=function(a,b){function g(a,c){var k,l,m=a[c];if(m&&typeof m==="object")for(k in m)if(Object.prototype.hasOwnProperty.call(m,k)){l=g(m,k);l!==void 0?m[k]=l:delete m[k]}return b.call(a,c,m)}var c,a=""+a;d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){c=eval("("+a+")");return typeof b==="function"?g({"":c},""):c}throw new SyntaxError("JSON.parse");})})();define("util/json2",[],function(){return ka});define("aloha/rangy-core",["jquery"],function(j){var f=function(){function a(a,b){var g=typeof a[b];return g==p||!!(g==e&&a[b])||"unknown"==g}function d(a,b){return!!(typeof a[b]==e&&a[b])}function c(a,b){return typeof a[b]!=f}function b(a){return function(b,e){for(var g=e.length;g--;)if(!a(b,e[g]))return!1;
return!0}}function l(a){return a&&j(a,t)&&x(a,u)}function m(a){window.alert("Rangy not supported in your browser. Reason: "+a);y.initialized=!0;y.supported=!1}function g(){if(!y.initialized){var b,e=!1,g=!1;a(document,"createRange")&&(b=document.createRange(),j(b,q)&&x(b,r)&&(e=!0),b.detach());if((b=d(document,"body")?document.body:document.getElementsByTagName("body")[0])&&a(b,"createTextRange"))b=b.createTextRange(),l(b)&&(g=!0);!e&&!g&&m("Neither Range nor TextRange are implemented");y.initialized=
!0;y.features={implementsDomRange:e,implementsTextRange:g};e=A.concat(B);g=0;for(b=e.length;g<b;++g)try{e[g](y)}catch(c){d(window,"console")&&a(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",c)}}}function k(a){this.name=a;this.supported=this.initialized=!1}var e="object",p="function",f="undefined",r="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),q="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),
u="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),t="collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),j=b(a),z=b(d),x=b(c),y={version:"1.2.1",initialized:!1,supported:!0,util:{isHostMethod:a,isHostObject:d,isHostProperty:c,areHostMethods:j,areHostObjects:z,areHostProperties:x,isTextRange:l},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!0}};
y.fail=m;y.warn=function(a){a="Rangy warning: "+a;y.config.alertOnWarn?window.alert(a):typeof window.console!=f&&typeof window.console.log!=f&&window.console.log(a)};({}).hasOwnProperty?y.util.extend=function(a,b){for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e])}:m("hasOwnProperty not supported");var B=[],A=[];y.init=g;y.addInitListener=function(a){y.initialized?a(y):B.push(a)};var F=[];y.addCreateMissingNativeApiListener=function(a){F.push(a)};y.createMissingNativeApi=function(a){a=a||window;g();
for(var b=0,e=F.length;b<e;++b)F[b](a)};k.prototype.fail=function(a){this.initialized=!0;this.supported=!1;throw Error("Module '"+this.name+"' failed to load: "+a);};k.prototype.warn=function(a){y.warn("Module "+this.name+": "+a)};k.prototype.createError=function(a){return Error("Error in Rangy "+this.name+" module: "+a)};y.createModule=function(a,b){var e=new k(a);y.modules[a]=e;A.push(function(a){b(a,e);e.initialized=!0;e.supported=!0})};y.requireModules=function(a){for(var b=0,e=a.length,g,c;b<
e;++b){c=a[b];g=y.modules[c];if(!g||!(g instanceof k))throw Error("Module '"+c+"' not found");if(!g.supported)throw Error("Module '"+c+"' not supported");}};var N=!1,z=function(){N||(N=!0,y.initialized||g())};if(typeof window==f)m("No window found");else if(typeof document==f)m("No document found");else return a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",z,!1),a(window,"addEventListener")?window.addEventListener("load",z,!1):a(window,"attachEvent")?window.attachEvent("onload",
z):m("Window does not have required addEventListener or attachEvent method"),y}();f.createModule("DomUtil",function(a,d){function c(a){for(var b=0;a=a.previousSibling;)b++;return b}function b(a,b){var e=[],g;for(g=a;g;g=g.parentNode)e.push(g);for(g=b;g;g=g.parentNode)if(z(e,g))return g;return null}function l(a,b,e){for(e=e?a:a.parentNode;e;){a=e.parentNode;if(a===b)return e;e=a}return null}function m(a){a=a.nodeType;return 3==a||4==a||8==a}function g(a,b){var e=b.nextSibling,g=b.parentNode;e?g.insertBefore(a,
e):g.appendChild(a);return a}function k(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=u)return a.ownerDocument;if(typeof a.document!=u)return a.document;if(a.parentNode)return k(a.parentNode);throw Error("getDocument: no document found for node");}function e(a){if(a)return a.previousSibling?a.previousSibling.nextSibling:a.nextSibling?a.nextSibling.previousSibling:a.parentNode?a.parentNode.firstChild:a}function p(a){return!a?"[No node]":m(a)?'"'+a.data+'"':1==a.nodeType?"<"+a.nodeName+(a.id?
' id="'+a.id+'"':"")+">["+a.childNodes.length+"]":a.nodeName}function f(a){this._next=this.root=a}function r(a,b){this.node=a;this.offset=b}function q(a){this.code=this[a];this.codeName=a;this.message="DOMException: "+this.codeName}var u="undefined",t=a.util;t.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||d.fail("document missing a Node creation method");t.isHostMethod(document,"getElementsByTagName")||d.fail("document missing getElementsByTagName method");
var j=document.createElement("div");t.areHostMethods(j,["insertBefore","appendChild","cloneNode"])||d.fail("Incomplete Element implementation");t.isHostProperty(j,"innerHTML")||d.fail("Element is missing innerHTML property");j=document.createTextNode("test");t.areHostMethods(j,["splitText","deleteData","insertData","appendData","cloneNode"])||d.fail("Incomplete Text Node implementation");var z=function(a,b){for(var e=a.length;e--;)if(a[e]===b)return!0;return!1};f.prototype={_current:null,hasNext:function(){return!!this._next},
next:function(){var a=this._current=this._next,b;if(this._current){b=a.firstChild;if(!b)for(b=null;a!==this.root&&!(b=a.nextSibling);)a=a.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}};r.prototype={equals:function(a){return this.node===a.node&this.offset==a.offset},inspect:function(){return"[DomPosition("+p(this.node)+":"+this.offset+")]"}};q.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,
NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};q.prototype.toString=function(){return this.message};a.dom={arrayContains:z,isHtmlNamespace:function(a){var b;return typeof a.namespaceURI==u||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b},parentElement:function(a){a=a.parentNode;return 1==a.nodeType?a:null},getNodeIndex:c,getNodeLength:function(a){var b;return m(a)?a.length:(b=a.childNodes)?b.length:0},getCommonAncestor:b,isAncestorOf:function(a,b,e){for(b=e?b:b.parentNode;b;){if(b===
a)return!0;b=b.parentNode}return!1},getClosestAncestorIn:l,isCharacterDataNode:m,insertAfter:g,splitDataNode:function(a,b){var e=a.cloneNode(!1);e.deleteData(0,b);a.deleteData(b,a.length-b);g(e,a);return e},getDocument:k,getWindow:function(a){a=k(a);if(typeof a.defaultView!=u)return a.defaultView;if(typeof a.parentWindow!=u)return a.parentWindow;throw Error("Cannot get a window object for node");},getIframeWindow:function(a){if(typeof a.contentWindow!=u)return a.contentWindow;if(typeof a.contentDocument!=
u)return a.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element");},getIframeDocument:function(a){if(typeof a.contentDocument!=u)return a.contentDocument;if(typeof a.contentWindow!=u)return a.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element");},getBody:function(a){return t.isHostObject(a,"body")?a.body:a.getElementsByTagName("body")[0]},getRootContainer:function(a){for(var b;b=a.parentNode;)a=b;return a},
comparePoints:function(a,g,k,m){var a=e(a),k=e(k),d;if(a==k)return g===m?0:g<m?-1:1;if(d=l(k,a,!0))return g<=c(d)?-1:1;if(d=l(a,k,!0))return c(d)<m?-1:1;g=b(a,k);a=a===g?g:l(a,g,!0);k=k===g?g:l(k,g,!0);if(a===k)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(g=g.firstChild;g;){if(g===a)return-1;if(g===k)return 1;g=g.nextSibling}throw Error("Should not be here!");},inspectNode:p,fragmentFromNodeChildren:function(a){for(var b=k(a).createDocumentFragment(),e;e=a.firstChild;)b.appendChild(e);
return b},createIterator:function(a){return new f(a)},DomPosition:r};a.DOMException=q});f.createModule("DomRange",function(a){function d(a,b){return 3!=a.nodeType&&(E.isAncestorOf(a,b.startContainer,!0)||E.isAncestorOf(a,b.endContainer,!0))}function c(a){return E.getDocument(a.startContainer)}function b(a,b,e){if(b=a._listeners[b])for(var g=0,k=b.length;g<k;++g)b[g].call(a,{target:a,args:e})}function l(a){return new H(a.parentNode,E.getNodeIndex(a))}function m(a){return new H(a.parentNode,E.getNodeIndex(a)+
1)}function g(a,b,e){var g=11==a.nodeType?a.firstChild:a;E.isCharacterDataNode(b)?e==b.length?E.insertAfter(a,b):b.parentNode.insertBefore(a,0==e?b:E.splitDataNode(b,e)):e>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[e]);return g}function k(a){for(var b,e,g=c(a.range).createDocumentFragment();e=a.next();){b=a.isPartiallySelectedSubtree();e=e.cloneNode(!b);b&&(b=a.getSubtreeIterator(),e.appendChild(k(b)),b.detach(!0));if(10==e.nodeType)throw new L("HIERARCHY_REQUEST_ERR");g.appendChild(e)}return g}
function e(a,b,g){for(var k,c,g=g||{stop:!1};k=a.next();)if(a.isPartiallySelectedSubtree())if(!1===b(k)){g.stop=!0;break}else{if(k=a.getSubtreeIterator(),e(k,b,g),k.detach(!0),g.stop)break}else for(k=E.createIterator(k);c=k.next();)if(!1===b(c)){g.stop=!0;return}}function p(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),p(b),b.detach(!0)):a.remove()}function f(a){for(var b,e=c(a.range).createDocumentFragment(),g;b=a.next();){a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),
g=a.getSubtreeIterator(),b.appendChild(f(g)),g.detach(!0)):a.remove();if(10==b.nodeType)throw new L("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function r(a,b,g){var k=!(!b||!b.length),c,l=!!g;k&&(c=RegExp("^("+b.join("|")+")$"));var m=[];e(new u(a,!1),function(a){(!k||c.test(a.nodeType))&&(!l||g(a))&&m.push(a)});return m}function q(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+E.inspectNode(a.startContainer)+":"+a.startOffset+", "+E.inspectNode(a.endContainer)+":"+a.endOffset+
")]"}function u(a,b){this.range=a;this.clonePartiallySelectedTextNodes=b;if(!a.collapsed){this.sc=a.startContainer;this.so=a.startOffset;this.ec=a.endContainer;this.eo=a.endOffset;var e=a.commonAncestorContainer;this.sc===this.ec&&E.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===e&&!E.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:E.getClosestAncestorIn(this.sc,e,!0),this._last=this.ec===e&&!E.isCharacterDataNode(this.ec)?
this.ec.childNodes[this.eo-1]:E.getClosestAncestorIn(this.ec,e,!0))}}function t(a){this.code=this[a];this.codeName=a;this.message="RangeException: "+this.codeName}function j(a,b,e){this.nodes=r(a,b,e);this._next=this.nodes[0];this._position=0}function z(a){return function(b,e){for(var g,k=e?b:b.parentNode;k;){g=k.nodeType;if(E.arrayContains(a,g))return k;k=k.parentNode}return null}}function x(a,b){if(Da(a,b))throw new t("INVALID_NODE_TYPE_ERR");}function y(a){if(!a.startContainer)throw new L("INVALID_STATE_ERR");
}function B(a,b){if(!E.arrayContains(b,a.nodeType))throw new t("INVALID_NODE_TYPE_ERR");}function A(a,b){if(0>b||b>(E.isCharacterDataNode(a)?a.length:a.childNodes.length))throw new L("INDEX_SIZE_ERR");}function F(a,b){if(S(a,!0)!==S(b,!0))throw new L("WRONG_DOCUMENT_ERR");}function N(a){if(W(a,!0))throw new L("NO_MODIFICATION_ALLOWED_ERR");}function K(a,b){if(!a)throw new L(b);}function G(a){y(a);if(!E.arrayContains(O,a.startContainer.nodeType)&&!S(a.startContainer,!0)||!E.arrayContains(O,a.endContainer.nodeType)&&
!S(a.endContainer,!0)||!(a.startOffset<=(E.isCharacterDataNode(a.startContainer)?a.startContainer.length:a.startContainer.childNodes.length))||!(a.endOffset<=(E.isCharacterDataNode(a.endContainer)?a.endContainer.length:a.endContainer.childNodes.length)))throw Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")");}function R(){}function I(a){a.START_TO_START=J;a.START_TO_END=ea;a.END_TO_END=ua;a.END_TO_START=la;a.NODE_BEFORE=Ya;a.NODE_AFTER=La;a.NODE_BEFORE_AND_AFTER=
Qa;a.NODE_INSIDE=qa}function ba(a){I(a);I(a.prototype)}function T(a,b){return function(){G(this);var g=this.startContainer,k=this.startOffset,c=this.commonAncestorContainer,l=new u(this,!0);g!==c&&(g=E.getClosestAncestorIn(g,c,!0),k=m(g),g=k.node,k=k.offset);e(l,N);l.reset();c=a(l);l.detach();b(this,g,k,g,k);return c}}function Y(b,e,g){function k(a,b){return function(e){y(this);B(e,C);B(X(e),O);e=(a?l:m)(e);(b?c:q)(this,e.node,e.offset)}}function c(a,b,g){var k=a.endContainer,l=a.endOffset;if(b!==
a.startContainer||g!==this.startOffset){if(X(b)!=X(k)||1==E.comparePoints(b,g,k,l))k=b,l=g;e(a,b,g,k,l)}}function q(a,b,g){var k=a.startContainer,c=a.startOffset;if(b!==a.endContainer||g!==this.endOffset){if(X(b)!=X(k)||-1==E.comparePoints(b,g,k,c))k=b,c=g;e(a,k,c,b,g)}}function t(a,b,g){(b!==a.startContainer||g!==this.startOffset||b!==a.endContainer||g!==this.endOffset)&&e(a,b,g,b,g)}b.prototype=new R;a.util.extend(b.prototype,{setStart:function(a,b){y(this);x(a,!0);A(a,b);c(this,a,b)},setEnd:function(a,
b){y(this);x(a,!0);A(a,b);q(this,a,b)},setStartBefore:k(!0,!0),setStartAfter:k(!1,!0),setEndBefore:k(!0,!1),setEndAfter:k(!1,!1),collapse:function(a){G(this);a?e(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):e(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){y(this);x(a,!0);e(this,a,0,a,E.getNodeLength(a))},selectNode:function(a){y(this);x(a,!1);B(a,C);var b=l(a),a=m(a);e(this,b.node,b.offset,a.node,a.offset)},
extractContents:T(f,e),deleteContents:T(p,e),canSurroundContents:function(){G(this);N(this.startContainer);N(this.endContainer);var a=new u(this,!0),b=a._first&&d(a._first,this)||a._last&&d(a._last,this);a.detach();return!b},detach:function(){g(this)},splitBoundaries:function(){G(this);var a=this.startContainer,b=this.startOffset,g=this.endContainer,k=this.endOffset,c=a===g;E.isCharacterDataNode(g)&&(0<k&&k<g.length)&&E.splitDataNode(g,k);E.isCharacterDataNode(a)&&(0<b&&b<a.length)&&(a=E.splitDataNode(a,
b),c?(k-=b,g=a):g==a.parentNode&&k>=E.getNodeIndex(a)&&k++,b=0);e(this,a,b,g,k)},normalizeBoundaries:function(){G(this);var a=this.startContainer,b=this.startOffset,g=this.endContainer,k=this.endOffset,c=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(g=a,k=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},l=function(e){var c=e.previousSibling;if(c&&c.nodeType==e.nodeType){a=e;var l=e.length;b=c.length;e.insertData(0,c.data);c.parentNode.removeChild(c);a==g?(k+=b,g=a):g==e.parentNode&&
(c=E.getNodeIndex(e),k==c?(g=e,k=l):k>c&&k--)}},m=!0;E.isCharacterDataNode(g)?g.length==k&&c(g):(0<k&&(m=g.childNodes[k-1])&&E.isCharacterDataNode(m)&&c(m),m=!this.collapsed);m?E.isCharacterDataNode(a)?0==b&&l(a):b<a.childNodes.length&&(c=a.childNodes[b])&&E.isCharacterDataNode(c)&&l(c):(a=g,b=k);e(this,a,b,g,k)},collapseToPoint:function(a,b){y(this);x(a,!0);A(a,b);t(this,a,b)}});ba(b)}function D(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;a.commonAncestorContainer=
a.collapsed?a.startContainer:E.getCommonAncestor(a.startContainer,a.endContainer)}function M(a,e,g,k,c){var l=a.startContainer!==e||a.startOffset!==g,m=a.endContainer!==k||a.endOffset!==c;a.startContainer=e;a.startOffset=g;a.endContainer=k;a.endOffset=c;D(a);b(a,"boundarychange",{startMoved:l,endMoved:m})}function Z(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};D(this)}a.requireModules(["DomUtil"]);var E=a.dom,H=E.DomPosition,
L=a.DOMException;u.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;a&&(this._next=a!==this._last?a.nextSibling:null,E.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so)));
return a},remove:function(){var a=this._current,b,e;E.isCharacterDataNode(a)&&(a===this.sc||a===this.ec)?(b=a===this.sc?this.so:0,e=a===this.ec?this.eo:a.length,b!=e&&a.deleteData(b,e-b)):a.parentNode&&a.parentNode.removeChild(a)},isPartiallySelectedSubtree:function(){return d(this._current,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new Z(c(this.range));var b=this._current,e=b,g=0,k=b,l=E.getNodeLength(b);E.isAncestorOf(b,
this.sc,!0)&&(e=this.sc,g=this.so);E.isAncestorOf(b,this.ec,!0)&&(k=this.ec,l=this.eo);M(a,e,g,k,l)}return new u(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach();this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};t.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};t.prototype.toString=function(){return this.message};j.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=
this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var C=[1,3,4,5,7,8,10],O=[2,9,11],ha=[1,3,4,5,7,8,10,11],aa=[1,3,4,5,7,8],X=E.getRootContainer,S=z([9,11]),W=z([5,6,10,12]),Da=z([6,10,12]),ia=document.createElement("style"),na=!1;try{ia.innerHTML="<b>x</b>",na=3==ia.firstChild.nodeType}catch(ta){}a.features.htmlParsingConforms=na;var va="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),
J=0,ea=1,ua=2,la=3,Ya=0,La=1,Qa=2,qa=3;R.prototype={attachListener:function(a,b){this._listeners[a].push(b)},compareBoundaryPoints:function(a,b){G(this);F(this.startContainer,b.startContainer);var e=a==la||a==J?"start":"end",g=a==ea||a==J?"start":"end";return E.comparePoints(this[e+"Container"],this[e+"Offset"],b[g+"Container"],b[g+"Offset"])},insertNode:function(a){G(this);B(a,ha);N(this.startContainer);if(E.isAncestorOf(a,this.startContainer,!0))throw new L("HIERARCHY_REQUEST_ERR");this.setStartBefore(g(a,
this.startContainer,this.startOffset))},cloneContents:function(){G(this);var a,b;if(this.collapsed)return c(this).createDocumentFragment();if(this.startContainer===this.endContainer&&E.isCharacterDataNode(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=c(this).createDocumentFragment(),b.appendChild(a),b;b=new u(this,!0);a=k(b);b.detach();return a},canSurroundContents:function(){G(this);N(this.startContainer);N(this.endContainer);
var a=new u(this,!0),b=a._first&&d(a._first,this)||a._last&&d(a._last,this);a.detach();return!b},surroundContents:function(a){B(a,aa);if(!this.canSurroundContents())throw new t("BAD_BOUNDARYPOINTS_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset);a.appendChild(b);this.selectNode(a)},cloneRange:function(){G(this);for(var a=new Z(c(this)),b=va.length,e;b--;)e=va[b],a[e]=this[e];return a},toString:function(){G(this);
var a=this.startContainer;if(a===this.endContainer&&E.isCharacterDataNode(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],a=new u(this,!0);e(a,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)});a.detach();return b.join("")},compareNode:function(a){G(this);var b=a.parentNode,e=E.getNodeIndex(a);if(!b)throw new L("NOT_FOUND_ERR");a=this.comparePoint(b,e);b=this.comparePoint(b,e+1);return 0>a?0<b?Qa:Ya:0<b?La:qa},comparePoint:function(a,b){G(this);
K(a,"HIERARCHY_REQUEST_ERR");F(a,this.startContainer);return 0>E.comparePoints(a,b,this.startContainer,this.startOffset)?-1:0<E.comparePoints(a,b,this.endContainer,this.endOffset)?1:0},createContextualFragment:na?function(a){var b=this.startContainer,e=E.getDocument(b);if(!b)throw new L("INVALID_STATE_ERR");var g=null;1==b.nodeType?g=b:E.isCharacterDataNode(b)&&(g=E.parentElement(b));g=null===g||"HTML"==g.nodeName&&E.isHtmlNamespace(E.getDocument(g).documentElement)&&E.isHtmlNamespace(g)?e.createElement("body"):
g.cloneNode(!1);g.innerHTML=a;return E.fragmentFromNodeChildren(g)}:function(a){y(this);var b=c(this).createElement("body");b.innerHTML=a;return E.fragmentFromNodeChildren(b)},toHtml:function(){G(this);var a=c(this).createElement("div");a.appendChild(this.cloneContents());return a.innerHTML},intersectsNode:function(a,b){G(this);K(a,"NOT_FOUND_ERR");if(E.getDocument(a)!==c(this))return!1;var e=a.parentNode,g=E.getNodeIndex(a);K(e,"NOT_FOUND_ERR");var k=E.comparePoints(e,g,this.endContainer,this.endOffset),
e=E.comparePoints(e,g+1,this.startContainer,this.startOffset);return b?0>=k&&0<=e:0>k&&0<e},isPointInRange:function(a,b){G(this);K(a,"HIERARCHY_REQUEST_ERR");F(a,this.startContainer);return 0<=E.comparePoints(a,b,this.startContainer,this.startOffset)&&0>=E.comparePoints(a,b,this.endContainer,this.endOffset)},intersectsRange:function(a,b){G(this);if(c(a)!=c(this))throw new L("WRONG_DOCUMENT_ERR");var e=E.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),g=E.comparePoints(this.endContainer,
this.endOffset,a.startContainer,a.startOffset);return b?0>=e&&0<=g:0>e&&0<g},intersection:function(a){if(this.intersectsRange(a)){var b=E.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),e=E.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),g=this.cloneRange();-1==b&&g.setStart(a.startContainer,a.startOffset);1==e&&g.setEnd(a.endContainer,a.endOffset);return g}return null},union:function(a){if(this.intersectsRange(a,!0)){var b=this.cloneRange();
-1==E.comparePoints(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset);1==E.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset);return b}throw new t("Ranges do not intersect");},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==qa},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,E.getNodeLength(a))},containsRange:function(a){return this.intersection(a).equals(a)},
containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var e=b.getNodes([3]);return 0<e.length?(b.setStart(e[0],0),a=e.pop(),b.setEnd(a,a.length),a=this.containsRange(b),b.detach(),a):this.containsNodeContents(a)},createNodeIterator:function(a,b){G(this);return new j(this,a,b)},getNodes:function(a,b){G(this);return r(this,a,b)},getDocument:function(){return c(this)},collapseBefore:function(a){y(this);this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){y(this);this.setStartAfter(a);
this.collapse(!0)},getName:function(){return"DomRange"},equals:function(a){return Z.rangesEqual(this,a)},inspect:function(){return q(this)}};Y(Z,M,function(a){y(a);a.startContainer=a.startOffset=a.endContainer=a.endOffset=null;a.collapsed=a.commonAncestorContainer=null;b(a,"detach",null);a._listeners=null});a.rangePrototype=R.prototype;Z.rangeProperties=va;Z.RangeIterator=u;Z.copyComparisonConstants=ba;Z.createPrototypeRange=Y;Z.inspect=q;Z.getRangeDocument=c;Z.rangesEqual=function(a,b){return a.startContainer===
b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset};a.DomRange=Z;a.RangeException=t});f.createModule("WrappedRange",function(a){function d(a,b,g,k){var c=a.duplicate();c.collapse(g);var d=c.parentElement();l.isAncestorOf(b,d,!0)||(d=b);if(!d.canHaveHTML)return new m(d.parentNode,l.getNodeIndex(d));b=l.getDocument(d).createElement("span");b.parentNode&&b.parentNode.removeChild(b);var f,j=g?"StartToStart":"StartToEnd";do d.insertBefore(b,b.previousSibling),
c.moveToElementText(b);while(0<(f=c.compareEndPoints(j,a))&&b.previousSibling);j=b.nextSibling;if(-1==f&&j&&l.isCharacterDataNode(j)){c.setEndPoint(g?"EndToStart":"EndToEnd",a);if(/[\r\n]/.test(j.data)){c=c.duplicate();d=c.text.replace(/\r\n/g,"\r").length;for(d=c.moveStart("character",d);-1==c.compareEndPoints("StartToEnd",c);)d++,c.moveStart("character",1)}else if(d=c.text.replace(/\u00a0/g," "),g=j.data.replace(/\u00a0/g," "),0!==g.indexOf(d)){for(;0<d.length&&0!==g.indexOf(d);)d=d.substr(1);d=
d.length}else d=c.text.length;j=new m(j,d)}else j=(k||!g)&&b.previousSibling,j=(c=(k||g)&&b.nextSibling)&&l.isCharacterDataNode(c)?new m(c,0):j&&l.isCharacterDataNode(j)?new m(j,j.length):new m(d,l.getNodeIndex(b));b.parentNode.removeChild(b);return j}function c(a,b){var g,k,c=a.offset,m=l.getDocument(a.node),d=m.body.createTextRange(),f=l.isCharacterDataNode(a.node);f?(g=a.node,k=g.parentNode):(g=a.node.childNodes,g=c<g.length?g[c]:null,k=a.node);m=m.createElement("span");m.innerHTML="&#feff;";g?
k.insertBefore(m,g):k.appendChild(m);try{d.moveToElementText(m),d.collapse(!b)}catch(j){}k.removeChild(m);if(f)d[b?"moveStart":"moveEnd"]("character",c);return d}a.requireModules(["DomUtil","DomRange"]);var b,l=a.dom,m=l.DomPosition,g=a.DomRange;if(a.features.implementsDomRange&&(!a.features.implementsTextRange||!a.config.preferTextRange))(function(){function e(a){for(var b=c.length,e;b--;)e=c[b],a[e]=a.nativeRange[e]}var k,c=g.rangeProperties,m;b=function(a){if(!a)throw Error("Range must be specified");
this.nativeRange=a;e(this)};g.createPrototypeRange(b,function(a,b,e,g,k){var c=a.endContainer!==g||a.endOffset!=k;if(a.startContainer!==b||a.startOffset!=e||c)a.setEnd(g,k),a.setStart(b,e)},function(a){a.nativeRange.detach();a.detached=!0;for(var b=c.length,e;b--;)e=c[b],a[e]=null});k=b.prototype;k.selectNode=function(a){this.nativeRange.selectNode(a);e(this)};k.deleteContents=function(){this.nativeRange.deleteContents();e(this)};k.extractContents=function(){var a=this.nativeRange.extractContents();
e(this);return a};k.cloneContents=function(){return this.nativeRange.cloneContents()};k.surroundContents=function(a){this.nativeRange.surroundContents(a);e(this)};k.collapse=function(a){this.nativeRange.collapse(a);e(this)};k.cloneRange=function(){return new b(this.nativeRange.cloneRange())};k.refresh=function(){e(this)};k.toString=function(){return this.nativeRange.toString()};var d=document.createTextNode("test");l.getBody(document).appendChild(d);var f=document.createRange();f.setStart(d,0);f.setEnd(d,
0);try{f.setStart(d,1),k.setStart=function(a,b){this.nativeRange.setStart(a,b);e(this)},k.setEnd=function(a,b){this.nativeRange.setEnd(a,b);e(this)},m=function(a){return function(b){this.nativeRange[a](b);e(this)}}}catch(t){k.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(g){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}e(this)},k.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(g){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,b)}e(this)},m=function(a,
b){return function(g){try{this.nativeRange[a](g)}catch(k){this.nativeRange[b](g),this.nativeRange[a](g)}e(this)}}}k.setStartBefore=m("setStartBefore","setEndBefore");k.setStartAfter=m("setStartAfter","setEndAfter");k.setEndBefore=m("setEndBefore","setStartBefore");k.setEndAfter=m("setEndAfter","setStartAfter");f.selectNodeContents(d);k.selectNodeContents=f.startContainer==d&&f.endContainer==d&&0==f.startOffset&&f.endOffset==d.length?function(a){this.nativeRange.selectNodeContents(a);e(this)}:function(a){this.setStart(a,
0);this.setEnd(a,g.getEndOffset(a))};f.selectNodeContents(d);f.setEnd(d,3);m=document.createRange();m.selectNodeContents(d);m.setEnd(d,4);m.setStart(d,2);k.compareBoundaryPoints=-1==f.compareBoundaryPoints(f.START_TO_END,m)&1==f.compareBoundaryPoints(f.END_TO_START,m)?function(a,b){b=b.nativeRange||b;a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END);return this.nativeRange.compareBoundaryPoints(a,b)}:function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||
b)};a.util.isHostMethod(f,"createContextualFragment")&&(k.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)});l.getBody(document).removeChild(d);f.detach();m.detach()})(),a.createNativeRange=function(a){a=a||document;return a.createRange()};else if(a.features.implementsTextRange){b=function(a){this.textRange=a;this.refresh()};b.prototype=new g(document);b.prototype.refresh=function(){var a,b,g=this.textRange;a=g.parentElement();var k=g.duplicate();k.collapse(!0);
b=k.parentElement();k=g.duplicate();k.collapse(!1);g=k.parentElement();b=b==g?b:l.getCommonAncestor(b,g);b=b==a?b:l.getCommonAncestor(a,b);0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?b=a=d(this.textRange,b,!0,!0):(a=d(this.textRange,b,!0,!1),b=d(this.textRange,b,!1,!1));this.setStart(a.node,a.offset);this.setEnd(b.node,b.offset)};g.copyComparisonConstants(b);var k=function(){return this}();"undefined"==typeof k.Range&&(k.Range=b);a.createNativeRange=function(a){a=a||document;return a.body.createTextRange()}}a.features.implementsTextRange&&
(b.rangeToTextRange=function(a){if(a.collapsed)return c(new m(a.startContainer,a.startOffset),!0);var b=c(new m(a.startContainer,a.startOffset),!0),g=c(new m(a.endContainer,a.endOffset),!1),a=l.getDocument(a.startContainer).body.createTextRange();a.setEndPoint("StartToStart",b);a.setEndPoint("EndToEnd",g);return a});b.prototype.getName=function(){return"WrappedRange"};a.WrappedRange=b;a.createRange=function(e){e=e||document;return new b(a.createNativeRange(e))};a.createRangyRange=function(a){a=a||
document;return new g(a)};a.createIframeRange=function(b){return a.createRange(l.getIframeDocument(b))};a.createIframeRangyRange=function(b){return a.createRangyRange(l.getIframeDocument(b))};a.addCreateMissingNativeApiListener(function(b){b=b.document;if(typeof b.createRange=="undefined")b.createRange=function(){return a.createRange(this)};b=b=null})});f.createModule("WrappedSelection",function(a,d){function c(a){return(a||window).getSelection()}function b(a){return(a||window).document.selection}
function l(a,b,e){var g=e?"end":"start",e=e?"start":"end";a.anchorNode=b[g+"Container"];a.anchorOffset=b[g+"Offset"];a.focusNode=b[e+"Container"];a.focusOffset=b[e+"Offset"]}function m(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function g(b){var e;b instanceof x?(e=b._selectionNativeRange,e||(e=a.createNativeRange(v.getDocument(b.startContainer)),e.setEnd(b.endContainer,b.endOffset),e.setStart(b.startContainer,b.startOffset),
b._selectionNativeRange=e,b.attachListener("detach",function(){this._selectionNativeRange=null}))):b instanceof y?e=b.nativeRange:a.features.implementsDomRange&&b instanceof v.getWindow(b.startContainer).Range&&(e=b);return e}function k(a){var b=a.getNodes(),e;a:if(!b.length||1!=b[0].nodeType)e=!1;else{e=1;for(var g=b.length;e<g;++e)if(!v.isAncestorOf(b[0],b[e])){e=!1;break a}e=!0}if(!e)throw Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return b[0]}
function e(a,b){var e=new y(b);a._ranges=[e];l(a,e,!1);a.rangeCount=1;a.isCollapsed=e.collapsed}function f(b){b._ranges.length=0;if("None"==b.docSelection.type)m(b);else{var g=b.docSelection.createRange();if(g&&"undefined"!=typeof g.text)e(b,g);else{b.rangeCount=g.length;for(var k,c=v.getDocument(g.item(0)),d=0;d<b.rangeCount;++d)k=a.createRange(c),k.selectNode(g.item(d)),b._ranges.push(k);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed;l(b,b._ranges[b.rangeCount-1],!1)}}}function o(a,b){for(var e=
a.docSelection.createRange(),g=k(b),c=v.getDocument(e.item(0)),c=v.getBody(c).createControlRange(),l=0,m=e.length;l<m;++l)c.add(e.item(l));try{c.add(g)}catch(d){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");}c.select();f(a)}function r(a,b,e){this.nativeSelection=a;this.docSelection=b;this._ranges=[];this.win=e;this.refresh()}function q(a,b){for(var e=v.getDocument(b[0].startContainer),e=v.getBody(e).createControlRange(),
g=0,c;g<rangeCount;++g){c=k(b[g]);try{e.add(c)}catch(l){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)");}}e.select();f(a)}function u(a,b){if(a.anchorNode&&v.getDocument(a.anchorNode)!==v.getDocument(b))throw new B("WRONG_DOCUMENT_ERR");}function t(a){var b=[],e=new A(a.anchorNode,a.anchorOffset),g=new A(a.focusNode,a.focusOffset),k="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var c=
0,l=a.rangeCount;c<l;++c)b[c]=x.inspect(a.getRangeAt(c));return"["+k+"(Ranges: "+b.join(", ")+")(anchor: "+e.inspect()+", focus: "+g.inspect()+"]"}a.requireModules(["DomUtil","DomRange","WrappedRange"]);a.config.checkSelectionRanges=!0;var v=a.dom,z=a.util,x=a.DomRange,y=a.WrappedRange,B=a.DOMException,A=v.DomPosition,F,N,K=a.util.isHostMethod(window,"getSelection"),G=a.util.isHostObject(document,"selection"),R=G&&(!K||a.config.preferTextRange);R?(F=b,a.isSelectionValid=function(a){var a=(a||window).document,
b=a.selection;return"None"!=b.type||v.getDocument(b.createRange().parentElement())==a}):K?(F=c,a.isSelectionValid=function(){return!0}):d.fail("Neither document.selection or window.getSelection() detected.");a.getNativeSelection=F;var K=F(),I=a.createNativeRange(document),ba=v.getBody(document),T=z.areHostObjects(K,z.areHostProperties(K,["anchorOffset","focusOffset"]));a.features.selectionHasAnchorAndFocus=T;var Y=z.isHostMethod(K,"extend");a.features.selectionHasExtend=Y;var D="number"==typeof K.rangeCount;
a.features.selectionHasRangeCount=D;var M=!1,Z=!0;z.areHostMethods(K,["addRange","getRangeAt","removeAllRanges"])&&("number"==typeof K.rangeCount&&a.features.implementsDomRange)&&function(){var a=document.createElement("iframe");ba.appendChild(a);var b=v.getIframeDocument(a);b.open();b.write("<html><head></head><body>12</body></html>");b.close();var e=v.getIframeWindow(a).getSelection(),g=b.documentElement.lastChild.firstChild,b=b.createRange();b.setStart(g,1);b.collapse(true);e.addRange(b);Z=e.rangeCount==
1;e.removeAllRanges();var k=b.cloneRange();b.setStart(g,0);k.setEnd(g,2);e.addRange(b);e.addRange(k);M=e.rangeCount==2;b.detach();k.detach();ba.removeChild(a)}();a.features.selectionSupportsMultipleRanges=M;a.features.collapsedNonEditableSelectionsSupported=Z;var E=!1,H;ba&&z.isHostMethod(ba,"createControlRange")&&(H=ba.createControlRange(),z.areHostProperties(H,["item","add"])&&(E=!0));a.features.implementsControlRange=E;N=T?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:
function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:false};var L;z.isHostMethod(K,"getRangeAt")?L=function(a,b){try{return a.getRangeAt(b)}catch(e){return null}}:T&&(L=function(b){var e=v.getDocument(b.anchorNode),e=a.createRange(e);e.setStart(b.anchorNode,b.anchorOffset);e.setEnd(b.focusNode,b.focusOffset);if(e.collapsed!==this.isCollapsed){e.setStart(b.focusNode,b.focusOffset);e.setEnd(b.anchorNode,b.anchorOffset)}return e});a.getSelection=function(a){var a=a||window,e=a._rangySelection,
g=F(a),k=G?b(a):null;if(e){e.nativeSelection=g;e.docSelection=k;e.refresh(a)}else{e=new r(g,k,a);a._rangySelection=e}return e};a.getIframeSelection=function(b){return a.getSelection(v.getIframeWindow(b))};H=r.prototype;if(!R&&T&&z.areHostMethods(K,["removeAllRanges","addRange"])){H.removeAllRanges=function(){this.nativeSelection.removeAllRanges();m(this)};var C=function(b,e){var k=x.getRangeDocument(e),k=a.createRange(k);k.collapseToPoint(e.endContainer,e.endOffset);b.nativeSelection.addRange(g(k));
b.nativeSelection.extend(e.startContainer,e.startOffset);b.refresh()};H.addRange=D?function(b,e){if(E&&G&&this.docSelection.type=="Control")o(this,b);else if(e&&Y)C(this,b);else{var k;if(M)k=this.rangeCount;else{this.removeAllRanges();k=0}this.nativeSelection.addRange(g(b));this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==k+1){if(a.config.checkSelectionRanges)(k=L(this.nativeSelection,this.rangeCount-1))&&!x.rangesEqual(k,b)&&(b=new y(k));this._ranges[this.rangeCount-1]=b;l(this,
b,aa(this.nativeSelection));this.isCollapsed=N(this)}else this.refresh()}}:function(a,b){if(b&&Y)C(this,a);else{this.nativeSelection.addRange(g(a));this.refresh()}};H.setRanges=function(a){if(E&&a.length>1)q(this,a);else{this.removeAllRanges();for(var b=0,e=a.length;b<e;++b)this.addRange(a[b])}}}else if(z.isHostMethod(K,"empty")&&z.isHostMethod(I,"select")&&E&&R)H.removeAllRanges=function(){try{var a=j.browser.msie&&j.browser.version<8&&typeof document.documentMode==="undefined";a||this.docSelection.empty();
this.docSelection.type!="None"&&a&&this.docSelection.empty()}catch(b){}m(this)},H.addRange=function(a){if(this.docSelection.type=="Control")o(this,a);else try{y.rangeToTextRange(a).select();this._ranges[0]=a;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;l(this,a,false)}catch(b){}},H.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?q(this,a):b&&this.addRange(a[0])};else return d.fail("No means of selecting a Range or TextRange was found"),!1;H.getRangeAt=function(a){if(a<
0||a>=this.rangeCount)throw new B("INDEX_SIZE_ERR");return this._ranges[a]};var O;if(R)O=function(b){var g;if(a.isSelectionValid(b.win))g=b.docSelection.createRange();else{g=v.getBody(b.win.document).createTextRange();g.collapse(true)}b.docSelection.type=="Control"?f(b):g&&typeof g.text!="undefined"?e(b,g):m(b)};else if(z.isHostMethod(K,"getRangeAt")&&"number"==typeof K.rangeCount)O=function(b){if(E&&G&&b.docSelection.type=="Control")f(b);else{b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount;
if(b.rangeCount){for(var e=0,g=b.rangeCount;e<g;++e)b._ranges[e]=new a.WrappedRange(b.nativeSelection.getRangeAt(e));l(b,b._ranges[b.rangeCount-1],aa(b.nativeSelection));b.isCollapsed=N(b)}else m(b)}};else if(T&&"boolean"==typeof K.isCollapsed&&"boolean"==typeof I.collapsed&&a.features.implementsDomRange)O=function(a){var b;b=a.nativeSelection;if(b.anchorNode){b=L(b,0);a._ranges=[b];a.rangeCount=1;b=a.nativeSelection;a.anchorNode=b.anchorNode;a.anchorOffset=b.anchorOffset;a.focusNode=b.focusNode;
a.focusOffset=b.focusOffset;a.isCollapsed=N(a)}else m(a)};else return d.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;H.refresh=function(a){var b=a?this._ranges.slice(0):null;O(this);if(a){a=b.length;if(a!=this._ranges.length)return false;for(;a--;)if(!x.rangesEqual(b[a],this._ranges[a]))return false;return true}};var ha=function(a,b){var e=a.getAllRanges(),g=false;a.removeAllRanges();for(var k=0,c=e.length;k<c;++k)g||b!==e[k]?a.addRange(e[k]):g=true;a.rangeCount||
m(a)};H.removeRange=E?function(a){if(this.docSelection.type=="Control"){for(var b=this.docSelection.createRange(),a=k(a),e=v.getDocument(b.item(0)),e=v.getBody(e).createControlRange(),g,c=false,l=0,m=b.length;l<m;++l){g=b.item(l);g!==a||c?e.add(b.item(l)):c=true}e.select();f(this)}else ha(this,a)}:function(a){ha(this,a)};var aa;!R&&T&&a.features.implementsDomRange?(aa=function(a){var b=false;a.anchorNode&&(b=v.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)==1);return b},H.isBackwards=
function(){return aa(this)}):aa=H.isBackwards=function(){return false};H.toString=function(){for(var a=[],b=0,e=this.rangeCount;b<e;++b)a[b]=""+this._ranges[b];return a.join("")};H.collapse=function(b,e){u(this,b);var g=a.createRange(v.getDocument(b));g.collapseToPoint(b,e);this.removeAllRanges();this.addRange(g);this.isCollapsed=true};H.collapseToStart=function(){if(this.rangeCount){var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new B("INVALID_STATE_ERR");};H.collapseToEnd=
function(){if(this.rangeCount){var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new B("INVALID_STATE_ERR");};H.selectAllChildren=function(b){u(this,b);var e=a.createRange(v.getDocument(b));e.selectNodeContents(b);this.removeAllRanges();this.addRange(e)};H.deleteFromDocument=function(){if(E&&G&&this.docSelection.type=="Control"){for(var a=this.docSelection.createRange(),b;a.length;){b=a.item(0);a.remove(b);b.parentNode.removeChild(b)}this.refresh()}else if(this.rangeCount){a=
this.getAllRanges();this.removeAllRanges();b=0;for(var e=a.length;b<e;++b)a[b].deleteContents();this.addRange(a[e-1])}};H.getAllRanges=function(){return this._ranges.slice(0)};H.setSingleRange=function(a){this.setRanges([a])};H.containsNode=function(a,b){for(var e=0,g=this._ranges.length;e<g;++e)if(this._ranges[e].containsNode(a,b))return true;return false};H.toHtml=function(){var a="";if(this.rangeCount){for(var a=x.getRangeDocument(this._ranges[0]).createElement("div"),b=0,e=this._ranges.length;b<
e;++b)a.appendChild(this._ranges[b].cloneContents());a=a.innerHTML}return a};H.getName=function(){return"WrappedSelection"};H.inspect=function(){return t(this)};H.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null};r.inspect=t;a.Selection=r;a.selectionPrototype=H;a.addCreateMissingNativeApiListener(function(b){if(typeof b.getSelection=="undefined")b.getSelection=function(){return a.getSelection(this)};b=null})});return window.rangy=f});define("util/class",[],function(){var j=
!1,f=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(){function a(){!j&&this._constructor&&this._constructor.apply(this,arguments)}var d=this.prototype;j=!0;var c=new this;j=!1;for(var b=0;b<arguments.length;b++){var l=arguments[b],m;for(m in l)c[m]="function"==typeof l[m]&&"function"==typeof d[m]&&f.test(l[m])?function(a,b){return function(){var e=this._super;this._super=d[a];var c=b.apply(this,arguments);this._super=e;return c}}(m,l[m]):l[m]}a.prototype=
c;a.constructor=a;a.extend=arguments.callee;return a};return this.Class});GENTICS=window.GENTICS||{};GENTICS.Utils=GENTICS.Utils||{};define("util/lang",[],function(){});(function(j){var f=j.GENTICS;f.Utils.applyProperties=function(a,d){for(var c in d)d.hasOwnProperty(c)&&(a[c]=d[c])};f.Utils.uniqeString4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};f.Utils.guid=function(){var a=f.Utils.uniqeString4;return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}})(window);define("aloha/ecma5shims",
[],function(){function j(a){var b=null;if(a){do b=a;while(a=a.parentNode)}return b}function f(a,b){return(a.contains(b)&&16)+(b.contains(a)&&8)+(0<=a.sourceIndex&&0<=b.sourceIndex?(a.sourceIndex<b.sourceIndex&&4)+(a.sourceIndex>b.sourceIndex&&2):1)}function a(a){return"sourceIndex"in a?a:a.parentNode.insertBefore(document.createComment(""),a)}var d={bind:function(a){var b=this.obj||this,g=Function.prototype.bind,k=Array.prototype.slice.call(arguments,1);return g?g.apply(b,arguments):function(){return b.apply(a,
0===arguments.length?k:k.concat(Array.prototype.slice.call(arguments)))}},trim:function(){var a=this.obj||this,b=String.prototype.trim;return b?b.call(a):a.replace(/^\s+/,"").replace(/\s+$/,"")},indexOf:function(a,b){var g=this.obj||this,k=Array.prototype.indexOf;if(k)return k.call(g,a,b);void 0===b&&(b=0);0>b&&(b+=g.length);0>b&&(b=0);for(k=g.length;b<k;b++)if(b in g&&g[b]===a)return b;return-1},forEach:function(a,b){var g=this.obj||this,k=Array.prototype.forEach;if(k)return k.call(g,a,b);for(var k=
0,e=g.length;k<e;k++)k in g&&a.call(b,g[k],k,g)},map:function(a,b,g){var k=this.obj||this,e=Array.prototype.map,d="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,f=[];if(e)f=e.call(k,a,b);else{for(var e=Array(k.length),f=0,r=k.length;f<r;f++)f in k&&(e[f]=a.call(b,k[f],f,k));f=e}return d?c(f):f},filter:function(a,b,g){var k=this.obj||this,e=Array.prototype.filter,d="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,f=[];if(e)f=
e.call(k,a,b);else{for(var e=[],r,f=0,q=k.length;f<q;f++)f in k&&a.call(b,r=k[f],f,k)&&e.push(r);f=e}return d?c(f):f},every:function(a,b){var g=this.obj||this,k=Array.prototype.every;if(k)return k.call(g,a,b);for(var k=0,e=g.length;k<e;k++)if(k in g&&!a.call(b,g[k],k,g))return!1;return!0},some:function(a,b){var g=this.obj||this,k=Array.prototype.some;if(k)return k.call(g,a,b);for(var k=0,e=g.length;k<e;k++)if(k in g&&a.call(b,g[k],k,g))return!0;return!1},hasAttribute:function(a){var b=this.obj||this;
return b.hasAttribute?b.hasAttribute(a):!!b.getAttribute(a)}},c=function(a){var b=function(){};b.prototype=d;b=new b;b.obj=a;return b},b;for(b in d)c[b]=d[b];c.Node="undefined"!=typeof Node?Node:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,
DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32};c.compareDocumentPosition=function(b,c){if("compareDocumentPosition"in document.documentElement)return b.compareDocumentPosition(c);if(!("contains"in document.documentElement))throw"neither compareDocumentPosition nor contains is supported by this browser.";if(b==c)return 0;if(j(b)!=j(c))return 1;if("sourceIndex"in b&&"sourceIndex"in c)return f(b,c);if(b==document)return 20;if(c==document)return 10;
var g=a(b),k=a(c),e=f(g,k);b!=g&&g.parentNode.removeChild(g);c!=k&&k.parentNode.removeChild(k);return e};c.getComputedStyle=function(a,b){return"getComputedStyle"in window?window.getComputedStyle(a,b):a.currentStyle?a.currentStyle:null};return c});GENTICS=window.GENTICS||{};GENTICS.Utils=GENTICS.Utils||{};define("util/dom",["jquery","util/class","aloha/ecma5shims"],function(j,f,a){var d=window.GENTICS,c={P:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,LI:!0},f=f.extend({wordRegex:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,
nonWordRegex:/[^\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,
mergeableTags:"b code del em i ins strong sub sup #text".split(" "),nonWordBoundaryTags:"a b code del em i ins span strong sub sup #text".split(" "),nonEmptyTags:["br"],tags:{flow:"a abbr address area article aside audio b bdi bdo blockquote br button canvas cite code command datalist del details dfn div dl em embed fieldset figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr i iframe img input ins kbd keygen label map mark math menu meter nav noscript object ol output p pre progress q ruby s samp script section select small span strong style sub sup svg table textarea time u ul var video wbr #text".split(" "),
phrasing:"a abbr area audio b bdi bdo br button canvas cite code command datalist del dfn em embed i iframe img input ins kbd keygen label map mark math meter noscript object output progress q ruby samp script select small span strong sub sup svg textarea time u var video wbr #text".split(" ")},children:{a:"phrasing",abbr:"phrasing",address:"flow",area:"empty",article:"flow",aside:"flow",audio:"source",b:"phrasing",base:"empty",bdo:"phrasing",blockquote:"phrasing",body:"flow",br:"empty",button:"phrasing",
canvas:"phrasing",caption:"flow",cite:"phrasing",code:"phrasing",col:"empty",colgroup:"col",command:"empty",datalist:["phrasing","option"],dd:"flow",del:"phrasing",div:"flow",details:["summary","flow"],dfn:"flow",dl:["dt","dd"],dt:"phrasing",em:"phrasing",embed:"empty",fieldset:["legend","flow"],figcaption:"flow",figure:["figcaption","flow"],footer:"flow",form:"flow",h1:"phrasing",h2:"phrasing",h3:"phrasing",h4:"phrasing",h5:"phrasing",h6:"phrasing",header:"flow",hgroup:"h1 h2 h3 h4 h5 h6".split(" "),
hr:"empty",i:"phrasing",iframe:"#text",img:"empty",input:"empty",ins:"phrasing",kbd:"phrasing",keygen:"empty",label:"phrasing",legend:"phrasing",li:"flow",link:"empty",map:"area",mark:"phrasing",menu:["li","flow"],meta:"empty",meter:"phrasing",nav:"flow",noscript:"phrasing",object:"param",ol:"li",optgroup:"option",option:"#text",output:"phrasing",p:"phrasing",param:"empty",pre:"phrasing",progress:"phrasing",q:"phrasing",rp:"phrasing",rt:"phrasing",ruby:["phrasing","rt","rp"],s:"phrasing",samp:"pharsing",
script:"#script",section:"flow",select:["option","optgroup"],small:"phrasing",source:"empty",span:"phrasing",strong:"phrasing",style:"phrasing",sub:"phrasing",summary:"phrasing",sup:"phrasing",table:"caption colgroup thead tbody tfoot tr".split(" "),tbody:"tr",td:"flow",textarea:"#text",tfoot:"tr",th:"phrasing",thead:"tr",time:"phrasing",title:"#text",tr:["th","td"],track:"empty",u:"phrasing",ul:"li","var":"phrasing",video:"source",wbr:"empty"},blockLevelElements:"p h1 h2 h3 h4 h5 h6 blockquote div pre".split(" "),
listElements:["li","ol","ul"],split:function(a,c,d){var g=j(a.startContainer),k=a.startOffset,e,f,o,r,q,u,t,v,z;d&&(g=j(a.endContainer),k=a.endOffset);1>c.length&&(c=j(document.body));d=!a.isCollapsed()&&!d;f=g.parents().get();f.unshift(g.get(0));j.each(f,function(a,b){if(c.filter(function(){return this==b}).length){a>0&&(e=f.slice(0,a));return false}});if(!e)return!0;e=e.reverse();g=0;for(u=e.length;g<u;++g)if(t=e[g],g===u-1)3===t.nodeType?(q=document.createTextNode(t.data.substring(k,t.data.length)),
t.data=t.data.substring(0,k)):(v=j(t),q=v.contents(),v=v.clone(!1).empty(),q=v.append(q.slice(k,q.length)).get(0)),d&&a.endContainer===t&&(a.endContainer=q,a.endOffset-=k,a.clearCaches()),r?r.prepend(q):j(t).after(q);else{v=j(t).clone(!1).empty();o?r.prepend(v):o=v;for(r=v;;){z=e[g+1].nextSibling;if(!z)break;r.append(z)}if(d&&a.endContainer===t){a.endContainer=v.get(0);t=e[g+1];for(v=0;;){t=t.previousSibling;if(!t)break;v++}a.endOffset-=v;a.clearCaches()}}j(e[0]).after(o);return j([e[0],o?o.get(0):
q])},allowsNesting:function(a,c){if(!a||!a.nodeName||!c||!c.nodeName)return!1;var d=a.nodeName.toLowerCase(),g=c.nodeName.toLowerCase();return!this.children[d]?!1:this.children[d]==g||j.isArray(this.children[d])&&0<=j.inArray(g,this.children[d])||j.isArray(this.tags[this.children[d]])&&0<=j.inArray(g,this.tags[this.children[d]])?!0:!1},addMarkup:function(a,c,d){3===a.startContainer.nodeType&&(0<a.startOffset&&a.startOffset<a.startContainer.data.length)&&this.split(a,j(a.startContainer).parent(),!1);
3===a.endContainer.nodeType&&(0<a.endOffset&&a.endOffset<a.endContainer.data.length)&&this.split(a,j(a.endContainer).parent(),!0);this.recursiveAddMarkup(a.getRangeTree(),c,a,d);this.doCleanup({merge:!0,removeempty:!0},a)},recursiveAddMarkup:function(a,c,m,g){var k,e,m=0;for(e=a.length;m<e;++m)if("full"==a[m].type&&this.allowsNesting(c.get(0),a[m].domobj)){if((g||a[m].domobj.nodeName!=c.get(0).nodeName)&&(3!==a[m].domobj.nodeType||0!==j.trim(a[m].domobj.data).length))j(a[m].domobj).wrap(c),!g&&3!==
a[m].domobj.nodeType&&(k=new d.Utils.RangeObject,k.startContainer=k.endContainer=a[m].domobj.parentNode,k.startOffset=0,k.endOffset=k.endContainer.childNodes.length,this.removeMarkup(k,c,j(a[m].domobj.parentNode)))}else(g||a[m].domobj&&a[m].domobj.nodeName!==c.get(0).nodeName)&&(a[m].children&&0<a[m].children.length)&&this.recursiveAddMarkup(a[m].children,c)},findHighestElement:function(a,c,d){for(var c=c.toLowerCase(),g,k=a,a=d?function(){return d.filter(function(){return k==this}).length}:function(){return!1};!a()&&
k;)k.nodeName.toLowerCase()===c&&(g=k),k=k.parentNode;return g},removeMarkup:function(a,c,d){var g=c.get(0).nodeName,k=this.findHighestElement(a.startContainer,g,d),e=this.findHighestElement(a.endContainer,g,d),f=!1;k&&0<a.startOffset&&(this.split(a,j(k).parent(),!1),f=!0);if(e&&(3===a.endContainer.nodeType&&a.endOffset<a.endContainer.data.length&&(this.split(a,j(e).parent(),!0),f=!0),1===a.endContainer.nodeType&&a.endOffset<a.endContainer.childNodes.length))this.split(a,j(e).parent(),!0),f=!0;f&&
a.correctRange();if(d=(d=this.findHighestElement(a.getCommonAncestorContainer(),g,d))?d.parentNode:a.getCommonAncestorContainer())g=a.getRangeTree(d),this.recursiveRemoveMarkup(g,c),this.doCleanup({merge:!0,removeempty:!0},a,d)},recursiveRemoveMarkup:function(a,c){var d,g,k;d=0;for(g=a.length;d<g;++d)"full"==a[d].type&&a[d].domobj.nodeName==c.get(0).nodeName&&(k=j(a[d].domobj).contents(),0<k.length?k.first().unwrap():j(a[d].domobj).remove()),a[d].children&&this.recursiveRemoveMarkup(a[d].children,
c)},doCleanup:function(a,c,m){var g=this,k,e,f,o,r;"undefined"===typeof a&&(a={});"undefined"===typeof a.merge&&(a.merge=!1);"undefined"===typeof a.removeempty&&(a.removeempty=!1);"undefined"===typeof m&&c&&(m=c.getCommonAncestorContainer());e=k=!1;f=j(m);o=c.startOffset;r=c.endOffset;f.contents().each(function(){var m,u;try{u=this.nodeType;m=g.getIndexInParent(this)}catch(t){return}switch(u){case 1:if(k&&k.nodeName==this.nodeName){if(c.startContainer===f&&o>m){c.startOffset=c.startOffset-1;e=true}if(c.endContainer===
f&&r>m){c.endOffset=c.endOffset-1;e=true}j(k).append(j(this).contents());e=e|g.doCleanup(a,c,k);j(this).remove()}else{e=e|g.doCleanup(a,c,this);u=false;if(a.removeempty){d.Utils.Dom.isBlockLevelElement(this)&&this.childNodes.length===0&&(u=true);j.inArray(this.nodeName.toLowerCase(),g.mergeableTags)>=0&&(j(this).text().length===0&&this.childNodes.length===0)&&(u=true)}if(u){if(c.startContainer===this.parentNode&&o>m){c.startOffset=c.startOffset-1;e=true}if(c.endContainer===this.parentNode&&r>m){c.endOffset=
c.endOffset-1;e=true}j(this).remove()}else k=j.inArray(this.nodeName.toLowerCase(),g.mergeableTags)>=0?this:false}break;case 3:if(k&&k.nodeType===3&&a.merge){if(c.startContainer===this){c.startContainer=k;c.startOffset=c.startOffset+k.nodeValue.length;e=true}else if(c.startContainer===k.parentNode&&c.startOffset===g.getIndexInParent(k)+1){c.startContainer=k;c.startOffset=k.nodeValue.length;e=true}if(c.endContainer===this){c.endContainer=k;c.endOffset=c.endOffset+k.nodeValue.length;e=true}else if(c.endContainer===
k.parentNode&&c.endOffset===g.getIndexInParent(k)+1){c.endContainer=k;c.endOffset=k.nodeValue.length;e=true}k.data=k.data+this.data}else if(!(this.nodeValue===""&&a.removeempty)&&!(this.nodeValue===""&&a.removeempty)){k=this;break}if(c.startContainer===this.parentNode&&c.startOffset>m){c.startOffset=c.startOffset-1;e=true}if(c.endContainer===this.parentNode&&c.endOffset>m){c.endOffset=c.endOffset-1;e=true}j(this).remove();if(k&&(!k.nextSibling||k.nextSibling.nodeType!==3))for(m=k.data.length-1;m>=
0&&k.data.length>1;m--)if(k.data.charAt(m)==="​"){k.deleteData(m,1);if(c.startContainer===k&&c.startOffset>m){c.startOffset--;e=true}if(c.endContainer===k&&c.endOffset>m){c.endOffset--;e=true}}}});e&&c.clearCaches();return e},getIndexInParent:function(a){if(!a)return!1;for(var c=0,a=a.previousSibling;a;)c++,a=a.previousSibling;return c},isBlockLevelElement:function(a){return!a?!1:1===a.nodeType&&0<=j.inArray(a.nodeName.toLowerCase(),this.blockLevelElements)?!0:!1},isLineBreakElement:function(a){return!a?
!1:1===a.nodeType&&"br"==a.nodeName.toLowerCase()},isListElement:function(a){return!a?!1:1===a.nodeType&&0<=j.inArray(a.nodeName.toLowerCase(),this.listElements)},isSplitObject:function(a){return 1===a.nodeType&&c.hasOwnProperty(a.nodeName)},searchAdjacentTextNode:function(a,c,d,g){if(!a||1!==a.nodeType||0>c||c>a.childNodes.length)return!1;"undefined"===typeof g&&(g={blocklevel:!0,list:!0,linebreak:!0});"undefined"===typeof g.blocklevel&&(g.blocklevel=!0);"undefined"===typeof g.list&&(g.list=!0);
"undefined"===typeof g.linebreak&&(g.linebreak=!0);"undefined"===typeof d&&(d=!0);var k,e=a;d&&0<c&&(k=a.childNodes[c-1]);for(!d&&c<a.childNodes.length&&(k=a.childNodes[c]);e;)if(k){if(3===k.nodeType&&0<j.trim(k.data).length)return k;if(g.blocklevel&&this.isBlockLevelElement(k)||g.linebreak&&this.isLineBreakElement(k)||g.list&&this.isListElement(k))return!1;3===k.nodeType?k=d?k.previousSibling:k.nextSibling:(e=k,k=d?k.lastChild:k.firstChild)}else{if(g.blocklevel&&this.isBlockLevelElement(e)||g.list&&
this.isListElement(e))return!1;k=d?e.previousSibling:e.nextSibling;e=e.parentNode}},insertIntoDOM:function(a,c,d,g,k){var e=c.getContainerParents(d,g),f=this,o;d||(d=j(document.body));0===e.length?o=d.get(0):j.each(e,function(e,g){if(f.allowsNesting(g,a.get(0)))return o=g,!1});"undefined"===typeof o&&0<d.length&&(o=d.get(0));if((this.allowsNesting(o,a.get(0))||k)&&"undefined"!==typeof o){d=this.split(c,j(o),g);if(!0===d)return d=c.startContainer,k=c.startOffset,g&&(d=c.endContainer,k=c.endOffset),
0===k?(c=j(d).contents(),0<c.length?c.eq(0).before(a):j(d).append(a)):j(d).contents().eq(k-1).after(a),!0;if(d)return d.eq(0).after(a),!0}return!1},removeFromDOM:function(a,c,d){if(d){var d=this.getIndexInParent(a),g=j(a).contents().length,k=a.parentNode;c.startContainer==k&&c.startOffset>d?c.startOffset+=g-1:c.startContainer==a&&(c.startContainer=k,c.startOffset=d+c.startOffset);c.endContainer==k&&c.endOffset>d?c.endOffset+=g-1:c.endContainer==a&&(c.endContainer=k,c.endOffset=d+c.endOffset);j(a).contents().unwrap();
this.doCleanup({merge:!0},c,k)}},removeRange:function(a){if(!a||a.isCollapsed())return!1;3==a.startContainer.nodeType&&(0<a.startOffset&&a.startOffset<a.startContainer.data.length)&&this.split(a,j(a.startContainer).parent(),!1);3==a.endContainer.nodeType&&(0<a.endOffset&&a.endOffset<a.endContainer.data.length)&&this.split(a,j(a.endContainer).parent(),!0);var c=a.getRangeTree();a.endContainer=a.startContainer;a.endOffset=a.startOffset;this.recursiveRemoveRange(c,a);this.doCleanup({merge:!0},a);a.clearCaches()},
recursiveRemoveRange:function(a,c){for(var d=0;d<a.length;++d)"full"==a[d].type?(0<j(c.startContainer).parents().andSelf().filter(a[d].domobj).length&&(c.startContainer=c.endContainer=a[d].domobj.parentNode,c.startOffset=c.endOffset=this.getIndexInParent(a[d].domobj)),j(a[d].domobj).remove()):"partial"==a[d].type&&a[d].children&&this.recursiveRemoveRange(a[d].children,c)},extendToWord:function(a,c){var d=this.searchWordBoundary(a.startContainer,a.startOffset,!0),g=this.searchWordBoundary(a.endContainer,
a.endOffset,!1);if(c||!(a.startContainer==d.container&&a.startOffset==d.offset||a.endContainer==g.container&&a.endOffset==g.offset))a.startContainer=d.container,a.startOffset=d.offset,a.endContainer=g.container,a.endOffset=g.offset,a.correctRange(),a.clearCaches()},isWordBoundaryElement:function(a){return!a||!a.nodeName?!1:-1==j.inArray(a.nodeName.toLowerCase(),this.nonWordBoundaryTags)},searchWordBoundary:function(a,c,d){"undefined"===typeof d&&(d=!0);for(var g=!1,k,e;!g;)if(3===a.nodeType)if(d){for(e=
k=a.data.substring(0,c).search(this.nonWordRegex);-1!=e;)k=e,e=a.data.substring(k+1,c).search(this.nonWordRegex),-1!=e&&(e=e+k+1);-1!=k?(c=k+1,g=!0):(c=this.getIndexInParent(a),a=a.parentNode)}else k=a.data.substring(c).search(this.nonWordRegex),-1!=k?(c+=k,g=!0):(c=this.getIndexInParent(a)+1,a=a.parentNode);else 1===a.nodeType&&(d?0<c?this.isWordBoundaryElement(a.childNodes[c-1])?g=!0:(a=a.childNodes[c-1],c=3===a.nodeType?a.data.length:a.childNodes.length):this.isWordBoundaryElement(a)?g=!0:(c=this.getIndexInParent(a),
a=a.parentNode):c<a.childNodes.length?this.isWordBoundaryElement(a.childNodes[c])?g=!0:(a=a.childNodes[c],c=0):this.isWordBoundaryElement(a)?g=!0:(c=this.getIndexInParent(a)+1,a=a.parentNode));if(3!==a.nodeType&&(g=this.searchAdjacentTextNode(a,c,!d)))a=g,c=d?0:a.data.length;return{container:a,offset:c}},isEmpty:function(a){if(!a)return!0;if(-1!=j.inArray(a.nodeName.toLowerCase(),this.nonEmptyTags))return!1;if(3===a.nodeType)return-1==a.data.search(/\S/);for(var c=0,d=a.childNodes.length;c<d;++c)if(!this.isEmpty(a.childNodes[c]))return!1;
return!0},setCursorAfter:function(a){var c=new d.Utils.RangeObject;this.getIndexInParent(a);var m;3==a.nodeType?(m=a,a=m.nodeValue.length):a.nextSibling&&3==a.nextSibling.nodeType?(m=a.nextSibling,a=0):(m=a.parentNode,a=this.getIndexInParent(a)+1);c.startContainer=c.endContainer=m;c.startOffset=c.endOffset=a;c.select();return c},selectDomNode:function(a){var c=new d.Utils.RangeObject;c.startContainer=c.endContainer=a.parentNode;c.startOffset=this.getIndexInParent(a);c.endOffset=c.startOffset+1;c.select()},
setCursorInto:function(a){var c=new d.Utils.RangeObject;c.startContainer=c.endContainer=a;c.startOffset=c.endOffset=0;c.select()},isEditingHost:function(a){return a&&1==a.nodeType&&("true"==a.contentEditable||a.parentNode&&9==a.parentNode.nodeType&&"on"==a.parentNode.designMode)},isEditable:function(a){return a&&!this.isEditingHost(a)&&(1!=a.nodeType||"false"!=a.contentEditable)&&(this.isEditingHost(a.parentNode)||this.isEditable(a.parentNode))},getEditingHostOf:function(a){if(this.isEditingHost(a))return a;
if(this.isEditable(a)){for(a=a.parentNode;!this.isEditingHost(a);)a=a.parentNode;return a}return null},inSameEditingHost:function(a,c){return this.getEditingHostOf(a)&&this.getEditingHostOf(a)==this.getEditingHostOf(c)},isBlockNode:function(b){return b&&(b.nodeType==a.Node.ELEMENT_NODE&&-1==a(["inline","inline-block","inline-table","none"]).indexOf(a.getComputedStyle(b).display)||b.nodeType==a.Node.DOCUMENT_NODE||b.nodeType==a.Node.DOCUMENT_FRAGMENT_NODE)},getFirstVisibleChild:function(b,c){if(!b||
b.nodeType==a.Node.TEXT_NODE&&this.isEmpty(b)||b.nodeType==a.Node.ELEMENT_NODE&&0==b.offsetHeight&&-1===j.inArray(b.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(b.nodeType==a.Node.TEXT_NODE||b.nodeType==a.Node.ELEMENT_NODE&&0==b.childNodes.length||!j(b).contentEditable())return c?b:null;for(var d=0;d<b.childNodes.length;++d){var g=this.getFirstVisibleChild(b.childNodes[d],!0);if(null!=g)return g}return null},getLastVisibleChild:function(b,c){if(!b||b.nodeType==a.Node.TEXT_NODE&&this.isEmpty(b)||
b.nodeType==a.Node.ELEMENT_NODE&&0==b.offsetHeight&&-1===j.inArray(b.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(b.nodeType==a.Node.TEXT_NODE||b.nodeType==a.Node.ELEMENT_NODE&&0==b.childNodes.length||!j(b).contentEditable())return c?b:null;for(var d=b.childNodes.length-1;0<=d;--d){var g=this.getLastVisibleChild(b.childNodes[d],!0);if(null!=g)return g}return null}});d.Utils.Dom=new f;return d.Utils.Dom});define("aloha/pluginmanager",["jquery","util/class"],function(j,f){return new (f.extend({plugins:{},
init:function(a,d){var c=Aloha&&Aloha.settings?Aloha.settings.plugins||{}:{},b,l;for(l in c)if(c.hasOwnProperty(l)&&(b=this.plugins[l]||!1))b.settings=c[l]||{};if(!d.length)for(l in this.plugins)this.plugins.hasOwnProperty(l)&&d.push(l);for(c=0;c<d.length;++c)if(l=d[c],b=this.plugins[l]||!1)b.settings=b.settings||{},"undefined"===typeof b.settings.enabled&&(b.settings.enabled=!0),b.settings.enabled&&b.checkDependencies()&&b.init();a()},register:function(a){if(!a.name)throw Error("Plugin does not have an name.");
if(this.plugins[a.name])throw Error('Already registered the plugin "'+a.name+'"!');this.plugins[a.name]=a},makeClean:function(a){for(var d in this.plugins)this.plugins.hasOwnProperty(d)&&(Aloha.Log.isDebugEnabled()&&Aloha.Log.debug(this,"Passing contents of HTML Element with id { "+a.attr("id")+" } for cleaning to plugin { "+d+" }"),this.plugins[d].makeClean(a))},toString:function(){return"pluginmanager"}}))});define("aloha/core",["jquery","aloha/pluginmanager"],function(j,f){j.extend(!0,Aloha,{version:"0.22.2",
editables:[],activeEditable:null,settings:{},defaults:{},ui:{},OSName:"Unknown",stage:"loadingAloha",loadedPlugins:[],_pluginBaseUrlByName:{},init:function(){Aloha.stage="initAloha";Aloha.initAloha(function(){Aloha.stage="initPlugins";Aloha.initPlugins(function(){Aloha.stage="initGui";Aloha.initGui(function(){Aloha.stage="alohaReady";Aloha.trigger("aloha-ready")})})})},getLoadedPlugins:function(){return this.loadedPlugins},isPluginLoaded:function(a){var d=false;j.each(this.loadedPlugins,function(){a.toString()===
this.toString()&&(d=true)});return d},initAloha:function(a){var d=j("html");(j.browser.webkit&&parseFloat(j.browser.version)<532.5||j.browser.mozilla&&parseFloat(j.browser.version)<1.9||j.browser.msie&&j.browser.version<7||j.browser.opera&&j.browser.version<11)&&window.console&&window.console.log&&window.console.log("Your browser is not supported.");j("html").mousedown(function(){if(Aloha.activeEditable&&!j(".aloha-dialog").is(":visible")&&!Aloha.eventHandled){Aloha.activeEditable.blur();Aloha.activeEditable=
null}}).mouseup(function(){Aloha.eventHandled=false});j.browser.webkit?d.addClass("aloha-webkit"):j.browser.opera?d.addClass("aloha-opera"):j.browser.msie?d.addClass("aloha-ie"+parseInt(j.browser.version,10)):j.browser.mozilla&&d.addClass("aloha-mozilla");Aloha.settings.base=Aloha.getAlohaUrl();Aloha.Log.init();if(Aloha.settings.errorhandling)window.onerror=function(a,b,d){Aloha.Log.error(Aloha,"Error message: "+a+"\nURL: "+b+"\nLine Number: "+d);return true};if(navigator.appVersion.indexOf("Win")!=
-1)Aloha.OSName="Win";if(navigator.appVersion.indexOf("Mac")!=-1)Aloha.OSName="Mac";if(navigator.appVersion.indexOf("X11")!=-1)Aloha.OSName="Unix";if(navigator.appVersion.indexOf("Linux")!=-1)Aloha.OSName="Linux";a()},initPlugins:function(a){f.init(a,this.getLoadedPlugins())},initGui:function(a){Aloha.RepositoryManager.init();for(var d=0,c=Aloha.editables.length;d<c;d++)Aloha.editables[d].ready||Aloha.editables[d].init();a()},activateEditable:function(a){for(var d=0,c=Aloha.editables.length;d<c;d++)Aloha.editables[d]!=
a&&Aloha.editables[d].isActive&&Aloha.editables[d].blur();Aloha.activeEditable=a},getActiveEditable:function(){return Aloha.activeEditable},deactivateEditable:function(){if(!(typeof Aloha.activeEditable==="undefined"||Aloha.activeEditable===null)){Aloha.activeEditable.blur();Aloha.activeEditable=null}},getEditableById:function(a){j("#"+a).get(0).nodeName.toLowerCase()==="textarea"&&(a=a+"-aloha");for(var d=0,c=Aloha.editables.length;d<c;d++)if(Aloha.editables[d].getId()==a)return Aloha.editables[d];
return null},isEditable:function(a){for(var d=0,c=Aloha.editables.length;d<c;d++)if(Aloha.editables[d].originalObj.get(0)===a)return true;return false},getEditableHost:function(a){var d,c,b=Aloha.editables.length;if(a){a.parents().andSelf().each(function(){for(d=0;d<b;d++)if(Aloha.editables[d].originalObj.get(0)===this){c=Aloha.editables[d];return false}});return c}},log:function(a,d,c){typeof Aloha.Log!=="undefined"&&Aloha.Log.log(a,d,c)},registerEditable:function(a){Aloha.editables.push(a)},unregisterEditable:function(a){a=
j.inArray(a,Aloha.editables);a!=-1&&Aloha.editables.splice(a,1)},toString:function(){return"Aloha"},isModified:function(){for(var a=0;a<Aloha.editables.length;a++)if(Aloha.editables[a].isModified&&Aloha.editables[a].isModified())return true;return false},getAlohaUrl:function(){return Aloha.settings.baseUrl},getPluginUrl:function(a){var d;if(a)(d=Aloha.settings._pluginBaseUrlByName[a])&&(d.match("^(/|http[s]?:).*")||(d=Aloha.getAlohaUrl()+"/"+d));return d},disableObjectResizing:function(){try{var a;
try{a=document.queryCommandSupported("enableObjectResizing")}catch(d){a=false;Aloha.Log.log("enableObjectResizing is not supported.")}if(a){document.execCommand("enableObjectResizing",false,false);Aloha.Log.log("enableObjectResizing disabled.")}}catch(c){Aloha.Log.error(c,"Could not disable enableObjectResizing")}}});return Aloha});define("aloha/console",["aloha/core","util/class","jquery"],function(j,f){var a=window.console,d=f.extend({init:function(){if("undefined"===typeof j.settings.logLevels||
!j.settings.logLevels)j.settings.logLevels={error:!0,warn:!0};if("undefined"===typeof j.settings.logHistory||!j.settings.logHistory)j.settings.logHistory={};j.settings.logHistory.maxEntries||(j.settings.logHistory.maxEntries=100);j.settings.logHistory.highWaterMark||(j.settings.logHistory.highWaterMark=90);j.settings.logHistory.levels||(j.settings.logHistory.levels={error:!0,warn:!0});this.flushLogHistory();j.trigger("aloha-logger-ready")},logHistory:[],highWaterMarkReached:!1,log:function(c,b,d){"undefined"===
typeof b&&(d=c);"string"!==typeof b&&(b&&b.toString)&&(b=b.toString());"undefined"===typeof d&&(d=b,b=void 0);if("undefined"===typeof c||!c)c="log";c=c.toLowerCase();if("undefined"!==typeof j.settings.logLevels&&j.settings.logLevels[c])switch(b=b||"Unkown Aloha Component",this.addToLogHistory({level:c,component:b,message:d,date:new Date}),c){case "error":window.console&&a.error&&(!b&&!d?a.error("Error occured without message and component"):a.error(b+": "+d));break;case "warn":window.console&&a.warn&&
a.warn(b+": "+d);break;case "info":window.console&&a.info&&a.info(b+": "+d);break;case "debug":window.console&&a.log&&a.log(b+" ["+c+"]: "+d);break;default:window.console&&a.log&&a.log(b+" ["+c+"]: "+d)}},error:function(a,b){this.log("error",a,b)},warn:function(a,b){this.log("warn",a,b)},info:function(a,b){this.log("info",a,b)},debug:function(a,b){this.log("debug",a,b)},deprecated:function(a,b){this.log("warn",a,b);if(j.settings.logLevels.deprecated)throw Error(b);},isLogLevelEnabled:function(a){return j.settings&&
j.settings.logLevels&&j.settings.logLevels[a]},isErrorEnabled:function(){return this.isLogLevelEnabled("error")},isWarnEnabled:function(){return this.isLogLevelEnabled("warn")},isInfoEnabled:function(){return this.isLogLevelEnabled("info")},isDebugEnabled:function(){return this.isLogLevelEnabled("debug")},addToLogHistory:function(a){j.settings.logHistory||this.init();if(!(0>=j.settings.logHistory.maxEntries)&&j.settings.logHistory.levels[a.level]){this.logHistory.push(a);!this.highWaterMarkReached&&
this.logHistory.length>=j.settings.logHistory.maxEntries*j.settings.logHistory.highWaterMark/100&&(j.trigger("aloha-log-full"),this.highWaterMarkReached=!0);for(;this.logHistory.length>j.settings.logHistory.maxEntries;)this.logHistory.shift()}},getLogHistory:function(){return this.logHistory},flushLogHistory:function(){this.logHistory=[];this.highWaterMarkReached=!1}}),d=new d;return j.Log=j.Console=d});GENTICS=window.GENTICS||{};GENTICS.Utils=GENTICS.Utils||{};define("util/range",["jquery","util/dom",
"util/class","aloha/console","aloha/rangy-core"],function(j,f,a,d,c){function b(a,b){var c=[],e;for(e=1===a.nodeType?a:a.parentNode;e&&!(e===b||9===e.nodeType);)1===e.nodeType&&c.push(e),e=e.parentNode;return c}function b(a,b){var c=[],e;for(e=1===a.nodeType?a:a.parentNode;e&&!(e===b||9===e.nodeType);)1===e.nodeType&&c.push(e),e=e.parentNode;return c}var l=window.GENTICS;l.Utils.RangeObject=a.extend({_constructor:function(a){if("object"===typeof a){if("undefined"!==typeof a.startContainer&&(this.startContainer=
a.startContainer),"undefined"!==typeof a.startOffset&&(this.startOffset=a.startOffset),"undefined"!==typeof a.endContainer&&(this.endContainer=a.endContainer),"undefined"!==typeof a.endOffset)this.endOffset=a.endOffset}else!0===a&&this.initializeFromUserSelection()},startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0,deleteContents:function(){f.removeRange(this)},log:function(a){d.deprecated("Utils.RangeObject",'log() is deprecated. use console.log() from module "aloha/console" instead: '+
a)},isCollapsed:function(){return!this.endContainer||this.startContainer===this.endContainer&&this.startOffset===this.endOffset},getCommonAncestorContainer:function(){if(this.commonAncestorContainer)return this.commonAncestorContainer;this.updateCommonAncestorContainer();return this.commonAncestorContainer},getContainerParents:function(a,c){var k=c?this.endContainer:this.startContainer;return!k?!1:j(b(k,a?a[0]:null))},getStartContainerParents:function(a){return this.getContainerParents(a,!1)},getEndContainerParents:function(a){return this.getContainerParents(a,
!0)},updateCommonAncestorContainer:function(a){if(a)this.commonAncestorContainer=a;else{var b=this.getStartContainerParents(),c=this.getEndContainerParents(),e;if(!(0<b.length&&0<c.length))return d.warn("aloha/range","could not find commonAncestorContainer"),!1;for(e=0;e<b.length;e++)if(-1!=c.index(b[e])){this.commonAncestorContainer=b[e];break}}d.debug(a?"commonAncestorContainer was set successfully":"commonAncestorContainer was calculated successfully");return!0},getCollapsedIERange:function(a,
b){var c=document.body.createTextRange(),e,d,l;l=this.searchElementToLeft(a,b);l.element?(e=document.body.createTextRange(),e.moveToElementText(l.element),c.setEndPoint("StartToEnd",e),0!==l.characters?c.moveStart("character",l.characters):(c.moveStart("character",1),c.moveStart("character",-1))):(this.searchElementToRight(a,b),d=3==a.nodeType?a.parentNode:a,e=document.body.createTextRange(),e.moveToElementText(d),c.setEndPoint("StartToStart",e),0!==l.characters&&c.moveStart("character",l.characters));
c.collapse();return c},select:function(){var a;if("undefined"===typeof this.startContainer||"undefined"===typeof this.endContainer)return d.warn("can not select an empty range"),!1;a=c.createRange();a.setStart(this.startContainer,this.startOffset);a.setEnd(this.endContainer,this.endOffset);c.getSelection().setSingleRange(a)},searchElementToLeft:function(a,b){var c,e=0;3===a.nodeType?(e=b,c=a.previousSibling):0<b&&(c=a.childNodes[b-1]);for(;c&&3===c.nodeType;)e+=c.data.length,c=c.previousSibling;return{element:c,
characters:e}},searchElementToRight:function(a,b){var c,e=0;3===a.nodeType?(e=a.data.length-b,c=a.nextSibling):b<a.childNodes.length&&(c=a.childNodes[b]);for(;c&&3===c.nodeType;)e+=c.data.length,c=c.nextSibling;return{element:c,characters:e}},update:function(a){d.debug("now updating rangeObject");this.initializeFromUserSelection(a);this.updateCommonAncestorContainer()},initializeFromUserSelection:function(){var a=c.getSelection();if(!a||!a.rangeCount)return!1;a=a.getRangeAt(0);if(!a)return!1;this.startContainer=
a.startContainer;this.endContainer=a.endContainer;this.startOffset=a.startOffset;this.endOffset=a.endOffset;this.correctRange()},correctRange:function(){var a,b;this.clearCaches();if(this.isCollapsed()){if(1===this.startContainer.nodeType){if(0<this.startOffset&&3===this.startContainer.childNodes[this.startOffset-1].nodeType){this.startContainer=this.startContainer.childNodes[this.startOffset-1];this.startOffset=this.startContainer.data.length;this.endContainer=this.startContainer;this.endOffset=
this.startOffset;return}if(0<this.startOffset&&1===this.startContainer.childNodes[this.startOffset-1].nodeType){if(a=l.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!0)){this.startContainer=this.endContainer=a;this.startOffset=this.endOffset=a.data.length;return}if(a=l.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!1)){this.startContainer=this.endContainer=a;this.startOffset=this.endOffset=0;return}}if(this.startOffset<this.startContainer.childNodes.length&&
3===this.startContainer.childNodes[this.startOffset].nodeType){this.startContainer=this.startContainer.childNodes[this.startOffset];this.startOffset=0;this.endContainer=this.startContainer;this.endOffset=0;return}}if(3===this.startContainer.nodeType&&0===this.startOffset&&(a=l.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,l.Utils.Dom.getIndexInParent(this.startContainer),!0))&&0<j(a).closest(Aloha.activeEditable.obj).length)this.startContainer=this.endContainer=a,this.startOffset=
this.endOffset=a.data.length}else{if(1===this.startContainer.nodeType)if(this.startOffset<this.startContainer.childNodes.length&&3===this.startContainer.childNodes[this.startOffset].nodeType)this.startContainer=this.startContainer.childNodes[this.startOffset],this.startOffset=0;else if(this.startOffset<this.startContainer.childNodes.length&&1===this.startContainer.childNodes[this.startOffset].nodeType){a=!1;for(b=this.startContainer.childNodes[this.startOffset];!1===a&&b.childNodes&&0<b.childNodes.length;)b=
b.childNodes[0],3===b.nodeType&&(a=b);!1!==a&&(this.startContainer=a,this.startOffset=0)}if(3===this.startContainer.nodeType&&this.startOffset===this.startContainer.data.length&&(a=l.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,l.Utils.Dom.getIndexInParent(this.startContainer)+1,!1)))this.startContainer=a,this.startOffset=0;if(3===this.endContainer.nodeType&&0===this.endOffset)if(this.endContainer.previousSibling&&3===this.endContainer.previousSibling.nodeType)this.endContainer=
this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length;else if(this.endContainer.previousSibling&&1===this.endContainer.previousSibling.nodeType&&this.endContainer.parentNode){a=this.endContainer.parentNode;for(b=0;b<a.childNodes.length;++b)if(a.childNodes[b]==this.endContainer){this.endOffset=b;break}this.endContainer=a}1==this.endContainer.nodeType&&0===this.endOffset&&this.endContainer.previousSibling&&(3===this.endContainer.previousSibling.nodeType?(this.endContainer=this.endContainer.previousSibling,
this.endOffset=this.endContainer.data.length):1===this.endContainer.previousSibling.nodeType&&(this.endContainer.previousSibling.childNodes&&0<this.endContainer.previousSibling.childNodes.length)&&(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.childNodes.length));if(1==this.endContainer.nodeType)if(0<this.endOffset&&3===this.endContainer.childNodes[this.endOffset-1].nodeType)this.endContainer=this.endContainer.childNodes[this.endOffset-1],this.endOffset=this.endContainer.data.length;
else if(0<this.endOffset&&1===this.endContainer.childNodes[this.endOffset-1].nodeType){a=!1;for(b=this.endContainer.childNodes[this.endOffset-1];!1===a&&b.childNodes&&0<b.childNodes.length;)b=b.childNodes[b.childNodes.length-1],3===b.nodeType&&(a=b);!1!==a&&(this.endContainer=a,this.endOffset=this.endContainer.data.length)}}},clearCaches:function(){this.commonAncestorContainer=void 0},getRangeTree:function(a){"undefined"===typeof a&&(a=this.getCommonAncestorContainer());this.inselection=!1;return this.recursiveGetRangeTree(a)},
recursiveGetRangeTree:function(a){var b=0,c=this,e=[];j(a).contents().each(function(d){var f="none",r=!1,q=!1,u=!1,t=!1,j=!1,z=!1;c.isCollapsed()&&(a===c.startContainer&&c.startOffset===d)&&(e[b]=new l.Utils.RangeTree,e[b].type="collapsed",e[b].domobj=void 0,c.inselection=!1,u=!0,b++);if(!c.inselection&&!u)switch(this.nodeType){case 3:this===c.startContainer&&(c.inselection=!0,f=0<c.startOffset?"partial":"full",r=c.startOffset,q=this.length);break;case 1:if(this===c.startContainer&&0===c.startOffset&&
(c.inselection=!0,f="full"),a===c.startContainer&&c.startOffset===d)c.inselection=!0,f="full"}if(c.inselection&&!u){"none"==f&&(f="full");switch(this.nodeType){case 3:this===c.endContainer&&(c.inselection=!1,c.endOffset<this.length&&(f="partial"),!1===r&&(r=0),q=c.endOffset);break;case 1:this===c.endContainer&&0===c.endOffset&&(c.inselection=!1)}a===c.endContainer&&c.endOffset<=d&&(c.inselection=!1,f="none")}e[b]=new l.Utils.RangeTree;e[b].domobj=this;e[b].type=f;"partial"==f&&(e[b].startOffset=r,
e[b].endOffset=q);e[b].children=c.recursiveGetRangeTree(this);if(0<e[b].children.length){for(d=0;d<e[b].children.length;++d)switch(e[b].children[d].type){case "none":t=!0;break;case "full":z=!0;break;case "partial":j=!0}j||z&&t?e[b].type="partial":z&&(!j&&!t)&&(e[b].type="full")}b++});this.isCollapsed()&&(a===this.startContainer&&this.startOffset==a.childNodes.length)&&(e[b]=new l.Utils.RangeTree,e[b].type="collapsed",e[b].domobj=void 0);return e},findMarkup:function(a,c,k){var k=k?this.endContainer:
this.startContainer,c=c?c[0]:null,e;if(k){c=b(k,c);k=0;for(e=c.length;k<e;k++)if(a.apply(c[k]))return c[k];return!1}},getText:function(){return this.isCollapsed()?"":this.recursiveGetText(this.getRangeTree())},recursiveGetText:function(a){if(a){var b=this,c="";j.each(a,function(){"full"==this.type?c+=j(this.domobj).text():"partial"==this.type&&3===this.domobj.nodeType?c+=j(this.domobj).text().substring(this.startOffset,this.endOffset):"partial"==this.type&&(1===this.domobj.nodeType&&this.children)&&
(c+=b.recursiveGetText(this.children))});return c}return""}});l.Utils.RangeTree=a.extend({domobj:{},type:null,children:[]});return l.Utils.RangeObject});define("util/arrays",[],function(){function j(a,d){var c,b,l=[];c=0;for(b=a.length;c<b;c++)l.push(d(a[c]));return l}function f(a,d){return a.map(d)}return{sortUnique:function(a,d){var c;if(d){a.sort(d);for(c=1;c<a.length;c++)0===d(a[c],a[c-1])&&a.splice(c--,1)}else{a.sort();for(c=1;c<a.length;c++)a[c]==a[c-1]&&a.splice(c--,1)}return a},equal:function(a,
d,c){var b=0,l=a.length;if(l!==d.length)return!1;if(c)for(;b<l;b++){if(!c(a[b],d[b]))return!1}else for(;b<l;b++)if(a[b]!==d[b])return!1;return!0},map:Array.prototype.map?f:j}});define("util/strings",["jquery"],function(j){return{words:function(f){f=j.trim(f).split(/[\r\n\t\s]+/);return f.length&&""===f[0]?[]:f},dashesToCamelCase:function(f){return f.replace(/[-]([a-z])/gi,function(a,d){return d.toUpperCase()})},camelCaseToDashes:function(f){return f.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}}});
define("PubSub",[],function(){var j={},f={},a=0;return{sub:function(d,c){if("function"!==typeof c)return-1;var b=j[d];b||(b=j[d]=[]);b.push(++a);f[a]={channel:d,callback:c};return a},unsub:function(a){if(-1===a||!f[a])return!1;var c=f[a]&&j[f[a].channel];delete f[a];for(var b=c.length;b;)if(c[--b]===a)return c.splice(b,1),!0;return!1},pub:function(a,c){var b=a.split("."),l,m=b.length,g="",k=0;for(l=0;l<m;++l){var g=g+((0===l?"":".")+b[l]),e;var p=g;e=c;if(j[p]){e?"object"!==typeof e&&(e={data:e}):
e={};e.channel=p;for(var p=j[p].slice(),o=void 0,o=0;o<p.length;++o)f[p[o]].callback(e);e=o}else e=0;k+=e}return k}}});define("aloha/engine",["aloha/ecma5shims","jquery"],function(j,f){function a(a,b){return a.hasAttribute?a.hasAttribute(b):"undefined"!=typeof a.attributes[b]}function d(a){if(a){if(!a.style)return 0}else return 0;if("undefined"!==typeof a.style.length)return a.style.length;var b=0,e;for(e in a.style)a.style[e]&&(0!==a.style[e]&&"false"!==a.style[e])&&b++;return b}function c(a){if(!a)return null;
var b=[],e;for(e=a.length>>>0;e--;)b[e]=a[e];return b}function b(a){return a.hasChildNodes()?a.firstChild:m(a)}function l(a){if(a.previousSibling){for(a=a.previousSibling;a.hasChildNodes();)a=a.lastChild;return a}return a.parentNode&&a.parentNode.nodeType==j.Node.ELEMENT_NODE?a.parentNode:null}function m(a){for(;a&&!a.nextSibling;)a=a.parentNode;return!a?null:a.nextSibling}function g(a,b){return a&&b&&Boolean(j.compareDocumentPosition(a,b)&j.Node.DOCUMENT_POSITION_CONTAINED_BY)}function k(a,b){return b&&
a&&Boolean(j.compareDocumentPosition(b,a)&j.Node.DOCUMENT_POSITION_CONTAINED_BY)}function e(a,b){return Boolean(j.compareDocumentPosition(a,b)&j.Node.DOCUMENT_POSITION_FOLLOWING)}function p(a){for(var b=[];a.parentNode;)b.unshift(a.parentNode),a=a.parentNode;return b}function o(a){for(var e=[],c=m(a);(a=b(a))&&a!=c;)e.push(a);return e}function r(a){return{"xx-small":1,small:2,medium:3,large:4,"x-large":5,"xx-large":6,"xxx-large":7}[a]}function q(a){return null===a||!a||a===wb}function u(a){return"ltr"==
a.dir?"ltr":"rtl"==a.dir?"rtl":!Y(a.parentNode)?"ltr":u(a.parentNode)}function t(a){for(var b=0;a.previousSibling;)b++,a=a.previousSibling;return b}function v(a){switch(a.nodeType){case j.Node.PROCESSING_INSTRUCTION_NODE:case j.Node.DOCUMENT_TYPE_NODE:return 0;case j.Node.TEXT_NODE:case j.Node.COMMENT_NODE:return a.length;default:return a.childNodes.length}}function z(a,b,e,c){if(a==e){if(b==c)return"equal";if(b<c)return"before";if(b>c)return"after"}var g=j.compareDocumentPosition(e,a);if(g&j.Node.DOCUMENT_POSITION_FOLLOWING){c=
z(e,c,a,b);if("before"==c)return"after";if("after"==c)return"before"}if(g&j.Node.DOCUMENT_POSITION_CONTAINS){for(;e.parentNode!=a;)e=e.parentNode;if(t(e)<b)return"after"}return"before"}function x(a){for(;null!=a.parentNode;)a=a.parentNode;return a}function y(a,b){return"after"!==z(a,0,b.startContainer,b.startOffset)||"before"!==z(a,v(a),b.endContainer,b.endOffset)?!1:x(a)==x(b.startContainer)}function B(a,c){"undefined"==typeof c&&(c=function(){return!0});for(var g=a.startContainer,g=g.hasChildNodes()&&
a.startOffset<g.childNodes.length?g.childNodes[a.startOffset]:a.startOffset==v(g)?m(g):b(g),k=a.endContainer,k=k.hasChildNodes()&&a.endOffset<k.childNodes.length?k.childNodes[a.endOffset]:m(k),d=[];e(g,k);)y(g,a)&&c(g)?(d.push(g),g=m(g)):g=b(g);return d}function A(a,c){"undefined"==typeof c&&(c=function(){return!0});for(var g=a.startContainer,g=g.hasChildNodes()&&a.startOffset<g.childNodes.length?g.childNodes[a.startOffset]:a.startOffset==v(g)?m(g):b(g),k=a.endContainer,k=k.hasChildNodes()&&a.endOffset<
k.childNodes.length?k.childNodes[a.endOffset]:m(k),d=[];e(g,k);)y(g,a)&&c(g)&&d.push(g),g=b(g);return d}function F(a){if("currentcolor"==a.toLowerCase())return null;var b=document.createElement("span");document.body.appendChild(b);b.style.color="black";var e=document.createElement("span");b.appendChild(e);e.style.color=a;a=j.getComputedStyle(e).color;if("rgb(0, 0, 0)"==a&&(b.color="white",a=j.getComputedStyle(e).color,"rgb(0, 0, 0)"!=a))return null;document.body.removeChild(b);return/^rgba\([0-9]+, [0-9]+, [0-9]+, 1\)$/.test(a)?
a.replace("rgba","rgb").replace(", 1)",")"):"transparent"==a?"rgba(0, 0, 0, 0)":a}function N(a){a=a.toLowerCase();if(-1!=j("aliceblue antiquewhite aqua aquamarine azure beige bisque black blanchedalmond blue blueviolet brown burlywood cadetblue chartreuse chocolate coral cornflowerblue cornsilk crimson cyan darkblue darkcyan darkgoldenrod darkgray darkgreen darkgrey darkkhaki darkmagenta darkolivegreen darkorange darkorchid darkred darksalmon darkseagreen darkslateblue darkslategray darkslategrey darkturquoise darkviolet deeppink deepskyblue dimgray dimgrey dodgerblue firebrick floralwhite forestgreen fuchsia gainsboro ghostwhite gold goldenrod gray green greenyellow grey honeydew hotpink indianred indigo ivory khaki lavender lavenderblush lawngreen lemonchiffon lightblue lightcoral lightcyan lightgoldenrodyellow lightgray lightgreen lightgrey lightpink lightsalmon lightseagreen lightskyblue lightslategray lightslategrey lightsteelblue lightyellow lime limegreen linen magenta maroon mediumaquamarine mediumblue mediumorchid mediumpurple mediumseagreen mediumslateblue mediumspringgreen mediumturquoise mediumvioletred midnightblue mintcream mistyrose moccasin navajowhite navy oldlace olive olivedrab orange orangered orchid palegoldenrod palegreen paleturquoise palevioletred papayawhip peachpuff peru pink plum powderblue purple red rosybrown royalblue saddlebrown salmon sandybrown seagreen seashell sienna silver skyblue slateblue slategray slategrey snow springgreen steelblue tan teal thistle tomato turquoise violet wheat white whitesmoke yellow yellowgreen".split(" ")).indexOf(a))return a;
a=F(a);return(a=/^rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)$/.exec(a))?"#"+parseInt(a[1]).toString(16).replace(/^.$/,"0$&")+parseInt(a[2]).toString(16).replace(/^.$/,"0$&")+parseInt(a[3]).toString(16).replace(/^.$/,"0$&"):null}function K(a,b,e,c){0==eb&&"undefined"!=typeof e?Fa=e:0==eb&&(Fa=null,Fa=e);if(!(a in Q))throw"NOT_SUPPORTED_ERR";if("enabled"!=b&&!(b in Q[a]))throw"INVALID_ACCESS_ERR";eb++;try{var g=c()}catch(k){throw eb--,k;}eb--;return g}function G(a,b,e,c){a=a.toLowerCase();if(1==arguments.length||
4<=arguments.length&&"undefined"==typeof b)b=!1;if(2>=arguments.length||4<=arguments.length&&"undefined"==typeof e)e="";return K(a,"action",c,function(a,b,e){return function(){if(!R(a))return!1;Q[a].action(e,c);va(c);return!0}}(a,b,e))}function R(a,b){a=a.toLowerCase();return K(a,"action",b,function(a){return function(){return-1!=f.inArray(a,"copy cut paste selectall stylewithcss usecss".split(" "))||null!==b}}(a))}function I(a,b){a=a.toLowerCase();return K(a,"state",b,function(a){return function(){return!R(a,
b)?!1:"undefined"!=typeof fb(a,b)?fb(a,b):Q[a].state(b)}}(a))}function ba(a,b){a=a.toLowerCase();return K(a,"value",b,function(){return!R(a,b)?"":"fontsize"==a&&void 0!==Ha("fontsize",b)?Za(Ha("fontsize",b)):"undefined"!=typeof Ha(a,b)?Ha(a,b):Q[a].value(b)})}function T(a,b){"string"==typeof b&&(b=[b]);"object"==typeof b&&(b=j(b).map(function(a){return a.toUpperCase()}));return a&&1==a.nodeType&&q(a.namespaceURI)&&("undefined"==typeof b||-1!=j(b).indexOf(a.tagName))}function Y(a){return a&&1==a.nodeType&&
q(a.namespaceURI)}function D(a,b){return a&&1==a.nodeType&&q(a.namespaceURI)&&b.toUpperCase()===a.nodeName}function M(a,b){var e;if(e=a)if(e=1==a.nodeType)if(e=q(a.namespaceURI))a:{e=a.nodeName;var c,g;e=e.toUpperCase();c=0;for(g=b.length;c<g;c++)if(b[c].toUpperCase()===e){e=!0;break a}e=!1}return e}function Z(a){return a&&1==a.nodeType&&q(a.namespaceURI)&&ca[a.nodeName]}function E(a){return a&&(a.nodeType==j.Node.ELEMENT_NODE&&!ya[j.getComputedStyle(a).display]||a.nodeType==j.Node.DOCUMENT_NODE||
a.nodeType==j.Node.DOCUMENT_FRAGMENT_NODE)}function H(a){return a&&!E(a)}function L(a){return a&&a.nodeType==j.Node.ELEMENT_NODE&&("true"==a.contentEditable||a.parentNode&&a.parentNode.nodeType==j.Node.DOCUMENT_NODE&&"on"==a.parentNode.designMode)}function C(a){return a&&!L(a)&&(a.nodeType!=j.Node.ELEMENT_NODE||"false"!=a.contentEditable||f(a).hasClass("aloha-table-wrapper"))&&(L(a.parentNode)||C(a.parentNode))}function O(a){for(var b=0;b<a.childNodes.length;b++)if(C(a.childNodes[b])||O(a.childNodes[b]))return!0;
return!1}function ha(a){if(L(a))return a;if(C(a)){for(a=a.parentNode;!L(a);)a=a.parentNode;return a}return null}function aa(a,b){return ha(a)&&ha(a)==ha(b)}function X(a){if(!D(a,"br"))return!1;for(var b=a.parentNode;"inline"==j.getComputedStyle(b).display;)b=b.parentNode;var e=b.style.height,c=b.style.maxHeight,g=b.style.minHeight;b.style.height="auto";b.style.maxHeight="none";f.browser.msie&&8>f.browser.version||(b.style.minHeight="0");var k=document.createTextNode("​"),d=b.offsetHeight;if(0==d)throw"isCollapsedLineBreak: original height is zero, bug?";
a.parentNode.insertBefore(k,a.nextSibling);a=b.offsetHeight;k.parentNode.removeChild(k);b.style.height=e;b.style.maxHeight=c;f.browser.msie&&8>f.browser.version||(b.style.minHeight=g);return d<a-5}function S(a){if(!D(a,"br")||D(a.parentNode,"li")&&1==a.parentNode.childNodes.length)return!1;for(var b=a.parentNode;"inline"==j.getComputedStyle(b).display;)b=b.parentNode;var e=b.style.height,c=b.style.maxHeight,g=b.style.minHeight,k=b.contentEditable;b.style.height="auto";b.style.maxHeight="none";b.style.minHeight=
"0";f.browser.msie&&7>=f.browser.version&&(b.contentEditable="false");var d=b.offsetHeight;if(0==d)throw"isExtraneousLineBreak: original height is zero, bug?";var l=a.style.display;a.style.display="none";var m=b.offsetHeight;b.style.height=e;b.style.maxHeight=c;b.style.minHeight=g;f.browser.msie&&7>=f.browser.version&&(b.contentEditable=k);a.style.display=l;return d==m}function W(a){return a&&a.nodeType==j.Node.TEXT_NODE&&(""==a.data||/^[\t\n\r ]+$/.test(a.data)&&a.parentNode&&a.parentNode.nodeType==
j.Node.ELEMENT_NODE&&-1!=f.inArray(j.getComputedStyle(a.parentNode).whiteSpace,["normal","nowrap"])||/^[\t\r ]+$/.test(a.data)&&a.parentNode&&a.parentNode.nodeType==j.Node.ELEMENT_NODE&&"pre-line"==j.getComputedStyle(a.parentNode).whiteSpace||/^[\t\n\r ]+$/.test(a.data)&&a.parentNode&&a.parentNode.nodeType==j.Node.DOCUMENT_FRAGMENT_NODE)}function Da(a){if(!W(a))return!1;if(""==a.data)return!0;var e=a.parentNode;if(!e||j(p(a)).some(function(a){return a.nodeType==j.Node.ELEMENT_NODE&&"none"==j.getComputedStyle(a).display}))return!0;
for(;!E(e)&&e.parentNode;)e=e.parentNode;for(var c=a;c!=e;){c=l(c);if(E(c)||D(c,"br"))return!0;if(c.nodeType==j.Node.TEXT_NODE&&!W(c)||D(c,"img"))break}c=a;for(a=m(e);c!=a;){c=b(c);if(E(c)||D(c,"br"))return!0;if(c&&c.nodeType==j.Node.TEXT_NODE&&!W(c)||D(c,"img"))break}return!1}function ia(a){if(!a||j(p(a).concat(a)).filter(function(a){return a.nodeType==j.Node.ELEMENT_NODE},!0).some(function(a){return"none"==j.getComputedStyle(a).display}))return!1;if(E(a)||a.nodeType==j.Node.TEXT_NODE&&!Da(a)||D(a,
"img")||D(a,"br")&&!S(a))return!0;for(var b=0;b<a.childNodes.length;b++)if(ia(a.childNodes[b]))return!0;return!1}function na(a){return a&&!ia(a)}function ta(a){if(X(a)&&!S(a))return!0;if(!H(a)||a.nodeType!=j.Node.ELEMENT_NODE)return!1;for(var b=!1,e=0;e<a.childNodes.length;e++){if(!na(a.childNodes[e])&&!ta(a.childNodes[e]))return!1;ta(a.childNodes[e])&&(b=!0)}return b}function va(a){var b=new window.GENTICS.Utils.RangeObject;b.startContainer=a.startContainer;b.startOffset=a.startOffset;b.endContainer=
a.endContainer;b.endOffset=a.endOffset;b.select()}function J(){var a;if(Fa)a=Fa;else if(Aloha.getSelection().rangeCount)a=Aloha.getSelection().getRangeAt(0);else return null;if(-1==f.inArray(a.startContainer.nodeType,[j.Node.TEXT_NODE,j.Node.ELEMENT_NODE])||-1==f.inArray(a.endContainer.nodeType,[j.Node.TEXT_NODE,j.Node.ELEMENT_NODE])||!a.startContainer.ownerDocument||!a.endContainer.ownerDocument||!k(a.startContainer,a.startContainer.ownerDocument)||!k(a.endContainer,a.endContainer.ownerDocument))throw"Invalid active range; test bug?";
return a}function ea(a,b,e,c){-1==e&&(e=b.childNodes.length);for(var g=a.parentNode,k=t(a),d=[c],l=0;l<Aloha.getSelection().rangeCount;l++)d.push(Aloha.getSelection().getRangeAt(l));var f=[];j(d).forEach(function(a){f.push([a.startContainer,a.startOffset]);f.push([a.endContainer,a.endOffset])});j(f).forEach(function(a){a[0]==b&&a[1]>e&&a[1]++;if(a[0]==g&&(a[1]==k||a[1]==k+1)){a[0]=b;a[1]=a[1]+(e-k)}a[0]==g&&a[1]>k+1&&a[1]--});b.childNodes.length==e?b.appendChild(a):b.insertBefore(a,b.childNodes[e]);
if(f[0][1]>f[0][0].childNodes.length&&f[1][1]>f[1][0].childNodes.length)c.setStart(a,0),c.setEnd(a,0);else{c.setStart(f[0][0],f[0][1]);c.setEnd(f[1][0],f[1][1]);Aloha.getSelection().removeAllRanges();for(l=1;l<d.length;l++){var m=Aloha.createRange();m.setStart(f[2*l][0],f[2*l][1]);m.setEnd(f[2*l+1][0],f[2*l+1][1]);Aloha.getSelection().addRange(m)}m&&(c=m)}}function ua(a,b){f.browser.msie&&(7<=f.browser.version&&"undefined"!==typeof a.attributes[f.expando])&&f(a).removeAttr(f.expando);for(var e=a.attributes,
c=0;c<e.length;c++){var g=e[c];if("undefined"===typeof g.specified||g.specified)"function"===typeof b.setAttributeNS?b.setAttributeNS(g.namespaceURI,g.name,g.value):b.setAttribute(g.name,g.value)}}function la(a,b,e){if(D(a,b)||!a.parentNode)return a;b=a.ownerDocument.createElement(b);a.parentNode.insertBefore(b,a);for(ua(a,b);a.childNodes.length;)ea(a.firstChild,b,b.childNodes.length,e);a.parentNode.removeChild(a);e.startContainer===a&&(e.startContainer=b);e.endContainer===a&&(e.endContainer=b);return b}
function Ya(a){var b=a.previousSibling;if(b){for(;b.hasChildNodes();)b=b.lastChild;for(;na(b)&&!S(b)&&b!=a.parentNode;)b=l(b);C(b)&&S(b)&&b.parentNode.removeChild(b)}}function La(a){for(var b=a;b.hasChildNodes();)b=b.lastChild;for(;na(b)&&!S(b)&&b!=a;)b=l(b);C(b)&&S(b)&&b.parentNode.removeChild(b)}function Qa(a){Ya(a);La(a)}function qa(a,b,c,g){"undefined"==typeof b&&(b=function(){return!1});"undefined"==typeof c&&(c=function(){return null});if(!a.length||!C(a[0]))return null;H(a[a.length-1])&&(!D(a[a.length-
1],"br")&&D(a[a.length-1].nextSibling,"br"))&&a.push(a[a.length-1].nextSibling);c=C(a[0].previousSibling)&&b(a[0].previousSibling)?a[0].previousSibling:C(a[a.length-1].nextSibling)&&b(a[a.length-1].nextSibling)?a[a.length-1].nextSibling:c();if(!c)return null;if(!c.parentNode){a[0].parentNode.insertBefore(c,a[0]);var k=g.startContainer,d=g.startOffset,l=g.endContainer,f=g.endOffset;k==c.parentNode&&d>=t(c)&&g.setStart(k,d+1);l==c.parentNode&&f>=t(c)&&g.setEnd(l,f+1);Fa&&Fa!==g&&(k=Fa.startContainer,
d=Fa.startOffset,l=Fa.endContainer,f=Fa.endOffset,k==c.parentNode&&d>=t(c)&&Fa.setStart(k,d+1),l==c.parentNode&&f>=t(c)&&Fa.setEnd(l,f+1))}k=a[0].parentNode;if(e(c,a[0])){!H(c)&&(H(c.lastChild)&&H(a[0])&&!D(c.lastChild,"BR"))&&c.appendChild(c.ownerDocument.createElement("br"));for(d=0;d<a.length;d++)ea(a[d],c,-1,g)}else{!H(c)&&(H(c.firstChild)&&H(a[a.length-1])&&!D(a[a.length-1],"BR"))&&c.insertBefore(c.ownerDocument.createElement("br"),c.firstChild);for(d=a.length-1;0<=d;d--)ea(a[d],c,0,g)}C(k)&&
!k.hasChildNodes()&&k.parentNode.removeChild(k);if(C(c.nextSibling)&&b(c.nextSibling)){for(!H(c)&&(H(c.lastChild)&&H(c.nextSibling.firstChild)&&!D(c.lastChild,"BR"))&&c.appendChild(c.ownerDocument.createElement("br"));c.nextSibling.hasChildNodes();)ea(c.nextSibling.firstChild,c,-1,g);c.parentNode.removeChild(c.nextSibling)}Qa(c);return c}function pa(a,b){if((xb[b]||M(b,"colgroup table tbody tfoot thead tr".split(" ")))&&"object"==typeof a&&a.nodeType==j.Node.TEXT_NODE&&!/^[ \t\n\f\r]*$/.test(a.data)||
(yb[b]||M(b,["script","style","plaintext","xmp"]))&&("object"!=typeof a||a.nodeType!=j.Node.TEXT_NODE)||"object"==typeof a&&(a.nodeType==j.Node.DOCUMENT_NODE||a.nodeType==j.Node.DOCUMENT_FRAGMENT_NODE||a.nodeType==j.Node.DOCUMENT_TYPE_NODE))return!1;Y(a)&&(a=a.tagName.toLowerCase());if("string"!=typeof a)return!0;if(Y(b)){for(var e=b;e;){if("a"==a&&D(e,"a")||ca[a.toUpperCase()]&&e&&1==e.nodeType&&q(e.namespaceURI)&&zb[e.nodeName]||/^h[1-6]$/.test(a)&&Y(e)&&/^H[1-6]$/.test(e.tagName))return!1;e=e.parentNode}b=
b.tagName.toLowerCase()}if("object"==typeof b&&(b.nodeType==j.Node.ELEMENT_NODE||b.nodeType==j.Node.DOCUMENT_FRAGMENT_NODE))return!0;if("string"!=typeof b)return!1;switch(b){case "colgroup":return"col"==a;case "table":return-1!=f.inArray(a,"caption col colgroup tbody td tfoot th thead tr".split(" "));case "tbody":case "thead":case "tfoot":return-1!=f.inArray(a,["td","th","tr"]);case "tr":return-1!=f.inArray(a,["td","th"]);case "dl":return-1!=f.inArray(a,["dt","dd"]);case "dir":case "ol":case "ul":return-1!=
f.inArray(a,["dir","li","ol","ul"]);case "hgroup":return/^h[1-6]$/.test(a)}return-1!=f.inArray(a,"body caption col colgroup frame frameset head html tbody td tfoot th thead tr".split(" "))||-1!=f.inArray(a,["dd","dt"])&&"dl"!=b||"li"==a&&"ol"!=b&&"ul"!=b?!1:(e=Ab[b.toUpperCase()])&&e[a.toUpperCase()]?!1:!0}function Va(a,b){return b.collapsed?!1:y(a,b)||a==b.startContainer&&a.nodeType==j.Node.TEXT_NODE&&v(a)!=b.startOffset||a==b.endContainer&&a.nodeType==j.Node.TEXT_NODE&&0!=b.endOffset||a.hasChildNodes()&&
j(a.childNodes).every(function(a){return Va(a,b)})&&(!k(b.startContainer,a)||b.startContainer.nodeType!=j.Node.TEXT_NODE||0==b.startOffset)&&(!k(b.endContainer,a)||b.endContainer.nodeType!=j.Node.TEXT_NODE||b.endOffset==v(b.endContainer))?!0:!1}function oa(a,c){"undefined"==typeof c&&(c=function(){return!0});for(var g=a.startContainer;Va(g.parentNode,a);)g=g.parentNode;for(var k=m(a.endContainer),d=[];e(g,k);)Va(g,a)&&c(g)&&d.push(g),g=b(g);return d}function Pa(b){if(!Y(b))return!1;if(-1!=f.inArray(b.tagName,
"B EM I S SPAN STRIKE STRONG SUB SUP U".split(" "))&&(0==b.attributes.length||1==b.attributes.length&&a(b,"style")))return!0;if("FONT"==b.tagName||"A"==b.tagName){var e=b.attributes.length;a(b,"style")&&e--;"FONT"==b.tagName&&(a(b,"color")&&e--,a(b,"face")&&e--,a(b,"size")&&e--);"A"==b.tagName&&a(b,"href")&&e--;if(0==e)return!0}return!1}function Xa(b){return!Y(b)||-1==f.inArray(b.tagName,"A B EM FONT I S SPAN STRIKE STRONG SUB SUP U".split(" "))?!1:0==b.attributes.length?!0:1<b.attributes.length?
!1:a(b,"style")&&0==d(b)||"A"==b.tagName&&a(b,"href")||"FONT"==b.tagName&&(a(b,"color")||a(b,"face")||a(b,"size"))||("B"==b.tagName||"STRONG"==b.tagName)&&a(b,"style")&&1==d(b)&&""!=b.style.fontWeight||("I"==b.tagName||"EM"==b.tagName)&&a(b,"style")&&1==d(b)&&""!=b.style.fontStyle||("A"==b.tagName||"FONT"==b.tagName||"SPAN"==b.tagName)&&a(b,"style")&&1==d(b)&&""==b.style.textDecoration||-1!=f.inArray(b.tagName,"A FONT S SPAN STRIKE U".split(" "))&&a(b,"style")&&1==d(b)&&("line-through"==b.style.textDecoration||
"underline"==b.style.textDecoration||"overline"==b.style.textDecoration||"none"==b.style.textDecoration)?!0:!1}function sa(a,b,e){return null===b&&null===e||"string"==typeof b&&"string"==typeof e&&b==e&&!("equivalentValues"in Q[a])||"string"==typeof b&&"string"==typeof e&&"equivalentValues"in Q[a]&&Q[a].equivalentValues(b,e)?!0:!1}function Ca(a,b,e){if(sa(a,b,e))return!0;if("fontsize"!=a||"string"!=typeof b||"string"!=typeof e)return!1;var c=Ca;if(void 0===c.sizeMap){c.sizeMap={};var g=document.createElement("font");
document.body.appendChild(g);j("xx-small small medium large x-large xx-large xxx-large".split(" ")).forEach(function(a){g.size=r(a);c.sizeMap[a]=j.getComputedStyle(g).fontSize});document.body.removeChild(g)}return b===c.sizeMap[e]||e===c.sizeMap[b]}function da(b,e){if(b.nodeType!=j.Node.ELEMENT_NODE&&(!b.parentNode||b.parentNode.nodeType!=j.Node.ELEMENT_NODE))return null;if(b.nodeType!=j.Node.ELEMENT_NODE)return da(b.parentNode,e);if("createlink"==e||"unlink"==e){for(;b&&(!Y(b)||"A"!=b.tagName||!a(b,
"href"));)b=b.parentNode;return!b?null:b.getAttribute("href")}if("backcolor"==e||"hilitecolor"==e){for(;("rgba(0, 0, 0, 0)"==j.getComputedStyle(b).backgroundColor||""===j.getComputedStyle(b).backgroundColor||"transparent"==j.getComputedStyle(b).backgroundColor)&&b.parentNode&&b.parentNode.nodeType==j.Node.ELEMENT_NODE;)b=b.parentNode;return"rgba(0, 0, 0, 0)"==j.getComputedStyle(b).backgroundColor||""===j.getComputedStyle(b).backgroundColor||"transparent"==j.getComputedStyle(b).backgroundColor?"rgb(255, 255, 255)":
j.getComputedStyle(b).backgroundColor}if("subscript"==e||"superscript"==e){for(var c=!1,g=!1;H(b);)j.getComputedStyle(b),D(b,"sub")?c=!0:D(b,"sup")&&(g=!0),b=b.parentNode;return c&&g?"mixed":c?"subscript":g?"superscript":null}if("strikethrough"==e){do{if(-1!=j.getComputedStyle(b).textDecoration.indexOf("line-through"))return"line-through";b=b.parentNode}while(b&&b.nodeType==j.Node.ELEMENT_NODE);return null}if("underline"==e){do{if(-1!=j.getComputedStyle(b).textDecoration.indexOf("underline"))return"underline";
b=b.parentNode}while(b&&b.nodeType==j.Node.ELEMENT_NODE);return null}if(!("relevantCssProperty"in Q[e]))throw"Bug: no relevantCssProperty for "+e+" in getEffectiveCommandValue";return j.getComputedStyle(b)[Q[e].relevantCssProperty].toString()}function ra(b,e){if(("backcolor"==e||"hilitecolor"==e)&&"inline"!=j.getComputedStyle(b).display)return null;if("createlink"==e||"unlink"==e)return Y(b)&&"A"==b.tagName&&a(b,"href")?b.getAttribute("href"):null;if("subscript"==e||"superscript"==e)return D(b,"sup")?
"superscript":D(b,"sub")?"subscript":null;if("strikethrough"==e&&""!=b.style.textDecoration)return-1!=b.style.textDecoration.indexOf("line-through")?"line-through":null;if("strikethrough"==e&&M(b,["S","STRIKE"]))return"line-through";if("underline"==e&&""!=b.style.textDecoration)return-1!=b.style.textDecoration.indexOf("underline")?"underline":null;if("underline"==e&&D(b,"U"))return"underline";var c=Q[e].relevantCssProperty;if(null===c)return null;if(""!=b.style[c])return b.style[c];if(q(b.namespaceURI)&&
"FONT"==b.tagName){if("color"==c&&a(b,"color"))return b.color;if("fontFamily"==c&&a(b,"face"))return b.face;if("fontSize"==c&&a(b,"size"))return c=parseInt(b.size),1>c&&(c=1),7<c&&(c=7),{1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[c]}return"fontWeight"==c&&("B"==b.tagName||"STRONG"==b.tagName)?"bold":"fontStyle"==c&&("I"==b.tagName||"EM"==b.tagName)?"italic":null}function db(a,b,e,c){for(var g=a;Pa(g)&&1==g.childNodes.length&&Pa(g.firstChild)&&(!Xa(g)||!sa(b,
ra(g,b),e));)g=g.firstChild;if(!(g==a||!Xa(g)||!sa(b,ra(g,b),e)||!Ca(b,da(g,b),e))){for(;g.hasChildNodes();)ea(g.firstChild,g.parentNode,t(g),c);a.parentNode.insertBefore(g,a.nextSibling);ea(a,g,-1,c)}}function xa(a){for(var b=[],a=f.makeArray(a),e=0;e<a.length;e++)for(var c=a[e],g=0;g<pb.length;g++){var k=pb[g],d=c;1!=d.nodeType&&(d=d.parentNode);for(var l=null;d&&1==d.nodeType&&null===(l=ra(d,k));)d=d.parentNode;b.push([c,k,l])}return b}function za(a,b){j(a).forEach(function(a){var e=a[0],c=a[1],
a=a[2],g=e;if(!g||g.nodeType!=j.Node.ELEMENT_NODE)g=g.parentNode;for(;g&&g.nodeType==j.Node.ELEMENT_NODE&&null===ra(g,c);)g=g.parentNode;null===a&&g&&g.nodeType==j.Node.ELEMENT_NODE?Ra(e,c,null,b):(g&&g.nodeType==j.Node.ELEMENT_NODE&&!sa(c,ra(g,c),a)||(!g||g.nodeType!=j.Node.ELEMENT_NODE)&&null!==a)&&Ea(e,c,a,b)})}function Ja(a,b,e){if(!C(a)||null===ra(a,b))return[];if(Xa(a)){for(var b=Array.prototype.slice.call(c(a.childNodes)),g=0;g<b.length;g++)ea(b[g],a.parentNode,t(a),e);a.parentNode.removeChild(a);
return b}"strikethrough"==b&&-1!=a.style.textDecoration.indexOf("line-through")&&(a.style.textDecoration="line-through"==a.style.textDecoration?"":a.style.textDecoration.replace("line-through",""),""==a.getAttribute("style")&&a.removeAttribute("style"));"underline"==b&&-1!=a.style.textDecoration.indexOf("underline")&&(a.style.textDecoration="underline"==a.style.textDecoration?"":a.style.textDecoration.replace("underline",""),""==a.getAttribute("style")&&a.removeAttribute("style"));null!==Q[b].relevantCssProperty&&
(a.style[Q[b].relevantCssProperty]="",""==a.getAttribute("style")&&a.removeAttribute("style"));q(a.namespaceURI)&&"FONT"==a.tagName&&("forecolor"==b&&a.removeAttribute("color"),"fontname"==b&&a.removeAttribute("face"),"fontsize"==b&&a.removeAttribute("size"));D(a,"A")&&("createlink"==b||"unlink"==b)&&a.removeAttribute("href");return null===ra(a,b)?[]:[la(a,"span",e)]}function Ra(a,b,e,g){if(a.parentNode&&a.parentNode.nodeType==j.Node.ELEMENT_NODE&&!Ca(b,da(a,b),e)){for(var k=a.parentNode,d=[];C(k)&&
k.nodeType==j.Node.ELEMENT_NODE&&!Ca(b,da(k,b),e);)d.push(k),k=k.parentNode;if(d.length){var l=ra(d[d.length-1],b);if(!(null===l&&l!=e)&&(null===e||Ca(b,da(d[d.length-1].parentNode,b),e)))for(;d.length;){k=d.pop();null!==ra(k,b)&&(l=ra(k,b));e=Array.prototype.slice.call(c(k.childNodes));null!==ra(k,b)&&Ja(k,b,g);for(k=0;k<e.length;k++){var f=e[k];f!=a&&!(f.nodeType==j.Node.ELEMENT_NODE&&null!==ra(f,b)&&!sa(b,l,ra(f,b)))&&f!=d[d.length-1]&&Ea(f,b,l,g)}}}}}function Ea(a,b,e,c){if(a.parentNode&&null!==
e&&(pa(a,"span")&&(db(a.previousSibling,b,e,c),db(a.nextSibling,b,e,c),qa([a],function(a){return Xa(a)&&sa(b,ra(a,b),e)&&Ca(b,da(a,b),e)},function(){return null},c)),!Ca(b,da(a,b),e)))if(pa(a,"span")){if(!Ca(b,da(a,b),e)){var g=null;if(!gb){if("bold"==b&&("bold"==e||"700"==e))g=a.ownerDocument.createElement("b");"italic"==b&&"italic"==e&&(g=a.ownerDocument.createElement("i"));"strikethrough"==b&&"line-through"==e&&(g=a.ownerDocument.createElement("s"));"underline"==b&&"underline"==e&&(g=a.ownerDocument.createElement("u"));
"forecolor"==b&&N(e)&&(g=a.ownerDocument.createElement("span"),f(g).css("color",N(e)));"fontname"==b&&(g=a.ownerDocument.createElement("font"),g.face=e)}if("createlink"==b||"unlink"==b){g=a.ownerDocument.createElement("a");g.setAttribute("href",e);for(var k=a.parentNode;k;)D(k,"A")&&(k=la(k,"span",c)),k=k.parentNode}if("fontsize"==b&&-1!=f.inArray(e,"xx-small small medium large x-large xx-large xxx-large".split(" "))&&(!gb||"xxx-large"==e))g=a.ownerDocument.createElement("font"),g.size=r(e);if(("subscript"==
b||"superscript"==b)&&"subscript"==e)g=a.ownerDocument.createElement("sub");if(("subscript"==b||"superscript"==b)&&"superscript"==e)g=a.ownerDocument.createElement("sup");g||(g=a.ownerDocument.createElement("span"));a.parentNode.insertBefore(g,a);k=Q[b].relevantCssProperty;null!==k&&!Ca(b,da(g,b),e)&&(g.style[k]=e);"strikethrough"==b&&("line-through"==e&&"line-through"!=da(g,"strikethrough"))&&(g.style.textDecoration="line-through");"underline"==b&&("underline"==e&&"underline"!=da(g,"underline"))&&
(g.style.textDecoration="underline");ea(a,g,g.childNodes.length,c);if(a.nodeType==j.Node.ELEMENT_NODE&&!sa(b,da(a,b),e)){ea(a,g.parentNode,t(g),c);g.parentNode.removeChild(g);g=[];for(k=0;k<a.childNodes.length;k++){if(a.childNodes[k].nodeType==j.Node.ELEMENT_NODE&&(d=ra(a.childNodes[k],b),null!==d&&!sa(b,e,d)))continue;g.push(a.childNodes[k])}for(k=0;k<g.length;k++)Ea(g[k],b,e,c)}}}else{g=[];for(k=0;k<a.childNodes.length;k++){if(a.childNodes[k].nodeType==j.Node.ELEMENT_NODE){var d=ra(a.childNodes[k],
b);if(null!==d&&!sa(b,e,d))continue}g.push(a.childNodes[k])}for(k=0;k<g.length;k++)Ea(g[k],b,e,c)}}function ma(a,b,e){e=e||J();if(j(oa(e)).filter(function(a){return a.nodeType==j.Node.TEXT_NODE},!0).some(C)){if(C(e.startContainer)&&e.startContainer.nodeType==j.Node.TEXT_NODE&&0!=e.startOffset&&e.startOffset!=v(e.startContainer)){var c=e.startContainer.splitText(e.startOffset),g=Aloha.createRange();if(e.startContainer==e.endContainer){var k=e.endOffset-e.startOffset;g.setEnd(c,k);e.setEnd(c,k)}g.setStart(c,
0);Aloha.getSelection().removeAllRanges();Aloha.getSelection().addRange(g);e.setStart(c,0)}C(e.endContainer)&&(e.endContainer.nodeType==j.Node.TEXT_NODE&&0!=e.endOffset&&e.endOffset!=v(e.endContainer))&&(c=e,g=[c.startContainer,c.startOffset],k=[c.endContainer,c.endOffset],c.endContainer.splitText(c.endOffset),c.setStart(g[0],g[1]),c.setEnd(k[0],k[1]),Aloha.getSelection().removeAllRanges(),Aloha.getSelection().addRange(c));j(oa(J(),function(a){return C(a)&&a.nodeType==j.Node.ELEMENT_NODE})).forEach(function(b){Ja(b,
a,e)});j(oa(e,C)).forEach(function(c){Ra(c,a,b,e);Ea(c,a,b,e)})}else"inlineCommandActivatedValues"in Q[a]&&lb(a,-1!=j(Q[a].inlineCommandActivatedValues).indexOf(b),e),"subscript"==a&&mb("superscript",e),"superscript"==a&&mb("subscript",e),null===b?qb(a,e):"value"in Q[a]&&nb(a,b,e)}function Ma(a,b){if(a.nodeType===j.Node.TEXT_NODE&&b<a.length)for(var e=b;e<a.length;e++)if("\t"!==a.data.charAt(e)&&"\r"!==a.data.charAt(e)&&"\n"!==a.data.charAt(e)||160===a.data.charCodeAt(e))return!1;if(a.nextSibling&&
a.nextSibling.className&&0<=a.nextSibling.className.indexOf("aloha-table-wrapper"))return a.nextSibling;if(a.parentNode&&a.parentNode.nextSibling&&a.parentNode.nextSibling.className&&0<=a.parentNode.nextSibling.className.indexOf("aloha-table-wrapper"))return a.parentNode.nextSibling;if(a.parentNode&&a.parentNode.nextSibling&&W(a.parentNode.nextSibling)&&a.parentNode.nextSibling.nextSibling&&a.parentNode.nextSibling.nextSibling.className&&0<=a.parentNode.nextSibling.nextSibling.className.indexOf("aloha-table-wrapper"))return a.parentNode.nextSibling.nextSibling}
function Na(a,b){if(a.nodeType===j.Node.TEXT_NODE&&0<b)for(var e=b-1;0<=e;e--)if("\t"!==a.data.charAt(e)&&"\r"!==a.data.charAt(e)&&"\n"!==a.data.charAt(e)||160===a.data.charCodeAt(e))return!1;return a.previousSibling&&a.previousSibling.className&&0<=a.previousSibling.className.indexOf("aloha-table-wrapper")?a.previousSibling:a.parentNode&&a.parentNode.previousSibling&&a.parentNode.previousSibling.className&&0<=a.parentNode.previousSibling.className.indexOf("aloha-table-wrapper")?a.parentNode.previousSibling:
a.parentNode&&a.parentNode.previousSibling&&W(a.parentNode.previousSibling)&&a.parentNode.previousSibling.previousSibling&&a.parentNode.previousSibling.previousSibling.className&&0<=a.parentNode.previousSibling.previousSibling.className.indexOf("aloha-table-wrapper")?a.parentNode.previousSibling.previousSibling:!1}function Oa(a){a=j(a).trim();if(/^[-+]?[0-9]+(\.[0-9]+)?([eE][-+]?[0-9]+)?$/.test(a)){var b;"+"==a[0]?(a=a.slice(1),b="relative-plus"):"-"==a[0]?(a=a.slice(1),b="relative-minus"):b="absolute";
a=parseInt(a);"relative-plus"==b&&(a+=3);"relative-minus"==b&&(a=3-a);1>a&&(a=1);7<a&&(a=7);a={1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[a]}return a}function Za(a){a=Oa(a);if(-1==f.inArray(a,"xx-small x-small small medium large x-large xx-large xxx-large".split(" "))&&!/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc|px)$/.test(a))return null;var b=document.createElement("font");document.body.appendChild(b);"xxx-large"==a?b.size=7:b.style.fontSize=a;a=parseInt(j.getComputedStyle(b).fontSize);
document.body.removeChild(b);for(var e=1;7>e;){b=document.createElement("font");b.size=e;document.body.appendChild(b);var c=parseInt(j.getComputedStyle(b).fontSize);b.size=1+e;var g=parseInt(j.getComputedStyle(b).fontSize);document.body.removeChild(b);if(a<(g+c)/2)return""+e;e++}return"7"}function Aa(a){if(!Y(a))return!1;if("BLOCKQUOTE"==a.tagName)return!0;if("DIV"!=a.tagName)return!1;if("undefined"!==typeof a.style.length)for(var b=0;b<a.style.length;b++){if(/^(-[a-z]+-)?margin/.test(a.style[b]))return!0}else for(b in a.style)if(/^(-[a-z]+-)?margin/.test(b)&&
a.style[b]&&0!==a.style[b])return!0;return!1}function Ia(a){if(!Aa(a)||"BLOCKQUOTE"!=a.tagName&&"DIV"!=a.tagName)return!1;for(var b=0;b<a.attributes.length;b++)if(!q(a.attributes[b].namespaceURI)||-1==f.inArray(a.attributes[b].name,["style","class","dir"]))return!1;if("undefined"!==typeof a.style.length)for(b=0;b<a.style.length;b++){if(!/^(-[a-z]+-)?(margin|border|padding)/.test(a.style[b]))return!1}else for(var e in a.style)if(!/^(-[a-z]+-)?(margin|border|padding)/.test(e)&&a.style[e]&&0!==a.style[e]&&
"false"!==a.style[e])return!1;return!0}function ka(a){return M(a,"address div h1 h2 h3 h4 h5 h6 listing p pre xmp".split(" "))}function Sa(a){return ka(a)||M(a,["li","dt","dd"])}function U(a,b){if(C(a))if(j(p(a)).every(function(b){return!aa(a,b)||!pa(a,b)})&&!T(a,$a))if(M(a,["dd","dt"]))qa([a],function(a){return D(a,"dl")&&!a.attributes.length},function(){return document.createElement("dl")},b);else{if(Z(a)){a=la(a,$a,b);Ta(a);U(a,b);for(var e=o(a),c=0;c<e.length;c++)U(e[c],b)}}else{for(e=xa([a]);!pa(a,
a.parentNode);){for(c=a.parentNode.childNodes.length-1;0<=c;--c)3==a.parentNode.childNodes[c].nodeType&&0==a.parentNode.childNodes[c].data.length&&(a.parentNode.removeChild(a.parentNode.childNodes[c]),b.startContainer==a.parentNode&&b.startOffset>c&&b.startOffset--,b.endContainer==a.parentNode&&b.endOffset>c&&b.endOffset--);if(1==a.parentNode.childNodes.length){var c=b.startOffset,g=b.endOffset;b.startContainer===a.parentNode&&b.startOffset>t(a)&&(c=b.startOffset+(f(a).contents().length-1));b.endContainer===
a.parentNode&&b.endOffset>t(a)&&(g=b.endOffset+(f(a).contents().length-1));f(a).contents().unwrap();b.startOffset=c;b.endOffset=g;break}else if(c=a.parentNode,Ka([a],b),c===a.parentNode){c=b.startOffset;g=b.endOffset;b.startContainer===a.parentNode&&b.startOffset>t(a)&&(c=b.startOffset+(f(a).contents().length-1));b.endContainer===a.parentNode&&b.endOffset>t(a)&&(g=b.endOffset+(f(a).contents().length-1));f(a).contents().unwrap();b.startOffset=c;b.endOffset=g;break}}za(e,b)}}function P(a,b){if(D(a,
"LI")&&C(a)&&C(a.parentNode))for(var e=null;j(a.childNodes).some(function(a){return M(a,["OL","UL"])});){var c=a.lastChild;M(c,["OL","UL"])||!e&&c.nodeType==j.Node.TEXT_NODE&&/^[ \t\n\f\r]*$/.test(c.data)?(e=null,ea(c,a.parentNode,1+t(a),b)):(e||(e=a.ownerDocument.createElement("li"),a.parentNode.insertBefore(e,a.nextSibling)),ea(c,e,0,b))}}function Ba(a,b){M(a,["OL","UL"])&&C(a)&&f(a).children("ol,ul").each(function(a,e){D(e.previousSibling,"LI")&&ea(e,e.previousSibling,e.previousSibling.childNodes.length,
b)})}function ja(){var a=$(J()),b=B(a,function(a){return C(a)&&!Aa(a)&&(M(a,["ol","ul"])||M(a.parentNode,["ol","ul"])||pa(a,"li"))});if(!b.length)return"none";if(j(b).every(function(a){return D(a,"ol")||D(a.parentNode,"ol")||D(a.parentNode,"li")&&D(a.parentNode.parentNode,"ol")})&&!j(b).some(function(a){return D(a,"ul")||"querySelector"in a&&a.querySelector("ul")}))return"ol";if(j(b).every(function(a){return D(a,"ul")||D(a.parentNode,"ul")||D(a.parentNode,"li")&&D(a.parentNode.parentNode,"ul")})&&
!j(b).some(function(a){return D(a,"ol")||"querySelector"in a&&a.querySelector("ol")}))return"ul";a=j(b).some(function(a){return D(a,"ol")||D(a.parentNode,"ol")||"querySelector"in a&&a.querySelector("ol")||D(a.parentNode,"li")&&D(a.parentNode.parentNode,"ol")});b=j(b).some(function(a){return D(a,"ul")||D(a.parentNode,"ul")||"querySelector"in a&&a.querySelector("ul")||D(a.parentNode,"li")&&D(a.parentNode.parentNode,"ul")});return a&&b?"mixed":a?"mixed ol":b?"mixed ul":"none"}function ga(a){for(;a&&
a.nodeType!=j.Node.ELEMENT_NODE||a.nodeType==j.Node.ELEMENT_NODE&&-1!=f.inArray(j.getComputedStyle(a).display,["inline","none"]);)a=a.parentNode;if(!a||a.nodeType!=j.Node.ELEMENT_NODE)return"left";var b=j.getComputedStyle(a).textAlign.replace(/^-(moz|webkit)-/,"").replace(/^auto$/,"start");return"start"==b?"ltr"==u(a)?"left":"right":"end"==b?"ltr"==u(a)?"right":"left":-1!=f.inArray(b,["center","justify","left","right"])?b:"left"}function Ga(a,b){return!a.parentNode&&0==b||0<=b-1&&b-1<a.childNodes.length&&
ia(a.childNodes[b-1])&&(E(a.childNodes[b-1])||D(a.childNodes[b-1],"br"))}function V(a,b){return!a.parentNode&&b==v(a)||b<a.childNodes.length&&ia(a.childNodes[b])&&E(a.childNodes[b])}function $(a){var b=a.startContainer,e=a.startOffset,c=a.endContainer,a=a.endOffset,g=j(p(b).concat(b)).filter(function(a){return D(a,"li")}).slice(-1);g.length&&(e=t(g[0]),b=g[0].parentNode);if(!Ga(b,e)){do 0==e?(e=t(b),b=b.parentNode):e--;while(!Ga(b,e)&&!V(b,e))}for(;0==e&&b.parentNode;)e=t(b),b=b.parentNode;g=j(p(c).concat(c)).filter(function(a){return D(a,
"li")}).slice(-1);g.length&&(a=1+t(g[0]),c=g[0].parentNode);if(!V(c,a)){do a==v(c)?(a=1+t(c),c=c.parentNode):a++;while(!Ga(c,a)&&!V(c,a))}for(;a==v(c)&&c.parentNode;)a=1+t(c),c=c.parentNode;g=Aloha.createRange();g.setStart(b,e);g.setEnd(c,a);return g}function fa(a){for(var b=0;!Ga(a,b)&&!V(a,b);){if(0<=b-1&&b-1<a.childNodes.length&&ia(a.childNodes[b-1]))return!1;0==b||!a.hasChildNodes()?(b=t(a),a=a.parentNode):(a=a.childNodes[b-1],b=v(a))}return!0}function Wa(a){for(var b=v(a);!Ga(a,b)&&!V(a,b);){if(b<
a.childNodes.length&&ia(a.childNodes[b]))return!1;b==v(a)||!a.hasChildNodes()?(b=1+t(a),a=a.parentNode):(a=a.childNodes[b],b=0)}return!0}function Bb(a){var b=[];void 0!==Ha("createlink",a)&&b.push(["createlink",Ha("createlink",a)]);j("bold italic strikethrough subscript superscript underline".split(" ")).forEach(function(e){void 0!==fb(e,a)&&b.push([e,fb(e,a)])});j(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(e){void 0!==Ha(e,a)&&b.push([e,Ha(e,a)])});return b}function Cb(a){var b=
[],e=j(oa(a)).filter(function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE})[0];if(!e)return b;b.push(["createlink",Q.createlink.value(a)]);j("bold italic strikethrough subscript superscript underline".split(" ")).forEach(function(a){-1!=j(Q[a].inlineCommandActivatedValues).indexOf(da(e,a))?b.push([a,!0]):b.push([a,!1])});j(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(e){b.push([e,Q[e].value(a)])});b.push(["fontsize",da(e,"fontsize")]);return b}function hb(a,b){var e=j(oa(b)).filter(function(a){return C(a)&&
a.nodeType==j.Node.TEXT_NODE})[0];if(e)for(var c=0;c<a.length;c++){var g=a[c][0],k=a[c][1];if("boolean"==typeof k&&I(g,b)!=k)G(g);else if("string"==typeof k&&"fontsize"!=g&&!sa(g,ba(g,b),k))G(g,!1,k,b);else if("string"==typeof k&&"fontsize"==g&&(void 0!==Ha("fontsize",b)&&Ha("fontsize",b)!==k||void 0===Ha("fontsize",b)&&!Ca(g,da(e,"fontsize"),k)))G("fontsize",!1,k,b);else continue;e=j(oa(b)).filter(function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE})[0]||e}else for(c=0;c<a.length;c++)g=a[c][0],
k=a[c][1],"boolean"==typeof k&&lb(g,k,b),"string"==typeof k&&nb(g,k,b)}function wa(){var a,b={};3>arguments.length?a=arguments[0]:(a=Aloha.createRange(),a.setStart(arguments[0],arguments[1]),a.setEnd(arguments[2],arguments[3]));2==arguments.length&&(b=arguments[1]);5==arguments.length&&(b=arguments[4]);var e="blockMerging"in b?!!b.blockMerging:!0,d="stripWrappers"in b?!!b.stripWrappers:!0;if(a){for(var l=a.startContainer,f=a.startOffset,m=a.endContainer,p=a.endOffset;l.hasChildNodes();)if(f==v(l)&&
aa(l,l.parentNode)&&H(l))f=1+t(l),l=l.parentNode;else{if(f==v(l))break;var o=l.childNodes[f];if(E(o)||o.nodeType==j.Node.ELEMENT_NODE&&!o.hasChildNodes()||o.nodeType!=j.Node.ELEMENT_NODE&&o.nodeType!=j.Node.TEXT_NODE)break;l=o;f=0}for(;m.hasChildNodes();)if(0==p&&aa(m,m.parentNode)&&H(m))p=t(m),m=m.parentNode;else{if(0==p)break;o=m.childNodes[p-1];if(E(o)||o.nodeType==j.Node.ELEMENT_NODE&&!o.hasChildNodes()||o.nodeType!=j.Node.ELEMENT_NODE&&o.nodeType!=j.Node.TEXT_NODE)break;m=o;p=v(o)}if("after"!==
z(m,p,l,f))a.setEnd(a.startContainer,a.startOffset);else{m.nodeType==j.Node.TEXT_NODE&&(p==v(m)&&l!=m)&&(p=1+t(m),m=m.parentNode);a.setStart(l,f);a.setEnd(m,p);for(var q=a.startContainer;aa(q,q.parentNode)&&H(q);)q=q.parentNode;if(!E(q)&&!L(q)||!pa("span",q)||M(q,["td","th"]))q=null;for(var r=a.endContainer;aa(r,r.parentNode)&&H(r);)r=r.parentNode;if(!E(r)&&!L(r)||!pa("span",r)||M(r,["td","th"]))r=null;b=Cb(a);if(l==m&&C(l)&&l.nodeType==j.Node.TEXT_NODE)o=l.parentNode,l.deleteData(f,p-f),0<f&&(" "===
l.data.substr(f-1,1)&&f<l.data.length&&" "===l.data.substr(f,1))&&l.replaceData(f-1,1," "),Ua(l,f),a.setStart(a.startContainer,a.startOffset),a.setEnd(a.startContainer,a.startOffset),hb(b,a),(C(o)||L(o))&&!H(o)&&Ta(o);else{C(l)&&l.nodeType==j.Node.TEXT_NODE&&l.deleteData(f,v(l)-f);for(var f=B(a,function(a){return C(a)&&!M(a,["thead","tbody","tfoot","tr","th","td"])}),u=0;u<f.length;u++){var x=f[u],o=x.parentNode;o.removeChild(x);if(d||!g(o,l)&&o!=l)for(;C(o)&&H(o)&&0==v(o);)x=o.parentNode,x.removeChild(o),
o=x;(C(o)||L(o))&&!H(o)&&Ta(o)}C(m)&&m.nodeType==j.Node.TEXT_NODE&&m.deleteData(0,p);Ua(a.startContainer,a.startOffset);Ua(a.endContainer,a.endOffset);if(!e||!q||!r||!aa(q,r)||q==r)a.setEnd(a.startContainer,a.startOffset);else{1==q.children.length&&ta(q.firstChild)&&q.removeChild(q.firstChild);1==r.children.length&&ta(r.firstChild)&&r.removeChild(r.firstChild);if(g(q,r)){for(o=r;o.parentNode!=q;)o=o.parentNode;a.setStart(q,t(o));a.setEnd(q,t(o));if(!r.hasChildNodes()){for(;C(r)&&1==r.parentNode.childNodes.length&&
r.parentNode!=q;)o=r,o.removeChild(r),r=o;C(r)&&(!H(r)&&H(r.previousSibling)&&H(r.nextSibling))&&r.parentNode.insertBefore(document.createElement("br"),r.nextSibling);C(r)&&r.parentNode.removeChild(r);hb(b,a);return}if(!H(r.firstChild)){hb(b,a);return}d=[];for(d.push(r.firstChild);!D(d[d.length-1],"br")&&H(d[d.length-1].nextSibling);)d.push(d[d.length-1].nextSibling);for(e=xa(d);d[0].parentNode!=q;)Ka(d,a);C(d[0].previousSibling)&&D(d[0].previousSibling,"br")&&d[0].parentNode.removeChild(d[0].previousSibling)}else if(k(q,
r)){a.setStart(q,v(q));a.setEnd(q,v(q));for(o=q;o.parentNode!=r;)o=o.parentNode;H(o.nextSibling)&&D(q.lastChild,"br")&&q.removeChild(q.lastChild);r=[];o.nextSibling&&(!D(o.nextSibling,"br")&&!E(o.nextSibling))&&r.push(o.nextSibling);r.length&&(r[r.length-1].nextSibling&&!D(r[r.length-1].nextSibling,"br")&&!E(r[r.length-1].nextSibling))&&r.push(r[r.length-1].nextSibling);e=xa(r);j(r).forEach(function(b){ea(b,q,-1,a)});D(o.nextSibling,"br")&&o.parentNode.removeChild(o.nextSibling)}else{a.setStart(q,
v(q));a.setEnd(q,v(q));H(r.firstChild)&&D(q.lastChild,"br")&&q.removeChild(q.lastChild);for(e=xa([].slice.call(c(r.childNodes)));r.hasChildNodes();)ea(r.firstChild,q,-1,a);for(;!r.hasChildNodes();)o=r.parentNode,o.removeChild(r),r=o}za(e,a);Ta(q)}hb(b,a)}}}}function Ka(a,b){var e=a[0].parentNode;if(C(e)&&e.parentNode){-1!=f.inArray(e.firstChild,a)&&Ya(e);var c=-1!=f.inArray(e.firstChild,a),g=-1!=f.inArray(e.lastChild,a),k=c&&fa(e),d=g&&Wa(e);if(!c&&g){for(c=a.length-1;0<=c;c--)ea(a[c],e.parentNode,
1+t(e),b);d&&!Wa(a[a.length-1])&&a[a.length-1].parentNode.insertBefore(document.createElement("br"),a[a.length-1].nextSibling);La(e)}else{if(!c){c=e.cloneNode(!1);e.removeAttribute("id");for(e.parentNode.insertBefore(c,e);a[0].previousSibling;)ea(e.firstChild,c,c.childNodes.length,b)}for(c=0;c<a.length;c++)ea(a[c],e.parentNode,t(e),b);k&&!fa(a[0])&&a[0].parentNode.insertBefore(document.createElement("br"),a[0]);H(a[a.length-1])&&(!D(a[a.length-1],"br")&&D(e.firstChild,"br")&&!H(e))&&e.removeChild(e.firstChild);
e.hasChildNodes()?Ya(e):(e.parentNode===b.startContainer&&(e.parentNode===b.endContainer&&b.startContainer===b.endContainer&&b.startOffset===b.endOffset&&e.parentNode.childNodes.length===b.startOffset)&&(b.startOffset=e.parentNode.childNodes.length-1,b.endOffset=b.startOffset),e.parentNode.removeChild(e),d&&!Wa(a[a.length-1])&&a[a.length-1].parentNode.insertBefore(document.createElement("br"),a[a.length-1].nextSibling));!a[a.length-1].nextSibling&&a[a.length-1].parentNode&&La(a[a.length-1].parentNode)}}}
function ib(a,b){a.hasChildNodes()?Ka([].slice.call(c(a.childNodes)),b):a.parentNode.removeChild(a)}function Db(a,b,e){if(0==a)return"";if(1==a&&!b&&!e)return" ";if(1==a)return" ";var c="",g;for(g=b?"  ":"  ";3<a;)c+=g,a-=2;return 3==a?c+(!b&&!e?"   ":b&&!e?"   ":!b&&e?"   ":b&&e?"   ":"impossible"):c+(!b&&!e?"  ":b&&!e?"  ":!b&&e?"  ":b&&e?"  ":"impossible")}function Ua(a,b){if(C(a)||L(a)){for(var e=a,c=b;;)if(0<=c-1&&aa(e,e.childNodes[c-1]))e=e.childNodes[c-1],c=v(e);else if(0==c&&!fa(e)&&aa(e,
e.parentNode))c=t(e),e=e.parentNode;else if(e.nodeType==j.Node.TEXT_NODE&&-1==f.inArray(j.getComputedStyle(e.parentNode).whiteSpace,["pre","pre-wrap"])&&0!=c&&/[ \xa0]/.test(e.data[c-1]))c--;else break;for(var g=e,k=c,d=0,l=!1;;)if(k<g.childNodes.length&&aa(g,g.childNodes[k]))g=g.childNodes[k],k=0;else if(k==v(g)&&!Wa(g)&&aa(g,g.parentNode))k=1+t(g),g=g.parentNode;else if(g.nodeType==j.Node.TEXT_NODE&&-1==f.inArray(j.getComputedStyle(g.parentNode).whiteSpace,["pre","pre-wrap"])&&k!=v(g)&&/[ \xa0]/.test(g.data[k]))l&&
" "==g.data[k]?g.deleteData(k,1):(l=" "==g.data[k],k++,d++);else break;for(d=Db(d,0==c&&fa(e),k==v(g)&&Wa(g));"before"==z(e,c,g,k);)c<e.childNodes.length?(e=e.childNodes[c],c=0):e.nodeType!=j.Node.TEXT_NODE||c==v(e)?(c=1+t(e),e=e.parentNode):(l=d[0],d=d.slice(1),l!=e.data[c]&&(e.insertData(c,l),e.deleteData(c+1,1)),c++)}}function Eb(a,b){a&&f(a).find("ul,ol,li").each(function(){f(this).contents().each(function(){if(W(this)){var a=t(this);b.startContainer===this.parentNode&&b.startOffset>a?b.startOffset--:
b.startContainer===this&&(b.startContainer=this.parentNode,b.startOffset=a);b.endContainer===this.parentNode&&b.endOffset>a?b.endOffset--:b.endContainer===this&&(b.endContainer=this.parentNode,b.endOffset=a);f(this).remove()}})})}function ob(a,b){if(a.length){var e=a[0];if(M(e.parentNode,["OL","UL"])){var c=e.parentNode.tagName;qa(a,function(a){return T(a,c)},function(){return e.ownerDocument.createElement(c)},b)}else{var g=qa(a,function(a){return Ia(a)},function(){return e.ownerDocument.createElement("blockquote")},
b);U(g,b)}}}function jb(a,b){if(C(a))if(Ia(a))ib(a,b);else if(Aa(a))a.removeAttribute("class"),a.removeAttribute("dir"),a.style.margin="",a.style.padding="",a.style.border="",""==a.getAttribute("style")&&a.removeAttribute("style"),la(a,"div",b);else{for(var e=a.parentNode,g=[];C(e)&&e.nodeType==j.Node.ELEMENT_NODE&&!Ia(e)&&!M(e,["ol","ul"]);)g.push(e),e=e.parentNode;if(!C(e)||!Ia(e)){e=a.parentNode;for(g=[];C(e)&&e.nodeType==j.Node.ELEMENT_NODE&&!Aa(e)&&!M(e,["ol","ul"]);)g.push(e),e=e.parentNode}if(M(a,
["OL","UL"])&&(!C(e)||!Aa(e))){a.removeAttribute("reversed");a.removeAttribute("start");a.removeAttribute("type");g=[].slice.call(c(a.childNodes));if(a.attributes.length&&!M(a.parentNode,["OL","UL"]))la(a,"div",b);else{var k=xa([].slice.call(c(a.childNodes)));ib(a,b);za(k,b)}for(k=0;k<g.length;k++)U(g[k],b)}else if(C(e)&&Aa(e)){g.push(e);for(k=e;g.length;){var e=g.pop(),d=a.parentNode==e?a:g[g.length-1];H(d)&&(!D(d,"BR")&&D(d.nextSibling,"BR"))&&d.parentNode.removeChild(d.nextSibling);var l=[].slice.call(c(e.childNodes),
0,t(d)),e=[].slice.call(c(e.childNodes),1+t(d));ob(l,b);ob(e,b)}jb(k,b)}}}function sb(a,b){var e=ja()==a?"disable":"enable",a=a.toUpperCase(),g="OL"==a?"UL":"OL",k=[];(function(){for(var a=b.endContainer;a!=b.commonAncestorContainer;a=a.parentNode)D(a,"li")&&k.unshift(a);for(a=b.startContainer;a;a=a.parentNode)D(a,"li")&&k.unshift(a)})();j(k).forEach(function(a){P(a,b)});var d=$(b);"enable"==e&&j(A(d,function(a){return C(a)&&T(a,g)})).forEach(function(e){if(C(e.previousSibling)&&T(e.previousSibling,
a)||C(e.nextSibling)&&T(e.nextSibling,a)){var e=[].slice.call(c(e.childNodes)),g=xa(e);Ka(e,b);qa(e,function(b){return T(b,a)},function(){return null},b);za(g,b)}else la(e,a,b)});d=B(d,function(a){return C(a)&&!Aa(a)&&(M(a,["OL","UL"])||M(a.parentNode,["OL","UL"])||pa(a,"li"))});"enable"==e&&(d=j(d).filter(function(a){return!M(a,["ol","ul"])||M(a.parentNode,["ol","ul"])}));if("disable"==e)for(;d.length;){var l=[];l.push(d.shift());if(T(l[0],a))jb(l[0],b);else{for(;d.length&&d[0]==l[l.length-1].nextSibling&&
!T(d[0],a);)l.push(d.shift());e=xa(l);Ka(l,b);for(var f=0;f<l.length;f++)U(l[f],b);za(e,b)}}else for(;d.length;){for(l=[];!l.length||d.length&&d[0]==l[l.length-1].nextSibling;)if(M(d[0],["p","div"]))l.push(la(d[0],"li",b)),d.shift();else if(M(d[0],["li","ol","ul"]))l.push(d.shift());else{for(e=[];!e.length||d.length&&d[0]==e[e.length-1].nextSibling&&H(d[0])&&H(e[e.length-1])&&!D(e[e.length-1],"br");)e.push(d.shift());l.push(qa(e,void 0,function(){return document.createElement("li")},b))}!T(l[0].parentNode,
a)&&!j(l).every(function(a){return M(a,["ol","ul"])})&&(T(l[0].parentNode,g)?(e=xa(l),Ka(l,b),qa(l,function(b){return T(b,a)},function(){return document.createElement(a)},b),za(e,b)):U(qa(l,function(b){return T(b,a)},function(){if(!C(l[0].parentNode)||!Ia(l[0].parentNode)||!C(l[0].parentNode.previousSibling)||!T(l[0].parentNode.previousSibling,a))return document.createElement(a);var e=l[0].parentNode.previousSibling;P(e.lastChild,b);(!C(e.lastChild)||!T(e.lastChild,a))&&e.appendChild(document.createElement(a));
return e.lastChild},b),b))}}function kb(b,e){for(var c=$(e),g=A(c,function(b){return b.nodeType==j.Node.ELEMENT_NODE&&C(b)&&(a(b,"align")||""!=b.style.textAlign||D(b,"center"))}),c=0;c<g.length;c++){var k=g[c];k.removeAttribute("align");k.style.textAlign="";""==k.getAttribute("style")&&k.removeAttribute("style");M(k,["div","span","center"])&&!k.attributes.length&&ib(k,e);D(k,"center")&&k.attributes.length&&la(k,"div",e)}c=$(Fa);g=[];for(g=B(c,function(a){return C(a)&&pa(a,"div")&&ga(a)!=b});g.length;){c=
[];for(c.push(g.shift());g.length&&g[0]==c[c.length-1].nextSibling;)c.push(g.shift());qa(c,function(a){return D(a,"div")&&j(a.attributes).every(function(e){return"align"==e.name&&e.value.toLowerCase()==b||"style"==e.name&&1==d(a)&&a.style.textAlign==b})},function(){var a=document.createElement("div");a.setAttribute("style","text-align: "+b);return a},e)}}function ab(){return document.createElement("br")}function Ta(a){a&&(D(a.lastChild,"br")||j(a.childNodes).some(ia)||(f.browser.msie?f.browser.msie&&
(7>=f.browser.version&&M(a,"p h1 h2 h3 h4 h5 h6 pre blockquote".split(" ")))&&(a.firstChild||a.appendChild(document.createTextNode("​"))):a.appendChild(ab())))}function tb(a,b){var e;if(a.collapsed){e=a.startOffset;if(b){if(a.startContainer&&a.startContainer.nodeType===j.Node.TEXT_NODE)for(;e<a.startContainer.data.length&&"​"===a.startContainer.data.charAt(e);)e++}else if(a.startContainer&&a.startContainer.nodeType===j.Node.TEXT_NODE)for(;0<e&&"​"===a.startContainer.data.charAt(e-1);)e--;e!==a.startOffset&&
(a.setStart(a.startContainer,e),a.setEnd(a.startContainer,e))}}var wb="http://www.w3.org/1999/xhtml",gb=!1,Fa=null,Q={},eb=0,ca={ADDRESS:!0,ARTICLE:!0,ASIDE:!0,BLOCKQUOTE:!0,CAPTION:!0,CENTER:!0,COL:!0,COLGROUP:!0,DD:!0,DETAILS:!0,DIR:!0,DIV:!0,DL:!0,DT:!0,FIELDSET:!0,FIGCAPTION:!0,FIGURE:!0,FOOTER:!0,FORM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,HEADER:!0,HGROUP:!0,HR:!0,LI:!0,LISTING:!0,MENU:!0,NAV:!0,OL:!0,P:!0,PLAINTEXT:!0,PRE:!0,SECTION:!0,SUMMARY:!0,TABLE:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,
TR:!0,UL:!0,XMP:!0},ya={inline:!0,"inline-block":!0,"inline-table":!0,none:!0},fb,lb,mb,Ha,nb,qb;(function(){function a(g){if(!c||c.startContainer!=g.startContainer||c.endContainer!=g.endContainer||c.startOffset!=g.startOffset||c.endOffset!=g.endOffset)b={},e={},c=g.cloneRange()}var b={},e={},c=null;fb=function(e,c){a(c);return b[e]};lb=function(e,c,g){a(g);b[e]=c};mb=function(e,c){a(c);delete b[e]};Ha=function(b,c){a(c);return e[b]};nb=function(b,c,g){a(g);e[b]=c;"backcolor"==b?e.hilitecolor=c:"hilitecolor"==
b&&(e.backcolor=c)};qb=function(b,c){a(c);delete e[b];"backcolor"==b?delete e.hilitecolor:"hilitecolor"==b&&delete e.backcolor}})();var zb={A:!0,ABBR:!0,B:!0,BDI:!0,BDO:!0,CITE:!0,CODE:!0,DFN:!0,EM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,I:!0,KBD:!0,MARK:!0,P:!0,PRE:!0,Q:!0,RP:!0,RT:!0,RUBY:!0,S:!0,SAMP:!0,SMALL:!0,SPAN:!0,STRONG:!0,SUB:!0,SUP:!0,U:!0,VAR:!0,ACRONYM:!0,LISTING:!0,STRIKE:!0,XMP:!0,BIG:!0,BLINK:!0,FONT:!0,MARQUEE:!0,NOBR:!0,TT:!0},xb={colgroup:!0,table:!0,tbody:!0,tfoot:!0,thead:!0,
tr:!0},yb={script:!0,style:!0,plaintext:!0,xmp:!0},bb=f.extend({H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0},ca),ub={CAPTION:!0,COL:!0,COLGROUP:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0},vb={DD:!0,DT:!0},Ab={A:f.extend({A:!0},ca),DD:vb,DT:vb,LI:{LI:!0},NOBR:f.extend({NOBR:!0},ca),H1:bb,H2:bb,H3:bb,H4:bb,H5:bb,H6:bb,TD:ub,TH:ub,ABBR:ca,B:ca,BDI:ca,BDO:ca,CITE:ca,CODE:ca,DFN:ca,EM:ca,I:ca,KBD:ca,MARK:ca,P:ca,PRE:ca,Q:ca,RP:ca,RT:ca,RUBY:ca,S:ca,SAMP:ca,SMALL:ca,SPAN:ca,STRONG:ca,SUB:ca,SUP:ca,U:ca,VAR:ca,
ACRONYM:ca,LISTING:ca,STRIKE:ca,XMP:ca,BIG:ca,BLINK:ca,FONT:ca,MARQUEE:ca,TT:ca},pb="subscript bold fontname fontsize forecolor hilitecolor italic strikethrough underline".split(" ");Q.backcolor={action:function(a){/^([0-9a-fA-F]{3}){1,2}$/.test(a)&&(a="#"+a);(/^(rgba?|hsla?)\(.*\)$/.test(a)||N(a)||"transparent"==a.toLowerCase())&&ma("backcolor",a)},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(a,b){return F(a)===F(b)}};Q.bold={action:function(a,b){I("bold",
b)?ma("bold","normal",b):ma("bold","bold",b)},inlineCommandActivatedValues:["bold","600","700","800","900"],relevantCssProperty:"fontWeight",equivalentValues:function(a,b){return a==b||"bold"==a&&"700"==b||"700"==a&&"bold"==b||"normal"==a&&"400"==b||"400"==a&&"normal"==b}};Q.createlink={action:function(b){""!==b&&(j(oa(J())).forEach(function(e){j(p(e)).forEach(function(e){C(e)&&(D(e,"a")&&a(e,"href"))&&e.setAttribute("href",b)})}),ma("createlink",b))},standardInlineValueCommand:!0};Q.fontname={action:function(a){ma("fontname",
a)},standardInlineValueCommand:!0,relevantCssProperty:"fontFamily"};Q.fontsize={action:function(a){""!==a&&(a=Oa(a),(-1!=f.inArray(a,"xx-small x-small small medium large x-large xx-large xxx-large".split(" "))||/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc)$/.test(a))&&ma("fontsize",a))},indeterm:function(){return 2<=j(oa(J(),function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE})).map(function(a){return da(a,"fontsize")},!0).filter(function(a,b,e){return-1==j(e.slice(0,b)).indexOf(a)}).length},value:function(a){var b=
oa(a,function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE})[0];void 0===b&&(b=a.startContainer);a=da(b,"fontsize");return Za(a)},relevantCssProperty:"fontSize"};Q.forecolor={action:function(a){/^([0-9a-fA-F]{3}){1,2}$/.test(a)&&(a="#"+a);(/^(rgba?|hsla?)\(.*\)$/.test(a)||N(a)||"transparent"==a.toLowerCase())&&ma("forecolor",a)},standardInlineValueCommand:!0,relevantCssProperty:"color",equivalentValues:function(a,b){return F(a)===F(b)}};Q.hilitecolor={action:function(a){/^([0-9a-fA-F]{3}){1,2}$/.test(a)&&
(a="#"+a);(/^(rgba?|hsla?)\(.*\)$/.test(a)||N(a)||"transparent"==a.toLowerCase())&&ma("hilitecolor",a)},indeterm:function(){return 2<=j(oa(J(),function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE})).map(function(a){return da(a,"hilitecolor")},!0).filter(function(a,b,e){return-1==j(e.slice(0,b)).indexOf(a)}).length},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(a,b){return F(a)===F(b)}};Q.italic={action:function(a,b){I("italic",b)?ma("italic","normal",
b):ma("italic","italic",b)},inlineCommandActivatedValues:["italic","oblique"],relevantCssProperty:"fontStyle"};Q.removeformat={action:function(){function a(b){return C(b)&&M(b,"abbr acronym b bdi bdo big blink cite code dfn em font i ins kbd mark nobr q s samp small span strike strong sub sup tt u var".split(" "))}var b=oa(J(),a);j(b).forEach(function(a){for(;a.hasChildNodes();)ea(a.firstChild,a.parentNode,t(a),range);a.parentNode.removeChild(a)});if(C(J().startContainer)&&J().startContainer.nodeType==
j.Node.TEXT_NODE&&0!=J().startOffset&&J().startOffset!=v(J().startContainer))if(J().startContainer==J().endContainer){var b=J().endOffset-J().startOffset,e=J().startContainer.splitText(J().startOffset);J().setStart(e,0);J().setEnd(e,b)}else J().setStart(J().startContainer.splitText(J().startOffset),0);C(J().endContainer)&&(J().endContainer.nodeType==j.Node.TEXT_NODE&&0!=J().endOffset&&J().endOffset!=v(J().endContainer))&&(e=[J().startContainer,J().startOffset],b=[J().endContainer,J().endOffset],J().setEnd(document.documentElement,
0),b[0].splitText(b[1]),J().setStart(e[0],e[1]),J().setEnd(b[0],b[1]));j(oa(J(),C)).forEach(function(b){for(;a(b.parentNode)&&aa(b.parentNode,b);)Ka([b],range)});j("subscript bold fontname fontsize forecolor hilitecolor italic strikethrough underline".split(" ")).forEach(function(a){ma(a,null)})}};Q.strikethrough={action:function(){I("strikethrough")?ma("strikethrough",null):ma("strikethrough","line-through")},inlineCommandActivatedValues:["line-through"]};Q.subscript={action:function(){var a=I("subscript");
ma("subscript",null);a||ma("subscript","subscript")},indeterm:function(){var a=oa(J(),function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE});return j(a).some(function(a){return"subscript"==da(a,"subscript")})&&j(a).some(function(a){return"subscript"!=da(a,"subscript")})||j(a).some(function(a){return"mixed"==da(a,"subscript")})},inlineCommandActivatedValues:["subscript"]};Q.superscript={action:function(){var a=I("superscript");ma("superscript",null);a||ma("superscript","superscript")},indeterm:function(){var a=
oa(J(),function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE});return j(a).some(function(a){return"superscript"==da(a,"superscript")})&&j(a).some(function(a){return"superscript"!=da(a,"superscript")})||j(a).some(function(a){return"mixed"==da(a,"superscript")})},inlineCommandActivatedValues:["superscript"]};Q.underline={action:function(){I("underline")?ma("underline",null):ma("underline","underline")},inlineCommandActivatedValues:["underline"]};Q.unlink={action:function(){for(var e=J(),c=[],k=e.startContainer;k;k=
k.parentNode)D(k,"A")&&a(k,"href")&&c.unshift(k);for(k=e.startContainer;k!=m(e.endContainer);k=b(k))D(k,"A")&&(a(k,"href")&&(y(k,e)||g(k,e.endContainer)||k==e.endContainer))&&c.push(k);for(k=0;k<c.length;k++)Ja(c[k],"unlink",e)},standardInlineValueCommand:!0};var $a="p";Q["delete"]={action:function(a,b){f.browser.msie&&7>=f.browser.version&&tb(b,!1);if(b.collapsed){Ua(b.startContainer,b.startOffset);for(var e=b.startContainer,c=b.startOffset,k=!1,d=!1;;)if(0<c&&(k=D(e.childNodes[c-1],"br")||!1,d=
D(e.childNodes[c-1],"hr")||!1),0==c&&C(e.previousSibling)&&na(e.previousSibling))e.parentNode.removeChild(e.previousSibling);else if(0<=c-1&&c-1<e.childNodes.length&&C(e.childNodes[c-1])&&(na(e.childNodes[c-1])||k||d)){if(e.removeChild(e.childNodes[c-1]),c--,k||d){b.setStart(e,c);b.setEnd(e,c);return}}else if(0==c&&H(e)||na(e))c=t(e),e=e.parentNode;else{if(0<=c-1&&c-1<e.childNodes.length&&C(e.childNodes[c-1])&&D(e.childNodes[c-1],"a")){ib(e.childNodes[c-1],b);return}if(0<=c-1&&c-1<e.childNodes.length&&
!E(e.childNodes[c-1])&&!M(e.childNodes[c-1],["br","img"]))e=e.childNodes[c-1],c=v(e);else break}if(k=Na(e,c))k.parentNode.removeChild(k);else if(e.nodeType==j.Node.TEXT_NODE&&0!=c)b.setStart(e,c-1),b.setEnd(e,c-1),wa(e,c-1,e,c);else if(e.nodeType==j.Node.TEXT_NODE&&0==c&&f.browser.msie)c=1,b.setStart(e,c),b.setEnd(e,c),b.startOffset=0,wa(b);else if(!H(e))if(0<=c-1&&c-1<e.childNodes.length&&M(e.childNodes[c-1],["br","hr","img"]))b.setStart(e,c),b.setEnd(e,c),wa(b);else if(M(e,["li","dt","dd"])&&e==
e.parentNode.firstChild&&0==c){c=[];for(k=e.parentNode;k;k=k.parentNode)D(k,"li")&&c.unshift(k);for(k=0;k<c.length;k++)P(c[k],b);k=xa([e]);Ka([e],b);za(k,b);M(e,["dd","dt"])&&j(p(e)).every(function(a){return!aa(e,a)||!pa(e,a)})&&(e=la(e,$a,b));U(e,b);for(k=0;k<c.length;k++)Ba(c[k].parentNode,b)}else{k=e;for(d=c;;)if(0==d)d=t(k),k=k.parentNode;else if(0<=d-1&&d-1<k.childNodes.length&&C(k.childNodes[d-1])&&na(k.childNodes[d-1]))k.removeChild(k.childNodes[d-1]),d--;else break;if(0==c&&j(p(e).concat(e)).filter(function(a){return C(a)&&
aa(a,e)&&Aa(a)}).length){c=Aloha.createRange();c.setStart(e,0);c.setEnd(e,0);c=$(c);c=B(c,function(a){return C(a)&&!O(a)});for(k=0;k<c.length;k++)jb(c[k],b)}else if(!D(k.childNodes[d],"table"))if(0<=d-1&&d-1<k.childNodes.length&&D(k.childNodes[d-1],"table"))b.setStart(k,d-1),b.setEnd(k,d);else if(0==c&&(D(k.childNodes[d-1],"hr")||D(k.childNodes[d-1],"br")&&(D(k.childNodes[d-1].previousSibling,"br")||!H(k.childNodes[d-1].previousSibling))))b.setStart(e,c),b.setEnd(e,c),wa(k,d-1,k,d);else{if(M(k.childNodes[d],
["li","dt","dd"])&&H(k.childNodes[d].firstChild)&&0!=d){var l=k.childNodes[d-1];H(l.lastChild)&&!D(l.lastChild,"br")&&l.appendChild(document.createElement("br"));H(l.lastChild)&&l.appendChild(document.createElement("br"))}if(M(k.childNodes[d],["li","dt","dd"])&&M(k.childNodes[d-1],["li","dt","dd"]))k=k.childNodes[d-1],d=v(k),e=k.nextSibling,c=0;else for(;0<=d-1&&d-1<k.childNodes.length;)C(k.childNodes[d-1])&&na(k.childNodes[d-1])?(k.removeChild(k.childNodes[d-1]),d--):(k=k.childNodes[d-1],d=v(k));
l=Aloha.createRange();l.setStart(k,d);l.setEnd(e,c);wa(l);if(!document.body&&!b.startContainer||!(document.body==b.startContainer||g(document.body,b.startContainer)))l.startContainer.hasChildNodes()||l.startContainer.nodeType==j.Node.TEXT_NODE?(b.setStart(l.startContainer,l.startOffset),b.setEnd(l.startContainer,l.startOffset)):(b.setStart(l.startContainer.parentNode,t(l.startContainer)),b.setEnd(l.startContainer.parentNode,t(l.startContainer)))}}}else wa(b)}};var cb="address dd div dt h1 h2 h3 h4 h5 h6 p pre".split(" ");
Q.formatblock={action:function(a){/^<.*>$/.test(a)&&(a=a.slice(1,-1));a=a.toLowerCase();if(-1!=j(cb).indexOf(a)){for(var b=$(J()),b=B(b,function(a){return C(a)&&(ka(a)||pa(a,"p")||M(a,["dd","dt"]))&&!j(o(a)).some(Z)}),e=xa(b),g=0;g<b.length;g++)for(var k=b[g];j(p(k)).some(function(a){return C(a)&&aa(a,k)&&T(a,cb)&&!j(o(a)).some(Z)});)Ka([k],range);for(za(e,range);b.length;){if(Sa(b[0]))g=[].slice.call(c(b[0].childNodes)),e=xa(g),ib(b[0],range),za(e,range),b.shift();else{g=[];for(g.push(b.shift());b.length&&
b[0]==g[g.length-1].nextSibling&&!Sa(b[0])&&!D(g[g.length-1],"BR");)g.push(b.shift())}U(qa(g,-1==f.inArray(a,["div","p"])?function(b){return T(b,a)&&!b.attributes.length}:function(){return!1},function(){return document.createElement(a)},range),range)}}},indeterm:function(){var a=$(J()),a=A(a,function(a){return ia(a)&&C(a)&&!a.hasChildNodes()});if(!a.length)return!1;for(var b=null,e=0;e<a.length;e++){for(var c=a[e];C(c.parentNode)&&aa(c,c.parentNode)&&!T(c,cb);)c=c.parentNode;var g="";C(c)&&(T(c,cb)&&
!j(o(c)).some(Z))&&(g=c.tagName);if(null===b)b=g;else if(b!=g)return!0}return!1},value:function(){var a=$(J()),a=A(a,function(a){return ia(a)&&C(a)&&!a.hasChildNodes()});if(!a.length)return"";for(a=a[0];C(a.parentNode)&&aa(a,a.parentNode)&&!T(a,cb);)a=a.parentNode;return C(a)&&T(a,cb)&&!j(o(a)).some(Z)?a.tagName.toLowerCase():""}};Q.forwarddelete={action:function(a,b){f.browser.msie&&7>=f.browser.version&&tb(b,!0);if(b.collapsed){Ua(b.startContainer,b.startOffset);for(var e=b.startContainer,c=b.startOffset;;)if(c==
v(e)&&C(e.nextSibling)&&na(e.nextSibling))e.parentNode.removeChild(e.nextSibling);else if(c<e.childNodes.length&&C(e.childNodes[c])&&na(e.childNodes[c]))e.removeChild(e.childNodes[c]);else if(c<e.childNodes.length&&ta(e.childNodes[c]))c++;else if(c==v(e)&&H(e)||na(e))c=1+t(e),e=e.parentNode;else if(c<e.childNodes.length&&!E(e.childNodes[c])&&!M(e.childNodes[c],["br","img"]))e=e.childNodes[c],c=0;else break;Ua(b.startContainer,b.startOffset);var g;if(g=Ma(e,c))g.parentNode.removeChild(g);else if(e.nodeType==
j.Node.TEXT_NODE&&c!=v(e)){b.setStart(e,c);b.setEnd(e,c);for(g=c+1;g!=e.length&&/^[\u0300-\u036f\u0591-\u05bd\u05c1\u05c2]$/.test(e.data[g]);)g++;wa(e,c,e,g)}else if(!H(e))if(c<e.childNodes.length&&M(e.childNodes[c],["br","hr","img"]))b.setStart(e,c),b.setEnd(e,c),wa(e,c,e,c+1);else{var k=e;for(g=c;;)if(g==v(k))g=1+t(k),k=k.parentNode;else if(g<k.childNodes.length&&C(k.childNodes[g])&&na(k.childNodes[g]))k.removeChild(k.childNodes[g]);else break;if(!D(k.childNodes[g-1],"table"))if(D(k.childNodes[g],
"table"))b.setStart(k,g),b.setEnd(k,g+1);else if(c==v(e)&&M(k.childNodes[g],["br","hr"]))b.setStart(e,c),b.setEnd(e,c),wa(k,g,k,g+1);else{for(;g<k.childNodes.length;)C(k.childNodes[g])&&na(k.childNodes[g])?k.removeChild(k.childNodes[g]):(k=k.childNodes[g],g=0);wa(e,c,k,g)}}}else wa(b)}};Q.indent={action:function(){for(var a=[],b=J().endContainer;b!=J().commonAncestorContainer;b=b.parentNode)D(b,"LI")&&a.unshift(b);for(b=J().startContainer;b!=J().commonAncestorContainer;b=b.parentNode)D(b,"LI")&&a.unshift(b);
for(b=J().commonAncestorContainer;b;b=b.parentNode)D(b,"LI")&&a.unshift(b);for(b=0;b<a.length;b++)P(a[b,range]);b=$(J());a=[];a=B(b,function(a){return C(a)&&(pa(a,"div")||pa(a,"ol"))});for(a.length&&(D(a[0],"LI")&&M(a[0].parentNode,["OL","UL"])&&D(a[0].previousSibling,"LI"))&&P(a[0].previousSibling,range);a.length;){b=[];for(b.push(a.shift());a.length&&a[0]==b[b.length-1].nextSibling;)b.push(a.shift());ob(b,range)}}};Q.inserthorizontalrule={action:function(a,b){for(;0==b.startOffset&&b.startContainer.parentNode;)b.setStart(b.startContainer.parentNode,
t(b.startContainer));for(;b.endOffset==v(b.endContainer)&&b.endContainer.parentNode;)b.setEnd(b.endContainer.parentNode,1+t(b.endContainer));wa(b,{blockMerging:!1});if(C(J().startContainer)||L(J().startContainer)){J().startContainer.nodeType==j.Node.TEXT_NODE&&0==J().startOffset&&(J().setStart(J().startContainer.parentNode,t(J().startContainer)),J().collapse(!0));J().startContainer.nodeType==j.Node.TEXT_NODE&&J().startOffset==v(J().startContainer)&&(J().setStart(J().startContainer.parentNode,1+t(J().startContainer)),
J().collapse(!0));var e=document.createElement("hr");b.insertNode(e);U(e,b);b.setStart(e.parentNode,1+t(e));b.setEnd(e.parentNode,1+t(e));Aloha.getSelection().removeAllRanges();Aloha.getSelection().addRange(b)}}};Q.inserthtml={action:function(a,b){wa(b);if(C(b.startContainer)||L(b.startContainer)){var e=b.createContextualFragment(a),c=e.lastChild;if(c){var g=o(e);E(b.startContainer)&&j(b.startContainer.childNodes).filter(function(a,b){return C(a)&&ta(a)&&t(a)>=b.startOffset},!0).forEach(function(a){a.parentNode.removeChild(a)});
b.insertNode(e);E(b.startContainer)&&Ta(b.startContainer);b.setStart(c.parentNode,1+t(c));b.setEnd(c.parentNode,1+t(c));for(e=0;e<g.length;e++)U(g[e],b);va(b)}}}};Q.insertimage={action:function(a){if(""!==a){var b=J();wa(b,{stripWrappers:!1});if(C(J().startContainer)||L(J().startContainer)){E(b.startContainer)&&(1==b.startContainer.childNodes.length&&D(b.startContainer.firstChild,"br")&&0==b.startOffset)&&b.startContainer.removeChild(b.startContainer.firstChild);var e=document.createElement("img");
e.setAttribute("src",a);b.insertNode(e);b.setStart(e.parentNode,1+t(e));b.setEnd(e.parentNode,1+t(e));Aloha.getSelection().removeAllRanges();Aloha.getSelection().addRange(b);e.removeAttribute("width");e.removeAttribute("height")}}}};Q.insertlinebreak={action:function(a,b){wa(b,{stripWrappers:!1});if(C(b.startContainer)||L(b.startContainer))if(b.startContainer.nodeType!=j.Node.ELEMENT_NODE||pa("br",b.startContainer))if(b.startContainer.nodeType==j.Node.ELEMENT_NODE||pa("br",b.startContainer.parentNode)){if(b.startContainer.nodeType==
j.Node.TEXT_NODE&&0==b.startOffset){var e=b.startContainer.parentNode,c=t(b.startContainer);Aloha.getSelection().collapse(e,c);b.setStart(e,c);b.setEnd(e,c)}b.startContainer.nodeType==j.Node.TEXT_NODE&&b.startOffset==v(b.startContainer)&&(e=b.startContainer.parentNode,c=1+t(b.startContainer),Aloha.getSelection().collapse(e,c),b.setStart(e,c),b.setEnd(e,c));e=document.createElement("br");b.insertNode(e);Aloha.getSelection().collapse(e.parentNode,1+t(e));b.setStart(e.parentNode,1+t(e));b.setEnd(e.parentNode,
1+t(e));X(e)&&(b.insertNode(ab()),Aloha.getSelection().collapse(e.parentNode,1+t(e)),b.setStart(e.parentNode,1+t(e)),b.setEnd(e.parentNode,1+t(e)));f.browser.msie&&8>f.browser.version&&e.parentNode.removeAttribute("style")}}};Q.insertorderedlist={action:function(){sb("ol")},indeterm:function(){return/^mixed( ol)?$/.test(ja())},state:function(){return"ol"==ja()}};var Fb={LI:!0,DT:!0,DD:!0};Q.insertparagraph={action:function(a,e){wa(e);Eb(ha(e.startContainer),e);if(C(e.startContainer)||L(e.startContainer)){var c=
e.startContainer,g=e.startOffset;c.nodeType==j.Node.TEXT_NODE&&(0!=g&&g!=v(c))&&c.splitText(g);c.nodeType==j.Node.TEXT_NODE&&g==v(c)&&(g=1+t(c),c=c.parentNode);if(c.nodeType==j.Node.TEXT_NODE||c.nodeType==j.Node.COMMENT_NODE)g=t(c),c=c.parentNode;Aloha.getSelection().collapse(c,g);e.setStart(c,g);e.setEnd(c,g);for(var d=c;!Sa(d)&&C(d.parentNode)&&aa(c,d.parentNode);)d=d.parentNode;if(!C(d)||!aa(d,c)||!Sa(d)){var l=$a,f=$(e),f=B(f,function(a){return pa(a,"p")}).slice(0,1);if(!f.length){if(!pa(l,e.startContainer))return;
d=document.createElement(l);e.insertNode(d);d.appendChild(ab());Aloha.getSelection().collapse(d,0);e.setStart(d,0);e.setEnd(d,0);return}for(;f[f.length-1].nextSibling&&pa(f[f.length-1].nextSibling,"p");)f.push(f[f.length-1].nextSibling);d=qa(f,function(){return false},function(){return document.createElement(l)},e)}if("ADDRESS"==d.tagName||"LISTING"==d.tagName||"PRE"==d.tagName){var m=document.createElement("br"),f=d.offsetHeight;e.insertNode(m);var q=d.offsetHeight;Aloha.getSelection().collapse(c,
g+1);e.setStart(c,g+1);e.setEnd(c,g+1);f==q&&!k(b(m),d)&&(e.insertNode(ab()),Aloha.getSelection().collapse(c,g+1),e.setEnd(c,g+1))}else if(Fb[d.tagName]&&(!d.hasChildNodes()||1==d.childNodes.length&&D(d.firstChild,"br"))){if(Ka([d],e),M(d,["dd","dt"])&&j(p(d)).every(function(a){return!aa(d,a)||!pa(d,a)})&&(d=la(d,$a,e)),U(d,e),D(d,"li")&&D(d.nextSibling,"li")&&M(d.nextSibling.firstChild,["ol","ul"])){c=d.nextSibling;g=d.nextSibling.childNodes.length;for(f=0;f<g;f++)d.appendChild(c.childNodes[0]);
c.parentNode.removeChild(c)}}else{g=Aloha.createRange();g.setStart(e.startContainer,e.startOffset);for(g.setEnd(d,v(d));0==g.startOffset&&g.startContainer!=d;)g.setStart(g.startContainer.parentNode,t(g.startContainer));for(;g.startOffset==v(g.startContainer)&&g.startContainer!=d;)g.setStart(g.startContainer.parentNode,1+t(g.startContainer));c=B(g);c=!c.length||1==c.length&&D(c[0],"br");c=/^H[1-6]$/.test(d.tagName)&&c?$a:"DT"==d.tagName&&c?"dd":"DD"==d.tagName&&c?"dt":d.tagName.toLowerCase();c=document.createElement(c);
ua(d,c);c.removeAttribute("id");d.parentNode.insertBefore(c,d.nextSibling);q=A(g);g=g.extractContents();m=o(g);for(f=0;f<m.length;f++)m[f].nodeType==j.Node.ELEMENT_NODE&&-1==j(q).indexOf(m[f])&&m[f].removeAttribute("id");f=[];if(q=g.firstChild){do W(q)||f.push(q);while(q=q.nextSibling)}D(c,"li")&&(f.length&&M(f[0],["ul","ol"]))&&(f=c.offsetHeight,m=ab(),c.appendChild(m),q=c.offsetHeight,f!==q&&c.removeChild(m));c.appendChild(g);Ta(d);Ta(c);Aloha.getSelection().collapse(c,0);e.setStart(c,0);e.setEnd(c,
0)}}}};Q.inserttext={action:function(a,b){wa(b,{stripWrappers:!1});if(C(b.startContainer)||L(b.startContainer))if(1<a.length)for(var e=0;e<a.length;e++)Q.inserttext.action(a[e],b);else if(""!=a)if("\n"==a)Q.insertparagraph.action("",b);else{var e=b.startContainer,c=b.startOffset;0<=c-1&&(c-1<e.childNodes.length&&e.childNodes[c-1].nodeType==j.Node.TEXT_NODE)&&(e=e.childNodes[c-1],c=v(e));0<=c&&(c<e.childNodes.length&&e.childNodes[c].nodeType==j.Node.TEXT_NODE)&&(e=e.childNodes[c],c=0);var g=e.nodeType==
j.Node.ELEMENT_NODE?e:e.parentNode;" "==a&&(g.nodeType==j.Node.ELEMENT_NODE&&-1==f.inArray(j.getComputedStyle(g).whiteSpace,["pre","pre-wrap"]))&&(a=" ");g=Bb(b);e.nodeType==j.Node.TEXT_NODE?(e.insertData(c,a),Aloha.getSelection().collapse(e,c),b.setStart(e,c),Aloha.getSelection().extend(e,c+1),b.setEnd(e,c+1)):(1==e.childNodes.length&&X(e.firstChild)&&e.removeChild(e.firstChild),e=document.createTextNode(a),b.insertNode(e),Aloha.getSelection().collapse(e,0),b.setStart(e,0),Aloha.getSelection().extend(e,
1),b.setEnd(e,1));hb(g);Ua(b.startContainer,b.startOffset);Ua(b.endContainer,b.endOffset);Aloha.getSelection().collapseToEnd();b.collapse(!1)}}};Q.insertunorderedlist={action:function(){sb("ul")},indeterm:function(){return/^mixed( ul)?$/.test(ja())},state:function(){return"ul"==ja()}};Q.justifycenter={action:function(a,b){kb("center",b)},indeterm:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return j(a).some(function(a){return"center"==ga(a)})&&j(a).some(function(a){return"center"!=
ga(a)})},state:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return a.length&&j(a).every(function(a){return"center"==ga(a)})},value:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return a.length?ga(a[0]):"left"}};Q.justifyfull={action:function(a,b){kb("justify",b)},indeterm:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return j(a).some(function(a){return"justify"==ga(a)})&&j(a).some(function(a){return"justify"!=
ga(a)})},state:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return a.length&&j(a).every(function(a){return"justify"==ga(a)})},value:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return a.length?ga(a[0]):"left"}};Q.justifyleft={action:function(a,b){kb("left",b)},indeterm:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return j(a).some(function(a){return"left"==ga(a)})&&j(a).some(function(a){return"left"!=
ga(a)})},state:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return a.length&&j(a).every(function(a){return"left"==ga(a)})},value:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return a.length?ga(a[0]):"left"}};Q.justifyright={action:function(a,b){kb("right",b)},indeterm:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return j(a).some(function(a){return"right"==ga(a)})&&j(a).some(function(a){return"right"!=
ga(a)})},state:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return a.length&&j(a).every(function(a){return"right"==ga(a)})},value:function(){var a=A($(J()),function(a){return C(a)&&ia(a)&&!a.hasChildNodes()});return a.length?ga(a[0]):"left"}};Q.outdent={action:function(){var a=[];(function(){for(var b=J().endContainer;b!=J().commonAncestorContainer;b=b.parentNode)D(b,"li")&&a.unshift(b);for(b=J().startContainer;b;b=b.parentNode)D(b,"li")&&a.unshift(b)})();j(a).forEach(function(a){P(a,
range)});for(var b=$(J()),b=B(b,function(a){return C(a)&&(!j(o(a)).some(C)||M(a,["ol","ul"])||D(a,"li")&&M(a.parentNode,["ol","ul"]))});b.length;){for(;b.length&&(M(b[0],["OL","UL"])||!M(b[0].parentNode,["OL","UL"]));)jb(b.shift(),range);if(!b.length)break;var e=[];for(e.push(b.shift());b.length&&b[0]==e[e.length-1].nextSibling&&!M(b[0],["OL","UL"]);)e.push(b.shift());var c=xa(e);Ka(e,range);j(e).forEach(U);za(c,range)}}};Q.selectall={action:function(){var a=document.body;a||(a=document.documentElement);
a?Aloha.getSelection().selectAllChildren(a):Aloha.getSelection().removeAllRanges()}};Q.stylewithcss={action:function(a){gb="false"!=(""+a).toLowerCase()},state:function(){return gb}};Q.usecss={action:function(a){gb="false"==(""+a).toLowerCase()}};(function(){var a=[],b;for(b in Q)a.push(b);j(a).forEach(function(a){"relevantCssProperty"in Q[a]||(Q[a].relevantCssProperty=null);"inlineCommandActivatedValues"in Q[a]&&!("indeterm"in Q[a])&&(Q[a].indeterm=function(b){var b=j(oa(b,function(a){return C(a)&&
a.nodeType==j.Node.TEXT_NODE})).map(function(b){return da(b,a)}),e=j(b).filter(function(b){return j(Q[a].inlineCommandActivatedValues).indexOf(b)!=-1});return e.length>=1&&b.length-e.length>=1});"inlineCommandActivatedValues"in Q[a]&&(Q[a].state=function(b){var e=oa(b,function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE});return e.length==0?j(Q[a].inlineCommandActivatedValues).indexOf(da(b.startContainer,a))!=-1:j(e).every(function(b){return j(Q[a].inlineCommandActivatedValues).indexOf(da(b,a))!=
-1})});"standardInlineValueCommand"in Q[a]&&(Q[a].indeterm=function(){for(var b=j(oa(J())).filter(function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE},true).map(function(b){return da(b,a)}),e=1;e<b.length;e++)if(b[e]!=b[e-1])return true;return false},Q[a].value=function(b){var e=oa(b,function(a){return C(a)&&a.nodeType==j.Node.TEXT_NODE})[0];if(typeof e=="undefined")e=b.startContainer;return da(e,a)})})})();return{commands:Q,execCommand:G,queryCommandIndeterm:function(a,b){a=a.toLowerCase();return K(a,
"indeterm",b,function(a){return function(){return!R(a,b)?!1:Q[a].indeterm(b)}}(a))},queryCommandState:I,queryCommandValue:ba,queryCommandEnabled:R,queryCommandSupported:function(a){a=a.toLowerCase();return a in Q},copyAttributes:ua,createEndBreak:ab,isEndBreak:function(a){return D(a,"br")&&a.parentNode.lastChild===a},ensureContainerEditable:Ta,isEditingHost:L,isEditable:C}});define("aloha/selection","aloha/core jquery util/class util/range util/arrays util/strings aloha/console PubSub aloha/engine aloha/ecma5shims aloha/rangy-core".split(" "),
function(j,f,a,d,c,b,l,m,g,k){function e(a){var b;if(f.browser.msie&&a.startContainer===a.endContainer&&a.startOffset===a.endOffset&&a.startContainer.nodeType==3&&a.startOffset==a.startContainer.data.length&&a.startContainer.nextSibling){b=a.startContainer.nextSibling;if("OL"===b.nodeName||"UL"===b.nodeName)a.startContainer.data[a.startContainer.data.length-1]==" "?a.startOffset=a.endOffset=a.startOffset-1:a.startContainer.data=a.startContainer.data+" "}}function p(a,b){var e=j.activeEditable?j.activeEditable.obj.parent()[0]:
null,e=f(a).parentsUntil(e).get(),g;g=[];var k,d,l;1===a.nodeType&&a.nodeName!=="BODY"&&a.nodeName!=="HTML"?g.push(a.cloneNode(false).outerHTML):g.push("#"+a.nodeType);l=0;for(d=e.length;l<d;l++){k=e[l];if(k.nodeName==="BODY"||k.nodeName==="HTML")break;g.push(k.cloneNode(false).outerHTML)}g=g.join("");return b&&a===b.node&&c.equal(b.parents,e)&&g===b.html?null:{node:a,parents:e,html:g}}var o=window.GENTICS,d=a.extend({_constructor:function(){this.rangeObject={};this.preventSelectionChangedFlag=false;
this.tagHierarchy={textNode:{},abbr:{textNode:true},b:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,del:true,ins:true,u:true,cite:true,q:true,code:true,abbr:true,strong:true},pre:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,del:true,ins:true,u:true,cite:true,q:true,code:true,abbr:true},blockquote:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,del:true,ins:true,u:true,cite:true,
q:true,code:true,abbr:true,p:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true},ins:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,u:true,p:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true},ul:{li:true},ol:{li:true},li:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,ul:true,ol:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,del:true,ins:true,u:true,a:true},tr:{td:true,th:true},table:{tr:true},div:{textNode:true,
b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,ul:true,ol:true,table:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,del:true,ins:true,u:true,p:true,div:true,pre:true,blockquote:true,a:true},h1:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,del:true,ins:true,u:true}};this.tagHierarchy={textNode:this.tagHierarchy.textNode,abbr:this.tagHierarchy.abbr,br:this.tagHierarchy.textNode,img:this.tagHierarchy.textNode,b:this.tagHierarchy.b,
strong:this.tagHierarchy.b,code:this.tagHierarchy.b,q:this.tagHierarchy.b,blockquote:this.tagHierarchy.blockquote,cite:this.tagHierarchy.b,i:this.tagHierarchy.b,em:this.tagHierarchy.b,sup:this.tagHierarchy.b,sub:this.tagHierarchy.b,span:this.tagHierarchy.b,del:this.tagHierarchy.del,ins:this.tagHierarchy.ins,u:this.tagHierarchy.b,p:this.tagHierarchy.b,pre:this.tagHierarchy.pre,a:this.tagHierarchy.b,ul:this.tagHierarchy.ul,ol:this.tagHierarchy.ol,li:this.tagHierarchy.li,td:this.tagHierarchy.li,div:this.tagHierarchy.div,
h1:this.tagHierarchy.h1,h2:this.tagHierarchy.h1,h3:this.tagHierarchy.h1,h4:this.tagHierarchy.h1,h5:this.tagHierarchy.h1,h6:this.tagHierarchy.h1,table:this.tagHierarchy.table};this.replacingElements={h1:{p:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,pre:true,blockquote:true}};this.replacingElements={h1:this.replacingElements.h1,h2:this.replacingElements.h1,h3:this.replacingElements.h1,h4:this.replacingElements.h1,h5:this.replacingElements.h1,h6:this.replacingElements.h1,pre:this.replacingElements.h1,
p:this.replacingElements.h1,blockquote:this.replacingElements.h1};this.allowedToStealElements={h1:{textNode:true}};this.allowedToStealElements={h1:this.allowedToStealElements.h1,h2:this.allowedToStealElements.h1,h3:this.allowedToStealElements.h1,h4:this.allowedToStealElements.h1,h5:this.allowedToStealElements.h1,h6:this.allowedToStealElements.h1,p:this.tagHierarchy.b}},SelectionTree:function(){this.domobj={};this.selection=void 0;this.children=[]},onChange:function(a,b,e){this.updateSelectionTimeout&&
window.clearTimeout(this.updateSelectionTimeout);var c=this;this.updateSelectionTimeout=window.setTimeout(function(){var g=new j.Selection.SelectionRange(true);if(!g.startContainer||"HTML"===g.startContainer.nodeName||"BODY"===g.startContainer.nodeName){if(!this.updateSelectionTimeout)c.onChange(a,b,10+(e||5)*2)}else j.Selection._updateSelection(b,g)},e||5)},preventSelectionChanged:function(){this.preventSelectionChangedFlag=true},isSelectionChangedPrevented:function(){var a=this.preventSelectionChangedFlag;
this.preventSelectionChangedFlag=false;return a},isSelectionEditable:function(){return this.rangeObject.commonAncestorContainer&&f(this.rangeObject.commonAncestorContainer).contentEditable()},isFloatingMenuVisible:function(){var a=f(j.Selection.rangeObject.commonAncestorContainer).attr("data-aloha-floatingmenu-visible");return a!=="undefined"&&a==="true"?true:false},updateSelection:function(a){return this._updateSelection(a,null)},_updateSelection:function(a,b){if(a&&a.originalEvent&&a.originalEvent.stopSelectionUpdate===
true||typeof b==="undefined")return false;this.rangeObject=b||new j.Selection.SelectionRange(true);if(typeof this.rangeObject!=="undefined"&&(typeof this.rangeObject.startContainer!=="undefined"&&this.rangeObject.endContainer!=="undefined")&&(this.rangeObject.startContainer.nodeType===3&&!f(this.rangeObject.startContainer.parentNode).contentEditable()||this.rangeObject.endContainer.nodeType===3&&!f(this.rangeObject.endContainer.parentNode).contentEditable())){j.getSelection().removeAllRanges();return true}this.rangeObject.update();
if(this.isSelectionChangedPrevented())return true;j.trigger("aloha-selection-changed-before",[this.rangeObject,a]);j.trigger("aloha-selection-changed",[this.rangeObject,a]);var e=this.rangeObject,c=e.startContainer,g=e.endContainer;if(!c||!g)l.warn("aloha/selection","encountered range object without start or end container");else{c=p(c,q);g=p(g,u);if(c||g){q=c;u=g;m.pub("aloha.selection.context-change",{range:e,event:a})}}j.trigger("aloha-selection-changed-after",[this.rangeObject,a]);return true},
getSelectionTree:function(a){if(!a)return this.rangeObject.getSelectionTree();if(!a.commonAncestorContainer){j.Log.error(this,"the rangeObject is missing the commonAncestorContainer");return false}this.inselection=false;if(o.Utils.Dom.doCleanup({merge:true},a)){a.update();a.select()}return this.recursiveGetSelectionTree(a,a.commonAncestorContainer)},recursiveGetSelectionTree:function(a,b){var e=0,c=this,g=[];f(b).contents().each(function(k){var d="none",l=false,f=false,m=false,p=false,o=false,q=false;
if(a.isCollapsed()&&b===a.startContainer&&a.startOffset==k){g[e]=new j.Selection.SelectionTree;g[e].selection="collapsed";g[e].domobj=void 0;c.inselection=false;m=true;e++}if(!c.inselection&&!m){var r;try{r=this.nodeType}catch(u){return}switch(r){case 3:if(this===a.startContainer){c.inselection=true;d=a.startOffset>0?"partial":"full";l=a.startOffset;f=this.length}break;case 1:if(this===a.startContainer&&a.startOffset===0){c.inselection=true;d="full"}if(b===a.startContainer&&a.startOffset===k){c.inselection=
true;d="full"}}}if(c.inselection&&!m){d=="none"&&(d="full");switch(this.nodeType){case 3:if(this===a.endContainer){c.inselection=false;a.endOffset<this.length&&(d="partial");l===false&&(l=0);f=a.endOffset}break;case 1:if(this===a.endContainer&&a.endOffset===0)c.inselection=false}if(b===a.endContainer&&a.endOffset<=k){c.inselection=false;d="none"}}g[e]=new j.Selection.SelectionTree;g[e].domobj=this;g[e].selection=d;if(d=="partial"){g[e].startOffset=l;g[e].endOffset=f}g[e].children=c.recursiveGetSelectionTree(a,
this);d=g[e].children.length;if(d>0){for(k=0;k<d;++k)switch(g[e].children[k].selection){case "none":p=true;break;case "full":q=true;break;case "partial":o=true}if(o||q&&p)g[e].selection="partial";else if(q&&!o&&!p)g[e].selection="full"}e++});if(a.isCollapsed()&&b===a.startContainer&&a.startOffset==b.childNodes.length){g[e]=new j.Selection.SelectionTree;g[e].selection="collapsed";g[e].domobj=void 0}return g},getRangeObject:function(){return this.rangeObject},isRangeObjectWithinMarkup:function(a,b,
e,c,g){var k=this,a=f(!b?a.startContainer:a.endContainer).parents(),d=false,l=-1;typeof c!=="undefined"&&typeof c!=="function"&&j.Log.error(this,"parameter tagComparator is not a function");typeof c==="undefined"&&(c=function(a,b){return k.standardTextLevelSemanticsComparator(a,b)});a.length>0&&a.each(function(){if(this===g){j.Log.debug(k,"reached limit dom obj");return false}if(c(this,e)){d===false&&(d=[]);j.Log.debug(k,"reached object equal to markup");l++;d[l]=this;return true}});return d},standardSectionsAndGroupingContentComparator:function(a,
b){if(a.nodeType!==1){j.Log.debug(this,"only element nodes (nodeType == 1) can be compared");return false}if(!b[0].nodeName)return false;var e=j.Selection.replacingElements[a.nodeName.toLowerCase()];return e&&e[b[0].nodeName.toLowerCase()]},standardTagNameComparator:function(a,b){if(a.nodeType===1)return a.nodeName!=b[0].nodeName?false:true;j.Log.debug(this,"only element nodes (nodeType == 1) can be compared");return false},standardTextLevelSemanticsComparator:function(a,b){if(a.nodeType===1)return a.nodeName!=
b[0].nodeName||!this.standardAttributesComparator(a,b)?false:true;j.Log.debug(this,"only element nodes (nodeType == 1) can be compared");return false},standardAttributesComparator:function(a,e){var g=b.words(a&&a.className||""),k=b.words(e.length&&e[0].className||"");c.sortUnique(g);c.sortUnique(k);return c.equal(g,k)},changeMarkup:function(a,b,e){var c=b[0].tagName.toLowerCase(),d,l,m=this.isRangeObjectWithinMarkup(a,false,b,e,d),p=this.isRangeObjectWithinMarkup(a,true,b,e,d),o,q,r,u;if(this.replacingElements[c]){l=
a;a=new this.SelectionRange(a);c=j.activeEditable?j.activeEditable.obj.get(0):f("body");a.update(c);b.isReplacingElement=true}else if(a.isCollapsed()){j.Log.debug(this,"early returning from applying markup because nothing is currently selected");return false}d=j.activeEditable?j.activeEditable.obj[0]:f("body");if(!b.isReplacingElement&&a.startOffset===0&&(r=this.getTextNodeSibling(false,a.commonAncestorContainer.parentNode,a.startContainer)))u=this.isRangeObjectWithinMarkup({startContainer:r,startOffset:0},
false,b,e,d);if(!b.isReplacingElement&&a.endOffset===a.endContainer.length&&(o=this.getTextNodeSibling(true,a.commonAncestorContainer.parentNode,a.endContainer)))q=this.isRangeObjectWithinMarkup({startContainer:o,startOffset:0},false,b,e,d);if(!b.isReplacingElement&&m&&!p){j.Log.info(this,"markup 2 non-markup");this.prepareForRemoval(a.getSelectionTree(),b,e);f(m).addClass("preparedForRemoval");this.insertCroppedMarkups(m,a,false,e)}else if(!b.isReplacingElement&&m&&p){j.Log.info(this,"markup 2 markup");
this.prepareForRemoval(a.getSelectionTree(),b,e);this.splitRelevantMarkupObject(m,p,a,e)}else if(!b.isReplacingElement&&(!m&&p||q||u)){j.Log.info(this,"non-markup 2 markup OR with next2markup");if(u&&q){m=new j.Selection.SelectionRange(a);m.startContainer=f(u[u.length-1]).textNodes()[0];m.startOffset=0;m.endContainer=f(q[q.length-1]).textNodes().last()[0];m.endOffset=m.endContainer.length;m.update();this.applyMarkup(m.getSelectionTree(),a,b,e);j.Log.info(this,"double extending previous markup(previous and after selection), actually wrapping it ...")}else if(u&&
!q&&!p){this.extendExistingMarkupWithSelection(u,a,false,e);j.Log.info(this,"extending previous markup")}else if(u&&!q&&p){m=new j.Selection.SelectionRange(a);m.startContainer=f(u[u.length-1]).textNodes()[0];m.startOffset=0;m.endContainer=f(p[p.length-1]).textNodes().last()[0];m.endOffset=m.endContainer.length;m.update();this.applyMarkup(m.getSelectionTree(),a,b,e);j.Log.info(this,"double extending previous markup(previous and relevant at the end), actually wrapping it ...")}else if(!u&&q){this.extendExistingMarkupWithSelection(q,
a,true,e);j.Log.info(this,"extending following markup backwards")}else this.extendExistingMarkupWithSelection(p,a,true,e)}else if(b.isReplacingElement||!m&&!p&&!u&&!q){j.Log.info(this,"non-markup 2 non-markup");if(a.startContainer!==a.endContainer)p=false;else if(a.startContainer.nodeType!=1)p=false;else{p=a.startContainer.firstChild;p=!p||!p.nextSibling&&p.nodeName=="BR"}if(p){b=b.clone();e=a.startContainer!==a.endContainer?false:a.startContainer.nodeType!=1?false:g.isEndBreak(a.startContainer);
e&&b[0].appendChild(g.createEndBreak());j.activeEditable&&f.browser.mozilla&&j.activeEditable.obj.focus();if(g.isEditable(a.startContainer)){g.copyAttributes(a.startContainer,b[0]);f(a.startContainer).after(b[0]).remove()}else if(g.isEditingHost(a.startContainer)){f(a.startContainer).append(b[0]);g.ensureContainerEditable(b[0])}l.startContainer=b[0];l.endContainer=b[0];l.startOffset=0;l.endOffset=0;return}this.applyMarkup(a.getSelectionTree(),a,b,e,{setRangeObject2NewMarkup:true});l.startContainer=
a.startContainer;l.endContainer=a.endContainer;l.startOffset=a.startOffset;l.endOffset=a.endOffset}if(b.isReplacingElement){if(l&&l.startContainer.className&&l.startContainer.className.indexOf("preparedForRemoval")>-1){e=f(l.startContainer).parents(b[0].tagName).get(0);l.startContainer=e;a.startContainer=e}if(l&&l.endContainer.className&&l.endContainer.className.indexOf("preparedForRemoval")>-1){e=f(l.endContainer).parents(b[0].tagName).get(0);l.endContainer=e;a.endContainer=e}}f(".preparedForRemoval").zap();
if(b.isReplacingElement){if(k.Node.ELEMENT_NODE===l.startContainer.nodeType&&l.startContainer.childNodes&&l.startContainer.childNodes.length<l.startOffset){l.startOffset=l.startContainer.childNodes.length;a.startOffset=l.startContainer.childNodes.length}if(k.Node.ELEMENT_NODE===l.endContainer.nodeType&&l.endContainer.childNodes&&l.endContainer.childNodes.length<l.endOffset){l.endOffset=l.endContainer.childNodes.length;a.endOffset=l.endContainer.childNodes.length}a.endContainer=l.endContainer;a.endOffset=
l.endOffset;a.startContainer=l.startContainer;a.startOffset=l.startOffset;l.update();l.select()}else{a.update();a.select()}},areMarkupObjectsAsLongAsRangeObject:function(a,b,e){var c,g,k;if(e.startOffset!==0)return false;c=0;for(k=a.length;c<k;c++){g=f(a[c]);if(g.textNodes().first()[0]!==e.startContainer)return false}c=0;for(a=b.length;c<a;c++){g=f(b[c]);g=g.textNodes().last()[0];if(g!==e.endContainer||g.length!=e.endOffset)return false}return true},splitRelevantMarkupObject:function(a,b,e,c){f(a).addClass("preparedForRemoval");
f(b).addClass("preparedForRemoval");if(this.areMarkupObjectsAsLongAsRangeObject(a,b,e))return true;var g=this.intersectRelevantMarkupObjects(a,b);if(g){this.insertCroppedMarkups([g],e,false,c);this.insertCroppedMarkups([g],e,true,c)}else{this.insertCroppedMarkups(a,e,false,c);this.insertCroppedMarkups(b,e,true,c)}return true},intersectRelevantMarkupObjects:function(a,b){var e=false,c,g,k,d,l,f;if(!a||!b)return e;l=a.length;f=b.length;for(c=0;c<l;c++){g=a[c];for(k=0;k<f;k++){d=b[k];g===d&&(e=g)}}return e},
extendExistingMarkupWithSelection:function(a,b,e,c){var g,k,d,l,m,p,o;e||(g=true);e&&(k=true);e=[];d=0;for(l=a.length;d<l;d++){e[d]=new this.SelectionRange;m=a[d];if(k&&!g){e[d].startContainer=b.startContainer;e[d].startOffset=b.startOffset;p=f(m).textNodes(true);o=p.length-1;e[d].endContainer=p[o];e[d].endOffset=p[o].length;e[d].update();this.applyMarkup(e[d].getSelectionTree(),b,this.getClonedMarkup4Wrapping(m),c,{setRangeObject2NewMarkup:true})}if(!k&&g){p=f(m).textNodes(true);e[d].startContainer=
p[0];e[d].startOffset=0;e[d].endContainer=b.endContainer;e[d].endOffset=b.endOffset;e[d].update();this.applyMarkup(e[d].getSelectionTree(),b,this.getClonedMarkup4Wrapping(m),c,{setRangeObject2NewMarkup:true})}}return true},getClonedMarkup4Wrapping:function(a){a=f(a.outerHTML).removeClass("preparedForRemoval").empty();a.attr("class").length===0&&a.removeAttr("class");return a},insertCroppedMarkups:function(a,b,e,c){var g,k,d,l,m;e?k=true:g=true;e=[];for(l=0;l<a.length;l++){e[l]=new this.SelectionRange;
m=a[l];if(g&&!k){d=f(m).textNodes(true);e[l].startContainer=d[0];e[l].startOffset=0;if(e[l].startContainer===b.startContainer&&e[l].startOffset===b.startOffset)continue;if(b.startOffset===0){e[l].endContainer=this.getTextNodeSibling(false,m,b.startContainer);e[l].endOffset=e[l].endContainer.length}else{e[l].endContainer=b.startContainer;e[l].endOffset=b.startOffset}e[l].update();this.applyMarkup(e[l].getSelectionTree(),b,this.getClonedMarkup4Wrapping(m),c,{setRangeObject2NextSibling:true})}if(!g&&
k){e[l].startContainer=b.endContainer;e[l].startOffset=b.endOffset;d=f(m).textNodes(true);e[l].endContainer=d[d.length-1];e[l].endOffset=d[d.length-1].length;e[l].update();this.applyMarkup(e[l].getSelectionTree(),b,this.getClonedMarkup4Wrapping(m),c,{setRangeObject2PreviousSibling:true})}}return true},changeMarkupOnSelection:function(a){var b=this.getRangeObject();this.changeMarkup(b,a,this.getStandardTagComparator(a));o.Utils.Dom.doCleanup({merge:true},b);b.update();b.select();this.rangeObject=b},
applyMarkup:function(a,b,e,c,g){var k,d,g=g?g:{};this.prepareForRemoval(a,e,c);a=this.optimizeSelectionTree4Markup(a,e,c);for(k=0;k<a.length;k++){d=a[k];if(d.wrappable)this.wrapMarkupAroundSelectionTree(d.elements,b,e,c,g);else{j.Log.debug(this,"dive further into non-wrappable object");this.applyMarkup(d.element.children,b,e,c,g)}}},getMarkupType:function(a){var b=f(a)[0].nodeName.toLowerCase();a.outerHtml&&j.Log.debug(this,"Node name detected: "+b+" for: "+a.outerHtml());if(b=="#text")return"textNode";
if(this.replacingElements[b])return"sectionOrGroupingContent";if(this.tagHierarchy[b])return"textLevelSemantics";j.Log.warn(this,"unknown markup passed to this.getMarkupType(...): "+a.outerHtml())},getStandardTagComparator:function(a){var b=this;switch(this.getMarkupType(a)){case "textNode":a=function(){return false};break;case "sectionOrGroupingContent":a=function(a,e){return b.standardSectionsAndGroupingContentComparator(a,e)};break;default:a=function(a,e){return b.standardTextLevelSemanticsComparator(a,
e)}}return a},prepareForRemoval:function(a,b,e){var c,g;typeof e!=="undefined"&&typeof e!=="function"&&j.Log.error(this,"parameter tagComparator is not a function");typeof e==="undefined"&&(e=this.getStandardTagComparator(b));for(c=0;c<a.length;c++){g=a[c];if(g.domobj&&(g.selection=="full"||g.selection=="partial"&&b.isReplacingElement)&&g.domobj.nodeType===1&&e(g.domobj,b)){j.Log.debug(this,"Marking for removal: "+g.domobj.nodeName);f(g.domobj).addClass("preparedForRemoval")}g.selection!="none"&&
g.children.length>0&&this.prepareForRemoval(g.children,b,e)}},wrapMarkupAroundSelectionTree:function(a,b,e,c,g){var k=[],d=-1,l="",m="",p,o,q;j.Log.debug(this,"The formatting <"+e[0].tagName+"> will be wrapped around the selection");for(p=0;p<a.length;p++){o=a[p];if(o.domobj&&!this.canTag1WrapTag2(o.domobj.parentNode.tagName.toLowerCase(),e[0].tagName.toLowerCase()))j.Log.info(this,"Skipping the wrapping of <"+e[0].tagName.toLowerCase()+"> because this tag is not allowed inside <"+o.domobj.parentNode.tagName.toLowerCase()+
">");else if(!o.domobj||!(o.domobj.nodeType===3&&f.trim(o.domobj.nodeValue).length===0)){if(o.domobj&&o.selection=="partial"&&!e.isReplacingElement)if(o.startOffset!==void 0&&o.endOffset===void 0){d++;l=l+o.domobj.data.substr(0,o.startOffset);o.domobj.data=o.domobj.data.substr(o.startOffset,o.domobj.data.length-o.startOffset);k[d]=o.domobj}else if(o.endOffset!==void 0&&o.startOffset===void 0){d++;m=m+o.domobj.data.substr(o.endOffset,o.domobj.data.length-o.endOffset);o.domobj.data=o.domobj.data.substr(0,
o.endOffset);k[d]=o.domobj}else if(o.endOffset!==void 0&&o.startOffset!==void 0){if(o.startOffset==o.endOffset){j.Log.debug(this,"skipping empty selection");continue}d++;l=l+o.domobj.data.substr(0,o.startOffset);q=o.domobj.data.substr(o.startOffset,o.endOffset-o.startOffset);m=m+o.domobj.data.substr(o.endOffset,o.domobj.data.length-o.endOffset);o.domobj.data=q;k[d]=o.domobj}else{j.Log.debug(this,"diving into object");this.applyMarkup(o.children,b,e,c,g)}if(o.domobj&&(o.selection=="full"||o.selection==
"partial"&&e.isReplacingElement)){d++;k[d]=o.domobj}}}if(k.length>0){k=f(k);f.each(k,function(a,b){if(f.browser.msie&&b.nodeType==3&&!b.nextSibling&&!b.previousSibling&&b.parentNode&&b.parentNode.nodeName.toLowerCase()=="li")b.data=f.trim(b.data)});a=k.wrapAll(e).parent();a.before(l).after(m);if(g.setRangeObject2NewMarkup){l=k.textNodes();if(l.index(b.startContainer)!=-1)b.startOffset=0;if(l.index(b.endContainer)!=-1)b.endOffset=b.endContainer.length}if(g.setRangeObject2NextSibling){l=true;m=a.textNodes(true).last()[0];
if(k.index(b.startContainer)!=-1){b.startContainer=this.getTextNodeSibling(l,a.parent(),m);b.startOffset=0}if(k.index(b.endContainer)!=-1){b.endContainer=this.getTextNodeSibling(l,a.parent(),m);b.endOffset=b.endOffset-m.length}}if(g.setRangeObject2PreviousSibling){l=false;m=a.textNodes(true).first()[0];if(k.index(b.startContainer)!=-1){b.startContainer=this.getTextNodeSibling(l,a.parent(),m);b.startOffset=0}if(k.index(b.endContainer)!=-1){b.endContainer=this.getTextNodeSibling(l,a.parent(),m);b.endOffset=
b.endContainer.length}}}},getTextNodeSibling:function(a,b,e){b=f(b).textNodes(true);e=b.index(e);if(e==-1)return false;a=e+(!a?-1:1);return b[a]?b[a]:false},optimizeSelectionTree4Markup:function(a,b,e){var c=[],g=0,k=0,d=this,l,m,p,o;typeof e==="undefined"&&(e=function(a,b){return d.standardTextLevelSemanticsComparator(b)});for(l=0;l<a.length;l++)if(a[l].domobj&&a[l].selection!="none")if(b.isReplacingElement&&e(b[0],f(a[l].domobj))){c[g]!==void 0&&g++;c[g]={};c[g].wrappable=true;c[g].elements=[];
c[g].elements[k]=a[l];g++}else if(this.canMarkupBeApplied2ElementAsWhole([a[l]],b)){if(c[g]===void 0){c[g]={};c[g].wrappable=true;c[g].elements=[]}if(b.isReplacingElement){o=l;for(m=l-1;m>=0;m--)if(this.canMarkupBeApplied2ElementAsWhole([a[m]],b)&&this.isMarkupAllowedToStealSelectionTreeElement(a[m],b))o=m;else break;p=l;for(m=l+1;m<a.length;m++)if(this.canMarkupBeApplied2ElementAsWhole([a[m]],b)&&this.isMarkupAllowedToStealSelectionTreeElement(a[m],b))p=m;else break;k=0;for(m=o;m<=p;m++){c[g].elements[k]=
a[m];c[g].elements[k].selection="full";k++}k=0}else{c[g].elements[k]=a[l];k++}}else{c[g]!==void 0&&g++;c[g]={};c[g].wrappable=false;c[g].element=a[l];k=0;g++}return c},isMarkupAllowedToStealSelectionTreeElement:function(a,b){if(!a.domobj)return false;var e=a.domobj.nodeName.toLowerCase(),e=e=="#text"?"textNode":e,c=this.allowedToStealElements[b[0].nodeName.toLowerCase()];return c&&c[e]},canMarkupBeApplied2ElementAsWhole:function(a,b){var e,c,g;if(b.jquery)e=b[0].tagName;if(b.tagName)e=b.tagName;for(c=
0;c<a.length;c++){g=a[c];if(g.domobj&&(g.selection!="none"||b.isReplacingElement))if(!this.canTag1WrapTag2(e,g.domobj.nodeName)||g.children.length>0&&!this.canMarkupBeApplied2ElementAsWhole(g.children,b))return false}return true},canTag1WrapTag2:function(a,b){var a=a=="#text"?"textNode":a.toLowerCase(),b=b=="#text"?"textNode":b.toLowerCase(),e=this.tagHierarchy[a];return!e||!this.tagHierarchy[b]?true:e[b]},mayInsertTag:function(a){if(typeof this.rangeObject.unmodifiableMarkupAtStart=="object")for(var b=
0;b<this.rangeObject.unmodifiableMarkupAtStart.length;++b){if(!this.canTag1WrapTag2(this.rangeObject.unmodifiableMarkupAtStart[b].nodeName,a))return false}else j.Log.warn(this,"Unable to determine whether tag "+a+" may be inserted");return true},toString:function(){return"Aloha.Selection"},SelectionRange:o.Utils.RangeObject.extend({_constructor:function(a){this._super(a);if(a){if(a.commonAncestorContainer)this.commonAncestorContainer=a.commonAncestorContainer;if(a.selectionTree)this.selectionTree=
a.selectionTree;if(a.limitObject)this.limitObject=a.limitObject;if(a.markupEffectiveAtStart)this.markupEffectiveAtStart=a.markupEffectiveAtStart;if(a.unmodifiableMarkupAtStart)this.unmodifiableMarkupAtStart=a.unmodifiableMarkupAtStart;if(a.splitObject)this.splitObject=a.splitObject}},commonAncestorContainer:void 0,selectionTree:void 0,markupEffectiveAtStart:[],unmodifiableMarkupAtStart:[],limitObject:void 0,splitObject:void 0,select:function(){this._super();j.Selection.updateSelection()},update:function(a){this.updatelimitObject();
this.updateMarkupEffectiveAtStart();this.updateCommonAncestorContainer(a);this.selectionTree=void 0},getSelectionTree:function(){if(!this.selectionTree)this.selectionTree=j.Selection.getSelectionTree(this);return this.selectionTree},getSelectedSiblings:function(a){var b=this.getSelectionTree();return this.recursionGetSelectedSiblings(a,b)},recursionGetSelectedSiblings:function(a,b){var e=false,c=false,g;for(g=0;g<b.length;++g)if(b[g].domobj===a){c=true;e=[]}else if(!c&&b[g].children){e=this.recursionGetSelectedSiblings(a,
b[g].children);if(e!==false)break}else if(c&&b[g].domobj&&b[g].selection!="collapsed"&&b[g].selection!="none")e.push(b[g].domobj);else if(c&&b[g].selection=="none")break;return e},updateMarkupEffectiveAtStart:function(){this.markupEffectiveAtStart=[];this.unmodifiableMarkupAtStart=[];var a=this.getStartContainerParents(),b=false,e,c,g;for(c=0;c<a.length;c++){g=a[c];if(!b&&g!==this.limitObject){this.markupEffectiveAtStart[c]=g;if(!e&&o.Utils.Dom.isSplitObject(g)){e=true;this.splitObject=g}}else{b=
true;this.unmodifiableMarkupAtStart.push(g)}}if(!e)this.splitObject=false},updatelimitObject:function(){if(j.editables&&j.editables.length>0){var a=this.getStartContainerParents(),b=j.editables,e,c,g,k;for(e=0;e<a.length;e++){c=a[e];for(g=0;g<b.length;g++){k=b[g].obj[0];if(c===k){this.limitObject=c;return true}}}}this.limitObject=f("body");return true},toString:function(a){return!a?"Aloha.Selection.SelectionRange":"Aloha.Selection.SelectionRange {start ["+this.startContainer.nodeValue+"] offset "+
this.startOffset+", end ["+this.endContainer.nodeValue+"] offset "+this.endOffset+"}"}})}),r=a.extend({_constructor:function(a){this._nativeSelection=a;this.ranges=[];this.preventChange=false},anchorNode:null,anchorOffset:0,focusNode:null,focusOffset:0,isCollapsed:false,rangeCount:0,collapse:function(a,b){this._nativeSelection.collapse(a,b)},collapseToStart:function(){throw"NOT_IMPLEMENTED";},extend:function(){},modify:function(){},collapseToEnd:function(){throw"NOT_IMPLEMENTED";},selectAllChildren:function(){throw"NOT_IMPLEMENTED";
},deleteFromDocument:function(){throw"NOT_IMPLEMENTED";},getRangeAt:function(a){a=this._nativeSelection.getRangeAt(a);e(a);return a},addRange:function(a){this._nativeSelection.addRange(a);var b=this._nativeSelection._ranges;e(a);b[0]=a;j.Selection.updateSelection()},removeRange:function(){this._nativeSelection.removeRange()},removeAllRanges:function(){this._nativeSelection.removeAllRanges()},refresh:function(){},toString:function(){return"Aloha.Selection"},getRangeCount:function(){return this._nativeSelection.rangeCount}});
j.getSelection=function(a){a=a!==document||a!==window?window:a;return new r(window.rangy.getSelection(a))};j.createRange=function(a){return window.rangy.createRange(a)};a=new d;j.Selection=a;var q=null,u=null;return a});define("aloha/block-jump",["aloha/core","jquery"],function(j,f){function a(){if(c){var a=c.nodeValue.replace(/\u200b/,"");a===c.nodeValue&&console.warn("Expected to remove the zero width text node fix, but couldn't find it");d(c,a);c=null}}function d(a,c){a.deleteData(0,a.length);
""!==c&&(a.nextSibling&&3===a.nextSibling.nodeType?a.nextSibling.insertData(0,c):a.previousSibling&&3===a.previousSibling.nodeType?a.previousSibling.insertData(a.previousSibling.length,c):a.insertData(0,c));setTimeout(function(){0===a.length&&f(a).remove()},0)}var c=null;return{removeZeroWidthTextNodeFix:a,insertZeroWidthTextNodeFix:function(b,d){a();c=document.createTextNode("​");d?f(b).after(c):f(b).before(c);j.bind("aloha-selection-changed",function(b){a();j.unbind(b)});return c}}});define("aloha/markup",
"aloha/core util/class jquery aloha/ecma5shims aloha/console aloha/block-jump".split(" "),function(j,f,a,d,c,b){function l(b){return"false"===a(b).attr("contenteditable")}function m(a){return a&&3===a.nodeType}function g(a){return!a?0:m(a)?a.length:a.childNodes.length}function k(a){return!a?null:a.nextSibling?m(a.nextSibling)&&!(0<a.nextSibling.data.replace(/\s+/g,"").length)||"BR"===a.nextSibling.nodeName&&a.nextSibling===a.parentNode.lastChild||""===a.nextSibling.innerHTML&&!l(a.nextSibling)?k(a.nextSibling):
a.nextSibling:a.parentNode?k(a.parentNode):null}function e(a){return!a?null:a.previousSibling?m(a.previousSibling)&&!(0<a.previousSibling.data.replace(/\s+/g,"").length)?e(a.previousSibling):""===a.previousSibling.innerHTML&&!l(a.previousSibling)?e(a.previouSibling):a.previousSibling:a.parentNode?e(a.parentNode):null}function p(b){var e;if(e=window.$_alohaPlaceholder){e=b.startContainer;var b=b.endContainer,c=window.$_alohaPlaceholder;e=!(c.is(e)||c.is(b)||(r?d.compareDocumentPosition(c[0],e)&16:
0<a(c[0]).find(e).length)||(r?d.compareDocumentPosition(c[0],b)&16:0<a(c[0]).find(b).length))}if(e){0===window.$_alohaPlaceholder.html().replace(/^(&nbsp;)*$/,"").length&&window.$_alohaPlaceholder.remove();window.$_alohaPlaceholder=null}}var o=window.GENTICS,r=!!(a.browser.msie&&9>parseInt(a.browser.version,10));j.Markup=f.extend({keyHandlers:{},addKeyHandler:function(a,b){this.keyHandlers[a]||(this.keyHandlers[a]=[]);this.keyHandlers[a].push(b)},removeKeyHandler:function(a){this.keyHandlers[a]&&
(this.keyHandlers[a]=null)},insertBreak:function(){var b=j.Selection.rangeObject,e,c;b.isCollapsed()||this.removeSelectedMarkup();c=a("<br/>");o.Utils.Dom.insertIntoDOM(c,b,j.activeEditable.obj);if(e=o.Utils.Dom.searchAdjacentTextNode(c.parent().get(0),o.Utils.Dom.getIndexInParent(c.get(0))+1,false)){nonWSIndex=e.data.search(/\S/);if(nonWSIndex>0)e.data=e.data.substring(nonWSIndex)}b.startContainer=b.endContainer=c.get(0).parentNode;b.startOffset=b.endOffset=o.Utils.Dom.getIndexInParent(c.get(0))+
1;b.correctRange();b.clearCaches();b.select()},preProcessKeyStrokes:function(a){if(a.type!=="keydown")return false;var b,e;if(this.keyHandlers[a.keyCode]){b=this.keyHandlers[a.keyCode];for(e=0;e<b.length;++e)if(!b[e](a))return false}if(a.keyCode===37||a.keyCode===39){if(j.getSelection().getRangeCount()){b=j.getSelection().getRangeAt(0);if(this.processCursor(b,a.keyCode)){p(j.Selection.rangeObject);return true}}return false}if(a.keyCode===8){a.preventDefault();j.execCommand("delete",false);return false}if(a.keyCode===
46){j.execCommand("forwarddelete",false);return false}if(a.keyCode===13){a.shiftKey?j.execCommand("insertlinebreak",false):j.execCommand("insertparagraph",false);return false}return true},processCursor:function(c,d){if(!c.collapsed)return true;b.removeZeroWidthTextNodeFix();var f=c.startContainer,v=j.getSelection();if(!f)return true;var z;if(a.browser.msie&&parseInt(a.browser.version,10)<=7&&m(f))if(d==37){for(var x=c.startOffset;x>0&&f.data.charAt(x-1)==="​";)x--;if(x!=c.startOffset){c.setStart(c.startContainer,
x);c.setEnd(c.startContainer,x);v=j.getSelection();v.removeAllRanges();v.addRange(c)}}else if(d==39){for(x=c.startOffset;x<f.data.length&&f.data.charAt(x)==="​";)x++;if(x!=c.startOffset){c.setStart(c.startContainer,x);c.setEnd(c.startContainer,x);v.removeAllRanges();v.addRange(c)}}if(r&&!a(f).contentEditable()){x=a(f).parents("[contenteditable=false]");if(x.length>0)if(x.parent().hasClass("aloha-editable"))z=x[0];else return true}if(!z){var y=37===d||38===d,x=c.startOffset;if(m(f))if(y){if(1!==x&&
!(0===x||x<=f.data.length-f.data.replace(/^\s+/,"").length))return true}else{z=f;v=g(z);if(v===x)z=true;else{var B=m(z);z=B&&z.data.replace(/\s+$/,"").length===x?true:1===v&&!B?"BR"===z.childNodes[0].nodeName:false}if(!z)return true}else f=f.childNodes[x===g(f)?x-1:x];z=y?e(f):k(f)}if(l(z)){f=z;z=new o.Utils.RangeObject;x=y?e(f):k(f);if(!x||l(x)){x=a("<div>&nbsp;</div>");y?a(f).before(x):a(f).after(x);z.startContainer=z.endContainer=x[0];z.startOffset=z.endOffset=0;p(z);window.$_alohaPlaceholder=
x}else{if(c.startContainer.nodeType===3&&c.startContainer===c.endContainer&&c.startContainer.nodeValue!==""&&(y?c.startOffset===1:c.endOffset+1===c.endContainer.length)||c.startContainer.nodeType===1&&(!c.startOffset||c.startContainer.childNodes[c.startOffset]&&c.startContainer.childNodes[c.startOffset].nodeType===1)){x=b.insertZeroWidthTextNodeFix(f,y);z.startContainer=z.endContainer=x;z.startOffset=z.endOffset=y?1:0}else{z.startContainer=z.endContainer=x;z.startOffset=z.endOffset=y?g(x):0;y||b.insertZeroWidthTextNodeFix(f,
true)}p(z)}z.select();j.trigger("aloha-block-selected",f);j.Selection.preventSelectionChanged();return false}return true},processShiftEnter:function(a){this.insertHTMLBreak(a.getSelectionTree(),a)},processEnter:function(a){a.splitObject?this.splitRangeObject(a):this.insertHTMLBreak(a.getSelectionTree(),a)},insertHTMLCode:function(b){var e=j.Selection.rangeObject;this.insertHTMLBreak(e.getSelectionTree(),e,a(b))},insertHTMLBreak:function(b,e,c){var g,k,d,l,f,c=c?c:a("<br/>");g=0;for(k=b.length;g<k;++g){d=
b[g];l=d.domobj?a(d.domobj):void 0;if(d.selection!=="none")if(d.selection=="collapsed"){if(g>0){d=a(b[g-1].domobj);d.after(c)}else{d=a(b[1].domobj);d.before(c)}e.startContainer=e.endContainer=c[0].parentNode;e.startOffset=e.endOffset=o.Utils.Dom.getIndexInParent(c[0])+1;e.correctRange()}else if(d.domobj&&d.domobj.nodeType===3){d.domobj.nextSibling&&(d.domobj.nextSibling.nodeType==1&&j.Selection.replacingElements[d.domobj.nextSibling.nodeName.toLowerCase()])&&l.after("<br/>");if(this.needEndingBreak()){for(f=
d.domobj;f;)if(f.nextSibling)f=false;else{f=f.parentNode;if(o.Utils.Dom.isBlockLevelElement(f)||o.Utils.Dom.isListElement(f))break;f===e.limitObject&&(f=false)}f&&a(f).append('<br class="aloha-cleanme" />')}l.between(c,d.startOffset);l=0;for(d=c[0];d;){d=d.previousSibling;++l}e.startContainer=c[0].parentNode;e.endContainer=c[0].parentNode;e.startOffset=l;e.endOffset=l;e.correctRange()}else if(d.domobj&&d.domobj.nodeType===1){if(l.parent().find("br.aloha-ephemera").length===0){a(e.limitObject).find("br.aloha-ephemera").remove();
a(e.commonAncestorContainer).append(this.getFillUpElement(e.splitObject))}l.after(c);e.startContainer=e.commonAncestorContainer;e.endContainer=e.startContainer;e.startOffset=g+2;e.endOffset=g+2;e.update()}}e.select()},needEndingBreak:function(){return!a.browser.msie},getSelectedText:function(){var a=j.Selection.rangeObject;return a.isCollapsed()?false:this.getFromSelectionTree(a.getSelectionTree(),true)},getFromSelectionTree:function(b,e){var c="",g,k,d,l;g=0;for(k=b.length;g<k;g++){d=b[g];if(d.selection==
"partial")if(d.domobj.nodeType===3)c=c+d.domobj.data.substring(d.startOffset,d.endOffset);else{if(d.domobj.nodeType===1&&d.children)if(e)c=c+this.getFromSelectionTree(d.children,e);else{l=a(d.domobj.outerHTML).empty();l.html(this.getFromSelectionTree(d.children,e));c=c+l.outerHTML()}}else d.selection=="full"&&(d.domobj.nodeType===3?c=c+a(d.domobj).text():d.domobj.nodeType===1&&d.children&&(c=c+(e?a(d.domobj).text():a(d.domobj).outerHTML())))}return c},getSelectedMarkup:function(){var a=j.Selection.rangeObject;
return a.isCollapsed()?null:this.getFromSelectionTree(a.getSelectionTree(),false)},removeSelectedMarkup:function(){var a=j.Selection.rangeObject,b;if(!a.isCollapsed()){b=new j.Selection.SelectionRange;this.removeFromSelectionTree(a.getSelectionTree(),b);b.update();o.Utils.Dom.doCleanup({merge:true,removeempty:true},j.Selection.rangeObject);j.Selection.rangeObject=b;b.correctRange();b.update();b.select();j.Selection.updateSelection()}},removeFromSelectionTree:function(b,e){var c,g,k,d,l;k=0;for(l=
b.length;k<l;k++){d=b[k];if(d.selection=="partial")if(d.domobj.nodeType===3){g="";d.startOffset>0&&(g=g+d.domobj.data.substring(0,d.startOffset));d.endOffset<d.domobj.data.length&&(g=g+d.domobj.data.substring(d.endOffset,d.domobj.data.length));d.domobj.data=g;if(!e.startContainer){e.startContainer=e.endContainer=d.domobj;e.startOffset=e.endOffset=d.startOffset}}else{if(d.domobj.nodeType===1&&d.children){this.removeFromSelectionTree(d.children,e);if(c){if(c.nodeName==d.domobj.nodeName){a(c).append(a(d.domobj).contents());
a(d.domobj).remove()}}else c=d.domobj}}else if(d.selection=="full"){if(!e.startContainer)if(g=o.Utils.Dom.searchAdjacentTextNode(d.domobj.parentNode,o.Utils.Dom.getIndexInParent(d.domobj)+1,false,{blocklevel:false})){e.startContainer=e.endContainer=g;e.startOffset=e.endOffset=0}else{e.startContainer=e.endContainer=d.domobj.parentNode;e.startOffset=e.endOffset=o.Utils.Dom.getIndexInParent(d.domobj)+1}a(d.domobj).remove()}}},splitRangeObject:function(b){a(b.splitObject);var e,c;b.update(b.splitObject);
e=b.getSelectionTree();c=this.getSplitFollowUpContainer(b);this.splitRangeObjectHelper(e,b,c);c.hasClass("preparedForRemoval")&&c.removeClass("preparedForRemoval");e=this.getInsertAfterObject(b,c);a(c).insertAfter(e);b.splitObject.nodeName.toLowerCase()==="li"&&!j.Selection.standardTextLevelSemanticsComparator(b.splitObject,c)&&a(b.splitObject).remove();b.startContainer=null;e=c.contents();if(e.length>0&&e.get(0).nodeType==1&&e.get(0).nodeName.toLowerCase()==="br")b.startContainer=c.get(0);if(!b.startContainer)b.startContainer=
c.textNodes(true,true).first().get(0);if(!b.startContainer)b.startContainer=c.textNodes(false).first().parent().get(0);if(b.startContainer){b.endContainer=b.startContainer;b.startOffset=0;b.endOffset=0}else{b.startContainer=b.endContainer=c.parent().get(0);b.startOffset=b.endOffset=o.Utils.Dom.getIndexInParent(c.get(0))}b.update();b.select()},getInsertAfterObject:function(b,e){var c,g,k;for(g=0;g<b.markupEffectiveAtStart.length;g++){k=b.markupEffectiveAtStart[g];k===b.splitObject&&(c=true);if(c&&
j.Selection.canTag1WrapTag2(a(k).parent()[0].nodeName,e[0].nodeName))return k}return false},getFillUpElement:function(){return a.browser.msie?false:a('<br class="aloha-cleanme"/>')},removeElementContentWhitespaceObj:function(a){var b=0,e=[],c,g;for(c=0;c<a.length;++c){g=a[c];g.isElementContentWhitespace&&(e[e.length]=c)}for(c=0;c<e.length;++c){g=e[c];a.splice(g-b,1);++b}},splitRangeObjectHelper:function(b,e,c,g){c||j.Log.warn(this,"no followUpContainer, no inBetweenMarkup, nothing to do...");var k=
this.getFillUpElement(e.splitObject),d=a(e.splitObject),l=false,f,m,p,r,K;if(b.length>0){p=c.contents();p.length!==b.length&&this.removeElementContentWhitespaceObj(p);m=0;for(K=b.length;m<K;++m){f=b[m];if(f.selection==="none"&&l===false||f.domobj&&f.domobj.nodeType===3&&f===b[b.length-1]&&f.startOffset===f.domobj.data.length)if(c.textNodes().length>1||f.domobj.nodeType===1&&f.children.length===0)p.eq(m).remove();else if(o.Utils.Dom.isSplitObject(c[0]))k?c.html(k):c.empty();else{c.empty();c.addClass("preparedForRemoval")}else if(f.selection!==
"none"){if(f.domobj&&f.domobj.nodeType===3&&f.startOffset!==void 0){l=f.domobj.data;if(f.startOffset>0)f.domobj.data=l.substr(0,f.startOffset);else if(b.length>1)a(f.domobj).remove();else{r=a(f.domobj).parent();o.Utils.Dom.isSplitObject(r[0])?k?r.html(k):r.empty():r.remove()}if(l.length-f.startOffset>0)p[m].data=l.substr(f.startOffset,l.length);else if(p.length>1)p.eq(m).remove();else if(o.Utils.Dom.isBlockLevelElement(c[0]))k?c.html(k):c.empty();else{c.empty();c.addClass("preparedForRemoval")}}l=
true;f.children.length>0&&this.splitRangeObjectHelper(f.children,e,p.eq(m),g)}else f.selection==="none"&&l===true&&a(f.domobj).remove()}}else j.Log.error(this,"can not split splitObject due to an empty selection tree");d.find("br.aloha-ephemera:gt(0)").remove();c.find("br.aloha-ephemera:gt(0)").remove();d.find(".preparedForRemoval").remove();c.find(".preparedForRemoval").remove();d.contents().length===0&&(o.Utils.Dom.isSplitObject(d[0])&&k)&&d.html(k);c.contents().length===0&&(o.Utils.Dom.isSplitObject(c[0])&&
k)&&c.html(k)},getSplitFollowUpContainer:function(b){var e;switch(b.splitObject.nodeName.toLowerCase()){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":if((e=a(b.splitObject).textNodes(":not(.aloha-cleanme)").last()[0])&&b.startContainer===e&&b.startOffset===e.length){e=a("<p></p>");b=a(b.splitObject.outerHTML).contents();e.append(b);return e}break;case "li":if(b.startContainer.nodeName.toLowerCase()==="br"&&a(b.startContainer).hasClass("aloha-ephemera")){e=a("<p></p>");b=a(b.splitObject.outerHTML).contents();
e.append(b);return e}if(!b.splitObject.nextSibling&&a.trim(a(b.splitObject).text()).length===0)return e=a("<p></p>")}return a(b.splitObject.outerHTML)},transformDomObject:function(b,e,c){var g=a(b),e=a("<"+e+">"),k,d=g[0].cloneNode(false).attributes;if(d)for(k=0;k<d.length;++k)(typeof d[k].specified==="undefined"||d[k].specified)&&e.attr(d[k].nodeName,d[k].nodeValue);if(g[0].style&&g[0].style.cssText)e[0].style.cssText=g[0].style.cssText;g.contents().appendTo(e);g.replaceWith(e);if(c){if(c.startContainer==
b)c.startContainer=e.get(0);if(c.endContainer==b)c.endContainer=e.get(0)}return e},toString:function(){return"Aloha.Markup"}});j.Markup=new j.Markup;return j.Markup});define("aloha/observable",["jquery"],function(j){return{_eventHandlers:null,bind:function(f,a,d){this._eventHandlers=this._eventHandlers||{};this._eventHandlers[f]||(this._eventHandlers[f]=[]);this._eventHandlers[f].push({handler:a,scope:d?d:window})},unbind:function(f,a){this._eventHandlers=this._eventHandlers||{};this._eventHandlers[f]&&
(this._eventHandlers[f]=a?j.grep(this._eventHandlers[f],function(d){return d.handler===a?!1:!0}):[])},trigger:function(f){this._eventHandlers=this._eventHandlers||{};if(this._eventHandlers[f]){var a=[];j.each(arguments,function(d,c){0<d&&a.push(c)});j.each(this._eventHandlers[f],function(d,c){c.handler.apply(c.scope,a)})}},unbindAll:function(){this._eventHandlers=null}}});define("aloha/registry",["jquery","aloha/observable","util/class"],function(j,f,a){return a.extend(f,{_entries:null,_ids:null,
_constructor:function(){this._entries={};this._ids=[]},register:function(a,c){this._entries[a]=c;this._ids.push(a);this.trigger("register",c,a)},unregister:function(a){var c,b=this._entries[a];delete this._entries[a];for(c in this._ids)if(this._ids.hasOwnProperty(c)&&this._ids[c]===a){this._ids.splice(c,1);break}this.trigger("unregister",b,a)},get:function(a){return this._entries[a]},has:function(a){return this._entries[a]?!0:!1},getEntries:function(){return j.extend({},this._entries)},getIds:function(){return j.extend([],
this._ids)}})});define("aloha/contenthandlermanager",["jquery","aloha/registry","util/class","aloha/console"],function(j,f,a,d){return new (f.extend({createHandler:function(c){if("function"!==typeof c.handleContent)throw"ContentHandler has no function handleContent().";return new (a.extend({handleContent:function(){}},c))},handleContent:function(a,b){var l,f;l=this.getIds();if("undefined"===typeof b.contenthandler)for(f in b.contenthandler=[],l)l.hasOwnProperty(f)&&b.contenthandler.push(l[f]);for(f in b.contenthandler)if(b.contenthandler.hasOwnProperty(f)&&
((l=this.get(b.contenthandler[f]))&&("function"===typeof l.handleContent?a=l.handleContent(a,b):d.error("A valid content handler needs the method handleContent.")),null===a))break;return a}}))});define("aloha/editable","aloha/core util/class jquery aloha/pluginmanager aloha/selection aloha/markup aloha/contenthandlermanager aloha/console aloha/block-jump".split(" "),function(j,f,a,d,c,b,l,m,g){function k(b){if(a.browser.msie&&a.browser.version<8){b=a(b);b.find("[hidefocus]").each(function(){a(this).removeAttr("hidefocus")});
b.find("[hideFocus]").each(function(){a(this).removeAttr("hideFocus")});b.find("[tabindex]").each(function(){a(this).removeAttr("tabindex")});b.find("[tabIndex]").each(function(){a(this).removeAttr("tabIndex")})}}var e=window.unescape,p=window.GENTICS,o=false,r={};j.defaults.contentHandler={};j.defaults.contentHandler.initEditable=["blockelement","sanitize"];j.defaults.contentHandler.getContents=["blockelement","sanitize","basic"];if(typeof j.settings.contentHandler==="undefined")j.settings.contentHandler=
{};var q=function(b){return a(b).html()},u=l.createHandler({handleContent:function(b){a.browser.msie&&a.browser.version<8&&(b=b.replace(/(<table\s+[^>]*?)contenteditable=['\"\w]+/gi,"$1"));return b=this.stringFizzleSizzle(b)},stringFizzleSizzle:function(a){for(var b=a;a!==(b=a.replace(/(<[^>]*?)(nodeIndex|sizcache|sizset|jquery)[\w\d]*="[^"]*"/gi,"$1"));)a=b;return a}});l.register("basic",u);j.Editable=f.extend({_constructor:function(a){a.attr("id")||a.attr("id",p.Utils.guid());this.originalObj=this.obj=
a;this.ready=false;this.sccDelimiters=[":",";",".","!","?",",",e("%u0009"),e("%u0020"),e("%u0008"),e("%u007F"),"Enter"];this.sccIdle=5E3;this.sccDelay=500;this.sccTimerDelay=this.sccTimerIdle=false;this.keyCodeMap={93:"Apps",18:"Alt",20:"CapsLock",17:"Control",40:"Down",35:"End",13:"Enter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",36:"Home",45:"Insert",37:"Left",224:"Meta",34:"PageDown",33:"PageUp",19:"Pause",44:"PrintScreen",39:"Right",
145:"Scroll",16:"Shift",38:"Up",91:"Win",92:"Win"};this.placeholderClass="aloha-placeholder";j.registerEditable(this);this.init()},init:function(){var e=this;if((this.settings=j.settings)&&j.settings.smartContentChange){if(j.settings.smartContentChange.delimiters)this.sccDelimiters=j.settings.smartContentChange.delimiters;if(j.settings.smartContentChange.idle)this.sccIdle=j.settings.smartContentChange.idle;if(j.settings.smartContentChange.delay)this.sccDelay=j.settings.smartContentChange.delay}if(this.check(this.obj)){if(typeof j.settings.contentHandler.getContents===
"undefined")j.settings.contentHandler.getContents=j.defaults.contentHandler.getContents;if(typeof j.settings.contentHandler.initEditable==="undefined")j.settings.contentHandler.initEditable=j.defaults.contentHandler.initEditable;var g=e.obj.html(),g=l.handleContent(g,{contenthandler:j.settings.contentHandler.initEditable,command:"initEditable"});e.obj.html(g);j.bind("aloha-ready",function(){e.obj.addClass("aloha-editable").contentEditable(true);e.obj.mousedown(function(a){if(!j.eventHandled){j.eventHandled=
true;return e.activate(a)}});e.obj.mouseup(function(){j.eventHandled=false});e.obj.focus(function(a){return e.activate(a)});e.obj.add(".aloha-block",e.obj).keydown(function(a){var c=b.preProcessKeyStrokes(a);e.keyCode=a.which;c||e.smartContentChange(a);return c});e.obj.keypress(function(a){j.activeEditable.smartContentChange(a)});e.obj.keyup(function(a){if(a.keyCode===27){j.deactivateEditable();return false}});e.obj.contentEditableSelectionChange(function(a){c.onChange(e.obj,a);return e.obj});e.setUnmodified();
e.snapshotContent=e.getContents();a.browser.mozilla&&e.initEmptyEditable();e.initPlaceholder();e.ready=true;window.setTimeout(function(){j.disableObjectResizing()},20);j.trigger("aloha-editable-created",[e])})}else this.destroy()},isActive:false,originalContent:null,range:void 0,check:function(){var b=this,e=this.obj,c=e.get(0).nodeName.toLowerCase(),g=["a","abbr","address","article","aside","b","bdo","blockquote","cite","code","command","del","details","dfn","div","dl","em","footer","h1","h2","h3",
"h4","h5","h6","header","i","ins","menu","nav","p","pre","q","ruby","section","small","span","strong","sub","sup","var"],k;for(k=0;k<g.length;++k)if(c===g[k])return true;switch(c){case "textarea":case "input":c=a('<div id="'+this.getId()+'-aloha" class="aloha-'+c+'" />').insertAfter(e);c.height(e.height()).width(e.width()).html(e.val());e.hide();e.parents("form:first").submit(function(){e.val(b.getContents())});this.obj=c;return true}return false},initPlaceholder:function(){j.settings.placeholder&&
this.isEmpty()&&this.addPlaceholder()},isEmpty:function(){var b=a.trim(this.getContents());return b.length===0||(b==="<br>"?true:false)},initEmptyEditable:function(){var b=this.obj;this.empty(this.getContents())&&a(b).prepend('<br class="aloha-cleanme" />')},addPlaceholder:function(){var b=a("<div>"),e=a("<span>"),c,g=this.obj;c=p.Utils.Dom.allowsNesting(g[0],b[0])?b:e;if(a("."+this.placeholderClass,g).length===0){a(g).append(c.addClass(this.placeholderClass));a.each(j.settings.placeholder,function(a,
b){g.is(a)&&c.html(b)});a("br",g).remove()}},removePlaceholder:function(b,e){var g=this.placeholderClass,k;a("."+this.placeholderClass,b).length!==0&&(e===true?window.setTimeout(function(){k=new c.SelectionRange;k.startContainer=k.endContainer=b.get(0);k.startOffset=k.endOffset=0;a("."+g,b).remove();k.select()},100):a("."+g,b).remove())},destroy:function(){this===j.getActiveEditable()&&this.blur();switch(this.originalObj.get(0).nodeName.toLowerCase()){case "textarea":case "input":this.originalObj.val(this.getContents());
this.obj.remove();this.originalObj.show()}this.ready=false;this.removePlaceholder(this.obj);this.obj.removeClass("aloha-editable").contentEditable(false).unbind("mousedown click dblclick focus keydown keypress keyup");j.trigger("aloha-editable-destroyed",[this]);j.unregisterEditable(this)},setUnmodified:function(){this.originalContent=this.getContents()},isModified:function(){return this.originalContent!==this.getContents()},toString:function(){return"Aloha.Editable"},isDisabled:function(){return!this.obj.contentEditable()||
this.obj.contentEditable()==="false"},disable:function(){return this.isDisabled()||this.obj.contentEditable(false)},enable:function(){return this.isDisabled()&&this.obj.contentEditable(true)},activate:function(a){var b=j.getActiveEditable();if(o)o=false;else if((!a||!(a.type==="focus"&&b!==null&&b.obj.parent().get(0)===a.currentTarget))&&!this.isActive&&!this.isDisabled()){this.obj.addClass("aloha-editable-active");j.activateEditable(this);o=true;this.removePlaceholder(this.obj,true);o=false;this.isActive=
true;j.trigger("aloha-editable-activated",{oldActive:b,editable:this})}},blur:function(){this.obj.blur();this.isActive=false;this.initPlaceholder();this.obj.removeClass("aloha-editable-active");j.trigger("aloha-editable-deactivated",{editable:this});j.activeEditable.smartContentChange({type:"blur"},null)},empty:function(b){return null===b||a.trim(b)===""||b==="<br/>"},getContents:function(b){var e=this.obj.html(),c=r[this.getId()];if(!c||e!==c.raw){g.removeZeroWidthTextNodeFix();var f=this.obj.clone(false);
f.find(".aloha-cleanme").remove();this.removePlaceholder(f);d.makeClean(f);k(f);f=a("<div>"+l.handleContent(f.html(),{contenthandler:j.settings.contentHandler.getContents,command:"getContents"})+"</div>");c=r[this.getId()]={};c.raw=e;c.element=f}if(b)return c.element.clone().contents();if(null==c.serialized)c.serialized=q(c.element[0]);return c.serialized},setContents:function(a,b){var e=null;if(j.getActiveEditable()===this){j.deactivateEditable();e=this}this.obj.html(a);null!==e&&e.activate();this.smartContentChange({type:"set-contents"});
return b?this.obj.contents():q(this.obj[0])},getId:function(){return this.obj.attr("id")},smartContentChange:function(b){function e(){null==d&&(d=c.getSnapshotContent());return d}var c=this,g=null,k;if(b&&(b.metaKey||b.crtlKey||b.altKey))return false;if(b&&b.originalEvent){k=/U\+(\w{4})/;k.exec(b.originalEvent.keyIdentifier);g=this.keyCodeMap[this.keyCode]||String.fromCharCode(b.which)||"unknown"}var d=null;if(a.inArray(g,this.sccDelimiters)>=0){clearTimeout(this.sccTimerIdle);clearTimeout(this.sccTimerDelay);
this.sccTimerDelay=window.setTimeout(function(){j.trigger("aloha-smart-content-changed",{editable:c,keyIdentifier:b.originalEvent.keyIdentifier,keyCode:b.keyCode,"char":g,triggerType:"keypress",getSnapshotContent:e});m.debug("Aloha.Editable","smartContentChanged: event type keypress triggered")},this.sccDelay)}else if(b&&b.type==="paste")j.trigger("aloha-smart-content-changed",{editable:c,keyIdentifier:null,keyCode:null,"char":null,triggerType:"paste",getSnapshotContent:e});else if(b&&b.type==="blur")j.trigger("aloha-smart-content-changed",
{editable:c,keyIdentifier:null,keyCode:null,"char":null,triggerType:"blur",getSnapshotContent:e});else if(g!==null){clearTimeout(this.sccTimerDelay);clearTimeout(this.sccTimerIdle);this.sccTimerIdle=window.setTimeout(function(){j.trigger("aloha-smart-content-changed",{editable:c,keyIdentifier:null,keyCode:null,"char":null,triggerType:"idle",getSnapshotContent:e})},this.sccIdle)}},getSnapshotContent:function(){var a=this.snapshotContent;this.snapshotContent=this.getContents();return a}});j.Editable.setContentSerializer=
function(a){q=a};j.Editable.getContentSerializer=function(){return q}});define("aloha/plugin",["aloha/core","jquery","util/class","aloha/pluginmanager","aloha/console"],function(j,f,a,d,c){var b=a.extend({name:null,defaults:{},settings:{},dependencies:[],_constructor:function(a){"string"!==typeof a?c.error("Cannot initialise unnamed plugin, skipping"):this.name=a},checkDependencies:function(){var a=!0,b=this;f.each(this.dependencies,function(){j.isPluginLoaded(this)||(a=!1,c.error("plugin."+b.name,
'Required plugin "'+this+'" not found.'))});return a},init:function(){},getEditableConfig:function(a){var b=null,c=!1,k=this;this.settings.editables&&f.each(this.settings.editables,function(e,d){if(a.is(e))if(c=!0,d instanceof Array)b=[],b=f.merge(b,d);else if("object"===typeof d){b={};b["aloha-editable-selector"]=e;for(var o in d)d.hasOwnProperty(o)&&(d[o]instanceof Array?b[o]=d[o]:"object"===typeof d[o]?(b[o]={},b[o]=f.extend(!0,b[o],k.config[o],d[o])):b[o]=d[o])}else b=d});c||(b="undefined"===
typeof this.settings.config||!this.settings.config?this.config:this.settings.config);return b},makeClean:function(){},getUID:function(){c.deprecated("plugin","getUID() is deprecated. Use plugin.name instead.");return this.name},toString:function(){return this.name},log:function(a,b){c.deprecated("plugin","log() is deprecated. Use Aloha.console instead.");c.log(a,this,b)}});b.create=function(a,c){var g=new (b.extend(c))(a);g.settings=f.extendObjects(!0,g.defaults,j.settings[a]);d.register(g);return g};
return b});define("aloha/command",["aloha/core","aloha/registry","aloha/engine","util/dom","aloha/contenthandlermanager"],function(j,f,a,d,c){var b={execCommand:function(b,f,g,k){var e={commandId:b,preventDefault:!1};j.trigger("aloha-command-will-execute",e);if(!0!==e.preventDefault){if(!k){if(!j.getSelection().getRangeCount())return;k=j.getSelection().getRangeAt(0)}"inserthtml"===b.toLowerCase()&&(g=c.handleContent(g,{contenthandler:j.settings.contentHandler.insertHtml,command:"insertHtml"}));a.execCommand(b,
f,g,k);j.getSelection().getRangeCount()&&(k=j.getSelection().getRangeAt(0),f=k.commonAncestorContainer,f.parentNode&&(f=f.parentNode),g=new window.GENTICS.Utils.RangeObject,g.startContainer=k.startContainer,g.startOffset=k.startOffset,g.endContainer=k.endContainer,g.endOffset=k.endOffset,d.doCleanup({merge:!0,removeempty:!1},g,f),g.select());j.trigger("aloha-command-executed",b)}},queryCommandEnabled:function(b,c){if(!c){if(!j.getSelection().getRangeCount())return;c=j.getSelection().getRangeAt(0)}return a.queryCommandEnabled(b,
c)},queryCommandIndeterm:function(b,c){if(!c){if(!j.getSelection().getRangeCount())return;c=j.getSelection().getRangeAt(0)}return a.queryCommandIndeterm(b,c)},queryCommandState:function(b,c){if(!c){if(!j.getSelection().getRangeCount())return;c=j.getSelection().getRangeAt(0)}return a.queryCommandState(b,c)},queryCommandSupported:function(b){return a.queryCommandSupported(b)},queryCommandValue:function(b,c){if(!c){if(!j.getSelection().getRangeCount())return;c=j.getSelection().getRangeAt(0)}return a.queryCommandValue(b,
c)},querySupportedCommands:function(){var b=[],c;for(c in a.commands)b.push(c);return b}},b=new (f.extend(b));j.execCommand=b.execCommand;j.queryCommandEnabled=b.queryCommandEnabled;j.queryCommandIndeterm=b.queryCommandIndeterm;j.queryCommandState=b.queryCommandState;j.queryCommandSupported=b.queryCommandSupported;j.queryCommandValue=b.queryCommandValue;j.querySupportedCommands=b.querySupportedCommands;return b});define("aloha/jquery.aloha",["aloha/core","aloha/selection","jquery","aloha/console"],
function(j,f,a,d){function c(a,b,c,e){if(!(b!==e.target&&(/textarea|input|select/i.test(e.target.nodeName)||"text"===e.target.type)))return a.apply(b,c)}function b(b){if("string"===typeof b.data){for(var g=b.handler,k=b.data.toLowerCase().split(" "),e={},d=0;d<k.length;d++)e[k[d]]=!0;b.handler=function(b){if(this===b.target){var k="keypress"!==b.type&&a.hotkeys.specialKeys[b.which],d="";b.altKey&&"alt"!==k&&(d+="alt+");b.ctrlKey&&"ctrl"!==k&&(d+="ctrl+");b.metaKey&&(!b.ctrlKey&&"meta"!==k)&&(d+="meta+");
b.shiftKey&&"shift"!==k&&(d+="shift+");if(k){if(e[d+k])return c(g,this,arguments,b)}else if(k=String.fromCharCode(b.which).toLowerCase(),e[d+k]||e[d+a.hotkeys.shiftNums[k]]||"shift+"===d&&e[a.hotkeys.shiftNums[k]])return c(g,this,arguments,b)}}}}var l=window.XMLSerializer;a.fn.between=function(a,b){var c;3!==this[0].nodeType?(c=this.children().size(),b>c&&(b=c),0>=b?this.prepend(a):this.children().eq(b-1).after(a)):0>=b?this.before(a):(b>=this[0].length||(c=this[0].data,this[0].data=c.substring(0,
b),this.after(c.substring(b,c.length))),this.after(a))};a.fn.contentEditable=function(b){var c=a(this),k="contenteditable";a.browser.msie&&7==parseInt(a.browser.version,10)&&(k="contentEditable");if("undefined"===typeof b){if("undefined"===typeof c[0]){d.warn("The jquery object did not contain any valid elements.");return}return"undefined"===typeof c[0].isContentEditable?(d.warn("Could not determine whether the is editable or not. I assume it is."),!0):c[0].isContentEditable}""===b?c.removeAttr(k):
c.attr(k,b&&"false"!==b?"true":"false");return c};a.fn.aloha=function(){var b=a(this);j.bind("aloha-ready",function(){b.each(function(){j.isEditable(this)||new j.Editable(a(this))})});return b};a.fn.mahalo=function(){return this.each(function(){j.isEditable(this)&&j.getEditableById(a(this).attr("id")).destroy()})};a.fn.contentEditableSelectionChange=function(b){var c=this;this.keyup(function(a){f.getRangeObject();b(a)});this.dblclick(function(a){b(a)});this.mousedown(function(){c.selectionStarted=
!0});a(document).mouseup(function(a){f.eventOriginalTarget=c;c.selectionStarted&&b(a);f.eventOriginalTarget=!1;c.selectionStarted=!1});return this};a.fn.outerHtml=a.fn.outerHtml||function(){var b=a(this).get(0);if("undefined"!=typeof b.outerHTML)return b.outerHTML;try{return(new l).serializeToString(b)}catch(c){try{return b.xml}catch(k){}}};a.fn.zap=function(){return this.each(function(){a(this.childNodes).insertBefore(this)}).remove()};a.fn.textNodes=function(b,c){var k=[],e=function(d){if(3===d.nodeType&&
a.trim(d.data)&&!c||3===d.nodeType&&c||"BR"==d.nodeName&&!b)k.push(d);else for(var l=0,f=d.childNodes.length;l<f;++l)e(d.childNodes[l])};e(this[0]);return a(k)};a.extendObjects=a.fn.extendObjects=function(){var b,c,k,e,d,l=arguments[0]||{},f=1,q=arguments.length,u=!1;"boolean"===typeof l&&(u=l,l=arguments[1]||{},f=2);"object"!==typeof l&&!a.isFunction(l)&&(l={});q===f&&(l=this,--f);for(;f<q;f++)if(null!=(b=arguments[f]))for(c in b)k=l[c],e=b[c],l!==e&&(u&&e&&(a.isPlainObject(e)||(d=a.isArray(e)))?
(d?(d=!1,k=k&&a.isArray(k)?k:[]):k=k&&a.isPlainObject(k)?k:{},l[c]=a.isArray(e)?e:a.extendObjects(u,k,e)):void 0!==e&&(l[c]=e));return l};a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",
112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:b}})});define("aloha/sidebar",["aloha/core","jquery","aloha/selection","PubSub"],function(j,f,a,d){var c=+new Date;f.easing.easeOutExpo||
f.extend(f.easing,{easeOutExpo:function(a,b,c,g,k){return b==k?c+g:g*(-Math.pow(2,-10*b/k)+1)+c},easeOutElastic:function(a,b,c,g,k){var a=Math,d=1.70158,l=0,f=g;if(!b)return c;if(1==(b/=k))return c+g;l||(l=0.3*k);f<a.abs(g)?(f=g,d=l/4):d=l/(2*a.PI)*a.asin(g/f);return f*a.pow(2,-10*b)*a.sin((b*k-d)*2*a.PI/l)+g+c}});var b=function(a){this.id=null;this.folds={};this.button=null;this.title=f('<div class="aloha-sidebar-panel-title"><span class="aloha-sidebar-panel-title-arrow"></span><span class="aloha-sidebar-panel-title-text">Untitled</span></div>');
this.content=f('<div class="aloha-sidebar-panel-content"><div class="aloha-sidebar-panel-content-inner"><div class="aloha-sidebar-panel-content-inner-text"></div></div></div>');this.effectiveElement=this.element=null;this.expanded=!1;this.isActive=!0;this.init(a)},l=function(a){var b=this;this.id="aloha-sidebar-"+ ++c;this.panels={};this.container=f('<div class="aloha-ui aloha-sidebar-bar"><div class="aloha-sidebar-handle"><span class="aloha-sidebar-handle-icon"></span></div><div class="aloha-sidebar-inner"><ul class="aloha-sidebar-panels"></ul></div></div>');
this.width=300;this.isCompletelyOpen=this.isOpen=this.opened=!1;this.settings={rotateIcons:!f.browser.msie,overlayPage:!0};f(function(){"undefined"!==typeof j.settings.sidebar&&j.settings.sidebar.disabled||b.init(a)})},m=null,g=null;f.extend(l.prototype,{init:function(a){var b=this,c;"object"===typeof a&&(c=a.panels,delete a.panels);f.extend(this,a);"object"===typeof c&&f.each(c,function(){b.addPanel(this,true)});a=this.container;"right"===this.position&&a.addClass("aloha-sidebar-right");a.hide().appendTo(f("body")).click(function(){b.barClicked.apply(b,
arguments)}).find(".aloha-sidebar-panels").width(this.width);a.width(this.width);this.width=a.width();this.updateHeight();this.initToggler();this.container.css("right"===this.position?"marginRight":"marginLeft",-this.width);this.opened&&this.open(0);this.toggleHandleIcon(this.isOpen);this.subscribeToEvents();f(window).resize(function(){b.updateHeight();b.correctHeight()});this.correctHeight()},show:function(){this.container.css("display","block");return this},hide:function(){this.container.css("display",
"none");return this},checkActivePanels:function(a){var b=[];if("undefined"!==typeof a&&"undefined"!==typeof a.markupEffectiveAtStart){var c=a.markupEffectiveAtStart.length,g;for(g=0;g<c;++g)b.push(f(a.markupEffectiveAtStart[g]))}var k=this;f.each(this.panels,function(){k.showActivePanel(this,b)});this.correctHeight()},subscribeToEvents:function(){var a=this;d.sub("aloha.selection.context-change",function(b){a.isOpen&&a.checkActivePanels(b.range);a.lastRange=b.range});j.bind("aloha-editable-deactivated",
function(){a.isOpen&&a.checkActivePanels();a.lastRange=null});this.container.mousedown(function(a){a.originalEvent.stopSelectionUpdate=!0;j.eventHandled=!0});this.container.mouseup(function(a){a.originalEvent.stopSelectionUpdate=!0;j.eventHandled=!1})},correctHeight:function(){if(this.isOpen)if(this.isCompletelyOpen){var a=f(window).height(),b=[],c=[],k;for(k in this.panels)this.panels.hasOwnProperty(k)&&this.panels[k].isActive&&(c.push(this.panels[k]),b.push(k));if(0!==c.length&&(b=b.sort().join(","),
!(g===b&&m===a))){m=a;g=b;for(var a=this.container.find(".aloha-sidebar-inner").height()-(c[0].title.outerHeight()+10)*c.length,d,l,j,v=0,z=Math,x;0<c.length&&0<a;){a+=v;v=0;j=[];for(x=c.length-1;0<=x;--x)b=c[x],d=b.content.find(".aloha-sidebar-panel-content-inner"),k=z.min(d.height("auto").height(),z.floor(a/(x+1))),d.height(k),a-=k,l=d.find(".aloha-sidebar-panel-content-inner-text"),l.height()>k?(j.push(b),v+=k,d.css({"overflow-x":"hidden","overflow-y":"scroll"})):d.css("overflow-y","hidden"),b.expanded&&
b.expand();c=j}}}else this.correctHeightWhenCompletelyOpen=!0},showActivePanel:function(a,b){b.push(null);a.content.parent("li");var c=a.activeOn,g=f(),k=0,d=b.length,l;for(l=0;l<d;++l)c(b[l])&&(++k,b[l]&&f.merge(g,b[l]));k?a.activate(g):a.deactivate()},initToggler:function(){var a=this,b=this.container,c=b.find(".aloha-sidebar-handle-icon"),g,k="right"===this.position;this.opened&&this.rotateHandleArrow(k?0:180,0);f(function(){"undefined"!==typeof j.settings.sidebar&&(j.settings.sidebar.handle&&
j.settings.sidebar.handle.top)&&(f(b.find(".aloha-sidebar-handle"))[0].style.top=j.settings.sidebar.handle.top)});b.find(".aloha-sidebar-handle").click(function(){g&&clearInterval(g);c.stop().css("marginLeft",4);a.isOpen?(f(this).removeClass("aloha-sidebar-toggled"),a.close(),a.isOpen=!1):(f(this).addClass("aloha-sidebar-toggled"),a.open(),a.isOpen=!0)}).hover(function(){var b=a.isOpen?-1:1;g&&clearInterval(g);c.stop();f(this).stop().animate(k?{marginLeft:"-="+5*b}:{marginRight:"-="+5*b},200);g=setInterval(function(){b*=
-1;c.animate(k?{left:"-="+4*b}:{right:"-="+4*b},300)},300)},function(){g&&clearInterval(g);c.stop().css(k?"left":"right",5);f(this).stop().animate(k?{marginLeft:0}:{marginRight:0},600,"easeOutElastic")})},roundCorners:function(){var a=this.container,b=a.find(".aloha-sidebar-panels>li:not(.aloha-sidebar-deactivated)");a.find(".aloha-sidebar-panel-top, .aloha-sidebar-panel-bottom").removeClass("aloha-sidebar-panel-top").removeClass("aloha-sidebar-panel-bottom");b.first().find(".aloha-sidebar-panel-title").addClass("aloha-sidebar-panel-top");
b.last().find(".aloha-sidebar-panel-content").addClass("aloha-sidebar-panel-bottom")},updateHeight:function(){var a=f(window).height();this.container.height(a).find(".aloha-sidebar-inner").height(a)},barClicked:function(a){this.handleBarclick(f(a.target))},handleBarclick:function(a){a.hasClass("aloha-sidebar-panel-title")?this.togglePanel(a):!a.hasClass("aloha-sidebar-panel-content")&&(!a.hasClass("aloha-sidebar-handle")&&!a.hasClass("aloha-sidebar-bar"))&&this.handleBarclick(a.parent())},getPanelById:function(a){return this.panels[a]},
getPanelByElement:function(a){return this.getPanelById(("LI"===a[0].tagName?a:a.parent("li"))[0].id)},togglePanel:function(a){this.getPanelByElement(a).toggle()},rotateHandleIcon:function(a,b){var c=this.container.find(".aloha-sidebar-handle-icon");c.animate({angle:a},{duration:"number"===typeof b||"string"===typeof b?b:500,easing:"easeOutExpo",step:function(a){c.css({"-o-transform":"rotate("+a+"deg)","-webkit-transform":"rotate("+a+"deg)","-moz-transform":"rotate("+a+"deg)","-ms-transform":"rotate("+
a+"deg)"})}})},toggleHandleIcon:function(a){a^="right"===this.position;if(this.settings.rotateIcons)this.rotateHandleIcon(a?180:0,0);else{var b=this.container.find(".aloha-sidebar-handle-icon");a?b.addClass("aloha-sidebar-handle-icon-left"):b.removeClass("aloha-sidebar-handle-icon-left")}},open:function(a){if(this.isOpen)return this;var b="right"===this.position,c=b?{marginRight:0}:{marginLeft:0},g=this;this.toggleHandleIcon(!0);this.container.animate(c,"number"===typeof a||"string"===typeof a?a:
500,"easeOutExpo");this.settings.overlayPage||f("body").animate(b?{marginRight:"+="+this.width}:{marginLeft:"+="+this.width},500,"easeOutExpo",function(){g.isCompletelyOpen=!0;g.correctHeightWhenCompletelyOpen&&g.correctHeight()});this.isOpen=!0;this.correctHeight();this.lastRange&&this.checkActivePanels(this.lastRange);f("body").trigger("aloha-sidebar-opened",this);return this},close:function(a){if(!this.isOpen)return this;var b="right"===this.position,c=b?{marginRight:-this.width}:{marginLeft:-this.width};
this.toggleHandleIcon(!1);this.container.animate(c,"number"===typeof a||"string"===typeof a?a:500,"easeOutExpo");this.settings.overlayPage||f("body").animate(b?{marginRight:"-="+this.width}:{marginLeft:"-="+this.width},500,"easeOutExpo");this.isCompletelyOpen=this.isOpen=!1;return this},activatePanel:function(a,b){"string"===typeof a&&(a=this.getPanelById(a));a&&a.activate(b);this.roundCorners();return this},expandPanel:function(a,b){"string"===typeof a&&(a=this.getPanelById(a));a&&a.expand(b);return this},
collapsePanel:function(a,b){"string"===typeof a&&(a=this.getPanelById(a));a&&a.collapse(b);return this},addPanel:function(e){e instanceof b||(e.width||(e.width=this.width),e.sidebar=this,e=new b(e));this.panels[e.id]=e;this.container.find(".aloha-sidebar-panels").append(e.element);this.checkActivePanels(a.getRangeObject());return e}});f.extend(b.prototype,{init:function(a){this.setTitle(a.title).setContent(a.content);delete a.title;delete a.content;f.extend(this,a);this.id||(this.id="aloha-sidebar-"+
++c);this.element=f('<li id="'+this.id+'">').append(this.title,this.content);this.expanded&&this.content.height("auto");this.toggleTitleIcon(this.expanded);this.coerceActiveOn();this.title.attr("unselectable","on").css("-moz-user-select","none").each(function(){this.onselectstart=function(){return false}});"function"===typeof this.onInit&&this.onInit.apply(this)},toggleTitleIcon:function(a){if(this.sidebar.settings.rotateIcons)this.rotateTitleIcon(a?90:0);else{var b=this.title.find(".aloha-sidebar-panel-title-arrow");
a?b.addClass("aloha-sidebar-panel-title-arrow-down"):b.removeClass("aloha-sidebar-panel-title-arrow-down")}},coerceActiveOn:function(){if("function"!==typeof this.activeOn){var a=this.activeOn;this.activeOn=function(){var b=typeof a;return"boolean"===b?function(){return a}:"undefined"===b?function(){return!0}:"string"===b?function(b){return b?b.is(a):!1}:function(){return!1}}()}},activate:function(a){this.isActive=!0;this.content.parent("li").show().removeClass("aloha-sidebar-deactivated");this.effectiveElement=
a;"function"===typeof this.onActivate&&this.onActivate.call(this,a)},deactivate:function(){this.isActive&&(this.isActive=!1,this.content.parent("li").hide().addClass("aloha-sidebar-deactivated"),this.effectiveElement=null)},toggle:function(){this.expanded?this.collapse():this.expand()},expand:function(a){var b=this,c=this.content,g=c.height(),k=c.height("auto").height();c.height(g).stop().animate({height:k},500,"easeOutExpo",function(){"function"===typeof a&&a.call(b)});this.element.removeClass("collapsed");
this.toggleTitleIcon(!0);this.expanded=!0;return this},collapse:function(a,b){var c=this;this.element.addClass("collapsed");this.content.stop().animate({height:5},250,"easeOutExpo",function(){"function"===typeof b&&b.call(c)});this.toggleTitleIcon(!1);this.expanded=!1;return this},setTitle:function(a){this.title.find(".aloha-sidebar-panel-title-text").html(a);return this},setContent:function(a){if(!a||""===a)a="&nbsp;";this.content.find(".aloha-sidebar-panel-content-inner-text").html(a);return this},
rotateTitleIcon:function(a,b){var c=this.title.find(".aloha-sidebar-panel-title-arrow");c.animate({angle:a},{duration:"number"===typeof b?b:500,easing:"easeOutExpo",step:function(a){c.css({"-o-transform":"rotate("+a+"deg)","-webkit-transform":"rotate("+a+"deg)","-moz-transform":"rotate("+a+"deg)","-ms-transform":"rotate("+a+"deg)"})}})},renderEffectiveParents:function(a,b){for(var c=a.first(),g=[],k=[],d=this.activeOn,l,m;0<c.length&&!c.is(".aloha-editable");){if(d(c)){k.push("<span>"+c[0].tagName.toLowerCase()+
"</span>");l=k.length;for(m=[];l--;)m.push(k[l]);g.push('<div class="aloha-sidebar-panel-parent"><div class="aloha-sidebar-panel-parent-path">'+m.join("")+'</div><div class="aloha-sidebar-panel-parent-contentaloha-sidebar-opened">'+("function"===typeof b?b(c):"----")+"</div></div>")}c=c.parent()}this.setContent(g.join(""));f(".aloha-sidebar-panel-parent-path").click(function(){var a=f(this).parent().find(".aloha-sidebar-panel-parent-content");a.hasClass("aloha-sidebar-opened")?a.hide().removeClass("aloha-sidebar-opened"):
a.show().addClass("aloha-sidebar-opened")});this.content.height("auto").find(".aloha-sidebar-panel-content-inner").height("auto")}});var k=new l({position:"left",width:250}),l=new l({position:"right",width:250});j.Sidebar={left:k,right:l};return j.Sidebar});GENTICS=window.GENTICS||{};GENTICS.Utils=GENTICS.Utils||{};define("util/position",["jquery"],function(j){var f=window.GENTICS;f.Utils.Position={};f.Utils.Position.w=j(window);f.Utils.Position.Scroll={top:0,left:0,isScrolling:!1};f.Utils.Position.ScrollCorrection=
{top:100,left:50};f.Utils.Position.Mouse={x:0,y:0,oldX:0,oldY:0,isMoving:!1,triggeredMouseStop:!0};f.Utils.Position.mouseStopCallbacks=[];f.Utils.Position.mouseMoveCallbacks=[];f.Utils.Position.update=function(){var a=this.w.scrollTop(),d=this.w.scrollLeft();if(this.Scroll.isScrolling)this.Scroll.top==a&&this.Scroll.left==d&&(this.Scroll.isScrolling=!1);else if(this.Scroll.top!=a||this.Scroll.left!=d)this.Scroll.isScrolling=!0;this.Scroll.top=a;this.Scroll.left=d;if(this.Mouse.x==this.Mouse.oldX&&
this.Mouse.y==this.Mouse.oldY){if(this.Mouse.isMoving=!1,!this.Mouse.triggeredMouseStop){this.Mouse.triggeredMouseStop=!0;for(a=0;a<this.mouseStopCallbacks.length;a++)this.mouseStopCallbacks[a].call()}}else{this.Mouse.isMoving=!0;this.Mouse.triggeredMouseStop=!1;for(a=0;a<this.mouseMoveCallbacks.length;a++)this.mouseMoveCallbacks[a].call()}this.Mouse.oldX=this.Mouse.x;this.Mouse.oldY=this.Mouse.y};f.Utils.Position.addMouseStopCallback=function(a){this.mouseStopCallbacks.push(a);return this.mouseStopCallbacks.length-
1};f.Utils.Position.addMouseMoveCallback=function(a){this.mouseMoveCallbacks.push(a);return this.mouseMoveCallbacks.length-1};j(function(){window.setInterval(function(){f.Utils.Position.update()},500)});j("html").mousemove(function(a){f.Utils.Position.Mouse.x=a.pageX;f.Utils.Position.Mouse.y=a.pageY})});define("aloha/repositorymanager",["aloha/core","util/class","jquery","aloha/console"],function(j,f,a,d){j.RepositoryManager=f.extend({repositories:[],settings:{},init:function(){var c=this.repositories,
b=0,d=c.length,f;j.settings&&j.settings.repositories&&(this.settings=j.settings.repositories);for(this.settings.timeout=this.settings.timeout||5E3;b<d;++b)f=c[b],f.settings||(f.settings={}),this.settings[f.repositoryId]&&a.extend(f.settings,this.settings[f.repositoryId]),f.init()},register:function(a){this.getRepository(a.repositoryId)?d.warn(this,"A repository with name { "+a.repositoryId+" } already registerd. Ignoring this."):this.repositories.push(a)},getRepository:function(a){for(var b=this.repositories,
d=0,f=b.length;d<f;++d)if(b[d].repositoryId===a)return b[d];return null},query:function(c,b){var l=this,f,g=[],k={numItems:0,hasMoreItems:!1},e=[],p=0,o,r,q,u=function(e,c){if(0!==p){var f=e?e.length:0;if(f){if(!e[0].repositoryId){var m=this.repositoryId,q;for(q=0;q<f;++q)e[q].repositoryId=m}a.merge(g,e)}c&&k?(k.numItems=a.isNumeric(c.numItems)&&a.isNumeric(k.numItems)?k.numItems+c.numItems:void 0,k.hasMoreItems="boolean"===typeof c.hasMoreItems&&"boolean"===typeof k.hasMoreItems?k.hasMoreItems||
c.hasMoreItems:void 0,c.timeout&&(k.timeout=!0)):k=void 0;d.debug(this,"The repository "+this.repositoryId+" returned with "+f+" results.");0===--p&&l.queryCallback(b,g,k,o)}},j=parseInt(c.timeout,10)||this.settings.timeout;o=window.setTimeout(function(){0<p&&d.warn(this,p+" repositories did not return before the configured timeout of "+j+"ms.");p=0;k=k||{};k.timeout=!0;l.queryCallback(b,g,k,o)},j);c.repositoryId?e.push(this.getRepository(c.repositoryId)):e=this.repositories;q=e.length;var v=[];for(r=
0;r<q;++r)f=e[r],"function"===typeof f.query&&(++p,v.push(f));q=v.length;for(r=0;r<q;++r)f=v[r],f.query(c,function(){u.apply(f,arguments)});0===p&&this.queryCallback(b,g,k,o)},queryCallback:function(a,b,d,f){f&&clearTimeout(f);b={items:b,results:b.length};d&&(b.numItems=d.numItems,b.hasMoreItems=d.hasMoreItems,b.timeout=d.timeout);a.call(this,b)},getChildren:function(c,b){var d=this,f,g=[],k=[],e=0,p,o,r,q=function(c){0!==e&&(g&&c&&a.merge(g,c),0===--e&&d.getChildrenCallback(b,g,p))};if("aloha"===
c.inFolderId){var u=c.repositoryFilter,t=u&&u.length;r=this.repositories.length;for(o=0;o<r;++o)f=this.repositories[o],(!t||-1<a.inArray(f.repositoryId,u))&&k.push(new j.RepositoryFolder({id:f.repositoryId,name:f.repositoryName,repositoryId:f.repositoryId,type:"repository",hasMoreItems:!0}));d.getChildrenCallback(b,k,null)}else{k=this.repositories;o=parseInt(c.timeout,10)||this.settings.timeout;p=window.setTimeout(function(){e=0;d.getChildrenCallback(b,g,p)},o);r=k.length;for(o=0;o<r;++o)f=k[o],"function"===
typeof f.getChildren&&(++e,f.getChildren(c,function(){q.apply(f,arguments)}));0===e&&this.getChildrenCallback(b,g,p)}},getChildrenCallback:function(a,b,d){d&&clearTimeout(d);a.call(this,b)},makeClean:function(a){var b=this,l={},f=0,g=b.repositories.length;a.find("[data-gentics-aloha-repository="+this.prefix+"]").each(function(){for(;f<g;++f)l.makeClean(a);d.debug(b,"Passing contents of HTML Element with id { "+this.attr("id")+" } for cleaning to repository { "+l.repositoryId+" }");l.makeClean(this)})},
markObject:function(c,b){if(c)if(b){var l=this.getRepository(b.repositoryId);l?(a(c).attr({"data-gentics-aloha-repository":b.repositoryId,"data-gentics-aloha-object-id":b.id}),l.markObject(c,b)):d.error(this,"Trying to apply a repository { "+b.name+" } to an object, but item has no repositoryId.")}else a(c).removeAttr("data-gentics-aloha-repository").removeAttr("data-gentics-aloha-object-id")},getObject:function(c,b){var d=this,f=a(c),g=this.getRepository(f.attr("data-gentics-aloha-repository")),
k=f.attr("data-gentics-aloha-object-id");g&&k&&(this.itemCache=this.itemCache||[],this.itemCache[g.repositoryId]=this.itemCache[g.repositoryId]||[],this.itemCache[g.repositoryId][k]?b.call(this,[this.itemCache[g.repositoryId][k]]):g.getObjectById(k,function(a){d.itemCache[g.repositoryId][k]=a[0];b.call(this,a)}))},toString:function(){return"repositorymanager"}});j.RepositoryManager=new j.RepositoryManager;return j.RepositoryManager});define("aloha/repository",["aloha/core","util/class","aloha/repositorymanager"],
function(j,f,a){f=f.extend({_constructor:function(d,c){this.repositoryId=d;this.settings={};this.repositoryName=c?c:d;a.register(this)},init:function(){},query:null,getChildren:null,makeClean:function(){},markObject:function(){},setTemplate:function(a){this.template=a?a:null},hasTemplate:function(){return this.template?!0:!1},getTemplate:function(){return this.template},getObjectById:function(){return!0}});return j.AbstractRepository=f});define("aloha/repositoryobjects",["aloha/core","util/class"],
function(j,f){var a=window.GENTICS;j.RepositoryObject=function(){};j.RepositoryDocument=f.extend({_constructor:function(d){this.type="document";d.id&&(d.name&&d.repositoryId)&&(a.Utils.applyProperties(this,d),this.baseType="document")}});j.RepositoryFolder=f.extend({_constructor:function(d){this.type="folder";d.id&&(d.name&&d.repositoryId)&&(a.Utils.applyProperties(this,d),this.baseType="folder")}})});(function(j){function f(){var a,b,c=Aloha.settings.plugins&&Aloha.settings.plugins.load,e=Aloha.settings.baseUrl,
d,l=/\/aloha\.js$/,f=/\/[^\/]*\.js$/,q;if(!c||!e){a=document.getElementsByTagName("script");for(q=0;q<a.length;q++){b=a[q];d=b.getAttribute("data-aloha-plugins");if(null!=d){c||(c=d);e||(e=b.src.replace(f,""));break}!e&&l.test(b.src)&&(e=b.src.replace(l,""))}}"string"===typeof c&&""!==c&&(c=c.replace(/\s+/g,"").split(","));return{baseUrl:e,plugins:c||[]}}function a(){for(var a=document.getElementsByTagName("script"),b=0;b<a.length;b++)if("true"===a[b].getAttribute("data-aloha-defer-init"))return!0;
return!1}function d(a){var b={},c=[],e={},d={},l,f,q=Aloha.settings.basePath||"",u=Aloha.settings.bundles||{},j;for(j=0;j<a.length;j++){l=a[j].split("/");f=l[0];l=l[1];f=u[f]?q+u[f]:q+"../plugins/"+f;var v=b,z=f,x=l,y=["nls","css","vendor","res"],B=void 0,A=void 0;v[x]=z+"/"+x+"/lib";for(A=0;A<y.length;A++)B=y[A],v[x+"/"+B]=z+"/"+x+"/"+B;e[l]=f+"/"+l;c.push(l+"/"+l+"-plugin");d[l]={jquery:"aloha/jquery"}}return{paths:b,entryPoints:c,baseUrlByName:e,names:[],map:d}}function c(){var a={},b=Array.prototype.slice.call(arguments),
c,e,d;for(e=0;e<b.length;e++)for(c in d=b[e],d)d.hasOwnProperty(c)&&(a[c]=b[e][c]);return a}function b(a,b){define(a,function(){return b})}function l(){Aloha.defaults={};Aloha.settings=Aloha.settings||{};var a=f(),g=d(a.plugins);Aloha.settings.baseUrl=a.baseUrl;Aloha.settings.loadedPlugins=g.names;Aloha.settings._pluginBaseUrlByName=g.baseUrlByName;var a=c({aloha:{jquery:"aloha/jquery"},"aloha/jquery":{jquery:"jquery"},jqueryui:{jquery:"aloha/jquery"},vendor:{jquery:"aloha/jquery"},util:{jquery:"aloha/jquery"},
RepositoryBrowser:{jquery:"aloha/jquery"},jstree:{jquery:"aloha/jquery"},jqgrid:{jquery:"aloha/jquery"},"jqgrid-locale-en":{jquery:"aloha/jquery"},"jqgrid-locale-de":{jquery:"aloha/jquery"},"jquery-layout":{jquery:"aloha/jquery"}},g.map),k=c({context:"aloha",locale:Aloha.settings.locale||"en",baseUrl:Aloha.settings.baseUrl,map:a},Aloha.settings.requireConfig);k.paths=c({jquery:"vendor/jquery-1.7.2",jqueryui:"vendor/jquery-ui-1.9m6"},{PubSub:"vendor/pubsub/js/pubsub-unminified",Class:"vendor/class",
RepositoryBrowser:"vendor/repository-browser/js/repository-browser-unminified",jstree:"vendor/jquery.jstree",jqgrid:"vendor/jquery.jqgrid","jquery-layout":"vendor/jquery.layout","jqgrid-locale-en":"vendor/grid.locale.en","jqgrid-locale-de":"vendor/grid.locale.de","repository-browser-i18n-de":"vendor/repository-browser/js/repository-browser-unminified","repository-browser-i18n-en":"vendor/repository-browser/js/repository-browser-unminified"},g.paths,k.paths);a=Aloha.settings.predefinedModules||{};
Aloha.settings.jQuery&&(a.jquery=Aloha.settings.jQuery);for(var e in a)a.hasOwnProperty(e)&&(b(e,a[e]),delete k.paths[e]);var l=require.config(k);Aloha.require=function(a){return 1===arguments.length&&typeof a==="function"?l(["aloha"],a):l.apply(this,arguments)};var o;Aloha.bind=function(a,b){Aloha.require(["aloha/jquery"],function(e){Aloha.bind=function(a,b){o=o||e.Deferred();"aloha-ready"===a?"alohaReady"!==Aloha.stage?o.done(b):b():e(Aloha,"body").bind(a,b);return this};Aloha.bind(a,b)});return this};
Aloha.trigger=function(a,b){Aloha.require(["aloha/jquery"],function(e){Aloha.trigger=function(a,b){o=o||e.Deferred();"aloha-ready"===a&&e(o.resolve);e(Aloha,"body").trigger(a,b);return this};Aloha.trigger(a,b)});return this};Aloha.unbind=function(a){Aloha.require(["aloha/jquery"],function(b){Aloha.unbind=function(a){b(Aloha,"body").unbind(a)};Aloha.unbind(a)})};Aloha.ready=function(a){this.bind("aloha-ready",a);return this};var r=Aloha.settings.jQuery;define("aloha/jquery",["jquery"],function(a){return r||
a});define("aloha","aloha/jquery util/json2 aloha/rangy-core util/class util/lang util/range util/dom aloha/core aloha/editable aloha/console aloha/markup aloha/plugin aloha/selection aloha/command aloha/jquery.aloha aloha/sidebar util/position aloha/repositorymanager aloha/repository aloha/repositoryobjects aloha/contenthandlermanager".split(" "),function(a){Aloha.jQuery=a;Aloha.settings=a.extendObjects(true,{},Aloha.defaults,Aloha.settings);return Aloha});Aloha.stage="loadingAloha";require(k,["aloha",
"aloha/jquery"],function(a,b){a.stage="loadPlugins";require(k,g.entryPoints,function(){b(function(){window.rangy.init();a.init()})})})}j.Aloha=j.Aloha||{};j.Aloha.deferInit||a()?j.Aloha.deferInit=l:Aloha._load=l})(window);define("ui/context",["aloha","jquery","util/class"],function(j,f,a){var d;d=f("#aloha-ui-context");d.length||(d=f("<div>",{"class":"aloha",id:"aloha-ui-context"}),f(function(){d.appendTo("body")}));j=a.extend({surfaces:[],containers:[]});f.extend(j,{selector:"#aloha-ui-context",
element:d});return j});define("ui/scopes",["jquery","PubSub"],function(j,f){function a(b,c){if(d.hasOwnProperty(c))for(var e=d[c],l=0;l<e.length;l++){var f=e[l];b.push(f);a(b,f)}}var d={"Aloha.empty":[],"Aloha.global":["Aloha.empty"],"Aloha.continuoustext":["Aloha.global"]},c=[],b={},l=!1;Aloha.bind("aloha-selection-changed-before",function(){l=!1});Aloha.bind("aloha-selection-changed-after",function(a,b,e){"undefined"!==typeof e&&!l&&m.setScope("Aloha.continuoustext")});var m={enterScope:function(a){var c=
b[a]||0;b[a]=c+1;c||f.pub("aloha.ui.scope.change")},leaveScope:function(a){var c=b[a]-1;c?b[a]=c:(delete b[a],f.pub("aloha.ui.scope.change"))},isActiveScope:function(a){return b[a]||-1!==j.inArray(a,c)?!0:!1},getPrimaryScope:function(){return c[0]},setScope:function(b){l=!0;c[0]!=b&&(c=[b],a(c,b),f.pub("aloha.ui.scope.change"))},createScope:function(a,b){b?"string"===typeof b&&(b=[b]):b=["Aloha.empty"];d[a]=b}};return m});define("ui/container",["jquery","util/class","ui/scopes"],function(j,f,a){function d(c,
g){switch(j.type(g)){case "function":return g;case "object":if(g.scope)return b[g.scope]?b[g.scope]:b[g.scope]=function(){return a.isActiveScope(g.scope)};throw"Invalid showOn configuration";default:return l}}var c=0,b={},l=function(){return!0},f=f.extend({element:null,_constructor:function(a,b){var k=d(this,b.showOn),e;k.showOnId||(k.showOnId=++c);e=k.showOnId;var l=a.containers[e];this.context=a;l||(l=a.containers[e]={shouldShow:k,containers:[]});l.containers.push(this)},show:function(){},hide:function(){},
focus:function(){},foreground:function(){},childVisible:function(){},childFocus:function(){},childForeground:function(){}});j.extend(f,{showContainersForContext:function(a,b){var c,e,d;if(a.containers)for(e in d=a.containers,d)if(d.hasOwnProperty(e)){c=d[e];var l=c.containers;c=c.shouldShow(b)?"show":"hide";for(var f=void 0,f=0;f<l.length;f++)l[f][c]()}}});return f});define("ui/surface",["aloha/core","jquery","util/class","ui/container"],function(j,f,a){var d=a.extend({_constructor:function(a){a.surfaces.push(this)},
isActive:function(){return!0}});f.extend(d,{range:null,show:function(a){f.each(a.surfaces,function(a,c){c.show()})},hide:function(a){f.each(a.surfaces,function(a,c){c.hide()})},trackRange:function(a){a.bind("mousedown",function(a){a.originalEvent.stopSelectionUpdate=!0;j.eventHandled=!0;d.suppressHide=!0;j.activeEditable&&(a=j.getSelection(),d.range=0<a.getRangeCount()?a.getRangeAt(0):null)});a.bind("mouseup",function(a){a.originalEvent.stopSelectionUpdate=!0;j.eventHandled=!1;d.suppressHide=!1})}});
return d});define("ui/component",["aloha/core","jquery","util/class"],function(j,f,a){var d=0;return a.extend({id:0,isInstance:!0,container:null,type:null,visible:!0,_constructor:function(){this.id=d++;this.init()},adoptParent:function(a){this.container=a},init:function(){},isVisible:function(){return this.visible},show:function(a){!1===a?this.hide():this.visible||(this.visible=!0,this.element.show(),this.container&&this.container.childVisible(this,!0))},hide:function(){this.visible&&(this.visible=
!1,this.element.hide(),this.container&&this.container.childVisible(this,!1))},focus:function(){this.element.focus();this.container&&this.container.childFocus(this)},foreground:function(){this.container&&this.container.childForeground(this)},enable:function(){},disable:function(){}})});define("jqueryui",["jquery"],function(j){(function(f,a){function d(a,d){var m=a.nodeName.toLowerCase();if("area"===m){var m=a.parentNode,g=m.name;if(!a.href||!g||"map"!==m.nodeName.toLowerCase())return!1;m=f("img[usemap=#"+
g+"]")[0];return!!m&&c(m)}return(/input|select|textarea|button|object/.test(m)?!a.disabled:"a"==m?a.href||d:d)&&c(a)}function c(a){return!f(a).parents().andSelf().filter(function(){return"hidden"===f.curCSS(this,"visibility")||f.expr.filters.hidden(this)}).length}f.ui=f.ui||{};f.ui.version||(f.extend(f.ui,{version:"1.9m6",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,
NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),f.fn.extend({_focus:f.fn.focus,focus:function(a,c){return"number"===typeof a?this.each(function(){var d=this;setTimeout(function(){f(d).focus();c&&c.call(d)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=f.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?
this.parents().filter(function(){return/(relative|absolute|fixed)/.test(f.curCSS(this,"position",1))&&/(auto|scroll)/.test(f.curCSS(this,"overflow",1)+f.curCSS(this,"overflow-y",1)+f.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(f.curCSS(this,"overflow",1)+f.curCSS(this,"overflow-y",1)+f.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?f(document):a},zIndex:function(b){if(b!==a)return this.css("zIndex",b);if(this.length)for(var b=
f(this[0]),c;b.length&&b[0]!==document;){c=b.css("position");if("absolute"===c||"relative"===c||"fixed"===c)if(c=parseInt(b.css("zIndex"),10),!isNaN(c)&&0!==c)return c;b=b.parent()}return 0},disableSelection:function(){return this.bind((f.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),f.each(["Width","Height"],function(b,c){function d(a,b,e,c){f.each(g,function(){b-=parseFloat(f.curCSS(a,
"padding"+this,!0))||0;e&&(b-=parseFloat(f.curCSS(a,"border"+this+"Width",!0))||0);c&&(b-=parseFloat(f.curCSS(a,"margin"+this,!0))||0)});return b}var g="Width"===c?["Left","Right"]:["Top","Bottom"],k=c.toLowerCase(),e={innerWidth:f.fn.innerWidth,innerHeight:f.fn.innerHeight,outerWidth:f.fn.outerWidth,outerHeight:f.fn.outerHeight};f.fn["inner"+c]=function(b){return b===a?e["inner"+c].call(this):this.each(function(){f(this).css(k,d(this,b)+"px")})};f.fn["outer"+c]=function(a,b){return"number"!==typeof a?
e["outer"+c].call(this,a):this.each(function(){f(this).css(k,d(this,a,!0,b)+"px")})}}),f.extend(f.expr[":"],{data:function(a,c,d){return!!f.data(a,d[3])},focusable:function(a){return d(a,!isNaN(f.attr(a,"tabindex")))},tabbable:function(a){var c=f.attr(a,"tabindex"),m=isNaN(c);return(m||0<=c)&&d(a,!m)}}),f(function(){var a=document.body,c=a.appendChild(c=document.createElement("div"));f.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});f.support.minHeight=100===c.offsetHeight;
f.support.selectstart="onselectstart"in c;a.removeChild(c).style.display="none"}),f.extend(f.ui,{plugin:{add:function(a,c,d){var a=f.ui[a].prototype,g;for(g in d)a.plugins[g]=a.plugins[g]||[],a.plugins[g].push([c,d[g]])},call:function(a,c,d){if((c=a.plugins[c])&&a.element[0].parentNode)for(var g=0;g<c.length;g++)a.options[c[g][0]]&&c[g][1].apply(a.element,d)}},contains:f.contains,hasScroll:function(a,c){if("hidden"===f(a).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",g=!1;
if(0<a[d])return!0;a[d]=1;g=0<a[d];a[d]=0;return g},isOverAxis:function(a,c,d){return a>c&&a<c+d},isOver:function(a,c,d,g,k,e){return f.ui.isOverAxis(a,d,k)&&f.ui.isOverAxis(c,g,e)}}))})(j);(function(f,a){var d=Array.prototype.slice,c=f.cleanData;f.cleanData=function(a){for(var d=0,m;null!=(m=a[d]);d++)try{f(m).triggerHandler("remove")}catch(g){}c(a)};f.widget=function(a,c,m){var g=a.split(".")[0],k,a=a.split(".")[1];k=g+"-"+a;m||(m=c,c=f.Widget);f.expr[":"][k]=function(e){return!!f.data(e,a)};f[g]=
f[g]||{};f[g][a]=f.extend(function(e,c){if(!this._createWidget)return new f[g][a](e,c);arguments.length&&this._createWidget(e,c)},f[g][a],{version:m.version});var e=new c;e.options=f.widget.extend({},e.options);f.each(m,function(a,b){f.isFunction(b)&&(m[a]=function(){var a=function(a){return c.prototype[a].apply(this,d.call(arguments,1))},e=function(a,b){return c.prototype[a].apply(this,b)};return function(){var c=this._super,g=this._superApply,k;this._super=a;this._superApply=e;k=b.apply(this,arguments);
this._super=c;this._superApply=g;return k}}())});f[g][a].prototype=f.widget.extend(e,{namespace:g,widgetName:a,widgetEventPrefix:a,widgetBaseClass:k},m);f.widget.bridge(a,f[g][a])};f.widget.extend=function(b){for(var c=d.call(arguments,1),m=0,g=c.length,k,e;m<g;m++)for(k in c[m])e=c[m][k],c[m].hasOwnProperty(k)&&e!==a&&(b[k]=f.isPlainObject(e)?f.widget.extend({},b[k],e):e);return b};f.widget.bridge=function(b,c){f.fn[b]=function(m){var g="string"===typeof m,k=d.call(arguments,1),e=this,m=!g&&k.length?
f.widget.extend.apply(null,[m].concat(k)):m;g?this.each(function(){var c=f.data(this,b);if(!c)return f.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+m+"'");if(!f.isFunction(c[m])||"_"===m.charAt(0))return f.error("no such method '"+m+"' for "+b+" widget instance");var g=c[m].apply(c,k);if(g!==c&&g!==a)return e=g&&g.jquery?e.pushStack(g.get()):g,!1}):this.each(function(){var a=f.data(this,b);a?a.option(m||{})._init():c(m,this)});return e}};f.Widget=function(a,
c){if(!this._createWidget)return new f[namespace][name](a,c);arguments.length&&this._createWidget(a,c)};f.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(a,c){c=f(c||this.defaultElement||this)[0];this.element=f(c);this.options=f.widget.extend({},this.options,this._getCreateOptions(),a);this.bindings=f();this.hoverable=f();this.focusable=f();c!==this&&(f.data(c,this.widgetName,this),this._bind({remove:"destroy"}));
this._create();this._trigger("create");this._init()},_getCreateOptions:f.noop,_create:f.noop,_init:f.noop,destroy:function(){this._destroy();this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled");this.bindings.unbind("."+this.widgetName);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:f.noop,widget:function(){return this.element},
option:function(b,c){var d=b,g,k,e;if(0===arguments.length)return f.widget.extend({},this.options);if("string"===typeof b)if(d={},g=b.split("."),b=g.shift(),g.length){k=d[b]=f.widget.extend({},this.options[b]);for(e=0;e<g.length-1;e++)k[g[e]]=k[g[e]]||{},k=k[g[e]];b=g.pop();if(c===a)return k[b]===a?null:k[b];k[b]=c}else{if(c===a)return this.options[b]===a?null:this.options[b];d[b]=c}this._setOptions(d);return this},_setOptions:function(a){var c=this;f.each(a,function(a,b){c._setOption(a,b)});return this},
_setOption:function(a,c){this.options[a]=c;"disabled"===a&&(this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",!!c).attr("aria-disabled",c),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"));return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_bind:function(a,c){c?(a=f(a),this.bindings=this.bindings.add(a)):(c=a,a=this.element);var d=this;f.each(c,function(c,
k){function e(){if(!(d.options.disabled===true||f(this).hasClass("ui-state-disabled")))return(typeof k==="string"?d[k]:k).apply(d,arguments)}var l=c.match(/^(\w+)\s*(.*)$/),o=l[1]+"."+d.widgetName;(l=l[2])?d.widget().delegate(l,o,e):a.bind(o,e)})},_delay:function(a,c){var d=this;return setTimeout(function(){return("string"===typeof a?d[a]:a).apply(d,arguments)},c||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._bind(a,{mouseenter:function(a){f(a.currentTarget).addClass("ui-state-hover")},
mouseleave:function(a){f(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._bind(a,{focusin:function(a){f(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){f(a.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(a,c,d){var g=this.options[a],c=f.Event(c);c.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();d=d||{};if(c.originalEvent)for(var a=f.event.props.length,k;a;)k=f.event.props[--a],
c[k]=c.originalEvent[k];this.element.trigger(c,d);d=f.isArray(d)?[c].concat(d):[c,d];return!(f.isFunction(g)&&!1===g.apply(this.element[0],d)||c.isDefaultPrevented())}};f.each({show:"fadeIn",hide:"fadeOut"},function(a,c){f.Widget.prototype["_"+a]=function(d,g,k){"string"===typeof g&&(g={effect:g});var e,p=!g?a:!0===g||"number"===typeof g?c:g.effect||c,g=g||{};"number"===typeof g&&(g={duration:g});e=!f.isEmptyObject(g);g.complete=k;g.delay&&d.delay(g.delay);if(e&&f.effects&&(f.effects.effect[p]||!1!==
f.uiBackCompat&&f.effects[p]))d[a](g);else if(p!==a&&d[p])d[p](g.duration,g.easing,k);else d.queue(function(e){f(this)[a]();k&&k.call(d[0]);e()})}});!1!==f.uiBackCompat&&(f.Widget.prototype._getCreateOptions=function(){return f.metadata&&f.metadata.get(this.element[0])[this.widgetName]})})(j);(function(f){var a=!1;f(document).mouseup(function(){a=!1});f.widget("ui.mouse",{version:"1.9m6",options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+
this.widgetName,function(c){return a._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(!0===f.data(c.target,a.widgetName+".preventClickEvent"))return f.removeData(c.target,a.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(d){if(!a){this._mouseStarted&&this._mouseUp(d);this._mouseDownEvent=d;var c=this,b=1==d.which,l="string"==typeof this.options.cancel&&d.target.nodeName?
f(d.target).closest(this.options.cancel).length:!1;if(!b||l||!this._mouseCapture(d))return!0;this.mouseDelayMet=!this.options.delay;this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=!1!==this._mouseStart(d),!this._mouseStarted))return d.preventDefault(),!0;!0===f.data(d.target,this.widgetName+".preventClickEvent")&&f.removeData(d.target,this.widgetName+".preventClickEvent");
this._mouseMoveDelegate=function(a){return c._mouseMove(a)};this._mouseUpDelegate=function(a){return c._mouseUp(a)};f(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);d.preventDefault();return a=!0}},_mouseMove:function(a){if(f.browser.msie&&!(9<=document.documentMode)&&!a.button)return this._mouseUp(a);if(this._mouseStarted)return this._mouseDrag(a),a.preventDefault();this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&((this._mouseStarted=
!1!==this._mouseStart(this._mouseDownEvent,a))?this._mouseDrag(a):this._mouseUp(a));return!this._mouseStarted},_mouseUp:function(a){f(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,a.target==this._mouseDownEvent.target&&f.data(a.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(a));return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-
a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(j);(function(f){f.widget("ui.draggable",f.ui.mouse,{version:"1.9m6",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,
refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),
this._mouseDestroy(),this},_mouseCapture:function(a){var d=this.options;if(this.helper||d.disabled||f(a.target).is(".ui-resizable-handle"))return!1;this.handle=this._getHandle(a);if(!this.handle)return!1;f(!0===d.iframeFix?"iframe":d.iframeFix).each(function(){f('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(f(this).offset()).appendTo("body")});return!0},_mouseStart:function(a){var d=
this.options;this.helper=this._createHelper(a);this._cacheHelperProportions();f.ui.ddmanager&&(f.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};f.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.originalPosition=this.position=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt);d.containment&&this._setContainment();if(!1===this._trigger("start",a))return this._clear(),!1;this._cacheHelperProportions();f.ui.ddmanager&&!d.dropBehaviour&&f.ui.ddmanager.prepareOffsets(this,a);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(a,!0);f.ui.ddmanager&&f.ui.ddmanager.dragStart(this,a);return!0},_mouseDrag:function(a,
d){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!d){var c=this._uiHash();if(!1===this._trigger("drag",a,c))return this._mouseUp({}),!1;this.position=c.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";f.ui.ddmanager&&f.ui.ddmanager.drag(this,a);return!1},_mouseStop:function(a){var d=!1;f.ui.ddmanager&&
!this.options.dropBehaviour&&(d=f.ui.ddmanager.drop(this,a));this.dropped&&(d=this.dropped,this.dropped=!1);if(!this.element[0]||!this.element[0].parentNode)return!1;if("invalid"==this.options.revert&&!d||"valid"==this.options.revert&&d||!0===this.options.revert||f.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)){var c=this;f(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",a)!==false&&c._clear()})}else!1!==
this._trigger("stop",a)&&this._clear();return!1},_mouseUp:function(a){!0===this.options.iframeFix&&f("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});f.ui.ddmanager&&f.ui.ddmanager.dragStop(this,a);return f.ui.mouse.prototype._mouseUp.call(this,a)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(a){var d=!this.options.handle||!f(this.options.handle,this.element).length?!0:!1;f(this.options.handle,
this.element).find("*").andSelf().each(function(){this==a.target&&(d=!0)});return d},_createHelper:function(a){var d=this.options,a=f.isFunction(d.helper)?f(d.helper.apply(this.element[0],[a])):"clone"==d.helper?this.element.clone().removeAttr("id"):this.element;a.parents("body").length||a.appendTo("parent"==d.appendTo?this.element[0].parentNode:d.appendTo);a[0]!=this.element[0]&&!/(fixed|absolute)/.test(a.css("position"))&&a.css("position","absolute");return a},_adjustOffsetFromHelper:function(a){"string"==
typeof a&&(a=a.split(" "));f.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();"absolute"==this.cssPosition&&
(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0]))&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&f.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==
this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions=
{width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;"parent"==a.containment&&(a.containment=this.helper[0].parentNode);if("document"==a.containment||"window"==a.containment)this.containment=["document"==a.containment?0:f(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==a.containment?0:f(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==a.containment?0:f(window).scrollLeft())+
f("document"==a.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==a.containment?0:f(window).scrollTop())+(f("document"==a.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&a.containment.constructor!=Array){var a=f(a.containment),d=a[0];if(d){a.offset();var c="hidden"!=f(d).css("overflow");this.containment=[(parseInt(f(d).css("borderLeftWidth"),
10)||0)+(parseInt(f(d).css("paddingLeft"),10)||0),(parseInt(f(d).css("borderTopWidth"),10)||0)+(parseInt(f(d).css("paddingTop"),10)||0),(c?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(f(d).css("borderLeftWidth"),10)||0)-(parseInt(f(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(c?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(f(d).css("borderTopWidth"),10)||0)-(parseInt(f(d).css("paddingBottom"),10)||0)-this.helperProportions.height-
this.margins.top-this.margins.bottom];this.relative_container=a}}else a.containment.constructor==Array&&(this.containment=a.containment)},_convertPositionTo:function(a,d){d||(d=this.position);var c="absolute"==a?1:-1,b="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,l=/(html|body)/i.test(b[0].tagName);return{top:d.top+this.offset.relative.top*c+this.offset.parent.top*c-(f.browser.safari&&526>
f.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():l?0:b.scrollTop())*c),left:d.left+this.offset.relative.left*c+this.offset.parent.left*c-(f.browser.safari&&526>f.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():l?0:b.scrollLeft())*c)}},_generatePosition:function(a){var d=this.options,c="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0]))?
this.offsetParent:this.scrollParent,b=/(html|body)/i.test(c[0].tagName),l=a.pageX,m=a.pageY;if(this.originalPosition){var g;this.containment&&(this.relative_container?(g=this.relative_container.offset(),g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]):g=this.containment,a.pageX-this.offset.click.left<g[0]&&(l=g[0]+this.offset.click.left),a.pageY-this.offset.click.top<g[1]&&(m=g[1]+this.offset.click.top),a.pageX-this.offset.click.left>g[2]&&
(l=g[2]+this.offset.click.left),a.pageY-this.offset.click.top>g[3]&&(m=g[3]+this.offset.click.top));d.grid&&(m=d.grid[1]?this.originalPageY+Math.round((m-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY,m=g?!(m-this.offset.click.top<g[1]||m-this.offset.click.top>g[3])?m:!(m-this.offset.click.top<g[1])?m-d.grid[1]:m+d.grid[1]:m,l=d.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/d.grid[0])*d.grid[0]:this.originalPageX,l=g?!(l-this.offset.click.left<g[0]||l-this.offset.click.left>
g[2])?l:!(l-this.offset.click.left<g[0])?l-d.grid[0]:l+d.grid[0]:l)}return{top:m-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(f.browser.safari&&526>f.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():b?0:c.scrollTop()),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(f.browser.safari&&526>f.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():
b?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(a,d,c){c=c||this._uiHash();f.ui.plugin.call(this,a,[d,c]);"drag"==a&&(this.positionAbs=this._convertPositionTo("absolute"));return f.Widget.prototype._trigger.call(this,a,d,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,
offset:this.positionAbs}}});f.ui.plugin.add("draggable","connectToSortable",{start:function(a,d){var c=f(this).data("draggable"),b=c.options,l=f.extend({},d,{item:c.element});c.sortables=[];f(b.connectToSortable).each(function(){var b=f.data(this,"sortable");b&&!b.options.disabled&&(c.sortables.push({instance:b,shouldRevert:b.options.revert}),b.refreshPositions(),b._trigger("activate",a,l))})},stop:function(a,d){var c=f(this).data("draggable"),b=f.extend({},d,{item:c.element});f.each(c.sortables,
function(){this.instance.isOver?(this.instance.isOver=0,c.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(a),this.instance.options.helper=this.instance.options._helper,"original"==c.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",a,b))})},drag:function(a,d){var c=f(this).data("draggable"),b=this;f.each(c.sortables,
function(){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=f(b).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return d.helper[0]},a.target=this.instance.currentItem[0],
this.instance._mouseCapture(a,!0),this.instance._mouseStart(a,!0,!0),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,c._trigger("toSortable",a),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=c),this.instance.currentItem&&this.instance._mouseDrag(a)):
this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",a,this.instance._uiHash(this.instance)),this.instance._mouseStop(a,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),c._trigger("fromSortable",a),c.dropped=!1)})}});f.ui.plugin.add("draggable","cursor",{start:function(){var a=f("body"),d=f(this).data("draggable").options;
a.css("cursor")&&(d._cursor=a.css("cursor"));a.css("cursor",d.cursor)},stop:function(){var a=f(this).data("draggable").options;a._cursor&&f("body").css("cursor",a._cursor)}});f.ui.plugin.add("draggable","opacity",{start:function(a,d){var c=f(d.helper),b=f(this).data("draggable").options;c.css("opacity")&&(b._opacity=c.css("opacity"));c.css("opacity",b.opacity)},stop:function(a,d){var c=f(this).data("draggable").options;c._opacity&&f(d.helper).css("opacity",c._opacity)}});f.ui.plugin.add("draggable",
"scroll",{start:function(){var a=f(this).data("draggable");a.scrollParent[0]!=document&&"HTML"!=a.scrollParent[0].tagName&&(a.overflowOffset=a.scrollParent.offset())},drag:function(a){var d=f(this).data("draggable"),c=d.options,b=!1;if(d.scrollParent[0]!=document&&"HTML"!=d.scrollParent[0].tagName){if(!c.axis||"x"!=c.axis)d.overflowOffset.top+d.scrollParent[0].offsetHeight-a.pageY<c.scrollSensitivity?d.scrollParent[0].scrollTop=b=d.scrollParent[0].scrollTop+c.scrollSpeed:a.pageY-d.overflowOffset.top<
c.scrollSensitivity&&(d.scrollParent[0].scrollTop=b=d.scrollParent[0].scrollTop-c.scrollSpeed);if(!c.axis||"y"!=c.axis)d.overflowOffset.left+d.scrollParent[0].offsetWidth-a.pageX<c.scrollSensitivity?d.scrollParent[0].scrollLeft=b=d.scrollParent[0].scrollLeft+c.scrollSpeed:a.pageX-d.overflowOffset.left<c.scrollSensitivity&&(d.scrollParent[0].scrollLeft=b=d.scrollParent[0].scrollLeft-c.scrollSpeed)}else{if(!c.axis||"x"!=c.axis)a.pageY-f(document).scrollTop()<c.scrollSensitivity?b=f(document).scrollTop(f(document).scrollTop()-
c.scrollSpeed):f(window).height()-(a.pageY-f(document).scrollTop())<c.scrollSensitivity&&(b=f(document).scrollTop(f(document).scrollTop()+c.scrollSpeed));if(!c.axis||"y"!=c.axis)a.pageX-f(document).scrollLeft()<c.scrollSensitivity?b=f(document).scrollLeft(f(document).scrollLeft()-c.scrollSpeed):f(window).width()-(a.pageX-f(document).scrollLeft())<c.scrollSensitivity&&(b=f(document).scrollLeft(f(document).scrollLeft()+c.scrollSpeed))}!1!==b&&(f.ui.ddmanager&&!c.dropBehaviour)&&f.ui.ddmanager.prepareOffsets(d,
a)}});f.ui.plugin.add("draggable","snap",{start:function(){var a=f(this).data("draggable"),d=a.options;a.snapElements=[];f(d.snap.constructor!=String?d.snap.items||":data(draggable)":d.snap).each(function(){var c=f(this),b=c.offset();this!=a.element[0]&&a.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:b.top,left:b.left})})},drag:function(a,d){for(var c=f(this).data("draggable"),b=c.options,l=b.snapTolerance,m=d.offset.left,g=m+c.helperProportions.width,k=d.offset.top,
e=k+c.helperProportions.height,p=c.snapElements.length-1;0<=p;p--){var o=c.snapElements[p].left,r=o+c.snapElements[p].width,q=c.snapElements[p].top,u=q+c.snapElements[p].height;if(o-l<m&&m<r+l&&q-l<k&&k<u+l||o-l<m&&m<r+l&&q-l<e&&e<u+l||o-l<g&&g<r+l&&q-l<k&&k<u+l||o-l<g&&g<r+l&&q-l<e&&e<u+l){if("inner"!=b.snapMode){var j=Math.abs(q-e)<=l,v=Math.abs(u-k)<=l,z=Math.abs(o-g)<=l,x=Math.abs(r-m)<=l;j&&(d.position.top=c._convertPositionTo("relative",{top:q-c.helperProportions.height,left:0}).top-c.margins.top);
v&&(d.position.top=c._convertPositionTo("relative",{top:u,left:0}).top-c.margins.top);z&&(d.position.left=c._convertPositionTo("relative",{top:0,left:o-c.helperProportions.width}).left-c.margins.left);x&&(d.position.left=c._convertPositionTo("relative",{top:0,left:r}).left-c.margins.left)}var y=j||v||z||x;if("outer"!=b.snapMode&&(j=Math.abs(q-k)<=l,v=Math.abs(u-e)<=l,z=Math.abs(o-m)<=l,x=Math.abs(r-g)<=l,j&&(d.position.top=c._convertPositionTo("relative",{top:q,left:0}).top-c.margins.top),v&&(d.position.top=
c._convertPositionTo("relative",{top:u-c.helperProportions.height,left:0}).top-c.margins.top),z&&(d.position.left=c._convertPositionTo("relative",{top:0,left:o}).left-c.margins.left),x))d.position.left=c._convertPositionTo("relative",{top:0,left:r-c.helperProportions.width}).left-c.margins.left;!c.snapElements[p].snapping&&(j||v||z||x||y)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,a,f.extend(c._uiHash(),{snapItem:c.snapElements[p].item}));c.snapElements[p].snapping=j||v||z||x||y}else c.snapElements[p].snapping&&
c.options.snap.release&&c.options.snap.release.call(c.element,a,f.extend(c._uiHash(),{snapItem:c.snapElements[p].item})),c.snapElements[p].snapping=!1}}});f.ui.plugin.add("draggable","stack",{start:function(){var a=f(this).data("draggable").options,a=f.makeArray(f(a.stack)).sort(function(a,b){return(parseInt(f(a).css("zIndex"),10)||0)-(parseInt(f(b).css("zIndex"),10)||0)});if(a.length){var d=parseInt(a[0].style.zIndex)||0;f(a).each(function(a){this.style.zIndex=d+a});this[0].style.zIndex=d+a.length}}});
f.ui.plugin.add("draggable","zIndex",{start:function(a,d){var c=f(d.helper),b=f(this).data("draggable").options;c.css("zIndex")&&(b._zIndex=c.css("zIndex"));c.css("zIndex",b.zIndex)},stop:function(a,d){var c=f(this).data("draggable").options;c._zIndex&&f(d.helper).css("zIndex",c._zIndex)}})})(j);(function(f){f.widget("ui.droppable",{version:"1.9m6",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var a=
this.options,d=a.accept;this.isover=0;this.isout=1;this.accept=f.isFunction(d)?d:function(a){return a.is(d)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};f.ui.ddmanager.droppables[a.scope]=f.ui.ddmanager.droppables[a.scope]||[];f.ui.ddmanager.droppables[a.scope].push(this);a.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var a=f.ui.ddmanager.droppables[this.options.scope],d=0;d<a.length;d++)a[d]==this&&a.splice(d,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");
return this},_setOption:function(a,d){"accept"==a&&(this.accept=f.isFunction(d)?d:function(a){return a.is(d)});f.Widget.prototype._setOption.apply(this,arguments)},_activate:function(a){var d=f.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);d&&this._trigger("activate",a,this.ui(d))},_deactivate:function(a){var d=f.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);d&&this._trigger("deactivate",a,this.ui(d))},
_over:function(a){var d=f.ui.ddmanager.current;if(d&&(d.currentItem||d.element)[0]!=this.element[0])if(this.accept.call(this.element[0],d.currentItem||d.element))this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",a,this.ui(d))},_out:function(a){var d=f.ui.ddmanager.current;if(d&&(d.currentItem||d.element)[0]!=this.element[0])if(this.accept.call(this.element[0],d.currentItem||d.element))this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),
this._trigger("out",a,this.ui(d))},_drop:function(a,d){var c=d||f.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return!1;var b=!1;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var a=f.data(this,"droppable");if(a.options.greedy&&!a.options.disabled&&a.options.scope==c.options.scope&&a.accept.call(a.element[0],c.currentItem||c.element)&&f.ui.intersect(c,f.extend(a,{offset:a.element.offset()}),a.options.tolerance))return b=!0,!1});return b?
!1:this.accept.call(this.element[0],c.currentItem||c.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",a,this.ui(c)),this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});f.ui.intersect=function(a,d,c){if(!d.offset)return!1;var b=(a.positionAbs||a.position.absolute).left,l=b+a.helperProportions.width,
m=(a.positionAbs||a.position.absolute).top,g=m+a.helperProportions.height,k=d.offset.left,e=k+d.proportions.width,p=d.offset.top,o=p+d.proportions.height;switch(c){case "fit":return k<=b&&l<=e&&p<=m&&g<=o;case "intersect":return k<b+a.helperProportions.width/2&&l-a.helperProportions.width/2<e&&p<m+a.helperProportions.height/2&&g-a.helperProportions.height/2<o;case "pointer":return f.ui.isOver((a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,(a.positionAbs||a.position.absolute).left+
(a.clickOffset||a.offset.click).left,p,k,d.proportions.height,d.proportions.width);case "touch":return(m>=p&&m<=o||g>=p&&g<=o||m<p&&g>o)&&(b>=k&&b<=e||l>=k&&l<=e||b<k&&l>e);default:return!1}};f.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(a,d){var c=f.ui.ddmanager.droppables[a.options.scope]||[],b=d?d.type:null,l=(a.currentItem||a.element).find(":data(droppable)").andSelf(),m=0;a:for(;m<c.length;m++)if(!(c[m].options.disabled||a&&!c[m].accept.call(c[m].element[0],a.currentItem||
a.element))){for(var g=0;g<l.length;g++)if(l[g]==c[m].element[0]){c[m].proportions.height=0;continue a}c[m].visible="none"!=c[m].element.css("display");c[m].visible&&("mousedown"==b&&c[m]._activate.call(c[m],d),c[m].offset=c[m].element.offset(),c[m].proportions={width:c[m].element[0].offsetWidth,height:c[m].element[0].offsetHeight})}},drop:function(a,d){var c=!1;f.each(f.ui.ddmanager.droppables[a.options.scope]||[],function(){if(this.options&&(!this.options.disabled&&(this.visible&&f.ui.intersect(a,
this,this.options.tolerance))&&(c=c||this._drop.call(this,d)),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],a.currentItem||a.element)))this.isout=1,this.isover=0,this._deactivate.call(this,d)});return c},dragStart:function(a,d){a.element.parentsUntil("body").bind("scroll.droppable",function(){a.options.refreshPositions||f.ui.ddmanager.prepareOffsets(a,d)})},drag:function(a,d){a.options.refreshPositions&&f.ui.ddmanager.prepareOffsets(a,d);f.each(f.ui.ddmanager.droppables[a.options.scope]||
[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var c=f.ui.intersect(a,this,this.options.tolerance);if(c=!c&&1==this.isover?"isout":c&&0==this.isover?"isover":null){var b;if(this.options.greedy){var l=this.element.parents(":data(droppable):eq(0)");l.length&&(b=f.data(l[0],"droppable"),b.greedyChild="isover"==c?1:0)}b&&"isover"==c&&(b.isover=0,b.isout=1,b._out.call(b,d));this[c]=1;this["isout"==c?"isover":"isout"]=0;this["isover"==c?"_over":"_out"].call(this,d);b&&"isout"==
c&&(b.isout=0,b.isover=1,b._over.call(b,d))}}})},dragStop:function(a,d){a.element.parentsUntil("body").unbind("scroll.droppable");a.options.refreshPositions||f.ui.ddmanager.prepareOffsets(a,d)}}})(j);(function(f){f.widget("ui.resizable",f.ui.mouse,{version:"1.9m6",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,
zIndex:1E3},_create:function(){var a=this,b=this.options;this.element.addClass("ui-resizable");f.extend(this,{_aspectRatio:!!b.aspectRatio,aspectRatio:b.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:b.helper||b.ghost||b.animate?b.helper||"ui-resizable-helper":null});this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(/relative/.test(this.element.css("position"))&&f.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"}),
this.element.wrap(f('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),
marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize());this.handles=b.handles||(!f(".ui-resizable-handle",
this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var d=this.handles.split(",");this.handles={};for(var m=0;m<d.length;m++){var g=f.trim(d[m]),k=f('<div class="ui-resizable-handle ui-resizable-'+g+'"></div>');/sw|se|ne|nw/.test(g)&&k.css({zIndex:++b.zIndex});
"se"==g&&k.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[g]=".ui-resizable-"+g;this.element.append(k)}}this._renderAxis=function(a){var a=a||this.element,b;for(b in this.handles){this.handles[b].constructor==String&&(this.handles[b]=f(this.handles[b],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var c=f(this.handles[b],this.element),g=0,g=/sw|ne|nw|se|n|s/.test(b)?c.outerHeight():c.outerWidth(),c=["padding",
/ne|nw|n/.test(b)?"Top":/se|sw|s/.test(b)?"Bottom":/^e$/.test(b)?"Right":"Left"].join("");a.css(c,g);this._proportionallyResize()}f(this.handles[b])}};this._renderAxis(this.element);this._handles=f(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!a.resizing){if(this.className)var b=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);a.axis=b&&b[1]?b[1]:"se"}});b.autoHide&&(this._handles.hide(),f(this.element).addClass("ui-resizable-autohide").hover(function(){if(!b.disabled){f(this).removeClass("ui-resizable-autohide");
a._handles.show()}},function(){if(!b.disabled&&!a.resizing){f(this).addClass("ui-resizable-autohide");a._handles.hide()}}));this._mouseInit()},destroy:function(){this._mouseDestroy();var a=function(a){f(a).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){a(this.element);var b=this.element;b.after(this.originalElement.css({position:b.css("position"),width:b.outerWidth(),
height:b.outerHeight(),top:b.css("top"),left:b.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);a(this.originalElement);return this},_mouseCapture:function(a){var b=!1,d;for(d in this.handles)f(this.handles[d])[0]==a.target&&(b=!0);return!this.options.disabled&&b},_mouseStart:function(c){var b=this.options,d=this.element.position(),m=this.element;this.resizing=!0;this.documentScroll={top:f(document).scrollTop(),left:f(document).scrollLeft()};(m.is(".ui-draggable")||
/absolute/.test(m.css("position")))&&m.css({position:"absolute",top:d.top,left:d.left});f.browser.opera&&/relative/.test(m.css("position"))&&m.css({position:"relative",top:"auto",left:"auto"});this._renderProxy();var d=a(this.helper.css("left")),g=a(this.helper.css("top"));b.containment&&(d+=f(b.containment).scrollLeft()||0,g+=f(b.containment).scrollTop()||0);this.offset=this.helper.offset();this.position={left:d,top:g};this.size=this._helper?{width:m.outerWidth(),height:m.outerHeight()}:{width:m.width(),
height:m.height()};this.originalSize=this._helper?{width:m.outerWidth(),height:m.outerHeight()}:{width:m.width(),height:m.height()};this.originalPosition={left:d,top:g};this.sizeDiff={width:m.outerWidth()-m.width(),height:m.outerHeight()-m.height()};this.originalMousePosition={left:c.pageX,top:c.pageY};this.aspectRatio="number"==typeof b.aspectRatio?b.aspectRatio:this.originalSize.width/this.originalSize.height||1;b=f(".ui-resizable-"+this.axis).css("cursor");f("body").css("cursor","auto"==b?this.axis+
"-resize":b);m.addClass("ui-resizable-resizing");this._propagate("start",c);return!0},_mouseDrag:function(a){var b=this.helper,d=this.originalMousePosition,f=this._change[this.axis];if(!f)return!1;d=f.apply(this,[a,a.pageX-d.left||0,a.pageY-d.top||0]);this._updateVirtualBoundaries(a.shiftKey);if(this._aspectRatio||a.shiftKey)d=this._updateRatio(d,a);d=this._respectSize(d,a);this._propagate("resize",a);b.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+
"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(d);this._trigger("resize",a,this.ui());return!1},_mouseStop:function(a){this.resizing=!1;var b=this.options;if(this._helper){var d=this._proportionallyResizeElements,m=d.length&&/textarea/i.test(d[0].nodeName),d=m&&f.ui.hasScroll(d[0],"left")?0:this.sizeDiff.height,m=m?0:this.sizeDiff.width,m={width:this.helper.width()-m,height:this.helper.height()-d},d=parseInt(this.element.css("left"),
10)+(this.position.left-this.originalPosition.left)||null,g=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;b.animate||this.element.css(f.extend(m,{top:g,left:d}));this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!b.animate&&this._proportionallyResize()}f("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",a);this._helper&&this.helper.remove();return!1},_updateVirtualBoundaries:function(a){var b=
this.options,l,f,g,b={minWidth:d(b.minWidth)?b.minWidth:0,maxWidth:d(b.maxWidth)?b.maxWidth:Infinity,minHeight:d(b.minHeight)?b.minHeight:0,maxHeight:d(b.maxHeight)?b.maxHeight:Infinity};if(this._aspectRatio||a)if(a=b.minHeight*this.aspectRatio,f=b.minWidth/this.aspectRatio,l=b.maxHeight*this.aspectRatio,g=b.maxWidth/this.aspectRatio,a>b.minWidth&&(b.minWidth=a),f>b.minHeight&&(b.minHeight=f),l<b.maxWidth&&(b.maxWidth=l),g<b.maxHeight)b.maxHeight=g;this._vBoundaries=b},_updateCache:function(a){this.offset=
this.helper.offset();d(a.left)&&(this.position.left=a.left);d(a.top)&&(this.position.top=a.top);d(a.height)&&(this.size.height=a.height);d(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,l=this.size,f=this.axis;d(a.height)?a.width=a.height*this.aspectRatio:d(a.width)&&(a.height=a.width/this.aspectRatio);"sw"==f&&(a.left=b.left+(l.width-a.width),a.top=null);"nw"==f&&(a.top=b.top+(l.height-a.height),a.left=b.left+(l.width-a.width));return a},_respectSize:function(a){var b=
this._vBoundaries,l=this.axis,f=d(a.width)&&b.maxWidth&&b.maxWidth<a.width,g=d(a.height)&&b.maxHeight&&b.maxHeight<a.height,k=d(a.width)&&b.minWidth&&b.minWidth>a.width,e=d(a.height)&&b.minHeight&&b.minHeight>a.height;k&&(a.width=b.minWidth);e&&(a.height=b.minHeight);f&&(a.width=b.maxWidth);g&&(a.height=b.maxHeight);var p=this.originalPosition.left+this.originalSize.width,o=this.position.top+this.size.height,r=/sw|nw|w/.test(l),l=/nw|ne|n/.test(l);k&&r&&(a.left=p-b.minWidth);f&&r&&(a.left=p-b.maxWidth);
e&&l&&(a.top=o-b.minHeight);g&&l&&(a.top=o-b.maxHeight);(b=!a.width&&!a.height)&&!a.left&&a.top?a.top=null:b&&(!a.top&&a.left)&&(a.left=null);return a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var a=this.helper||this.element,b=0;b<this._proportionallyResizeElements.length;b++){var d=this._proportionallyResizeElements[b];if(!this.borderDif){var m=[d.css("borderTopWidth"),d.css("borderRightWidth"),d.css("borderBottomWidth"),d.css("borderLeftWidth")],g=[d.css("paddingTop"),
d.css("paddingRight"),d.css("paddingBottom"),d.css("paddingLeft")];this.borderDif=f.map(m,function(a,b){var c=parseInt(a,10)||0,d=parseInt(g[b],10)||0;return c+d})}if(!f.browser.msie||!f(a).is(":hidden")&&!f(a).parents(":hidden").length)d.css({height:a.height()-this.borderDif[0]-this.borderDif[2]||0,width:a.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var a=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||f('<div style="overflow:hidden;"></div>');
var b=f.browser.msie&&7>f.browser.version,d=b?1:0,b=b?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+b,height:this.element.outerHeight()+b,position:"absolute",left:this.elementOffset.left-d+"px",top:this.elementOffset.top-d+"px",zIndex:++a.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){return{left:this.originalPosition.left+b,width:this.originalSize.width-
b}},n:function(a,b,d){return{top:this.originalPosition.top+d,height:this.originalSize.height-d}},s:function(a,b,d){return{height:this.originalSize.height+d}},se:function(a,b,d){return f.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[a,b,d]))},sw:function(a,b,d){return f.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[a,b,d]))},ne:function(a,b,d){return f.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[a,b,d]))},nw:function(a,b,
d){return f.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[a,b,d]))}},_propagate:function(a,b){f.ui.plugin.call(this,a,[b,this.ui()]);"resize"!=a&&this._trigger(a,b,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});f.ui.plugin.add("resizable","alsoResize",{start:function(){var a=f(this).data("resizable").options,
b=function(a){f(a).each(function(){var a=f(this);a.data("resizable-alsoresize",{width:parseInt(a.width(),10),height:parseInt(a.height(),10),left:parseInt(a.css("left"),10),top:parseInt(a.css("top"),10),position:a.css("position")})})};"object"==typeof a.alsoResize&&!a.alsoResize.parentNode?a.alsoResize.length?(a.alsoResize=a.alsoResize[0],b(a.alsoResize)):f.each(a.alsoResize,function(a){b(a)}):b(a.alsoResize)},resize:function(a,b){var d=f(this).data("resizable"),m=d.options,g=d.originalSize,k=d.originalPosition,
e={height:d.size.height-g.height||0,width:d.size.width-g.width||0,top:d.position.top-k.top||0,left:d.position.left-k.left||0},p=function(a,c){f(a).each(function(){var a=f(this),g=f(this).data("resizable-alsoresize"),k={},m=c&&c.length?c:a.parents(b.originalElement[0]).length?["width","height"]:["width","height","top","left"];f.each(m,function(a,b){var c=(g[b]||0)+(e[b]||0);c&&0<=c&&(k[b]=c||null)});f.browser.opera&&/relative/.test(a.css("position"))&&(d._revertToRelativePosition=!0,a.css({position:"absolute",
top:"auto",left:"auto"}));a.css(k)})};"object"==typeof m.alsoResize&&!m.alsoResize.nodeType?f.each(m.alsoResize,function(a,b){p(a,b)}):p(m.alsoResize)},stop:function(){var a=f(this).data("resizable"),b=a.options,d=function(a){f(a).each(function(){var a=f(this);a.css({position:a.data("resizable-alsoresize").position})})};a._revertToRelativePosition&&(a._revertToRelativePosition=!1,"object"==typeof b.alsoResize&&!b.alsoResize.nodeType?f.each(b.alsoResize,function(a){d(a)}):d(b.alsoResize));f(this).removeData("resizable-alsoresize")}});
f.ui.plugin.add("resizable","animate",{stop:function(a){var b=f(this).data("resizable"),d=b.options,m=b._proportionallyResizeElements,g=m.length&&/textarea/i.test(m[0].nodeName),k=g&&f.ui.hasScroll(m[0],"left")?0:b.sizeDiff.height,g={width:b.size.width-(g?0:b.sizeDiff.width),height:b.size.height-k},k=parseInt(b.element.css("left"),10)+(b.position.left-b.originalPosition.left)||null,e=parseInt(b.element.css("top"),10)+(b.position.top-b.originalPosition.top)||null;b.element.animate(f.extend(g,e&&k?
{top:e,left:k}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var e={width:parseInt(b.element.css("width"),10),height:parseInt(b.element.css("height"),10),top:parseInt(b.element.css("top"),10),left:parseInt(b.element.css("left"),10)};m&&m.length&&f(m[0]).css({width:e.width,height:e.height});b._updateCache(e);b._propagate("resize",a)}})}});f.ui.plugin.add("resizable","containment",{start:function(){var c=f(this).data("resizable"),b=c.element,d=c.options.containment;if(b=d instanceof
f?d.get(0):/parent/.test(d)?b.parent().get(0):d)if(c.containerElement=f(b),/document/.test(d)||d==document)c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:f(document),left:0,top:0,width:f(document).width(),height:f(document).height()||document.body.parentNode.scrollHeight};else{var m=f(b),g=[];f(["Top","Right","Left","Bottom"]).each(function(b,e){g[b]=a(m.css("padding"+e))});c.containerOffset=m.offset();c.containerPosition=m.position();c.containerSize={height:m.innerHeight()-
g[3],width:m.innerWidth()-g[1]};var d=c.containerOffset,k=c.containerSize.height,e=c.containerSize.width,e=f.ui.hasScroll(b,"left")?b.scrollWidth:e,k=f.ui.hasScroll(b)?b.scrollHeight:k;c.parentData={element:b,left:d.left,top:d.top,width:e,height:k}}},resize:function(a){var b=f(this).data("resizable"),d=b.options,m=b.containerOffset,g=b.position,a=b._aspectRatio||a.shiftKey,k={top:0,left:0},e=b.containerElement;e[0]!=document&&/static/.test(e.css("position"))&&(k=m);if(g.left<(b._helper?m.left:0))b.size.width+=
b._helper?b.position.left-m.left:b.position.left-k.left,a&&(b.size.height=b.size.width/d.aspectRatio),b.position.left=d.helper?m.left:0;if(g.top<(b._helper?m.top:0))b.size.height+=b._helper?b.position.top-m.top:b.position.top,a&&(b.size.width=b.size.height*d.aspectRatio),b.position.top=b._helper?m.top:0;b.offset.left=b.parentData.left+b.position.left;b.offset.top=b.parentData.top+b.position.top;d=Math.abs(b.offset.left-k.left+b.sizeDiff.width);m=Math.abs((b._helper?b.offset.top-k.top:b.offset.top-
m.top)+b.sizeDiff.height);g=b.containerElement.get(0)==b.element.parent().get(0);k=/relative|absolute/.test(b.containerElement.css("position"));g&&k&&(d-=b.parentData.left);d+b.size.width>=b.parentData.width&&(b.size.width=b.parentData.width-d,a&&(b.size.height=b.size.width/b.aspectRatio));m+b.size.height>=b.parentData.height&&(b.size.height=b.parentData.height-m,a&&(b.size.width=b.size.height*b.aspectRatio))},stop:function(){var a=f(this).data("resizable"),b=a.options,d=a.containerOffset,m=a.containerPosition,
g=a.containerElement,k=f(a.helper),e=k.offset(),p=k.outerWidth()-a.sizeDiff.width,k=k.outerHeight()-a.sizeDiff.height;a._helper&&(!b.animate&&/relative/.test(g.css("position")))&&f(this).css({left:e.left-m.left-d.left,width:p,height:k});a._helper&&(!b.animate&&/static/.test(g.css("position")))&&f(this).css({left:e.left-m.left-d.left,width:p,height:k})}});f.ui.plugin.add("resizable","ghost",{start:function(){var a=f(this).data("resizable"),b=a.options,d=a.size;a.ghost=a.originalElement.clone();a.ghost.css({opacity:0.25,
display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof b.ghost?b.ghost:"");a.ghost.appendTo(a.helper)},resize:function(){var a=f(this).data("resizable");a.ghost&&a.ghost.css({position:"relative",height:a.size.height,width:a.size.width})},stop:function(){var a=f(this).data("resizable");a.ghost&&a.helper&&a.helper.get(0).removeChild(a.ghost.get(0))}});f.ui.plugin.add("resizable","grid",{resize:function(){var a=
f(this).data("resizable"),b=a.options,d=a.size,m=a.originalSize,g=a.originalPosition,k=a.axis;b.grid="number"==typeof b.grid?[b.grid,b.grid]:b.grid;var e=Math.round((d.width-m.width)/(b.grid[0]||1))*(b.grid[0]||1),b=Math.round((d.height-m.height)/(b.grid[1]||1))*(b.grid[1]||1);/^(se|s|e)$/.test(k)?(a.size.width=m.width+e,a.size.height=m.height+b):/^(ne)$/.test(k)?(a.size.width=m.width+e,a.size.height=m.height+b,a.position.top=g.top-b):(/^(sw)$/.test(k)?(a.size.width=m.width+e,a.size.height=m.height+
b):(a.size.width=m.width+e,a.size.height=m.height+b,a.position.top=g.top-b),a.position.left=g.left-e)}});var a=function(a){return parseInt(a,10)||0},d=function(a){return!isNaN(parseInt(a,10))}})(j);(function(f){f.widget("ui.selectable",f.ui.mouse,{version:"1.9m6",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var a=this;this.element.addClass("ui-selectable");this.dragged=!1;var d;this.refresh=function(){d=f(a.options.filter,a.element[0]);d.each(function(){var a=
f(this),b=a.offset();f.data(this,"selectable-item",{element:this,$element:a,left:b.left,top:b.top,right:b.left+a.outerWidth(),bottom:b.top+a.outerHeight(),startselected:!1,selected:a.hasClass("ui-selected"),selecting:a.hasClass("ui-selecting"),unselecting:a.hasClass("ui-unselecting")})})};this.refresh();this.selectees=d.addClass("ui-selectee");this._mouseInit();this.helper=f("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");
this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(a){var d=this;this.opos=[a.pageX,a.pageY];if(!this.options.disabled){var c=this.options;this.selectees=f(c.filter,this.element[0]);this._trigger("start",a);f(c.appendTo).append(this.helper);this.helper.css({left:a.clientX,top:a.clientY,width:0,height:0});c.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var b=
f.data(this,"selectable-item");b.startselected=!0;a.metaKey||(b.$element.removeClass("ui-selected"),b.selected=!1,b.$element.addClass("ui-unselecting"),b.unselecting=!0,d._trigger("unselecting",a,{unselecting:b.element}))});f(a.target).parents().andSelf().each(function(){var b=f.data(this,"selectable-item");if(b){var c=!a.metaKey||!b.$element.hasClass("ui-selected");b.$element.removeClass(c?"ui-unselecting":"ui-selected").addClass(c?"ui-selecting":"ui-unselecting");b.unselecting=!c;b.selecting=c;
(b.selected=c)?d._trigger("selecting",a,{selecting:b.element}):d._trigger("unselecting",a,{unselecting:b.element});return!1}})}},_mouseDrag:function(a){var d=this;this.dragged=!0;if(!this.options.disabled){var c=this.options,b=this.opos[0],l=this.opos[1],m=a.pageX,g=a.pageY;if(b>m)var k=m,m=b,b=k;l>g&&(k=g,g=l,l=k);this.helper.css({left:b,top:l,width:m-b,height:g-l});this.selectees.each(function(){var e=f.data(this,"selectable-item");if(e&&e.element!=d.element[0]){var k=false;c.tolerance=="touch"?
k=!(e.left>m||e.right<b||e.top>g||e.bottom<l):c.tolerance=="fit"&&(k=e.left>b&&e.right<m&&e.top>l&&e.bottom<g);if(k){if(e.selected){e.$element.removeClass("ui-selected");e.selected=false}if(e.unselecting){e.$element.removeClass("ui-unselecting");e.unselecting=false}if(!e.selecting){e.$element.addClass("ui-selecting");e.selecting=true;d._trigger("selecting",a,{selecting:e.element})}}else{if(e.selecting)if(a.metaKey&&e.startselected){e.$element.removeClass("ui-selecting");e.selecting=false;e.$element.addClass("ui-selected");
e.selected=true}else{e.$element.removeClass("ui-selecting");e.selecting=false;if(e.startselected){e.$element.addClass("ui-unselecting");e.unselecting=true}d._trigger("unselecting",a,{unselecting:e.element})}if(e.selected&&!a.metaKey&&!e.startselected){e.$element.removeClass("ui-selected");e.selected=false;e.$element.addClass("ui-unselecting");e.unselecting=true;d._trigger("unselecting",a,{unselecting:e.element})}}}});return!1}},_mouseStop:function(a){var d=this;this.dragged=!1;f(".ui-unselecting",
this.element[0]).each(function(){var c=f.data(this,"selectable-item");c.$element.removeClass("ui-unselecting");c.unselecting=!1;c.startselected=!1;d._trigger("unselected",a,{unselected:c.element})});f(".ui-selecting",this.element[0]).each(function(){var c=f.data(this,"selectable-item");c.$element.removeClass("ui-selecting").addClass("ui-selected");c.selecting=!1;c.selected=!0;c.startselected=!0;d._trigger("selected",a,{selected:c.element})});this._trigger("stop",a);this.helper.remove();return!1}})})(j);
(function(f){f.widget("ui.sortable",f.ui.mouse,{version:"1.9m6",widgetEventPrefix:"sort",options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");
this.refresh();this.floating=this.items.length?"x"===a.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData("sortable-item");return this},_setOption:function(a,d){"disabled"===
a?(this.options[a]=d,this.widget().toggleClass("ui-sortable-disabled",!!d)):f.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(a,d){if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(a);var c=null,b=this;f(a.target).parents().each(function(){if(f.data(this,"sortable-item")==b)return c=f(this),!1});f.data(a.target,"sortable-item")==b&&(c=f(a.target));if(!c)return!1;if(this.options.handle&&!d){var l=!1;f(this.options.handle,c).find("*").andSelf().each(function(){this==
a.target&&(l=!0)});if(!l)return!1}this.currentItem=c;this._removeCurrentsFromItems();return!0},_mouseStart:function(a,d,c){d=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(a);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=
this.helper.css("position");f.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();
d.containment&&this._setContainment();d.cursor&&(f("body").css("cursor")&&(this._storedCursor=f("body").css("cursor")),f("body").css("cursor",d.cursor));d.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",d.opacity));d.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",d.zIndex));this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());
this._trigger("start",a,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!c)for(c=this.containers.length-1;0<=c;c--)this.containers[c]._trigger("activate",a,this._uiHash(this));f.ui.ddmanager&&(f.ui.ddmanager.current=this);f.ui.ddmanager&&!d.dropBehaviour&&f.ui.ddmanager.prepareOffsets(this,a);this.dragging=!0;this.helper.addClass("ui-sortable-helper");this._mouseDrag(a);return!0},_mouseDrag:function(a){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");
this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var d=this.options,c=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<d.scrollSensitivity?this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop+d.scrollSpeed:a.pageY-this.overflowOffset.top<d.scrollSensitivity&&(this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop-d.scrollSpeed),this.overflowOffset.left+
this.scrollParent[0].offsetWidth-a.pageX<d.scrollSensitivity)?this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft+d.scrollSpeed:a.pageX-this.overflowOffset.left<d.scrollSensitivity&&(this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft-d.scrollSpeed):(a.pageY-f(document).scrollTop()<d.scrollSensitivity?c=f(document).scrollTop(f(document).scrollTop()-d.scrollSpeed):f(window).height()-(a.pageY-f(document).scrollTop())<d.scrollSensitivity&&(c=f(document).scrollTop(f(document).scrollTop()+
d.scrollSpeed)),a.pageX-f(document).scrollLeft()<d.scrollSensitivity?c=f(document).scrollLeft(f(document).scrollLeft()-d.scrollSpeed):f(window).width()-(a.pageX-f(document).scrollLeft())<d.scrollSensitivity&&(c=f(document).scrollLeft(f(document).scrollLeft()+d.scrollSpeed)));!1!==c&&(f.ui.ddmanager&&!d.dropBehaviour)&&f.ui.ddmanager.prepareOffsets(this,a)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+
"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(d=this.items.length-1;0<=d;d--){var c=this.items[d],b=c.item[0],l=this._intersectsWithPointer(c);if(l&&b!=this.currentItem[0]&&this.placeholder[1==l?"next":"prev"]()[0]!=b&&!f.contains(this.placeholder[0],b)&&("semi-dynamic"==this.options.type?!f.contains(this.element[0],b):1)){this.direction=1==l?"down":"up";if("pointer"==this.options.tolerance||this._intersectsWithSides(c))this._rearrange(a,c);
else break;this._trigger("change",a,this._uiHash());break}}this._contactContainers(a);f.ui.ddmanager&&f.ui.ddmanager.drag(this,a);this._trigger("sort",a,this._uiHash());this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(a,d){if(a){f.ui.ddmanager&&!this.options.dropBehaviour&&f.ui.ddmanager.drop(this,a);if(this.options.revert){var c=this,b=c.placeholder.offset();c.reverting=!0;f(this.helper).animate({left:b.left-this.offset.parent.left-c.margins.left+(this.offsetParent[0]==document.body?
0:this.offsetParent[0].scrollLeft),top:b.top-this.offset.parent.top-c.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){c._clear(a)})}else this._clear(a,d);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var a=this.containers.length-1;0<=a;a--)this.containers[a]._trigger("deactivate",
null,this._uiHash(this)),this.containers[a].containerCache.over&&(this.containers[a]._trigger("out",null,this._uiHash(this)),this.containers[a].containerCache.over=0)}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&(this.helper&&this.helper[0].parentNode)&&this.helper.remove(),f.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?f(this.domPosition.prev).after(this.currentItem):
f(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(a){var d=this._getItemsAsjQuery(a&&a.connected),c=[],a=a||{};f(d).each(function(){var b=(f(a.item||this).attr(a.attribute||"id")||"").match(a.expression||/(.+)[-=_](.+)/);b&&c.push((a.key||b[1]+"[]")+"="+(a.key&&a.expression?b[1]:b[2]))});!c.length&&a.key&&c.push(a.key+"=");return c.join("&")},toArray:function(a){var d=this._getItemsAsjQuery(a&&a.connected),c=[],a=a||{};d.each(function(){c.push(f(a.item||this).attr(a.attribute||
"id")||"")});return c},_intersectsWith:function(a){var d=this.positionAbs.left,c=d+this.helperProportions.width,b=this.positionAbs.top,l=b+this.helperProportions.height,f=a.left,g=f+a.width,k=a.top,e=k+a.height,p=this.offset.click.top,o=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?b+p>k&&b+p<e&&d+o>f&&d+o<g:f<d+this.helperProportions.width/
2&&c-this.helperProportions.width/2<g&&k<b+this.helperProportions.height/2&&l-this.helperProportions.height/2<e},_intersectsWithPointer:function(a){var d=f.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height),a=f.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width),d=d&&a,a=this._getDragVerticalDirection(),c=this._getDragHorizontalDirection();return!d?!1:this.floating?c&&"right"==c||"down"==a?2:1:a&&("down"==a?2:1)},_intersectsWithSides:function(a){var d=
f.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),a=f.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),c=this._getDragVerticalDirection(),b=this._getDragHorizontalDirection();return this.floating&&b?"right"==b&&a||"left"==b&&!a:c&&("down"==c&&d||"up"==c&&!d)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!=a&&(0<a?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-
this.lastPositionAbs.left;return 0!=a&&(0<a?"right":"left")},refresh:function(a){this._refreshItems(a);this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(a){var d=[],c=[],b=this._connectWith();if(b&&a)for(a=b.length-1;0<=a;a--)for(var l=f(b[a]),m=l.length-1;0<=m;m--){var g=f.data(l[m],"sortable");g&&(g!=this&&!g.options.disabled)&&c.push([f.isFunction(g.options.items)?g.options.items.call(g.element):
f(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g])}c.push([f.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):f(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(a=c.length-1;0<=a;a--)c[a][0].each(function(){d.push(this)});return f(d)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data(sortable-item)"),d=0;d<this.items.length;d++)for(var c=
0;c<a.length;c++)a[c]==this.items[d].item[0]&&this.items.splice(d,1)},_refreshItems:function(a){this.items=[];this.containers=[this];var d=this.items,c=[[f.isFunction(this.options.items)?this.options.items.call(this.element[0],a,{item:this.currentItem}):f(this.options.items,this.element),this]],b=this._connectWith();if(b)for(var l=b.length-1;0<=l;l--)for(var m=f(b[l]),g=m.length-1;0<=g;g--){var k=f.data(m[g],"sortable");k&&(k!=this&&!k.options.disabled)&&(c.push([f.isFunction(k.options.items)?k.options.items.call(k.element[0],
a,{item:this.currentItem}):f(k.options.items,k.element),k]),this.containers.push(k))}for(l=c.length-1;0<=l;l--){a=c[l][1];b=c[l][0];g=0;for(m=b.length;g<m;g++)k=f(b[g]),k.data("sortable-item",a),d.push({item:k,instance:a,width:0,height:0,left:0,top:0})}},refreshPositions:function(a){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var d=this.items.length-1;0<=d;d--){var c=this.items[d];if(!(c.instance!=this.currentContainer&&this.currentContainer&&c.item[0]!=this.currentItem[0])){var b=
this.options.toleranceElement?f(this.options.toleranceElement,c.item):c.item;a||(c.width=b.outerWidth(),c.height=b.outerHeight());b=b.offset();c.left=b.left;c.top=b.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(d=this.containers.length-1;0<=d;d--)b=this.containers[d].element.offset(),this.containers[d].containerCache.left=b.left,this.containers[d].containerCache.top=b.top,this.containers[d].containerCache.width=this.containers[d].element.outerWidth(),
this.containers[d].containerCache.height=this.containers[d].element.outerHeight();return this},_createPlaceholder:function(a){var d=a||this,c=d.options;if(!c.placeholder||c.placeholder.constructor==String){var b=c.placeholder;c.placeholder={element:function(){var a=f(document.createElement(d.currentItem[0].nodeName)).addClass(b||d.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];b||(a.style.visibility="hidden");return a},update:function(a,f){if(!b||c.forcePlaceholderSize)f.height()||
f.height(d.currentItem.innerHeight()-parseInt(d.currentItem.css("paddingTop")||0,10)-parseInt(d.currentItem.css("paddingBottom")||0,10)),f.width()||f.width(d.currentItem.innerWidth()-parseInt(d.currentItem.css("paddingLeft")||0,10)-parseInt(d.currentItem.css("paddingRight")||0,10))}}}d.placeholder=f(c.placeholder.element.call(d.element,d.currentItem));d.currentItem.after(d.placeholder);c.placeholder.update(d,d.placeholder)},_contactContainers:function(a){for(var d=null,c=null,b=this.containers.length-
1;0<=b;b--)if(!f.contains(this.currentItem[0],this.containers[b].element[0]))if(this._intersectsWith(this.containers[b].containerCache)){if(!d||!f.contains(this.containers[b].element[0],d.element[0]))d=this.containers[b],c=b}else this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",a,this._uiHash(this)),this.containers[b].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[c]._trigger("over",a,this._uiHash(this)),this.containers[c].containerCache.over=1;
else if(this.currentContainer!=this.containers[c]){for(var d=1E4,b=null,l=this.positionAbs[this.containers[c].floating?"left":"top"],m=this.items.length-1;0<=m;m--)if(f.contains(this.containers[c].element[0],this.items[m].item[0])){var g=this.items[m][this.containers[c].floating?"left":"top"];Math.abs(g-l)<d&&(d=Math.abs(g-l),b=this.items[m])}if(b||this.options.dropOnEmpty)this.currentContainer=this.containers[c],b?this._rearrange(a,b,null,!0):this._rearrange(a,null,this.containers[c].element,!0),
this._trigger("change",a,this._uiHash()),this.containers[c]._trigger("change",a,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[c]._trigger("over",a,this._uiHash(this)),this.containers[c].containerCache.over=1}},_createHelper:function(a){var d=this.options,a=f.isFunction(d.helper)?f(d.helper.apply(this.element[0],[a,this.currentItem])):"clone"==d.helper?this.currentItem.clone():this.currentItem;a.parents("body").length||f("parent"!=d.appendTo?
d.appendTo:this.currentItem[0].parentNode)[0].appendChild(a[0]);a[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")});(""==a[0].style.width||d.forceHelperSize)&&a.width(this.currentItem.width());(""==a[0].style.height||d.forceHelperSize)&&a.height(this.currentItem.height());return a},_adjustOffsetFromHelper:function(a){"string"==
typeof a&&(a=a.split(" "));f.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();"absolute"==this.cssPosition&&
(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0]))&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&f.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==
this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},
_setContainment:function(){var a=this.options;"parent"==a.containment&&(a.containment=this.helper[0].parentNode);if("document"==a.containment||"window"==a.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,f("document"==a.containment?document:window).width()-this.helperProportions.width-this.margins.left,(f("document"==a.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-
this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)){var d=f(a.containment)[0],a=f(a.containment).offset(),c="hidden"!=f(d).css("overflow");this.containment=[a.left+(parseInt(f(d).css("borderLeftWidth"),10)||0)+(parseInt(f(d).css("paddingLeft"),10)||0)-this.margins.left,a.top+(parseInt(f(d).css("borderTopWidth"),10)||0)+(parseInt(f(d).css("paddingTop"),10)||0)-this.margins.top,a.left+(c?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(f(d).css("borderLeftWidth"),10)||
0)-(parseInt(f(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,a.top+(c?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(f(d).css("borderTopWidth"),10)||0)-(parseInt(f(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(a,d){d||(d=this.position);var c="absolute"==a?1:-1,b="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:
this.scrollParent,l=/(html|body)/i.test(b[0].tagName);return{top:d.top+this.offset.relative.top*c+this.offset.parent.top*c-(f.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():l?0:b.scrollTop())*c),left:d.left+this.offset.relative.left*c+this.offset.parent.left*c-(f.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():l?0:b.scrollLeft())*c)}},_generatePosition:function(a){var d=this.options,c="absolute"==
this.cssPosition&&!(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,b=/(html|body)/i.test(c[0].tagName);"relative"==this.cssPosition&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var l=a.pageX,m=a.pageY;if(this.originalPosition&&(this.containment&&(a.pageX-this.offset.click.left<this.containment[0]&&(l=this.containment[0]+this.offset.click.left),
a.pageY-this.offset.click.top<this.containment[1]&&(m=this.containment[1]+this.offset.click.top),a.pageX-this.offset.click.left>this.containment[2]&&(l=this.containment[2]+this.offset.click.left),a.pageY-this.offset.click.top>this.containment[3]&&(m=this.containment[3]+this.offset.click.top)),d.grid))m=this.originalPageY+Math.round((m-this.originalPageY)/d.grid[1])*d.grid[1],m=this.containment?!(m-this.offset.click.top<this.containment[1]||m-this.offset.click.top>this.containment[3])?m:!(m-this.offset.click.top<
this.containment[1])?m-d.grid[1]:m+d.grid[1]:m,l=this.originalPageX+Math.round((l-this.originalPageX)/d.grid[0])*d.grid[0],l=this.containment?!(l-this.offset.click.left<this.containment[0]||l-this.offset.click.left>this.containment[2])?l:!(l-this.offset.click.left<this.containment[0])?l-d.grid[0]:l+d.grid[0]:l;return{top:m-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(f.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():b?
0:c.scrollTop()),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(f.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():b?0:c.scrollLeft())}},_rearrange:function(a,d,c,b){c?c[0].appendChild(this.placeholder[0]):d.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?d.item[0]:d.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var l=this,f=this.counter;window.setTimeout(function(){f==
l.counter&&l.refreshPositions(!b)},0)},_clear:function(a,d){this.reverting=!1;var c=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var b in this._storedCSS)if("auto"==this._storedCSS[b]||"static"==this._storedCSS[b])this._storedCSS[b]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!d&&c.push(function(a){this._trigger("receive",
a,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!d&&c.push(function(a){this._trigger("update",a,this._uiHash())});if(!f.contains(this.element[0],this.currentItem[0])){d||c.push(function(a){this._trigger("remove",a,this._uiHash())});for(b=this.containers.length-1;0<=b;b--)f.contains(this.containers[b].element[0],this.currentItem[0])&&!d&&(c.push(function(a){return function(b){a._trigger("receive",
b,this._uiHash(this))}}.call(this,this.containers[b])),c.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.containers[b])))}for(b=this.containers.length-1;0<=b;b--)d||c.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[b])),this.containers[b].containerCache.over&&(c.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[b])),this.containers[b].containerCache.over=
0);this._storedCursor&&f("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!d){this._trigger("beforeStop",a,this._uiHash());for(b=0;b<c.length;b++)c[b].call(this,a);this._trigger("stop",a,this._uiHash())}return!1}d||this._trigger("beforeStop",a,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!d){for(b=0;b<c.length;b++)c[b].call(this,a);this._trigger("stop",a,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){!1===f.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(a){var d=a||this;return{helper:d.helper,placeholder:d.placeholder||f([]),position:d.position,originalPosition:d.originalPosition,offset:d.positionAbs,item:d.currentItem,sender:a?a.element:null}}})})(j);
j.effects||function(f,a){function d(a){var b;return a&&a.constructor===Array&&3===a.length?a:(b=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a))?[parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10)]:(b=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(a))?[2.55*parseFloat(b[1]),2.55*parseFloat(b[2]),2.55*parseFloat(b[3])]:(b=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a))?[parseInt(b[1],16),parseInt(b[2],
16),parseInt(b[3],16)]:(b=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(a))?[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]:/rgba\(0, 0, 0, 0\)/.exec(a)?g.transparent:g[f.trim(a).toLowerCase()]}function c(){var a=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,b={},e,c;if(a&&a.length&&a[0]&&a[a[0]])for(c=a.length;c--;)e=a[c],"string"===typeof a[e]&&(b[f.camelCase(e)]=a[e]);else for(e in a)"string"===typeof a[e]&&(b[e]=a[e]);return b}
function b(b,e,c,g){if(f.isPlainObject(b))return b;b={effect:b};e===a&&(e={});f.isFunction(e)&&(g=e,c=null,e={});if("number"===f.type(e)||f.fx.speeds[e])g=c,c=e,e={};f.isFunction(c)&&(g=c,c=null);e&&f.extend(b,e);c=c||e.duration;b.duration=f.fx.off?0:"number"===typeof c?c:c in f.fx.speeds?f.fx.speeds[c]:f.fx.speeds._default;b.complete=g||e.complete;return b}function l(a){return!a||"number"===typeof a||f.fx.speeds[a]?!0:"string"===typeof a&&!f.effects.effect[a]?m&&f.effects[a]?!1:!0:!1}var m=!1!==
f.uiBackCompat;f.effects={effect:{}};f.each("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor borderColor color outlineColor".split(" "),function(a,b){f.fx.step[b]=function(a){if(!a.colorInit){var e;e=a.elem;var c=b,g;do{g=f.curCSS(e,c);if(g!=""&&g!=="transparent"||f.nodeName(e,"body"))break;c="backgroundColor"}while(e=e.parentNode);e=d(g);a.start=e;a.end=d(a.end);a.colorInit=true}a.elem.style[b]="rgb("+Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],
10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)+")"}});var g={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,
50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,
192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},k=["add","remove","toggle"],e={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};f.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(a,b){f.fx.step[b]=function(a){if("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)j.style(a.elem,b,a.end),a.setAttr=!0}});f.effects.animateClass=function(a,b,g,d){var l=f.speed(b,g,d);return this.queue(function(){var b=
f(this),g=b.attr("class"),d,m=l.children?b.find("*").andSelf():b,m=m.map(function(){var a=f(this);return{el:a,originalStyleAttr:a.attr("style")||" ",start:c.call(this)}});f.each(k,function(e,c){if(a[c])b[c+"Class"](a[c])});d=b.attr("class");m=m.map(function(){this.end=c.call(this.el[0]);var a=this.start,b=this.end,g={},k,d;for(k in b)if(d=b[k],a[k]!=d&&!e[k]&&(f.fx.step[k]||!isNaN(parseFloat(d))))g[k]=d;this.diff=g;return this});b.attr("class",g);m=m.map(function(){var a=this,b=f.Deferred();this.el.animate(this.diff,
{duration:l.duration,easing:l.easing,queue:!1,complete:function(){b.resolve(a)}});return b.promise()});f.when.apply(f,m.get()).done(function(){b.attr("class",d);f.each(arguments,function(){"object"===typeof this.el.attr("style")?(this.el.attr("style").cssText="",this.el.attr("style").cssText=this.originalStyleAttr):this.el.attr("style",this.originalStyleAttr)});l.complete.call(b[0])})})};f.fn.extend({_addClass:f.fn.addClass,addClass:function(a,b,e,c){return b?f.effects.animateClass.apply(this,[{add:a},
b,e,c]):this._addClass(a)},_removeClass:f.fn.removeClass,removeClass:function(a,b,e,c){return b?f.effects.animateClass.apply(this,[{remove:a},b,e,c]):this._removeClass(a)},_toggleClass:f.fn.toggleClass,toggleClass:function(b,e,c,g,k){return"boolean"===typeof e||e===a?c?f.effects.animateClass.apply(this,[e?{add:b}:{remove:b},c,g,k]):this._toggleClass(b,e):f.effects.animateClass.apply(this,[{toggle:b},e,c,g])},switchClass:function(a,b,e,c,g){return f.effects.animateClass.apply(this,[{add:b,remove:a},
e,c,g])}});f.extend(f.effects,{version:"1.9m6",save:function(a,b){for(var e=0;e<b.length;e++)null!==b[e]&&a.data("ec.storage."+b[e],a[0].style[b[e]])},restore:function(a,b){for(var e=0;e<b.length;e++)null!==b[e]&&a.css(b[e],a.data("ec.storage."+b[e]))},setMode:function(a,b){"toggle"===b&&(b=a.is(":hidden")?"show":"hide");return b},getBaseline:function(a,b){var e,c;switch(a[0]){case "top":e=0;break;case "middle":e=0.5;break;case "bottom":e=1;break;default:e=a[0]/b.height}switch(a[1]){case "left":c=
0;break;case "center":c=0.5;break;case "right":c=1;break;default:c=a[1]/b.width}return{x:c,y:e}},createWrapper:function(a){if(a.parent().is(".ui-effects-wrapper"))return a.parent();var b={width:a.outerWidth(!0),height:a.outerHeight(!0),"float":a.css("float")},e=f("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),c={width:a.width(),height:a.height()},g=document.activeElement;a.wrap(e);(a[0]===g||f.contains(a[0],g))&&f(g).focus();
e=a.parent();"static"===a.css("position")?(e.css({position:"relative"}),a.css({position:"relative"})):(f.extend(b,{position:a.css("position"),zIndex:a.css("z-index")}),f.each(["top","left","bottom","right"],function(e,c){b[c]=a.css(c);isNaN(parseInt(b[c],10))&&(b[c]="auto")}),a.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"}));a.css(c);return e.css(b).show()},removeWrapper:function(a){var b=document.activeElement;a.parent().is(".ui-effects-wrapper")&&(a.parent().replaceWith(a),(a[0]===
b||f.contains(a[0],b))&&f(b).focus());return a},setTransition:function(a,b,e,c){c=c||{};f.each(b,function(b,g){var k=a.cssUnit(g);0<k[0]&&(c[g]=k[0]*e+k[1])});return c}});f.fn.extend({effect:function(a,e,c,g){function k(a){function b(){f.isFunction(c)&&c.call(e[0]);f.isFunction(a)&&a()}var e=f(this),c=d.complete,g=d.mode;(e.is(":hidden")?"hide"===g:"show"===g)?b():x.call(e[0],d,b)}var d=b.apply(this,arguments),l=d.mode,j=d.queue,x=f.effects.effect[d.effect],y=!x&&m&&f.effects[d.effect];return f.fx.off||
!x&&!y?l?this[l](d.duration,d.complete):this.each(function(){d.complete&&d.complete.call(this)}):x?!1===j?this.each(k):this.queue(j||"fx",k):y.call(this,{options:d,duration:d.duration,callback:d.complete,mode:d.mode})},_show:f.fn.show,show:function(a){if(l(a))return this._show.apply(this,arguments);var e=b.apply(this,arguments);e.mode="show";return this.effect.call(this,e)},_hide:f.fn.hide,hide:function(a){if(l(a))return this._hide.apply(this,arguments);var e=b.apply(this,arguments);e.mode="hide";
return this.effect.call(this,e)},__toggle:f.fn.toggle,toggle:function(a){if(l(a)||"boolean"===typeof a||f.isFunction(a))return this.__toggle.apply(this,arguments);var e=b.apply(this,arguments);e.mode="toggle";return this.effect.call(this,e)},cssUnit:function(a){var b=this.css(a),e=[];f.each(["em","px","%","pt"],function(a,c){0<b.indexOf(c)&&(e=[parseFloat(b),c])});return e}});f.easing.jswing=f.easing.swing;f.extend(f.easing,{def:"easeOutQuad",swing:function(a,b,e,c,g){return f.easing[f.easing.def](a,
b,e,c,g)},easeInQuad:function(a,b,e,c,g){return c*(b/=g)*b+e},easeOutQuad:function(a,b,e,c,g){return-c*(b/=g)*(b-2)+e},easeInOutQuad:function(a,b,e,c,g){return 1>(b/=g/2)?c/2*b*b+e:-c/2*(--b*(b-2)-1)+e},easeInCubic:function(a,b,e,c,g){return c*(b/=g)*b*b+e},easeOutCubic:function(a,b,e,c,g){return c*((b=b/g-1)*b*b+1)+e},easeInOutCubic:function(a,b,e,c,g){return 1>(b/=g/2)?c/2*b*b*b+e:c/2*((b-=2)*b*b+2)+e},easeInQuart:function(a,b,e,c,g){return c*(b/=g)*b*b*b+e},easeOutQuart:function(a,b,e,c,g){return-c*
((b=b/g-1)*b*b*b-1)+e},easeInOutQuart:function(a,b,e,c,g){return 1>(b/=g/2)?c/2*b*b*b*b+e:-c/2*((b-=2)*b*b*b-2)+e},easeInQuint:function(a,b,e,c,g){return c*(b/=g)*b*b*b*b+e},easeOutQuint:function(a,b,e,c,g){return c*((b=b/g-1)*b*b*b*b+1)+e},easeInOutQuint:function(a,b,e,c,g){return 1>(b/=g/2)?c/2*b*b*b*b*b+e:c/2*((b-=2)*b*b*b*b+2)+e},easeInSine:function(a,b,e,c,g){return-c*Math.cos(b/g*(Math.PI/2))+c+e},easeOutSine:function(a,b,e,c,g){return c*Math.sin(b/g*(Math.PI/2))+e},easeInOutSine:function(a,
b,e,c,g){return-c/2*(Math.cos(Math.PI*b/g)-1)+e},easeInExpo:function(a,b,e,c,g){return 0==b?e:c*Math.pow(2,10*(b/g-1))+e},easeOutExpo:function(a,b,e,c,g){return b==g?e+c:c*(-Math.pow(2,-10*b/g)+1)+e},easeInOutExpo:function(a,b,e,c,g){return 0==b?e:b==g?e+c:1>(b/=g/2)?c/2*Math.pow(2,10*(b-1))+e:c/2*(-Math.pow(2,-10*--b)+2)+e},easeInCirc:function(a,b,e,c,g){return-c*(Math.sqrt(1-(b/=g)*b)-1)+e},easeOutCirc:function(a,b,e,c,g){return c*Math.sqrt(1-(b=b/g-1)*b)+e},easeInOutCirc:function(a,b,e,c,g){return 1>
(b/=g/2)?-c/2*(Math.sqrt(1-b*b)-1)+e:c/2*(Math.sqrt(1-(b-=2)*b)+1)+e},easeInElastic:function(a,b,e,c,g){var a=1.70158,k=0.3*g,d=c;if(0==b)return e;if(1==(b/=g))return e+c;d<Math.abs(c)?(d=c,a=k/4):a=k/(2*Math.PI)*Math.asin(c/d);return-(d*Math.pow(2,10*(b-=1))*Math.sin((b*g-a)*2*Math.PI/k))+e},easeOutElastic:function(a,b,e,c,g){var a=1.70158,k=0.3*g,d=c;if(0==b)return e;if(1==(b/=g))return e+c;d<Math.abs(c)?(d=c,a=k/4):a=k/(2*Math.PI)*Math.asin(c/d);return d*Math.pow(2,-10*b)*Math.sin((b*g-a)*2*Math.PI/
k)+c+e},easeInOutElastic:function(a,b,e,c,g){var a=1.70158,k=g*0.3*1.5,d=c;if(0==b)return e;if(2==(b/=g/2))return e+c;d<Math.abs(c)?(d=c,a=k/4):a=k/(2*Math.PI)*Math.asin(c/d);return 1>b?-0.5*d*Math.pow(2,10*(b-=1))*Math.sin((b*g-a)*2*Math.PI/k)+e:0.5*d*Math.pow(2,-10*(b-=1))*Math.sin((b*g-a)*2*Math.PI/k)+c+e},easeInBack:function(b,e,c,g,k,d){d==a&&(d=1.70158);return g*(e/=k)*e*((d+1)*e-d)+c},easeOutBack:function(b,e,c,g,k,d){d==a&&(d=1.70158);return g*((e=e/k-1)*e*((d+1)*e+d)+1)+c},easeInOutBack:function(b,
e,c,g,k,d){d==a&&(d=1.70158);return 1>(e/=k/2)?g/2*e*e*(((d*=1.525)+1)*e-d)+c:g/2*((e-=2)*e*(((d*=1.525)+1)*e+d)+2)+c},easeInBounce:function(a,b,e,c,g){return c-f.easing.easeOutBounce(a,g-b,0,c,g)+e},easeOutBounce:function(a,b,e,c,g){return(b/=g)<1/2.75?c*7.5625*b*b+e:b<2/2.75?c*(7.5625*(b-=1.5/2.75)*b+0.75)+e:b<2.5/2.75?c*(7.5625*(b-=2.25/2.75)*b+0.9375)+e:c*(7.5625*(b-=2.625/2.75)*b+0.984375)+e},easeInOutBounce:function(a,b,e,c,g){return b<g/2?0.5*f.easing.easeInBounce(a,2*b,0,c,g)+e:0.5*f.easing.easeOutBounce(a,
2*b-g,0,c,g)+0.5*c+e}})}(j);(function(f){var a=/up|down|vertical/,d=/up|left|vertical|horizontal/;f.effects.effect.blind=function(c,b){var l=f(this),m="position top bottom left right height width".split(" "),g=f.effects.setMode(l,c.mode||"hide"),k=c.direction||"up",e=a.test(k),p=e?"height":"width",o=e?"top":"left",k=d.test(k),j={},q="show"===g,u,t;l.parent().is(".ui-effects-wrapper")?f.effects.save(l.parent(),m):f.effects.save(l,m);l.show();u=f.effects.createWrapper(l).css({overflow:"hidden"});t=
u[p]();j[p]=q?t:0;k||(l.css(e?"bottom":"right",0).css(e?"top":"left","").css({position:"absolute"}),j[o]=q?0:t);q&&(u.css(p,0),k||u.css(o,t));u.animate(j,{duration:c.duration,easing:c.easing,queue:!1,complete:function(){g==="hide"&&l.hide();f.effects.restore(l,m);f.effects.removeWrapper(l);b()}})}})(j);(function(f){f.effects.effect.bounce=function(a,d){var c=f(this),b="position top bottom left right height width".split(" "),l=f.effects.setMode(c,a.mode||"effect"),m="hide"===l,g="show"===l,k=a.direction||
"up",l=a.distance,e=a.times||5,p=2*e+(g||m?1:0),o=a.duration/p,j=a.easing,q="up"===k||"down"===k?"top":"left",k="up"===k||"left"===k,u,t,v=c.queue(),z=v.length;(g||m)&&b.push("opacity");f.effects.save(c,b);c.show();f.effects.createWrapper(c);l||(l=c["top"===q?"outerHeight":"outerWidth"]()/3);g&&(t={opacity:1},t[q]=0,c.css("opacity",0).css(q,k?2*-l:2*l).animate(t,o,j));m&&(l/=Math.pow(2,e-1));t={};for(g=t[q]=0;g<e;g++)u={},u[q]=(k?"-=":"+=")+l,c.animate(u,o,j).animate(t,o,j),l=m?2*l:l/2;m&&(u={opacity:0},
u[q]=(k?"-=":"+=")+l,c.animate(u,o,j));c.queue(function(){m&&c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);d()});1<z&&v.splice.apply(v,[1,0].concat(v.splice(z,p+1)));c.dequeue()}})(j);(function(f){f.effects.effect.clip=function(a,d){var c=f(this),b="position top bottom left right height width".split(" "),l="show"===f.effects.setMode(c,a.mode||"hide"),m="vertical"===(a.direction||"vertical"),g=m?"height":"width",m=m?"top":"left",k={},e,p;f.effects.save(c,b);c.show();e=f.effects.createWrapper(c).css({overflow:"hidden"});
e="IMG"===c[0].tagName?e:c;p=e[g]();l&&(e.css(g,0),e.css(m,p/2));k[g]=l?p:0;k[m]=l?0:p/2;e.animate(k,{queue:!1,duration:a.duration,easing:a.easing,complete:function(){l||c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);d()}})}})(j);(function(f){f.effects.effect.drop=function(a,d){var c=f(this),b="position top bottom left right opacity height width".split(" "),l=f.effects.setMode(c,a.mode||"hide"),m="show"===l,g=a.direction||"left",k="up"===g||"down"===g?"top":"left",g="up"===g||"left"===
g?"pos":"neg",e={opacity:m?1:0},p;f.effects.save(c,b);c.show();f.effects.createWrapper(c);p=a.distance||c["top"==k?"outerHeight":"outerWidth"]({margin:!0})/2;m&&c.css("opacity",0).css(k,"pos"==g?-p:p);e[k]=(m?"pos"===g?"+=":"-=":"pos"===g?"-=":"+=")+p;c.animate(e,{queue:!1,duration:a.duration,easing:a.easing,complete:function(){"hide"==l&&c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);d()}})}})(j);(function(f){f.effects.effect.explode=function(a,d){function c(){o.push(this);o.length==
b*l&&(m.css({visibility:"visible"}),f(o).remove(),g||m.hide(),d())}var b=a.pieces?Math.round(Math.sqrt(a.pieces)):3,l=b,m=f(this),g="show"===f.effects.setMode(m,a.mode||"hide"),k=m.show().css("visibility","hidden").offset(),e=Math.ceil(m.outerWidth()/l),p=Math.ceil(m.outerHeight()/b),o=[],j,q,u,t,v,z;for(j=0;j<b;j++){t=k.top+j*p;z=j-(b-1)/2;for(q=0;q<l;q++)u=k.left+q*e,v=q-(l-1)/2,m.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-q*e,top:-j*p}).parent().addClass("ui-effects-explode").css({position:"absolute",
overflow:"hidden",width:e,height:p,left:u+(g?v*e:0),top:t+(g?z*p:0),opacity:g?0:1}).animate({left:u+(g?0:v*e),top:t+(g?0:z*p),opacity:g?1:0},a.duration||500,a.easing,c)}}})(j);(function(f){f.effects.effect.fade=function(a,d){var c=f(this),b="hide"===f.effects.setMode(c,a.mode||"toggle");c.show();c.animate({opacity:b?0:1},{queue:!1,duration:a.duration,easing:a.easing,complete:function(){b&&c.hide();d()}})}})(j);(function(f){f.effects.effect.fold=function(a,d){var c=f(this),b="position top bottom left right height width".split(" "),
l=f.effects.setMode(c,a.mode||"hide"),m="show"===l,g="hide"===l,l=a.size||15,k=/([0-9]+)%/.exec(l),e=!!a.horizFirst,p=m!=e,o=p?["width","height"]:["height","width"],j=a.duration/2,q,u={},t={};f.effects.save(c,b);c.show();q=f.effects.createWrapper(c).css({overflow:"hidden"});p=p?[q.width(),q.height()]:[q.height(),q.width()];k&&(l=parseInt(k[1],10)/100*p[g?0:1]);m&&q.css(e?{height:0,width:l}:{height:l,width:0});u[o[0]]=m?p[0]:l;t[o[1]]=m?p[1]:0;q.animate(u,j,a.easing).animate(t,j,a.easing,function(){g&&
c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);d()})}})(j);(function(f){f.effects.effect.highlight=function(a,d){var c=f(this),b=["backgroundImage","backgroundColor","opacity"],l=f.effects.setMode(c,a.mode||"show"),m={backgroundColor:c.css("backgroundColor")};"hide"===l&&(m.opacity=0);f.effects.save(c,b);c.show().css({backgroundImage:"none",backgroundColor:a.color||"#ffff99"}).animate(m,{queue:!1,duration:a.duration,easing:a.easing,complete:function(){l==="hide"&&c.hide();f.effects.restore(c,
b);d()}})}})(j);(function(f){f.effects.effect.pulsate=function(a,d){var c=f(this),b=f.effects.setMode(c,a.mode||"show"),l="show"===b,m="hide"===b,b=2*(a.times||5)+(l||"hide"===b?1:0),g=a.duration/b,k=0,e=c.queue(),p=e.length;if(l||!c.is(":visible"))c.css("opacity",0).show(),k=1;for(l=1;l<b;l++)c.animate({opacity:k},g,a.easing),k=1-k;c.animate({opacity:k},g,a.easing);c.queue(function(){m&&c.hide();d()});1<p&&e.splice.apply(e,[1,0].concat(e.splice(p,b+1)));c.dequeue()}})(j);(function(f){f.effects.effect.puff=
function(a,d){var c=f(this),b=f.effects.setMode(c,a.mode||"hide"),l="hide"===b,m=parseInt(a.percent,10)||150,g=m/100,k={height:c.height(),width:c.width()};f.extend(a,{effect:"scale",queue:!1,fade:!0,mode:b,complete:d,percent:l?m:100,from:l?k:{height:k.height*g,width:k.width*g}});c.effect(a)};f.effects.effect.scale=function(a,d){var c=f(this),b=f.extend(!0,{},a),l=f.effects.setMode(c,a.mode||"effect"),m=parseInt(a.percent,10)||(0==parseInt(a.percent,10)?0:"hide"==l?0:100),g=a.direction||"both",k=a.origin,
e={height:c.height(),width:c.width(),outerHeight:c.outerHeight(),outerWidth:c.outerWidth()},p="horizontal"!=g?m/100:1,m="vertical"!=g?m/100:1;b.effect="size";b.queue=!1;b.complete=d;"effect"!=l&&(b.origin=k||["middle","center"],b.restore=!0);b.from=a.from||("show"==l?{height:0,width:0}:e);b.to={height:e.height*p,width:e.width*m,outerHeight:e.outerHeight*p,outerWidth:e.outerWidth*m};if(b.fade&&("show"==l&&(b.from.opacity=0,b.to.opacity=1),"hide"==l))b.from.opacity=1,b.to.opacity=0;c.effect(b)};f.effects.effect.size=
function(a,d){var c,b,l,m,g=f(this),k="position top bottom left right width height overflow opacity".split(" "),e="position top bottom left right overflow opacity".split(" "),p=["width","height","overflow"],o=["fontSize"],j=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],q=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],u=f.effects.setMode(g,a.mode||"effect"),t=a.restore||"effect"!==u,v=a.scale||"both",z=a.origin||["middle","center"],x,y,B=g.css("position"),
A="auto"!==g.css("bottom")?"bottom":"top";originalHorizontalPositioning="auto"!==g.css("right")?"right":"left";"show"===u&&g.show();x={height:g.height(),width:g.width(),outerHeight:g.outerHeight(),outerWidth:g.outerWidth()};g.from=a.from||x;g.to=a.to||x;l=g.from.height/x.height;m=g.from.width/x.width;c=g.to.height/x.height;b=g.to.width/x.width;if("box"==v||"both"==v)if(l!==c&&(k=k.concat(j),g.from=f.effects.setTransition(g,j,l,g.from),g.to=f.effects.setTransition(g,j,c,g.to)),m!==b)k=k.concat(q),
g.from=f.effects.setTransition(g,q,m,g.from),g.to=f.effects.setTransition(g,q,b,g.to);if(("content"==v||"both"==v)&&l!==c)k=k.concat(o),g.from=f.effects.setTransition(g,o,l,g.from),g.to=f.effects.setTransition(g,o,c,g.to);f.effects.save(g,t?k:e);g.show();f.effects.createWrapper(g);g.css("overflow","hidden").css(g.from);z&&(y=f.effects.getBaseline(z,x),g.from.top=(x.outerHeight-g.outerHeight())*y.y,g.from.left=(x.outerWidth-g.outerWidth())*y.x,g.to.top=(x.outerHeight-g.to.outerHeight)*y.y,g.to.left=
(x.outerWidth-g.to.outerWidth)*y.x);g.css(g.from);if("content"==v||"both"==v)j=j.concat(["marginTop","marginBottom"]).concat(o),q=q.concat(["marginLeft","marginRight"]),p=k.concat(j).concat(q),g.find("*[width]").each(function(){var e=f(this),g=e.height(),k=e.width();t&&f.effects.save(e,p);e.from={height:g*l,width:k*m};e.to={height:g*c,width:k*b};if(l!=c){e.from=f.effects.setTransition(e,j,l,e.from);e.to=f.effects.setTransition(e,j,c,e.to)}if(m!=b){e.from=f.effects.setTransition(e,q,m,e.from);e.to=
f.effects.setTransition(e,q,b,e.to)}e.css(e.from);e.animate(e.to,a.duration,a.easing,function(){t&&f.effects.restore(e,p)})});g.animate(g.to,{queue:!1,duration:a.duration,easing:a.easing,complete:function(){g.to.opacity===0&&g.css("opacity",g.from.opacity);u=="hide"&&g.hide();f.effects.restore(g,t?k:e);t||(B==="static"?g.css({position:"relative",top:g.to.top,left:g.to.left}):f.each([A,originalHorizontalPositioning],function(a,b){g.css(b,function(e,c){var k=parseInt(c,10),d=a?g.to.left:g.to.top,f=
a?g.to.outerWidth-g.from.outerWidth:g.to.outerHeight-g.from.outerHeight,l=z[a]===b,m=z[a]==="middle"||z[a]==="center";if(c==="auto")return d+"px";b=="left"||b=="top"||(B==="relative"?d=d*-1:m||(d=d-f*(l?-1:1)));return k+d+"px"})}));f.effects.removeWrapper(g);d()}})}})(j);(function(f){f.effects.effect.shake=function(a,d){var c=f(this),b="position top bottom left right height width".split(" "),l=f.effects.setMode(c,a.mode||"effect"),m=a.direction||"left",g=a.distance||20,k=a.times||3,e=2*k+1,p=a.duration,
o="up"==m||"down"==m?"top":"left",j="up"==m||"left"==m,m={},q={},u={},t=c.queue(),v=t.length;f.effects.save(c,b);c.show();f.effects.createWrapper(c);m[o]=(j?"-=":"+=")+g;q[o]=(j?"+=":"-=")+2*g;u[o]=(j?"-=":"+=")+2*g;c.animate(m,p,a.easing);for(g=1;g<k;g++)c.animate(q,p,a.easing).animate(u,p,a.easing);c.animate(q,p,a.easing).animate(m,p/2,a.easing).queue(function(){"hide"===l&&c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);d()});1<v&&t.splice.apply(t,[1,0].concat(t.splice(v,e+1)));c.dequeue()}})(j);
(function(f){f.effects.effect.slide=function(a,d){var c=f(this),b="position top bottom left right width height".split(" "),l=f.effects.setMode(c,a.mode||"show"),m="show"===l,g=a.direction||"left",k="up"==g||"down"==g?"top":"left",g="up"==g||"left"==g,e,p={};f.effects.save(c,b);c.show();e=a.distance||c["top"===k?"outerHeight":"outerWidth"]({margin:!0});f.effects.createWrapper(c).css({overflow:"hidden"});m&&c.css(k,g?isNaN(e)?"-"+e:-e:e);p[k]=(m?g?"+=":"-=":g?"-=":"+=")+e;c.animate(p,{queue:!1,duration:a.duration,
easing:a.easing,complete:function(){"hide"===l&&c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);d()}})}})(j);(function(f){f.effects.effect.transfer=function(a,d){var c=f(this),b=f(a.to),l="fixed"===b.css("position"),m=f("body"),g=l?m.scrollTop():0,m=l?m.scrollLeft():0,k=b.offset(),b={top:k.top-g,left:k.left-m,height:b.innerHeight(),width:b.innerWidth()},k=c.offset(),e=f('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(a.className).css({top:k.top-g,left:k.left-
m,height:c.innerHeight(),width:c.innerWidth(),position:l?"fixed":"absolute"}).animate(b,a.duration,a.easing,function(){e.remove();d()})}})(j);(function(f){var a={};f.widget("ui.accordion",{version:"1.9m6",options:{active:0,animated:"slide",collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var a=this.options;this.element.addClass("ui-accordion ui-widget ui-helper-reset");
this.headers=this.element.find(a.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this._hoverable(this.headers);this._focusable(this.headers);this.headers.find(":first-child").addClass("ui-accordion-heading");this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");!a.collapsible&&!1===a.active&&(a.active=0);0>a.active&&(a.active+=this.headers.length);this.active=this._findActive(a.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");
this.active.next().addClass("ui-accordion-content-active");this._createIcons();this.refresh();this.element.attr("role","tablist");this.headers.attr("role","tab").bind("keydown.accordion",f.proxy(this,"_keydown")).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();this.active.length?this.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):this.headers.eq(0).attr("tabIndex",0);f.browser.safari||
this.headers.find("a").attr("tabIndex",-1);this._setupEvents(a.event)},_createIcons:function(){var a=this.options.icons;a&&(f("<span>").addClass("ui-accordion-header-icon ui-icon "+a.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(a.header).addClass(a.activeHeader),this.element.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.children(".ui-accordion-header-icon").remove();this.element.removeClass("ui-accordion-icons")},_destroy:function(){this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");
this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex").find("a").removeAttr("tabIndex").end().find(".ui-accordion-heading").removeClass("ui-accordion-heading");this._destroyIcons();var a=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");
"content"!==this.options.heightStyle&&a.css("height","")},_setOption:function(a,c){"active"===a?this._activate(c):("event"===a&&(this.options.event&&this.headers.unbind(this.options.event+".accordion",this._eventHandler),this._setupEvents(c)),this._super("_setOption",a,c),"collapsible"===a&&(!c&&!1===this.options.active)&&this._activate(0),"icons"===a&&(this._destroyIcons(),c&&this._createIcons()),"disabled"===a&&this.headers.add(this.headers.next()).toggleClass("ui-accordion-disabled ui-state-disabled",
!!c))},_keydown:function(a){if(!this.options.disabled&&!a.altKey&&!a.ctrlKey){var c=f.ui.keyCode,b=this.headers.length,l=this.headers.index(a.target),m=!1;switch(a.keyCode){case c.RIGHT:case c.DOWN:m=this.headers[(l+1)%b];break;case c.LEFT:case c.UP:m=this.headers[(l-1+b)%b];break;case c.SPACE:case c.ENTER:this._eventHandler(a)}m&&(f(a.target).attr("tabIndex",-1),f(m).attr("tabIndex",0),m.focus(),a.preventDefault())}},refresh:function(){var a=this.options,c=this.element.parent(),b,l;"fill"===a.heightStyle?
(f.support.minHeight||(l=c.css("overflow"),c.css("overflow","hidden")),b=c.height(),this.element.siblings(":visible").each(function(){var a=f(this),c=a.css("position");c==="absolute"||c==="fixed"||(b=b-a.outerHeight(true))}),l&&c.css("overflow",l),this.headers.each(function(){b=b-f(this).outerHeight(true)}),this.headers.next().each(function(){f(this).height(Math.max(0,b-f(this).innerHeight()+f(this).height()))}).css("overflow","auto")):"auto"===a.heightStyle&&(b=0,this.headers.next().each(function(){b=
Math.max(b,f(this).height("").height())}).height(b));return this},_activate:function(a){a=this._findActive(a)[0];a!==this.active[0]&&(a=a||this.active[0],this._eventHandler({target:a,currentTarget:a,preventDefault:f.noop}))},_findActive:function(a){return"number"===typeof a?this.headers.eq(a):f()},_setupEvents:function(a){a&&this.headers.bind(a.split(" ").join(".accordion ")+".accordion",f.proxy(this,"_eventHandler"))},_eventHandler:function(a){var c=this.options,b=this.active,l=f(a.currentTarget),
m=l[0]===b[0],g=m&&c.collapsible,k=g?f():l.next(),e=b.next(),k={oldHeader:b,oldContent:e,newHeader:g?f():l,newContent:k};a.preventDefault();if(!c.disabled&&!(m&&!c.collapsible||!1===this._trigger("beforeActivate",a,k)))c.active=g?!1:this.headers.index(l),this.active=m?f():l,this._toggle(k),b.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-accordion-header-icon").removeClass(c.icons.activeHeader).addClass(c.icons.header),m||(l.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-accordion-header-icon").removeClass(c.icons.header).addClass(c.icons.activeHeader),
l.next().addClass("ui-accordion-content-active"))},_toggle:function(d){function c(){b._completed(d)}var b=this,l=b.options,m=d.newContent,g=d.oldContent;if(l.animated){var k=f.ui.accordion.animations,l=l.animated,e;k[l]||(e={easing:f.easing[l]?l:"slide",duration:700},l="slide");k[l]({toShow:m,toHide:g,prevShow:a.toShow,prevHide:a.toHide,complete:c,down:m.length&&(!g.length||m.index()<g.index())},e)}else g.hide(),m.show(),c();g.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur();
m.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(a){var c=a.newContent,b=a.oldContent;"content"===this.options.heightStyle&&c.add(b).css({height:"",overflow:""});b.removeClass("ui-accordion-content-active");b.length&&(b.parent()[0].className=b.parent()[0].className);this._trigger("activate",null,a)}});f.extend(f.ui.accordion,{animations:{slide:function(d,c){if(d.prevShow||d.prevHide)d.prevHide.stop(!0,!0),d.toHide=d.prevShow;var b=d.toShow.css("overflow"),
l=d.toHide.css("overflow"),m=0,g={},k={},e=["height","paddingTop","paddingBottom"],p;a=d=f.extend({easing:"swing",duration:300},d,c);if(d.toHide.size())if(d.toShow.size()){var o=d.toShow;p=o[0].style.width;o.width(parseInt(o.parent().width(),10)-parseInt(o.css("paddingLeft"),10)-parseInt(o.css("paddingRight"),10)-(parseInt(o.css("borderLeftWidth"),10)||0)-(parseInt(o.css("borderRightWidth"),10)||0));f.each(e,function(a,b){k[b]="hide";var e=(""+f.css(d.toShow[0],b)).match(/^([\d+-.]+)(.*)$/);g[b]=
{value:"height"===b&&"0"===e[1]?1:e[1],unit:e[2]||"px"}});d.toShow.css({height:0,overflow:"hidden"}).show();d.toHide.filter(":hidden").each(d.complete).end().filter(":visible").animate(k,{step:function(a,b){if("height"==b.prop||"paddingTop"==b.prop||"paddingBottom"==b.prop)m=0===b.end-b.start?0:(b.now-b.start)/(b.end-b.start);d.toShow[0].style[b.prop]=m*g[b.prop].value+g[b.prop].unit},duration:d.duration,easing:d.easing,complete:function(){d.toShow.css({width:p,overflow:b});d.toHide.css("overflow",
l);d.complete()}})}else d.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},d);else p=d.toShow[0].style.width,d.toShow.show().width(d.toShow.width()).hide().animate({height:"show",paddingTop:"show",paddingBottom:"show"},{duration:d.duration,easing:d.easing,complete:function(){d.toShow.width(p);d.complete()}})},bounceslide:function(a){this.slide(a,{easing:a.down?"easeOutBounce":"swing",duration:a.down?1E3:200})}}});!1!==f.uiBackCompat&&(function(a,c){a.extend(c.options,{navigation:!1,
navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var b=c._create;c._create=function(){if(this.options.navigation){var c=this,f=this.element.find(this.options.header),g=f.next(),k=f.add(g).find("a").filter(this.options.navigationFilter)[0];k&&f.add(g).each(function(b){if(a.contains(this,k))return c.options.active=Math.floor(b/2),!1})}b.call(this)}}(j,j.ui.accordion.prototype),function(a,c){a.extend(c.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});
var b=c._create,f=c._setOption;a.extend(c,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle();b.call(this)},_setOption:function(a,b){if("autoHeight"===a||"clearStyle"===a||"fillSpace"===a)this.options.heightStyle=this._mergeHeightStyle();f.apply(this,arguments)},_mergeHeightStyle:function(){var a=this.options;if(a.fillSpace)return"fill";if(a.clearStyle)return"content";if(a.autoHeight)return"auto"}})}(j,j.ui.accordion.prototype),function(a,c){a.extend(c.options.icons,
{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var b=c._createIcons;c._createIcons=function(){this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected;b.call(this)}}(j,j.ui.accordion.prototype),function(a,c){c.activate=c._activate;var b=c._findActive;c._findActive=function(a){-1===a&&(a=!1);a&&"number"!==typeof a&&(a=this.headers.index(this.headers.filter(a)),-1===a&&(a=!1));return b.call(this,a)}}(j,j.ui.accordion.prototype),j.ui.accordion.prototype.resize=
j.ui.accordion.prototype.refresh,function(a,c){a.extend(c.options,{change:null,changestart:null});var b=c._trigger;c._trigger=function(a,c,g){var k=b.apply(this,arguments);if(!k)return!1;"beforeActivate"===a?k=b.call(this,"changestart",c,g):"activate"===a&&(k=b.call(this,"change",c,g));return k}}(j,j.ui.accordion.prototype))})(j);(function(f){var a=0;f.widget("ui.autocomplete",{version:"1.9m6",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",
at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var a=this,c=this.element[0].ownerDocument,b,l;this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"];this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(a.options.disabled||a.element.prop("readOnly"))l=
b=!0;else{l=b=!1;var g=f.ui.keyCode;switch(c.keyCode){case g.PAGE_UP:b=!0;a._move("previousPage",c);break;case g.PAGE_DOWN:b=!0;a._move("nextPage",c);break;case g.UP:b=!0;a._move("previous",c);c.preventDefault();break;case g.DOWN:b=!0;a._move("next",c);c.preventDefault();break;case g.ENTER:case g.NUMPAD_ENTER:a.menu.active&&(b=!0,c.preventDefault());case g.TAB:if(!a.menu.active)break;a.menu.select(c);break;case g.ESCAPE:a._value(a.term);a.close(c);break;default:a._searchTimeout(c)}}}).bind("keypress.autocomplete",
function(c){if(b)b=!1,c.preventDefault();else{var g=f.ui.keyCode;switch(c.keyCode){case g.PAGE_UP:a._move("previousPage",c);break;case g.PAGE_DOWN:a._move("nextPage",c);break;case g.UP:a._move("previous",c);c.preventDefault();break;case g.DOWN:a._move("next",c),c.preventDefault()}}}).bind("input.autocomplete",function(b){l?(l=!1,b.preventDefault()):a._searchTimeout(b)}).bind("focus.autocomplete",function(){a.options.disabled||(a.selectedItem=null,a.previous=a._value())}).bind("blur.autocomplete",
function(b){a.options.disabled||(clearTimeout(a.searching),a.closing=setTimeout(function(){a.close(b);a._change(b)},150))});this._initSource();this.response=function(){return a._response.apply(a,arguments)};this.menu=f("<ul></ul>").addClass("ui-autocomplete").appendTo(f(this.options.appendTo||"body",c)[0]).mousedown(function(b){var c=a.menu.element[0];f(b.target).closest(".ui-menu-item").length||setTimeout(function(){f(document).one("mousedown",function(b){b.target!==a.element[0]&&(b.target!==c&&
!f.contains(c,b.target))&&a.close()})},1);setTimeout(function(){clearTimeout(a.closing)},13)}).menu({input:f(),focus:function(b,c){var k=c.item.data("item.autocomplete");!1!==a._trigger("focus",b,{item:k})&&/^key/.test(b.originalEvent.type)&&a._value(k.value)},select:function(b,g){var k=g.item.data("item.autocomplete"),e=a.previous;a.element[0]!==c.activeElement&&(a.element.focus(),a.previous=e,setTimeout(function(){a.previous=e;a.selectedItem=k},1));!1!==a._trigger("select",b,{item:k})&&a._value(k.value);
a.term=a._value();a.close(b);a.selectedItem=k},blur:function(){a.menu.element.is(":visible")&&a._value()!==a.term&&a._value(a.term)}}).zIndex(this.element.zIndex()+1).hide().data("menu");f.fn.bgiframe&&this.menu.element.bgiframe()},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove()},_setOption:function(a,c){this._super("_setOption",
a,c);"source"===a&&this._initSource();"appendTo"===a&&this.menu.element.appendTo(f(c||"body",this.element[0].ownerDocument)[0]);"disabled"===a&&(c&&this.xhr)&&this.xhr.abort()},_initSource:function(){var d=this,c,b;f.isArray(this.options.source)?(c=this.options.source,this.source=function(a,b){b(f.ui.autocomplete.filter(c,a.term))}):"string"===typeof this.options.source?(b=this.options.source,this.source=function(c,m){d.xhr&&d.xhr.abort();d.xhr=f.ajax({url:b,data:c,dataType:"json",autocompleteRequest:++a,
success:function(b){this.autocompleteRequest===a&&m(b)},error:function(){this.autocompleteRequest===a&&m([])}})}):this.source=this.options.source},_searchTimeout:function(a){var c=this;c.searching=setTimeout(function(){c.term!=c.element.val()&&(c.selectedItem=null,c.search(null,a))},c.options.delay)},search:function(a,c){a=null!=a?a:this._value();this.term=this._value();if(a.length<this.options.minLength)return this.close(c);clearTimeout(this.closing);if(!1!==this._trigger("search",c))return this._search(a)},
_search:function(a){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:a},this.response)},_response:function(a){a&&(a=this._normalize(a));this._trigger("response",null,{content:a});!this.options.disabled&&a&&a.length?(this._suggest(a),this._trigger("open")):this.close();this.pending--;this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing);this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),
this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(a){return a.length&&a[0].label&&a[0].value?a:f.map(a,function(a){return"string"===typeof a?{label:a,value:a}:f.extend({label:a.label||a.value,value:a.value||a.label},a)})},_suggest:function(a){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,a);this.menu.blur();this.menu.refresh();c.show();this._resizeMenu();c.position(f.extend({of:this.element},
this.options.position));this.options.autoFocus&&this.menu.next(new f.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(a,c){var b=this;f.each(c,function(c,f){b._renderItem(a,f)})},_renderItem:function(a,c){return f("<li></li>").data("item.autocomplete",c).append(f("<a></a>").text(c.label)).appendTo(a)},_move:function(a,c){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(a)||
this.menu.last()&&/^next/.test(a))this._value(this.term),this.menu.blur();else this.menu[a](c);else this.search(null,c)},widget:function(){return this.menu.element},_value:function(a){return this.valueMethod.apply(this.element,arguments)}});f.extend(f.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(a,c){var b=RegExp(f.ui.autocomplete.escapeRegex(c),"i");return f.grep(a,function(a){return b.test(a.label||a.value||a)})}})})(j);(function(f){var a,
d,c,b,l=function(){var a=f(this).find(":ui-button");setTimeout(function(){a.button("refresh")},1)},m=function(a){var b=a.name,e=a.form,c=f([]);b&&(c=e?f(e).find("[name='"+b+"']"):f("[name='"+b+"']",a.ownerDocument).filter(function(){return!this.form}));return c};f.widget("ui.button",{version:"1.9m6",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",l);"boolean"!==
typeof this.options.disabled&&(this.options.disabled=this.element.prop("disabled"));this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var g=this,k=this.options,e="checkbox"===this.type||"radio"===this.type,p="ui-state-hover"+(!e?" ui-state-active":"");null===k.label&&(k.label=this.buttonElement.html());this.element.is(":disabled")&&(k.disabled=!0);this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",
function(){if(!k.disabled){f(this).addClass("ui-state-hover");this===a&&f(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){k.disabled||f(this).removeClass(p)}).bind("click.button",function(a){if(k.disabled){a.preventDefault();a.stopImmediatePropagation()}});this.element.bind("focus.button",function(){g.buttonElement.addClass("ui-state-focus")}).bind("blur.button",function(){g.buttonElement.removeClass("ui-state-focus")});e&&(this.element.bind("change.button",function(){b||
g.refresh()}),this.buttonElement.bind("mousedown.button",function(a){if(!k.disabled){b=false;d=a.pageX;c=a.pageY}}).bind("mouseup.button",function(a){if(!k.disabled&&(d!==a.pageX||c!==a.pageY))b=true}));"checkbox"===this.type?this.buttonElement.bind("click.button",function(){if(k.disabled||b)return false;f(this).toggleClass("ui-state-active");g.buttonElement.attr("aria-pressed",g.element[0].checked)}):"radio"===this.type?this.buttonElement.bind("click.button",function(){if(k.disabled||b)return false;
f(this).addClass("ui-state-active");g.buttonElement.attr("aria-pressed","true");var a=g.element[0];m(a).not(a).map(function(){return f(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown.button",function(){if(k.disabled)return false;f(this).addClass("ui-state-active");a=this;f(document).one("mouseup",function(){a=null})}).bind("mouseup.button",function(){if(k.disabled)return false;f(this).removeClass("ui-state-active")}).bind("keydown.button",
function(a){if(k.disabled)return false;(a.keyCode==f.ui.keyCode.SPACE||a.keyCode==f.ui.keyCode.ENTER)&&f(this).addClass("ui-state-active")}).bind("keyup.button",function(){f(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(a){a.keyCode===f.ui.keyCode.SPACE&&f(this).click()}));this._setOption("disabled",k.disabled);this._resetButton()},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":
this.element.is("input")?"input":"button";if("checkbox"===this.type||"radio"===this.type){var a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']";this.buttonElement=a.find(b);this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b)));this.element.addClass("ui-helper-hidden-accessible");(a=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active");this.buttonElement.prop("aria-pressed",
a)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){this._super("_setOption",a,b);"disabled"===a?b?this.element.prop("disabled",!0):this.element.prop("disabled",!1):this._resetButton()},refresh:function(){var a=this.element.is(":disabled");a!==this.options.disabled&&this._setOption("disabled",a);"radio"===this.type?m(this.element[0]).each(function(){f(this).is(":checked")?f(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):f(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",
"false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)this.options.label&&this.element.val(this.options.label);else{var a=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
b=f("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(a.empty()).text(),e=this.options.icons,c=e.primary&&e.secondary,d=[];e.primary||e.secondary?(this.options.text&&d.push("ui-button-text-icon"+(c?"s":e.primary?"-primary":"-secondary")),e.primary&&a.prepend("<span class='ui-button-icon-primary ui-icon "+e.primary+"'></span>"),e.secondary&&a.append("<span class='ui-button-icon-secondary ui-icon "+e.secondary+"'></span>"),this.options.text||(d.push(c?"ui-button-icons-only":
"ui-button-icon-only"),this.hasTitle||a.attr("title",b))):d.push("ui-button-text-only");a.addClass(d.join(" "))}}});f.ui.button.version="1.9m6";f.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b);this._super("_setOption",a,b)},refresh:function(){var a="rtl"===this.element.css("direction");
this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return f(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(a?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(a?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return f(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})})(j);
(function(f,a){function d(){this.debug=!1;this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),
weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,
beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};f.extend(this._defaults,this.regional[""]);this.dpDiv=c(f('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function c(a){return a.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a",
"mouseout",function(){f(this).removeClass("ui-state-hover");-1!=this.className.indexOf("ui-datepicker-prev")&&f(this).removeClass("ui-datepicker-prev-hover");-1!=this.className.indexOf("ui-datepicker-next")&&f(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){if(!f.datepicker._isDisabledDatepicker(m.inline?a.parent()[0]:m.input[0]))f(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),
f(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&f(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&f(this).addClass("ui-datepicker-next-hover")})}function b(b,c){f.extend(b,c);for(var e in c)if(null==c[e]||c[e]==a)b[e]=c[e];return b}f.extend(f.ui,{datepicker:{version:"1.9m6"}});var l=(new Date).getTime(),m;f.extend(d.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",
arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){b(this._defaults,a||{});return this},_attachDatepicker:function(a,b){var e=null,c;for(c in this._defaults){var d=a.getAttribute("date:"+c);if(d){e=e||{};try{e[c]=eval(d)}catch(l){e[c]=d}}}c=a.nodeName.toLowerCase();d="div"==c||"span"==c;a.id||(this.uuid+=1,a.id="dp"+this.uuid);var m=this._newInst(f(a),d);m.settings=f.extend({},b||{},e||{});"input"==c?this._connectDatepicker(a,m):d&&this._inlineDatepicker(a,m)},_newInst:function(a,
b){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:!b?this.dpDiv:c(f('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}},_connectDatepicker:function(a,b){var e=f(a);b.append=f([]);b.trigger=f([]);e.hasClass(this.markerClassName)||(this._attachments(e,b),e.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",
function(a,e,c){b.settings[e]=c}).bind("getData.datepicker",function(a,e){return this._get(b,e)}),this._autoSize(b),f.data(a,"datepicker",b),b.settings.disabled&&this._disableDatepicker(a))},_attachments:function(a,b){var e=this._get(b,"appendText"),c=this._get(b,"isRTL");b.append&&b.append.remove();e&&(b.append=f('<span class="'+this._appendClass+'">'+e+"</span>"),a[c?"before":"after"](b.append));a.unbind("focus",this._showDatepicker);b.trigger&&b.trigger.remove();e=this._get(b,"showOn");("focus"==
e||"both"==e)&&a.focus(this._showDatepicker);if("button"==e||"both"==e){var e=this._get(b,"buttonText"),d=this._get(b,"buttonImage");b.trigger=f(this._get(b,"buttonImageOnly")?f("<img/>").addClass(this._triggerClass).attr({src:d,alt:e,title:e}):f('<button type="button"></button>').addClass(this._triggerClass).html(""==d?e:f("<img/>").attr({src:d,alt:e,title:e})));a[c?"before":"after"](b.trigger);b.trigger.click(function(){f.datepicker._datepickerShowing&&f.datepicker._lastInput==a[0]?f.datepicker._hideDatepicker():
f.datepicker._showDatepicker(a[0]);return false})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),e=this._get(a,"dateFormat");if(e.match(/[DM]/)){var c=function(a){for(var b=0,e=0,c=0;c<a.length;c++)a[c].length>b&&(b=a[c].length,e=c);return e};b.setMonth(c(this._get(a,e.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(c(this._get(a,e.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,
b){var e=f(a);e.hasClass(this.markerClassName)||(e.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(a,e,c){b.settings[e]=c}).bind("getData.datepicker",function(a,e){return this._get(b,e)}),f.data(a,"datepicker",b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(a),b.dpDiv.css("display","block"))},_dialogDatepicker:function(a,c,e,d,l){a=this._dialogInst;a||(this.uuid+=1,this._dialogInput=
f('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'),this._dialogInput.keydown(this._doKeyDown),f("body").append(this._dialogInput),a=this._dialogInst=this._newInst(this._dialogInput,!1),a.settings={},f.data(this._dialogInput[0],"datepicker",a));b(a.settings,d||{});c=c&&c.constructor==Date?this._formatDate(a,c):c;this._dialogInput.val(c);this._pos=l?l.length?l:[l.pageX,l.pageY]:null;this._pos||(this._pos=[document.documentElement.clientWidth/
2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]);this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");a.settings.onSelect=e;this._inDialog=!0;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);f.blockUI&&f.blockUI(this.dpDiv);f.data(this._dialogInput[0],"datepicker",a);return this},_destroyDatepicker:function(a){var b=
f(a),e=f.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var c=a.nodeName.toLowerCase();f.removeData(a,"datepicker");"input"==c?(e.append.remove(),e.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==c||"span"==c)&&b.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(a){var b=f(a),e=f.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var c=
a.nodeName.toLowerCase();if("input"==c)a.disabled=!1,e.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==c||"span"==c)b=b.children("."+this._inlineClass),b.children().removeClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=f.map(this._disabledInputs,function(b){return b==a?null:b})}},_disableDatepicker:function(a){var b=f(a),e=f.data(a,"datepicker");
if(b.hasClass(this.markerClassName)){var c=a.nodeName.toLowerCase();if("input"==c)a.disabled=!0,e.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==c||"span"==c)b=b.children("."+this._inlineClass),b.children().addClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=f.map(this._disabledInputs,function(b){return b==a?null:b});this._disabledInputs[this._disabledInputs.length]=
a}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(a){try{return f.data(a,"datepicker")}catch(b){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(c,k,e){var d=this._getInst(c);if(2==arguments.length&&"string"==typeof k)return"defaults"==k?f.extend({},f.datepicker._defaults):d?"all"==k?f.extend({},d.settings):this._get(d,k):null;var l=k||{};"string"==typeof k&&
(l={},l[k]=e);if(d){this._curInst==d&&this._hideDatepicker();var m=this._getDateDatepicker(c,!0),q=this._getMinMaxDate(d,"min"),j=this._getMinMaxDate(d,"max");b(d.settings,l);null!==q&&(l.dateFormat!==a&&l.minDate===a)&&(d.settings.minDate=this._formatDate(d,q));null!==j&&(l.dateFormat!==a&&l.maxDate===a)&&(d.settings.maxDate=this._formatDate(d,j));this._attachments(f(c),d);this._autoSize(d);this._setDate(d,m);this._updateAlternate(d);this._updateDatepicker(d)}},_changeDatepicker:function(a,b,e){this._optionDatepicker(a,
b,e)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){var e=this._getInst(a);e&&(this._setDate(e,b),this._updateDatepicker(e),this._updateAlternate(e))},_getDateDatepicker:function(a,b){var e=this._getInst(a);e&&!e.inline&&this._setDateFromField(e,b);return e?this._getDate(e):null},_doKeyDown:function(a){var b=f.datepicker._getInst(a.target),e=!0,c=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if(f.datepicker._datepickerShowing)switch(a.keyCode){case 9:f.datepicker._hideDatepicker();
e=!1;break;case 13:return e=f("td."+f.datepicker._dayOverClass+":not(."+f.datepicker._currentClass+")",b.dpDiv),e[0]&&f.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,e[0]),(a=f.datepicker._get(b,"onSelect"))?(e=f.datepicker._formatDate(b),a.apply(b.input?b.input[0]:null,[e,b])):f.datepicker._hideDatepicker(),!1;case 27:f.datepicker._hideDatepicker();break;case 33:f.datepicker._adjustDate(a.target,a.ctrlKey?-f.datepicker._get(b,"stepBigMonths"):-f.datepicker._get(b,"stepMonths"),"M");
break;case 34:f.datepicker._adjustDate(a.target,a.ctrlKey?+f.datepicker._get(b,"stepBigMonths"):+f.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&f.datepicker._clearDate(a.target);e=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&f.datepicker._gotoToday(a.target);e=a.ctrlKey||a.metaKey;break;case 37:if(a.ctrlKey||a.metaKey)f.datepicker._adjustDate(a.target,c?1:-1,"D");e=a.ctrlKey||a.metaKey;a.originalEvent.altKey&&f.datepicker._adjustDate(a.target,a.ctrlKey?
-f.datepicker._get(b,"stepBigMonths"):-f.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&f.datepicker._adjustDate(a.target,-7,"D");e=a.ctrlKey||a.metaKey;break;case 39:if(a.ctrlKey||a.metaKey)f.datepicker._adjustDate(a.target,c?-1:1,"D");e=a.ctrlKey||a.metaKey;a.originalEvent.altKey&&f.datepicker._adjustDate(a.target,a.ctrlKey?+f.datepicker._get(b,"stepBigMonths"):+f.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&f.datepicker._adjustDate(a.target,
7,"D");e=a.ctrlKey||a.metaKey;break;default:e=!1}else 36==a.keyCode&&a.ctrlKey?f.datepicker._showDatepicker(this):e=!1;e&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(b){var c=f.datepicker._getInst(b.target);if(f.datepicker._get(c,"constrainInput")){var c=f.datepicker._possibleChars(f.datepicker._get(c,"dateFormat")),e=String.fromCharCode(b.charCode==a?b.keyCode:b.charCode);return b.ctrlKey||b.metaKey||" ">e||!c||-1<c.indexOf(e)}},_doKeyUp:function(a){a=f.datepicker._getInst(a.target);
if(a.input.val()!=a.lastVal)try{if(f.datepicker.parseDate(f.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,f.datepicker._getFormatConfig(a)))f.datepicker._setDateFromField(a),f.datepicker._updateAlternate(a),f.datepicker._updateDatepicker(a)}catch(b){f.datepicker.log(b)}return!0},_showDatepicker:function(a){a=a.target||a;"input"!=a.nodeName.toLowerCase()&&(a=f("input",a.parentNode)[0]);if(!(f.datepicker._isDisabledDatepicker(a)||f.datepicker._lastInput==a)){var c=f.datepicker._getInst(a);
f.datepicker._curInst&&f.datepicker._curInst!=c&&(f.datepicker._datepickerShowing&&f.datepicker._triggerOnClose(f.datepicker._curInst),f.datepicker._curInst.dpDiv.stop(!0,!0));var e=f.datepicker._get(c,"beforeShow"),e=e?e.apply(a,[a,c]):{};if(!1!==e){b(c.settings,e);c.lastVal=null;f.datepicker._lastInput=a;f.datepicker._setDateFromField(c);f.datepicker._inDialog&&(a.value="");f.datepicker._pos||(f.datepicker._pos=f.datepicker._findPos(a),f.datepicker._pos[1]+=a.offsetHeight);var d=!1;f(a).parents().each(function(){d=
d|f(this).css("position")=="fixed";return!d});d&&f.browser.opera&&(f.datepicker._pos[0]-=document.documentElement.scrollLeft,f.datepicker._pos[1]-=document.documentElement.scrollTop);e={left:f.datepicker._pos[0],top:f.datepicker._pos[1]};f.datepicker._pos=null;c.dpDiv.empty();c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});f.datepicker._updateDatepicker(c);e=f.datepicker._checkOffset(c,e,d);c.dpDiv.css({position:f.datepicker._inDialog&&f.blockUI?"static":d?"fixed":"absolute",display:"none",
left:e.left+"px",top:e.top+"px"});if(!c.inline){var e=f.datepicker._get(c,"showAnim"),l=f.datepicker._get(c,"duration"),m=function(){var a=c.dpDiv.find("iframe.ui-datepicker-cover");if(a.length){var b=f.datepicker._getBorders(c.dpDiv);a.css({left:-b[0],top:-b[1],width:c.dpDiv.outerWidth(),height:c.dpDiv.outerHeight()})}};c.dpDiv.zIndex(f(a).zIndex()+1);f.datepicker._datepickerShowing=!0;if(f.effects&&(f.effects.effect[e]||f.effects[e]))c.dpDiv.show(e,f.datepicker._get(c,"showOptions"),l,m);else c.dpDiv[e||
"show"](e?l:null,m);(!e||!l)&&m();c.input.is(":visible")&&!c.input.is(":disabled")&&c.input.focus();f.datepicker._curInst=c}}}},_updateDatepicker:function(a){this.maxRows=4;var b=f.datepicker._getBorders(a.dpDiv);m=a;a.dpDiv.empty().append(this._generateHTML(a));var e=a.dpDiv.find("iframe.ui-datepicker-cover");e.length&&e.css({left:-b[0],top:-b[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()});a.dpDiv.find("."+this._dayOverClass+" a").mouseover();b=this._getNumberOfMonths(a);e=b[1];a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");
1<e&&a.dpDiv.addClass("ui-datepicker-multi-"+e).css("width",17*e+"em");a.dpDiv[(1!=b[0]||1!=b[1]?"add":"remove")+"Class"]("ui-datepicker-multi");a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");a==f.datepicker._curInst&&(f.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=document.activeElement)&&a.input.focus();if(a.yearshtml){var c=a.yearshtml;setTimeout(function(){c===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml);
c=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,e){var c=a.dpDiv.outerWidth(),d=a.dpDiv.outerHeight(),l=a.input?a.input.outerWidth():0,m=a.input?a.input.outerHeight():0,j=document.documentElement.clientWidth+f(document).scrollLeft(),t=document.documentElement.clientHeight+f(document).scrollTop();b.left-=this._get(a,"isRTL")?
c-l:0;b.left-=e&&b.left==a.input.offset().left?f(document).scrollLeft():0;b.top-=e&&b.top==a.input.offset().top+m?f(document).scrollTop():0;b.left-=Math.min(b.left,b.left+c>j&&j>c?Math.abs(b.left+c-j):0);b.top-=Math.min(b.top,b.top+d>t&&t>d?Math.abs(d+m):0);return b},_findPos:function(a){for(var b=this._get(this._getInst(a),"isRTL");a&&("hidden"==a.type||1!=a.nodeType||f.expr.filters.hidden(a));)a=a[b?"previousSibling":"nextSibling"];a=f(a).offset();return[a.left,a.top]},_triggerOnClose:function(a){var b=
this._get(a,"onClose");b&&b.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a])},_hideDatepicker:function(a){var b=this._curInst;if(b&&!(a&&b!=f.data(a,"datepicker"))&&this._datepickerShowing){var a=this._get(b,"showAnim"),e=this._get(b,"duration"),c=function(){f.datepicker._tidyDialog(b);this._curInst=null};if(f.effects&&(f.effects.effect[a]||f.effects[a]))b.dpDiv.hide(a,f.datepicker._get(b,"showOptions"),e,c);else b.dpDiv["slideDown"==a?"slideUp":"fadeIn"==a?"fadeOut":"hide"](a?e:null,c);
a||c();f.datepicker._triggerOnClose(b);this._datepickerShowing=!1;this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),f.blockUI&&(f.unblockUI(),f("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){f.datepicker._curInst&&(a=f(a.target),a[0].id!=f.datepicker._mainDivId&&(0==a.parents("#"+f.datepicker._mainDivId).length&&
!a.hasClass(f.datepicker.markerClassName)&&!a.hasClass(f.datepicker._triggerClass)&&f.datepicker._datepickerShowing&&(!f.datepicker._inDialog||!f.blockUI))&&f.datepicker._hideDatepicker())},_adjustDate:function(a,b,e){var a=f(a),c=this._getInst(a[0]);this._isDisabledDatepicker(a[0])||(this._adjustInstDate(c,b+("M"==e?this._get(c,"showCurrentAtPos"):0),e),this._updateDatepicker(c))},_gotoToday:function(a){var a=f(a),b=this._getInst(a[0]);if(this._get(b,"gotoCurrent")&&b.currentDay)b.selectedDay=b.currentDay,
b.drawMonth=b.selectedMonth=b.currentMonth,b.drawYear=b.selectedYear=b.currentYear;else{var e=new Date;b.selectedDay=e.getDate();b.drawMonth=b.selectedMonth=e.getMonth();b.drawYear=b.selectedYear=e.getFullYear()}this._notifyChange(b);this._adjustDate(a)},_selectMonthYear:function(a,b,e){var a=f(a),c=this._getInst(a[0]);c["selected"+("M"==e?"Month":"Year")]=c["draw"+("M"==e?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10);this._notifyChange(c);this._adjustDate(a)},_selectDay:function(a,
b,e,c){var d=f(a);!f(c).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(d[0])&&(d=this._getInst(d[0]),d.selectedDay=d.currentDay=f("a",c).html(),d.selectedMonth=d.currentMonth=b,d.selectedYear=d.currentYear=e,this._selectDate(a,this._formatDate(d,d.currentDay,d.currentMonth,d.currentYear)))},_clearDate:function(a){a=f(a);this._getInst(a[0]);this._selectDate(a,"")},_selectDate:function(a,b){var e=this._getInst(f(a)[0]),b=null!=b?b:this._formatDate(e);e.input&&e.input.val(b);this._updateAlternate(e);
var c=this._get(e,"onSelect");c?c.apply(e.input?e.input[0]:null,[b,e]):e.input&&e.input.trigger("change");e.inline?this._updateDatepicker(e):(this._hideDatepicker(),this._lastInput=e.input[0],"object"!=typeof e.input[0]&&e.input.focus(),this._lastInput=null)},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var e=this._get(a,"altFormat")||this._get(a,"dateFormat"),c=this._getDate(a),d=this.formatDate(e,c,this._getFormatConfig(a));f(b).each(function(){f(this).val(d)})}},noWeekends:function(a){a=
a.getDay();return[0<a&&6>a,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();a.setMonth(0);a.setDate(1);return Math.floor(Math.round((b-a)/864E5)/7)+1},parseDate:function(a,b,e){if(null==a||null==b)throw"Invalid arguments";b="object"==typeof b?b.toString():b+"";if(""==b)return null;for(var c=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),d=(e?e.dayNamesShort:
null)||this._defaults.dayNamesShort,l=(e?e.dayNames:null)||this._defaults.dayNames,m=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,j=(e?e.monthNames:null)||this._defaults.monthNames,t=e=-1,v=-1,z=-1,x=!1,y=function(b){(b=K+1<a.length&&a.charAt(K+1)==b)&&K++;return b},B=function(a){var e=y(a),a=RegExp("^\\d{1,"+("@"==a?14:"!"==a?20:"y"==a&&e?4:"o"==a?3:2)+"}"),a=b.substring(N).match(a);if(!a)throw"Missing number at position "+N;N+=a[0].length;return parseInt(a[0],10)},A=function(a,e,c){var a=
f.map(y(a)?c:e,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)}),g=-1;f.each(a,function(a,e){var c=e[1];if(b.substr(N,c.length).toLowerCase()==c.toLowerCase())return g=e[0],N+=c.length,!1});if(-1!=g)return g+1;throw"Unknown name at position "+N;},F=function(){if(b.charAt(N)!=a.charAt(K))throw"Unexpected literal at position "+N;N++},N=0,K=0;K<a.length;K++)if(x)"'"==a.charAt(K)&&!y("'")?x=!1:F();else switch(a.charAt(K)){case "d":v=B("d");break;case "D":A("D",d,l);break;
case "o":z=B("o");break;case "m":t=B("m");break;case "M":t=A("M",m,j);break;case "y":e=B("y");break;case "@":var G=new Date(B("@")),e=G.getFullYear(),t=G.getMonth()+1,v=G.getDate();break;case "!":G=new Date((B("!")-this._ticksTo1970)/1E4);e=G.getFullYear();t=G.getMonth()+1;v=G.getDate();break;case "'":y("'")?F():x=!0;break;default:F()}if(N<b.length&&(d=b.substr(N),!/^\s+/.test(d)))throw"Extra/unparsed characters found in date: "+d;-1==e?e=(new Date).getFullYear():100>e&&(e+=(new Date).getFullYear()-
(new Date).getFullYear()%100+(e<=c?0:-100));if(-1<z){t=1;v=z;do{c=this._getDaysInMonth(e,t-1);if(v<=c)break;t++;v-=c}while(1)}G=this._daylightSavingAdjust(new Date(e,t-1,v));if(G.getFullYear()!=e||G.getMonth()+1!=t||G.getDate()!=v)throw"Invalid date";return G},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-
Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,e){if(!b)return"";var c=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,d=(e?e.dayNames:null)||this._defaults.dayNames,f=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,e=(e?e.monthNames:null)||this._defaults.monthNames,l=function(b){(b=x+1<a.length&&a.charAt(x+1)==b)&&x++;return b},m=function(a,b,e){b=""+b;if(l(a))for(;b.length<e;)b="0"+b;return b},j=function(a,b,e,c){return l(a)?c[b]:e[b]},v="",z=!1;if(b)for(var x=0;x<
a.length;x++)if(z)"'"==a.charAt(x)&&!l("'")?z=!1:v+=a.charAt(x);else switch(a.charAt(x)){case "d":v+=m("d",b.getDate(),2);break;case "D":v+=j("D",b.getDay(),c,d);break;case "o":v+=m("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,0)).getTime())/864E5),3);break;case "m":v+=m("m",b.getMonth()+1,2);break;case "M":v+=j("M",b.getMonth(),f,e);break;case "y":v+=l("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case "@":v+=
b.getTime();break;case "!":v+=1E4*b.getTime()+this._ticksTo1970;break;case "'":l("'")?v+="'":z=!0;break;default:v+=a.charAt(x)}return v},_possibleChars:function(a){for(var b="",e=!1,c=function(b){(b=d+1<a.length&&a.charAt(d+1)==b)&&d++;return b},d=0;d<a.length;d++)if(e)"'"==a.charAt(d)&&!c("'")?e=!1:b+=a.charAt(d);else switch(a.charAt(d)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":c("'")?b+="'":e=!0;break;default:b+=a.charAt(d)}return b},_get:function(b,
c){return b.settings[c]!==a?b.settings[c]:this._defaults[c]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var e=this._get(a,"dateFormat"),c=a.lastVal=a.input?a.input.val():null,d,f;d=f=this._getDefaultDate(a);var l=this._getFormatConfig(a);try{d=this.parseDate(e,c,l)||f}catch(m){this.log(m),c=b?"":c}a.selectedDay=d.getDate();a.drawMonth=a.selectedMonth=d.getMonth();a.drawYear=a.selectedYear=d.getFullYear();a.currentDay=c?d.getDate():0;a.currentMonth=c?d.getMonth():0;a.currentYear=
c?d.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,e){var c=function(a){var b=new Date;b.setDate(b.getDate()+a);return b},d=function(b){try{return f.datepicker.parseDate(f.datepicker._get(a,"dateFormat"),b,f.datepicker._getFormatConfig(a))}catch(e){}for(var c=(b.toLowerCase().match(/^c/)?f.datepicker._getDate(a):null)||new Date,k=c.getFullYear(),d=c.getMonth(),
c=c.getDate(),l=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,m=l.exec(b);m;){switch(m[2]||"d"){case "d":case "D":c+=parseInt(m[1],10);break;case "w":case "W":c+=7*parseInt(m[1],10);break;case "m":case "M":d+=parseInt(m[1],10);c=Math.min(c,f.datepicker._getDaysInMonth(k,d));break;case "y":case "Y":k+=parseInt(m[1],10),c=Math.min(c,f.datepicker._getDaysInMonth(k,d))}m=l.exec(b)}return new Date(k,d,c)};if(b=(b=null==b||""===b?e:"string"==typeof b?d(b):"number"==typeof b?isNaN(b)?e:c(b):new Date(b.getTime()))&&
"Invalid Date"==b.toString()?e:b)b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0);return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(12<a.getHours()?a.getHours()+2:0);return a},_setDate:function(a,b,e){var c=!b,d=a.selectedMonth,f=a.selectedYear,b=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=
b.getFullYear();(d!=a.selectedMonth||f!=a.selectedYear)&&!e&&this._notifyChange(a);this._adjustInstDate(a);a.input&&a.input.val(c?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&""==a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_generateHTML:function(a){var b=new Date,b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate())),e=this._get(a,"isRTL"),c=this._get(a,"showButtonPanel"),d=this._get(a,
"hideIfNoPrevNext"),m=this._get(a,"navigationAsDateFormat"),q=this._getNumberOfMonths(a),j=this._get(a,"showCurrentAtPos"),t=this._get(a,"stepMonths"),v=1!=q[0]||1!=q[1],z=this._daylightSavingAdjust(!a.currentDay?new Date(9999,9,9):new Date(a.currentYear,a.currentMonth,a.currentDay)),x=this._getMinMaxDate(a,"min"),y=this._getMinMaxDate(a,"max"),j=a.drawMonth-j,B=a.drawYear;0>j&&(j+=12,B--);if(y)for(var A=this._daylightSavingAdjust(new Date(y.getFullYear(),y.getMonth()-q[0]*q[1]+1,y.getDate())),A=
x&&A<x?x:A;this._daylightSavingAdjust(new Date(B,j,1))>A;)j--,0>j&&(j=11,B--);a.drawMonth=j;a.drawYear=B;var A=this._get(a,"prevText"),A=!m?A:this.formatDate(A,this._daylightSavingAdjust(new Date(B,j-t,1)),this._getFormatConfig(a)),A=this._canAdjustMonth(a,-1,B,j)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+l+".datepicker._adjustDate('#"+a.id+"', -"+t+", 'M');\" title=\""+A+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"e":"w")+'">'+A+"</span></a>":d?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+
A+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"e":"w")+'">'+A+"</span></a>",F=this._get(a,"nextText"),F=!m?F:this.formatDate(F,this._daylightSavingAdjust(new Date(B,j+t,1)),this._getFormatConfig(a)),d=this._canAdjustMonth(a,1,B,j)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+l+".datepicker._adjustDate('#"+a.id+"', +"+t+", 'M');\" title=\""+F+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"w":"e")+'">'+F+"</span></a>":d?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+
F+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"w":"e")+'">'+F+"</span></a>",t=this._get(a,"currentText"),F=this._get(a,"gotoCurrent")&&a.currentDay?z:b,t=!m?t:this.formatDate(t,F,this._getFormatConfig(a)),m=!a.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+l+'.datepicker._hideDatepicker();">'+this._get(a,"closeText")+"</button>":"",c=c?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(e?m:"")+(this._isInRange(a,
F)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+l+".datepicker._gotoToday('#"+a.id+"');\">"+t+"</button>":"")+(e?"":m)+"</div>":"",m=parseInt(this._get(a,"firstDay"),10),m=isNaN(m)?0:m,t=this._get(a,"showWeek"),F=this._get(a,"dayNames");this._get(a,"dayNamesShort");var N=this._get(a,"dayNamesMin"),K=this._get(a,"monthNames"),G=this._get(a,"monthNamesShort"),R=this._get(a,"beforeShowDay"),I=this._get(a,"showOtherMonths"),
ba=this._get(a,"selectOtherMonths");this._get(a,"calculateWeek");for(var T=this._getDefaultDate(a),Y="",D=0;D<q[0];D++){var M="";this.maxRows=4;for(var Z=0;Z<q[1];Z++){var E=this._daylightSavingAdjust(new Date(B,j,a.selectedDay)),H=" ui-corner-all",L="";if(v){L+='<div class="ui-datepicker-group';if(1<q[1])switch(Z){case 0:L+=" ui-datepicker-group-first";H=" ui-corner-"+(e?"right":"left");break;case q[1]-1:L+=" ui-datepicker-group-last";H=" ui-corner-"+(e?"left":"right");break;default:L+=" ui-datepicker-group-middle",
H=""}L+='">'}for(var L=L+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+H+'">'+(/all|left/.test(H)&&0==D?e?d:A:"")+(/all|right/.test(H)&&0==D?e?A:d:"")+this._generateMonthYearHeader(a,j,B,x,y,0<D||0<Z,K,G)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),C=t?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"",H=0;7>H;H++)var O=(H+m)%7,C=C+("<th"+(5<=(H+m+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+F[O]+'">'+N[O]+"</span></th>");
L+=C+"</tr></thead><tbody>";C=this._getDaysInMonth(B,j);B==a.selectedYear&&j==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,C));H=(this._getFirstDayOfMonth(B,j)-m+7)%7;C=Math.ceil((H+C)/7);this.maxRows=C=v?this.maxRows>C?this.maxRows:C:C;for(var O=this._daylightSavingAdjust(new Date(B,j,1-H)),ha=0;ha<C;ha++){for(var L=L+"<tr>",aa=!t?"":'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(O)+"</td>",H=0;7>H;H++){var X=R?R.apply(a.input?a.input[0]:null,[O]):[!0,""],S=O.getMonth()!=
j,W=S&&!ba||!X[0]||x&&O<x||y&&O>y,aa=aa+('<td class="'+(5<=(H+m+6)%7?" ui-datepicker-week-end":"")+(S?" ui-datepicker-other-month":"")+(O.getTime()==E.getTime()&&j==a.selectedMonth&&a._keyEvent||T.getTime()==O.getTime()&&T.getTime()==E.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+" ui-state-disabled":"")+(S&&!I?"":" "+X[1]+(O.getTime()==z.getTime()?" "+this._currentClass:"")+(O.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!S||I)&&X[2]?' title="'+X[2]+'"':"")+(W?
"":' onclick="DP_jQuery_'+l+".datepicker._selectDay('#"+a.id+"',"+O.getMonth()+","+O.getFullYear()+', this);return false;"')+">"+(S&&!I?"&#xa0;":W?'<span class="ui-state-default">'+O.getDate()+"</span>":'<a class="ui-state-default'+(O.getTime()==b.getTime()?" ui-state-highlight":"")+(O.getTime()==z.getTime()?" ui-state-active":"")+(S?" ui-priority-secondary":"")+'" href="#">'+O.getDate()+"</a>")+"</td>");O.setDate(O.getDate()+1);O=this._daylightSavingAdjust(O)}L+=aa+"</tr>"}j++;11<j&&(j=0,B++);L+=
"</tbody></table>"+(v?"</div>"+(0<q[0]&&Z==q[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");M+=L}Y+=M}Y+=c+(f.browser.msie&&7>parseInt(f.browser.version,10)&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");a._keyEvent=!1;return Y},_generateMonthYearHeader:function(a,b,e,c,d,f,m,j){var t=this._get(a,"changeMonth"),v=this._get(a,"changeYear"),z=this._get(a,"showMonthAfterYear"),x='<div class="ui-datepicker-title">',y="";if(f||!t)y+='<span class="ui-datepicker-month">'+
m[b]+"</span>";else{for(var m=c&&c.getFullYear()==e,B=d&&d.getFullYear()==e,y=y+('<select class="ui-datepicker-month" onchange="DP_jQuery_'+l+".datepicker._selectMonthYear('#"+a.id+"', this, 'M');\" >"),A=0;12>A;A++)if((!m||A>=c.getMonth())&&(!B||A<=d.getMonth()))y+='<option value="'+A+'"'+(A==b?' selected="selected"':"")+">"+j[A]+"</option>";y+="</select>"}z||(x+=y+(f||!t||!v?"&#xa0;":""));if(!a.yearshtml)if(a.yearshtml="",f||!v)x+='<span class="ui-datepicker-year">'+e+"</span>";else{var j=this._get(a,
"yearRange").split(":"),F=(new Date).getFullYear(),m=function(a){a=a.match(/c[+-].*/)?e+parseInt(a.substring(1),10):a.match(/[+-].*/)?F+parseInt(a,10):parseInt(a,10);return isNaN(a)?F:a},b=m(j[0]),j=Math.max(b,m(j[1]||"")),b=c?Math.max(b,c.getFullYear()):b,j=d?Math.min(j,d.getFullYear()):j;for(a.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+l+".datepicker._selectMonthYear('#"+a.id+"', this, 'Y');\" >";b<=j;b++)a.yearshtml+='<option value="'+b+'"'+(b==e?' selected="selected"':
"")+">"+b+"</option>";a.yearshtml+="</select>";x+=a.yearshtml;a.yearshtml=null}x+=this._get(a,"yearSuffix");z&&(x+=(f||!t||!v?"&#xa0;":"")+y);return x+"</div>"},_adjustInstDate:function(a,b,e){var c=a.drawYear+("Y"==e?b:0),d=a.drawMonth+("M"==e?b:0),b=Math.min(a.selectedDay,this._getDaysInMonth(c,d))+("D"==e?b:0),c=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(c,d,b)));a.selectedDay=c.getDate();a.drawMonth=a.selectedMonth=c.getMonth();a.drawYear=a.selectedYear=c.getFullYear();("M"==e||
"Y"==e)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var e=this._getMinMaxDate(a,"min"),c=this._getMinMaxDate(a,"max"),e=e&&b<e?e:b;return c&&e>c?c:e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,"numberOfMonths");return null==a?[1,1]:"number"==typeof a?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,
b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,e,c){var d=this._getNumberOfMonths(a),e=this._daylightSavingAdjust(new Date(e,c+(0>b?b:d[0]*d[1]),1));0>b&&e.setDate(this._getDaysInMonth(e.getFullYear(),e.getMonth()));return this._isInRange(a,e)},_isInRange:function(a,b){var e=this._getMinMaxDate(a,"min"),c=this._getMinMaxDate(a,"max");return(!e||b.getTime()>=e.getTime())&&(!c||b.getTime()<=
c.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff"),b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,e,c){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);b=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(c,
e,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});f.fn.datepicker=function(a){if(!this.length)return this;f.datepicker.initialized||(f(document).mousedown(f.datepicker._checkExternalClick).find("body").append(f.datepicker.dpDiv),f.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);return"string"==typeof a&&("isDisabled"==a||"getDate"==a||"widget"==a)||"option"==
a&&2==arguments.length&&"string"==typeof arguments[1]?f.datepicker["_"+a+"Datepicker"].apply(f.datepicker,[this[0]].concat(b)):this.each(function(){typeof a=="string"?f.datepicker["_"+a+"Datepicker"].apply(f.datepicker,[this].concat(b)):f.datepicker._attachDatepicker(this,a)})};f.datepicker=new d;f.datepicker.initialized=!1;f.datepicker.uuid=(new Date).getTime();f.datepicker.version="1.9m6";window["DP_jQuery_"+l]=f})(j);(function(f,a){var d={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,
minWidth:!0,width:!0},c={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};f.widget("ui.dialog",{version:"1.9m6",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(a){var c=f(this).css(a).offset().top;0>c&&f(this).css("top",a.top-c)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1E3},
_create:function(){this.originalTitle=this.element.attr("title");"string"!==typeof this.originalTitle&&(this.originalTitle="");this.options.title=this.options.title||this.originalTitle;var a=this,c=a.options,d=c.title||"&#160;",g=f.ui.dialog.getTitleId(a.element),k=(a.uiDialog=f("<div>")).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c.dialogClass).css({display:"none",outline:0,zIndex:c.zIndex}).attr("tabIndex",-1).keydown(function(e){if(c.closeOnEscape&&!e.isDefaultPrevented()&&
e.keyCode&&e.keyCode===f.ui.keyCode.ESCAPE){a.close(e);e.preventDefault()}}).attr({role:"dialog","aria-labelledby":g}).mousedown(function(e){a.moveToTop(false,e)}).appendTo("body");a.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(k);var e=(a.uiDialogTitlebar=f("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").prependTo(k),p=f("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role",
"button").click(function(e){e.preventDefault();a.close(e)}).appendTo(e);(a.uiDialogTitlebarCloseText=f("<span>")).addClass("ui-icon ui-icon-closethick").text(c.closeText).appendTo(p);f("<span>").addClass("ui-dialog-title").attr("id",g).html(d).prependTo(e);e.find("*").add(e).disableSelection();this._hoverable(p);this._focusable(p);c.draggable&&f.fn.draggable&&a._makeDraggable();c.resizable&&f.fn.resizable&&a._makeResizable();a._createButtons(c.buttons);a._isOpen=!1;f.fn.bgiframe&&k.bgiframe()},_init:function(){this.options.autoOpen&&
this.open()},_destroy:function(){this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();this.originalTitle&&this.element.attr("title",this.originalTitle)},widget:function(){return this.uiDialog},close:function(a){if(!this._isOpen)return c;var c=this,d,g;if(!1!==c._trigger("beforeClose",a))return c._isOpen=!1,c.overlay&&c.overlay.destroy(),c.uiDialog.unbind("keypress.ui-dialog"),c.options.hide?
c.uiDialog.hide(c.options.hide,function(){c._trigger("close",a)}):(c.uiDialog.hide(),c._trigger("close",a)),f.ui.dialog.overlay.resize(),c.options.modal&&(d=0,f(".ui-dialog").each(function(){if(this!==c.uiDialog[0]){g=f(this).css("z-index");isNaN(g)||(d=Math.max(d,g))}}),f.ui.dialog.maxZ=d),c},isOpen:function(){return this._isOpen},moveToTop:function(a,c){var d=this.options;if(d.modal&&!a||!d.stack&&!d.modal)return this._trigger("focus",c);d.zIndex>f.ui.dialog.maxZ&&(f.ui.dialog.maxZ=d.zIndex);this.overlay&&
(f.ui.dialog.maxZ+=1,f.ui.dialog.overlay.maxZ=f.ui.dialog.maxZ,this.overlay.$el.css("z-index",f.ui.dialog.overlay.maxZ));d={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()};f.ui.dialog.maxZ+=1;this.uiDialog.css("z-index",f.ui.dialog.maxZ);this.element.attr(d);this._trigger("focus",c);return this},open:function(){if(!this._isOpen){var a=this.options,c=this.uiDialog;this._size();this._position(a.position);c.show(a.show);this.overlay=a.modal?new f.ui.dialog.overlay(this):null;
this.moveToTop(!0);a.modal&&c.bind("keydown.ui-dialog",function(a){if(a.keyCode===f.ui.keyCode.TAB){var b=f(":tabbable",this),c=b.filter(":first"),b=b.filter(":last");if(a.target===b[0]&&!a.shiftKey)return c.focus(1),!1;if(a.target===c[0]&&a.shiftKey)return b.focus(1),!1}});a=this.element.find(":tabbable");a.length||(a=c.find(".ui-dialog-buttonpane :tabbable"),a.length||(a=c));a.eq(0).focus();this._isOpen=!0;this._trigger("open");return this}},_createButtons:function(a){var c=this,d=!1;c.uiDialog.find(".ui-dialog-buttonpane").remove();
"object"===typeof a&&null!==a&&f.each(a,function(){return!(d=!0)});if(d){var g=f("<div>").addClass("ui-dialog-buttonpane  ui-widget-content ui-helper-clearfix"),k=f("<div>").addClass("ui-dialog-buttonset").appendTo(g);f.each(a,function(a,b){var b=f.isFunction(b)?{click:b,text:a}:b,g=f("<button type='button'>").attr(b,!0).unbind("click").click(function(){b.click.apply(c.element[0],arguments)}).appendTo(k);f.fn.button&&g.button()});c.uiDialog.addClass("ui-dialog-buttons");g.appendTo(c.uiDialog)}else c.uiDialog.removeClass("ui-dialog-buttons")},
_makeDraggable:function(){function a(b){return{position:b.position,offset:b.offset}}var c=this,d=c.options,g=f(document);c.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(g,e){f(this).addClass("ui-dialog-dragging");c._trigger("dragStart",g,a(e))},drag:function(g,e){c._trigger("drag",g,a(e))},stop:function(k,e){d.position=[e.position.left-g.scrollLeft(),e.position.top-g.scrollTop()];f(this).removeClass("ui-dialog-dragging");
c._trigger("dragStop",k,a(e));f.ui.dialog.overlay.resize()}})},_makeResizable:function(b){function c(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var b=b===a?this.options.resizable:b,d=this,g=d.options,k=d.uiDialog.css("position"),b="string"===typeof b?b:"n,e,s,w,se,sw,ne,nw";d.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:d.element,maxWidth:g.maxWidth,maxHeight:g.maxHeight,minWidth:g.minWidth,minHeight:d._minHeight(),
handles:b,start:function(a,b){f(this).addClass("ui-dialog-resizing");d._trigger("resizeStart",a,c(b))},resize:function(a,b){d._trigger("resize",a,c(b))},stop:function(a,b){f(this).removeClass("ui-dialog-resizing");g.height=f(this).height();g.width=f(this).width();d._trigger("resizeStop",a,c(b));f.ui.dialog.overlay.resize()}}).css("position",k).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,
a.height)},_position:function(a){var c=[],d=[0,0],g;if(a){if("string"===typeof a||"object"===typeof a&&"0"in a)c=a.split?a.split(" "):[a[0],a[1]],1===c.length&&(c[1]=c[0]),f.each(["left","top"],function(a,b){+c[a]===c[a]&&(d[a]=c[a],c[a]=b)}),a={my:c.join(" "),at:c.join(" "),offset:d.join(" ")};a=f.extend({},f.ui.dialog.prototype.options.position,a)}else a=f.ui.dialog.prototype.options.position;(g=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.position(a);g||this.uiDialog.hide()},
_setOptions:function(a){var l=this,m={},g=!1;f.each(a,function(a,b){l._setOption(a,b);a in d&&(g=!0);a in c&&(m[a]=b)});g&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",m)},_setOption:function(a,c){var d=this.uiDialog;switch(a){case "buttons":this._createButtons(c);break;case "closeText":this.uiDialogTitlebarCloseText.text(""+c);break;case "dialogClass":d.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c);
break;case "disabled":c?d.addClass("ui-dialog-disabled"):d.removeClass("ui-dialog-disabled");break;case "draggable":var g=d.is(":data(draggable)");g&&!c&&d.draggable("destroy");!g&&c&&this._makeDraggable();break;case "position":this._position(c);break;case "resizable":(g=d.is(":data(resizable)"))&&!c&&d.resizable("destroy");g&&"string"===typeof c&&d.resizable("option","handles",c);!g&&!1!==c&&this._makeResizable(c);break;case "title":f(".ui-dialog-title",this.uiDialogTitlebar).html(""+(c||"&#160;"))}this._super("_setOption",
a,c)},_size:function(){var a=this.options,c,d,g=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});a.minWidth>a.width&&(a.width=a.minWidth);c=this.uiDialog.css({height:"auto",width:a.width}).height();d=Math.max(0,a.minHeight-c);"auto"===a.height?f.support.minHeight?this.element.css({minHeight:d,height:"auto"}):(this.uiDialog.show(),a=this.element.css("height","auto").height(),g||this.uiDialog.hide(),this.element.height(Math.max(a,d))):this.element.height(Math.max(a.height-
c,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}});f.extend(f.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");a||(a=this.uuid+=1);return"ui-dialog-title-"+a},overlay:function(a){this.$el=f.ui.dialog.overlay.create(a)}});f.extend(f.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:f.map("focus mousedown mouseup keydown keypress click".split(" "),function(a){return a+".dialog-overlay"}).join(" "),create:function(a){0===
this.instances.length&&(setTimeout(function(){f.ui.dialog.overlay.instances.length&&f(document).bind(f.ui.dialog.overlay.events,function(a){if(f(a.target).zIndex()<f.ui.dialog.overlay.maxZ)return!1})},1),f(document).bind("keydown.dialog-overlay",function(c){a.options.closeOnEscape&&(!c.isDefaultPrevented()&&c.keyCode&&c.keyCode===f.ui.keyCode.ESCAPE)&&(a.close(c),c.preventDefault())}),f(window).bind("resize.dialog-overlay",f.ui.dialog.overlay.resize));var c=(this.oldInstances.pop()||f("<div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),
height:this.height()});f.fn.bgiframe&&c.bgiframe();this.instances.push(c);return c},destroy:function(a){var c=f.inArray(a,this.instances);-1!==c&&this.oldInstances.push(this.instances.splice(c,1)[0]);0===this.instances.length&&f([document,window]).unbind(".dialog-overlay");a.height(0).width(0).remove();var d=0;f.each(this.instances,function(){d=Math.max(d,this.css("z-index"))});this.maxZ=d},height:function(){var a,c;return f.browser.msie?(a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),
c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),a<c?f(window).height()+"px":a+"px"):f(document).height()+"px"},width:function(){var a,c;return f.browser.msie?(a=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),a<c?f(window).width()+"px":a+"px"):f(document).width()+"px"},resize:function(){var a=f([]);f.each(f.ui.dialog.overlay.instances,function(){a=a.add(this)});a.css({width:0,
height:0}).css({width:f.ui.dialog.overlay.width(),height:f.ui.dialog.overlay.height()})}});f.extend(f.ui.dialog.overlay.prototype,{destroy:function(){f.ui.dialog.overlay.destroy(this.$el)}})})(j);(function(f){function a(a){if(!f(a.target).closest(".ui-menu").length)for(var c in b)b.hasOwnProperty(c)&&b[c].collapseAll(a)}var d=0,c=0,b={};f.widget("ui.menu",{version:"1.9m6",defaultElement:"<ul>",delay:150,options:{position:{my:"left top",at:"right top"}},_create:function(){this.activeMenu=this.element;
this.menuId=this.element.attr("id")||"ui-menu-"+d++;this.element.find(".ui-icon").length&&this.element.addClass("ui-menu-icons");this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).bind("click.menu",f.proxy(function(a){this.options.disabled&&a.preventDefault()},this));this._bind({"click .ui-menu-item:has(a)":function(a){a.stopImmediatePropagation();var b=f(a.currentTarget);(!this.active||this.active[0]!==b[0])&&this.focus(a,b);this.select(a)},
"mouseover .ui-menu-item":function(a){a.stopImmediatePropagation();var b=f(a.currentTarget);b.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(a,b)},mouseleave:"_mouseleave","mouseleave .ui-menu":"_mouseleave","mouseout .ui-menu-item":"blur",focus:function(a){this.focus(a,f(a.target).children(".ui-menu-item:first"))},blur:"collapseAll"});this.refresh();this.element.attr("tabIndex",0);this._bind({keydown:function(a){switch(a.keyCode){case f.ui.keyCode.PAGE_UP:this.previousPage(a);
a.preventDefault();a.stopImmediatePropagation();break;case f.ui.keyCode.PAGE_DOWN:this.nextPage(a);a.preventDefault();a.stopImmediatePropagation();break;case f.ui.keyCode.HOME:this._move("first","first",a);a.preventDefault();a.stopImmediatePropagation();break;case f.ui.keyCode.END:this._move("last","last",a);a.preventDefault();a.stopImmediatePropagation();break;case f.ui.keyCode.UP:this.previous(a);a.preventDefault();a.stopImmediatePropagation();break;case f.ui.keyCode.DOWN:this.next(a);a.preventDefault();
a.stopImmediatePropagation();break;case f.ui.keyCode.LEFT:this.collapse(a)&&a.stopImmediatePropagation();a.preventDefault();break;case f.ui.keyCode.RIGHT:this.expand(a)&&a.stopImmediatePropagation();a.preventDefault();break;case f.ui.keyCode.ENTER:this.active.children("a[aria-haspopup='true']").length?this.expand(a)&&a.stopImmediatePropagation():(this.select(a),a.stopImmediatePropagation());a.preventDefault();break;case f.ui.keyCode.ESCAPE:this.collapse(a)&&a.stopImmediatePropagation();a.preventDefault();
break;default:a.stopPropagation();clearTimeout(this.filterTimer);var b;b=this.previousFilter||"";var c=String.fromCharCode(a.keyCode),d=!1;c==b?d=!0:c=b+c;var e=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};b=this.activeMenu.children(".ui-menu-item").filter(function(){return RegExp("^"+e(c),"i").test(f(this).children("a").text())});b=d&&-1!=b.index(this.active.next())?this.active.nextAll(".ui-menu-item"):b;b.length||(c=String.fromCharCode(a.keyCode),b=this.activeMenu.children(".ui-menu-item").filter(function(){return RegExp("^"+
e(c),"i").test(f(this).children("a").text())}));b.length?(this.focus(a,b),1<b.length?(this.previousFilter=c,this.filterTimer=this._delay(function(){delete this.previousFilter},1E3)):delete this.previousFilter):delete this.previousFilter}}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show();
this.element.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove()},refresh:function(){var a=this.element.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false"),b=this.menuId;a.add(this.element).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role",
"presentation").children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(a){return b+"-"+a});a.each(function(){var a=f(this),b=a.prev("a");b.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>');a.attr("aria-labelledby",b.attr("id"))})},focus:function(a,b){this.blur(a);if(this._hasScroll()){var c=parseFloat(f.curCSS(this.activeMenu[0],"borderTopWidth",!0))||0,d=parseFloat(f.curCSS(this.activeMenu[0],"paddingTop",
!0))||0,c=b.offset().top-this.activeMenu.offset().top-c-d,d=this.activeMenu.scrollTop(),e=this.activeMenu.height(),p=b.height();0>c?this.activeMenu.scrollTop(d+c):c+p>e&&this.activeMenu.scrollTop(d+c-e+p)}this.active=b.first().children("a").addClass("ui-state-focus").end();this.element.attr("aria-activedescendant",this.active.children("a").attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");this.timer=this._delay(function(){this._close()},this.delay);
c=f(">ul",b);c.length&&/^mouse/.test(a.type)&&this._startOpening(c);this.activeMenu=b.parent();this._trigger("focus",a,{item:b})},blur:function(a){this.active&&(clearTimeout(this.timer),this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer);"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close();this._open(a)},this.delay))},_open:function(d){clearTimeout(this.timer);
this.element.find(".ui-menu").not(d.parents()).hide().attr("aria-hidden","true");var m=f.extend({},{of:this.active},"function"==f.type(this.options.position)?this.options.position(this.active):this.options.position);d.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(m);b[this.menuId]||(b[this.menuId]=this,c++||f("body").click(a))},collapseAll:function(a){var b=!1;if(a){var c=f(a.target);c.is("ui.menu")?b=c:c.closest(".ui-menu").length&&(b=c.closest(".ui-menu"))}this._close(b);
b||(this.blur(a),this.activeMenu=this.element)},_close:function(d){d||(d=this.active?this.active.parent():this.element);d.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active");d[0]===this.element[0]&&b[this.menuId]&&(delete b[this.menuId],c&&!--c&&f("body").unbind("click",a))},collapse:function(a){var b=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(b&&b.length)return this._close(),this.focus(a,
b),!0},expand:function(a){var b=this.active&&this.active.children("ul").children("li").first();if(b&&b.length)return this._open(b.parent()),this._delay(function(){this.focus(a,b)},20),!0},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){this.active?(a="first"===a||"last"===
a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0),a.length?this.focus(c,a):this.focus(c,this.activeMenu.children(".ui-menu-item")[b]())):this.focus(c,this.activeMenu.children(".ui-menu-item")[b]())},nextPage:function(a){if(this._hasScroll())if(this.active){if(!this.last()){var b=this.active.offset().top,c=this.element.height(),d;this.active.nextAll(".ui-menu-item").each(function(){d=f(this);return 0>f(this).offset().top-b-c});this.focus(a,
d)}}else this.focus(a,this.activeMenu.children(".ui-menu-item").first());else this.focus(a,this.activeMenu.children(".ui-menu-item")[!this.active?"first":"last"]())},previousPage:function(a){if(this._hasScroll())if(this.active){if(!this.first()){var b=this.active.offset().top,c=this.element.height(),d;this.active.prevAll(".ui-menu-item").each(function(){d=f(this);return 0<f(this).offset().top-b+c});this.focus(a,d)}}else this.focus(a,this.activeMenu.children(".ui-menu-item").first());else this.focus(a,
this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.height()<this.element.prop("scrollHeight")},_mouseleave:function(a){this.collapseAll(a);this.blur()},select:function(a){var b={item:this.active};this.collapseAll(a);this._trigger("select",a,b)}})})(j);(function(f){f.widget("ui.menubar",{version:"1.9m6",options:{autoExpand:!1,buttons:!1,menuIcon:!1,position:{my:"left top",at:"left bottom"}},_create:function(){var a=this,d=this.items=this.element.children("li").addClass("ui-menubar-item").attr("role",
"presentation").children("button, a");d.slice(1).attr("tabIndex",-1);this.element.addClass("ui-menubar ui-widget-header ui-helper-clearfix").attr("role","menubar");this._focusable(d);this._hoverable(d);d.next("ul").menu({position:{within:this.options.position.within},select:function(c,b){b.item.parents("ul.ui-menu:last").hide();a._close();f(c.target).prev().focus();a._trigger("select",c,b)}}).hide().attr({"aria-hidden":"true","aria-expanded":"false"}).bind("keydown.menubar",function(c){if(!f(this).is(":hidden"))switch(c.keyCode){case f.ui.keyCode.LEFT:a._left(c);
c.preventDefault();break;case f.ui.keyCode.RIGHT:a._right(c),c.preventDefault()}});d.each(function(){var c=f(this),b=c.next("ul");c.bind("click.menubar focus.menubar mouseenter.menubar",function(c){if("focus"!=c.type||c.originalEvent)if(c.preventDefault(),"click"==c.type&&b.is(":visible")&&a.active&&a.active[0]==b[0])a._close();else if(a.open&&"mouseenter"==c.type||"click"==c.type||a.options.autoExpand)a.options.autoExpand&&clearTimeout(a.timer),a._open(c,b)}).bind("keydown",function(b){switch(b.keyCode){case f.ui.keyCode.SPACE:case f.ui.keyCode.UP:case f.ui.keyCode.DOWN:a._open(b,
f(this).next());b.preventDefault();break;case f.ui.keyCode.LEFT:a._prev(b,f(this));b.preventDefault();break;case f.ui.keyCode.RIGHT:a._next(b,f(this)),b.preventDefault()}}).addClass("ui-button ui-widget ui-button-text-only ui-menubar-link").attr("role","menuitem").attr("aria-haspopup","true").wrapInner("<span class='ui-button-text'></span>");a.options.autoExpand&&(c.bind("mouseleave.menubar",function(){a.timer=setTimeout(function(){a._close()},150)}),b.bind("mouseleave.menubar",function(){a.timer=
setTimeout(function(){a._close()},150)}).bind("mouseenter.menubar",function(){clearTimeout(a.timer)}));a.options.menuIcon&&(c.addClass("ui-state-default").append("<span class='ui-button-icon-secondary ui-icon ui-icon-triangle-1-s'></span>"),c.removeClass("ui-button-text-only").addClass("ui-button-text-icon-secondary"));a.options.buttons||c.addClass("ui-menubar-link").removeClass("ui-state-default")});a._bind({keydown:function(c){if(c.keyCode==f.ui.keyCode.ESCAPE&&a.active&&!0!==a.active.menu("collapse",
c)){var b=a.active;a.active.blur();a._close(c);b.prev().focus()}},focusin:function(){clearTimeout(a.closeTimer)},focusout:function(c){a.closeTimer=setTimeout(function(){a._close(c)},100)}})},_destroy:function(){var a=this.element.children("li").removeClass("ui-menubar-item").removeAttr("role").children("button, a");this.element.removeClass("ui-menubar ui-widget-header ui-helper-clearfix").removeAttr("role").unbind(".menubar");a.unbind(".menubar").removeClass("ui-button ui-widget ui-button-text-only ui-menubar-link ui-state-default").removeAttr("role").removeAttr("aria-haspopup").children("span.ui-button-text").each(function(){var a=
f(this);a.parent().html(a.html())}).end().children(".ui-icon").remove();this.element.find(":ui-menu").menu("destroy").show().removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("tabindex").unbind(".menubar")},_close:function(){this.active&&this.active.length&&(this.active.menu("collapseAll").hide().attr({"aria-hidden":"true","aria-expanded":"false"}),this.active.prev().removeClass("ui-state-active").removeAttr("tabIndex"),this.active=null,this.open=!1)},_open:function(a,d){if(!(this.active&&
this.active[0]==d[0])){this.active&&(this.active.menu("collapseAll").hide().attr({"aria-hidden":"true","aria-expanded":"false"}),this.active.prev().removeClass("ui-state-active"));var c=d.prev().addClass("ui-state-active").attr("tabIndex",-1);this.active=d.show().position(f.extend({of:c},this.options.position)).removeAttr("aria-hidden").attr("aria-expanded","true").menu("focus",a,d.children("li").first()).focus().focusin();this.open=!0}},_prev:function(a,d){d.attr("tabIndex",-1);var c=d.parent().prevAll("li").children(".ui-button").eq(0);
c.length?c.removeAttr("tabIndex")[0].focus():this.element.children("li:last").children(".ui-button:last").removeAttr("tabIndex")[0].focus()},_next:function(a,d){d.attr("tabIndex",-1);var c=d.parent().nextAll("li").children(".ui-button").eq(0);c.length?c.removeAttr("tabIndex")[0].focus():this.element.children("li:first").children(".ui-button:first").removeAttr("tabIndex")[0].focus()},_left:function(a){var d=this.active.parent().prevAll("li:eq(0)").children(".ui-menu").eq(0);d.length||(d=this.element.children("li:last").children(".ui-menu:first"));
this._open(a,d)},_right:function(a){var d=this.active.parent().nextAll("li:eq(0)").children(".ui-menu").eq(0);d.length||(d=this.element.children("li:first").children(".ui-menu:first"));this._open(a,d)}})})(j);(function(f){var a=0;f.widget("ui.popup",{version:"1.9m6",options:{position:{my:"left top",at:"left bottom"}},_create:function(){this.options.trigger||(this.options.trigger=this.element.prev());this.element.attr("id")||(this.element.attr("id","ui-popup-"+a++),this.generatedId=!0);this.element.attr("role")||
(this.element.attr("role","dialog"),this.generatedRole=!0);this.options.trigger.attr("aria-haspopup","true").attr("aria-owns",this.element.attr("id"));this.element.addClass("ui-popup");this.close();this._bind(this.options.trigger,{keydown:function(a){f.ui.button&&(this.options.trigger.is("a:ui-button")&&a.keyCode==f.ui.keyCode.SPACE)&&a.preventDefault();a.keyCode==f.ui.keyCode.SPACE&&this.options.trigger.is("a:not(:ui-button)")&&this.options.trigger.trigger("click",a);if(a.keyCode==f.ui.keyCode.DOWN){a.preventDefault();
this.options.trigger.trigger("click",a)}},click:function(a){a.preventDefault();if(!this.isOpen){clearTimeout(this.closeTimer);this._delay(function(){this.open(a)},1)}}});this.element.is(":ui-menu")||this._bind({keydown:function(a){if(a.keyCode===f.ui.keyCode.TAB){var c=f(":tabbable",this.element),b=c.first(),c=c.last();if(a.target===c[0]&&!a.shiftKey){b.focus(1);a.preventDefault()}else if(a.target===b[0]&&a.shiftKey){c.focus(1);a.preventDefault()}}}});this._bind({focusout:function(a){this.closeTimer=
this._delay(function(){this.close(a)},100)},focusin:function(){clearTimeout(this.closeTimer)}});this._bind({keyup:function(a){if(a.keyCode==f.ui.keyCode.ESCAPE&&this.element.is(":visible")){this.close(a);this.options.trigger.focus()}}});this._bind(document,{click:function(a){this.isOpen&&!f(a.target).closest(".ui-popup").length&&this.close(a)}})},_destroy:function(){this.element.show().removeClass("ui-popup").removeAttr("aria-hidden").removeAttr("aria-expanded").unbind("keypress.ui-popup");this.options.trigger.removeAttr("aria-haspopup").removeAttr("aria-owns");
this.generatedId&&this.element.removeAttr("id");this.generatedRole&&this.element.removeAttr("role")},open:function(a){var c=f.extend({},{of:this.options.trigger},this.options.position);this.element.show().attr("aria-hidden","false").attr("aria-expanded","true").position(c);this.element.is(":ui-menu")?(this.element.menu("focus",a,this.element.children("li").first()),this.element.focus()):(c=this.element.find(":tabbable"),this.removeTabIndex=!1,c.length||(this.element.is(":tabbable")||(this.element.attr("tabindex",
"0"),this.removeTabIndex=!0),c=c.add(this.element[0])),c.first().focus(1));this.options.trigger.attr("tabindex",-1);this.isOpen=!0;this._trigger("open",a)},close:function(a){this.element.hide().attr("aria-hidden","true").attr("aria-expanded","false");this.options.trigger.attr("tabindex",0);this.removeTabIndex&&this.element.removeAttr("tabindex");this.isOpen=!1;this._trigger("close",a)}})})(j);(function(f,a){f.ui=f.ui||{};var d=/left|center|right/,c=/top|center|bottom/,b=/[+-]\d+%?/,l=/^\w+/,m=/%$/,
g=f.fn.position;f.position={scrollbarWidth:function(){var a,b,c=f("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>");b=c.children()[0];f("body").append(c);a=b.offsetWidth;c.css("overflow","scroll");b=b.offsetWidth;a===b&&(b=c[0].clientWidth);c.remove();return a-b},getScrollInfo:function(a){var b=a[0]!==window,c=b?a.css("overflow-x"):"",b=b?a.css("overflow-y"):"",c="auto"===c||"scroll"===c?f.position.scrollbarWidth():0,b="auto"===
b||"scroll"===b?f.position.scrollbarWidth():0;return{height:a.height()<a[0].scrollHeight?b:0,width:a.width()<a[0].scrollWidth?c:0}}};f.fn.position=function(a){if(!a||!a.of)return g.apply(this,arguments);var a=f.extend({},a),e=f(a.of),p=f(a.within||window),o=e[0],j=(a.collision||"flip").split(" "),q={},u,t,v,z;9===o.nodeType?(t=e.width(),v=e.height(),z={top:0,left:0}):f.isWindow(o)?(t=e.width(),v=e.height(),z={top:e.scrollTop(),left:e.scrollLeft()}):o.preventDefault?(a.at="left top",t=v=0,z={top:a.of.pageY,
left:a.of.pageX}):(t=e.outerWidth(),v=e.outerHeight(),z=e.offset());f.each(["my","at"],function(){var e=(a[this]||"").split(" "),g,f;e.length===1&&(e=d.test(e[0])?e.concat(["center"]):c.test(e[0])?["center"].concat(e):["center","center"]);e[0]=d.test(e[0])?e[0]:"center";e[1]=c.test(e[1])?e[1]:"center";g=b.exec(e[0]);f=b.exec(e[1]);q[this]=[g?g[0]:0,f?f[0]:0];a[this]=[l.exec(e[0])[0],l.exec(e[1])[0]]});1===j.length&&(j[1]=j[0]);"right"===a.at[0]?z.left+=t:"center"===a.at[0]&&(z.left+=t/2);"bottom"===
a.at[1]?z.top+=v:"center"===a.at[1]&&(z.top+=v/2);u=[parseInt(q.at[0],10)*(m.test(q.at[0])?t/100:1),parseInt(q.at[1],10)*(m.test(q.at[1])?v/100:1)];z.left+=u[0];z.top+=u[1];return this.each(function(){var b=f(this),c=b.outerWidth(),e=b.outerHeight(),g=parseInt(f.curCSS(this,"marginLeft",true))||0,d=parseInt(f.curCSS(this,"marginTop",true))||0,l=f.position.getScrollInfo(p),o=c+g+(parseInt(f.curCSS(this,"marginRight",true))||0)+l.width,G=e+d+(parseInt(f.curCSS(this,"marginBottom",true))||0)+l.height,
R=f.extend({},z),I=[parseInt(q.my[0],10)*(m.test(q.my[0])?b.outerWidth()/100:1),parseInt(q.my[1],10)*(m.test(q.my[1])?b.outerHeight()/100:1)],ba;if(a.my[0]==="right")R.left=R.left-c;else if(a.my[0]==="center")R.left=R.left-c/2;if(a.my[1]==="bottom")R.top=R.top-e;else if(a.my[1]==="center")R.top=R.top-e/2;R.left=R.left+I[0];R.top=R.top+I[1];ba={marginLeft:g,marginTop:d};f.each(["left","top"],function(g,d){if(f.ui.position[j[g]])f.ui.position[j[g]][d](R,{targetWidth:t,targetHeight:v,elemWidth:c,elemHeight:e,
collisionPosition:ba,collisionWidth:o,collisionHeight:G,offset:[u[0]+I[0],u[1]+I[1]],my:a.my,at:a.at,within:p,elem:b})});f.fn.bgiframe&&b.bgiframe();b.offset(f.extend(R,{using:a.using}))})};f.ui.position={fit:{left:function(a,b){var c=b.within,g=f(window),d=f.isWindow(b.within[0]),l=d?g.scrollLeft():c.offset().left,g=d?g.width():c.outerWidth(),d=a.left-b.collisionPosition.marginLeft,c=l-d,m=d+b.collisionWidth-g-l;b.collisionWidth>g?0<c&&0>=m?(l=a.left+c+b.collisionWidth-g-l,a.left+=c-l):a.left=0<
m&&0>=c?l:c>m?l+g-b.collisionWidth:l:a.left=0<c?a.left+c:0<m?a.left-m:Math.max(a.left-d,a.left)},top:function(a,b){var c=b.within,g=f(window),d=f.isWindow(b.within[0]),l=d?g.scrollTop():c.offset().top,g=d?g.height():c.outerHeight(),d=a.top-b.collisionPosition.marginTop,c=l-d,m=d+b.collisionHeight-g-l;b.collisionHeight>g?0<c&&0>=m?(l=a.top+c+b.collisionHeight-g-l,a.top+=c-l):a.top=0<m&&0>=c?l:c>m?l+g-b.collisionHeight:l:a.top=0<c?a.top+c:0<m?a.top-m:Math.max(a.top-d,a.top)}},flip:{left:function(a,
b){if("center"!==b.at[0]){b.elem.removeClass("ui-flipped-left ui-flipped-right");var c=b.within;f(window);var g=f.isWindow(b.within[0]),d=(g?0:c.offset().left)+c.scrollLeft(),l=g?c.width():c.outerWidth(),g=a.left-b.collisionPosition.marginLeft,c=g-d,m=g+b.collisionWidth-l-d,g="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,j="left"===b.at[0]?b.targetWidth:-b.targetWidth,v=-2*b.offset[0];if(0>c){if(d=a.left+g+j+v+b.collisionWidth-l-d,0>d||d<Math.abs(c))b.elem.addClass("ui-flipped-right"),
a.left+=g+j+v}else if(0<m&&(d=a.left-b.collisionPosition.marginLeft+g+j+v-d,0<d||Math.abs(d)<m))b.elem.addClass("ui-flipped-left"),a.left+=g+j+v}},top:function(a,b){if("center"!==b.at[1]){b.elem.removeClass("ui-flipped-top ui-flipped-bottom");var c=b.within;f(window);var g=f.isWindow(b.within[0]),d=(g?0:c.offset().top)+c.scrollTop(),l=g?c.height():c.outerHeight(),g=a.top-b.collisionPosition.marginTop,c=g-d,m=g+b.collisionHeight-l-d,g="top"===b.my[1]?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,
j="top"===b.at[1]?b.targetHeight:-b.targetHeight,v=-2*b.offset[1];if(0>c){if(d=a.top+g+j+v+b.collisionHeight-l-d,0>d||d<Math.abs(c))b.elem.addClass("ui-flipped-bottom"),a.top+=g+j+v}else if(0<m&&(d=a.top-b.collisionPosition.marginTop+g+j+v-d,0<d||Math.abs(d)<m))b.elem.addClass("ui-flipped-top"),a.top+=g+j+v}}},flipfit:{left:function(){f.ui.position.flip.left.apply(this,arguments);f.ui.position.fit.left.apply(this,arguments)},top:function(){f.ui.position.flip.top.apply(this,arguments);f.ui.position.fit.top.apply(this,
arguments)}}};!1!==f.uiBackCompat&&function(b){var c=b.fn.position;b.fn.position=function(g){if(!g||!g.offset)return c.call(this,g);var d=g.offset.split(" "),f=g.at.split(" ");1===d.length&&(d[1]=d[0]);/^\d/.test(d[0])&&(d[0]="+"+d[0]);/^\d/.test(d[1])&&(d[1]="+"+d[1]);1===f.length&&(/left|center|right/.test(f[0])?f[1]="center":(f[1]=f[0],f[0]="center"));return c.call(this,b.extend(g,{at:f[0]+d[0]+" "+f[1]+d[1],offset:a}))}}(j)})(j);(function(f,a){f.widget("ui.progressbar",{version:"1.9m6",options:{value:0,
max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=f("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove()},value:function(d){if(d===a)return this._value();this._setOption("value",d);return this},_setOption:function(a,c){"value"===a&&(this.options.value=c,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete"));this._super("_setOption",a,c)},_value:function(){var a=this.options.value;"number"!==typeof a&&(a=0);return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var a=
this.value(),c=this._percentage();this.oldValue!==a&&(this.oldValue=a,this._trigger("change"));this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(c.toFixed(0)+"%");this.element.attr("aria-valuenow",a)}})})(j);(function(f){f.widget("ui.slider",f.ui.mouse,{version:"1.9m6",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var a=this,d=this.options,c=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),
b=d.values&&d.values.length||1,l=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(d.disabled?" ui-slider-disabled ui-disabled":""));this.range=f([]);if(d.range){if(!0===d.range&&(d.values||(d.values=[this._valueMin(),this._valueMin()]),d.values.length&&2!==d.values.length))d.values=[d.values[0],d.values[0]];this.range=
f("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===d.range||"max"===d.range?" ui-slider-range-"+d.range:""))}for(var m=c.length;m<b;m+=1)l.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=c.add(f(l.join("")).appendTo(a.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){d.disabled||f(this).addClass("ui-state-hover")},function(){f(this).removeClass("ui-state-hover")}).focus(function(){d.disabled?
f(this).blur():(f(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),f(this).addClass("ui-state-focus"))}).blur(function(){f(this).removeClass("ui-state-focus")});this.handles.each(function(a){f(this).data("index.ui-slider-handle",a)});this.handles.keydown(function(b){var c=!0,e=f(this).data("index.ui-slider-handle"),d,l,m;if(!a.options.disabled){switch(b.keyCode){case f.ui.keyCode.HOME:case f.ui.keyCode.END:case f.ui.keyCode.PAGE_UP:case f.ui.keyCode.PAGE_DOWN:case f.ui.keyCode.UP:case f.ui.keyCode.RIGHT:case f.ui.keyCode.DOWN:case f.ui.keyCode.LEFT:if(c=
!1,!a._keySliding&&(a._keySliding=!0,f(this).addClass("ui-state-active"),d=a._start(b,e),!1===d))return}m=a.options.step;d=a.options.values&&a.options.values.length?l=a.values(e):l=a.value();switch(b.keyCode){case f.ui.keyCode.HOME:l=a._valueMin();break;case f.ui.keyCode.END:l=a._valueMax();break;case f.ui.keyCode.PAGE_UP:l=a._trimAlignValue(d+(a._valueMax()-a._valueMin())/5);break;case f.ui.keyCode.PAGE_DOWN:l=a._trimAlignValue(d-(a._valueMax()-a._valueMin())/5);break;case f.ui.keyCode.UP:case f.ui.keyCode.RIGHT:if(d===
a._valueMax())return;l=a._trimAlignValue(d+m);break;case f.ui.keyCode.DOWN:case f.ui.keyCode.LEFT:if(d===a._valueMin())return;l=a._trimAlignValue(d-m)}a._slide(b,e,l);return c}}).keyup(function(b){var c=f(this).data("index.ui-slider-handle");a._keySliding&&(a._keySliding=!1,a._stop(b,c),a._change(b,c),f(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=!1},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");
this._mouseDestroy();return this},_mouseCapture:function(a){var d=this.options,c,b,l,m,g;if(d.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:a.pageX,y:a.pageY});b=this._valueMax()-this._valueMin()+1;m=this;this.handles.each(function(a){var e=Math.abs(c-m.values(a));b>e&&(b=e,l=f(this),g=a)});!0===d.range&&this.values(1)===d.min&&(g+=1,l=f(this.handles[g]));if(!1===this._start(a,
g))return!1;this._mouseSliding=!0;m._handleIndex=g;l.addClass("ui-state-active").focus();d=l.offset();this._clickOffset=!f(a.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:a.pageX-d.left-l.width()/2,top:a.pageY-d.top-l.height()/2-(parseInt(l.css("borderTopWidth"),10)||0)-(parseInt(l.css("borderBottomWidth"),10)||0)+(parseInt(l.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(a,g,c);return this._animateOff=!0},_mouseStart:function(){return!0},
_mouseDrag:function(a){var d=this._normValueFromMouse({x:a.pageX,y:a.pageY});this._slide(a,this._handleIndex,d);return!1},_mouseStop:function(a){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(a,this._handleIndex);this._change(a,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var d;"horizontal"===
this.orientation?(d=this.elementSize.width,a=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(d=this.elementSize.height,a=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));d=a/d;1<d&&(d=1);0>d&&(d=0);"vertical"===this.orientation&&(d=1-d);a=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+d*a)},_start:function(a,d){var c={handle:this.handles[d],value:this.value()};this.options.values&&this.options.values.length&&(c.value=
this.values(d),c.values=this.values());return this._trigger("start",a,c)},_slide:function(a,d,c){var b;if(this.options.values&&this.options.values.length){b=this.values(d?0:1);if(2===this.options.values.length&&!0===this.options.range&&(0===d&&c>b||1===d&&c<b))c=b;c!==this.values(d)&&(b=this.values(),b[d]=c,a=this._trigger("slide",a,{handle:this.handles[d],value:c,values:b}),this.values(d?0:1),!1!==a&&this.values(d,c,!0))}else c!==this.value()&&(a=this._trigger("slide",a,{handle:this.handles[d],value:c}),
!1!==a&&this.value(c))},_stop:function(a,d){var c={handle:this.handles[d],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(d),c.values=this.values());this._trigger("stop",a,c)},_change:function(a,d){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[d],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(d),c.values=this.values());this._trigger("change",a,c)}},value:function(a){if(arguments.length)this.options.value=
this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(a,d){var c,b,l;if(1<arguments.length)this.options.values[a]=this._trimAlignValue(d),this._refreshValue(),this._change(null,a);else if(arguments.length)if(f.isArray(arguments[0])){c=this.options.values;b=arguments[0];for(l=0;l<c.length;l+=1)c[l]=this._trimAlignValue(b[l]),this._change(null,l);this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(a):this.value();
else return this._values()},_setOption:function(a,d){var c,b=0;f.isArray(this.options.values)&&(b=this.options.values.length);f.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":d?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(c=0;c<b;c+=1)this._change(null,c);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var d,c;if(arguments.length)return d=this.options.values[a],d=this._trimAlignValue(d);d=this.options.values.slice();for(c=0;c<d.length;c+=1)d[c]=
this._trimAlignValue(d[c]);return d},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var d=0<this.options.step?this.options.step:1,c=(a-this._valueMin())%d,a=a-c;2*Math.abs(c)>=d&&(a+=0<c?d:-d);return parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var a=this.options.range,d=this.options,c=this,b=!this._animateOff?d.animate:!1,l,m=
{},g,k,e,p;if(this.options.values&&this.options.values.length)this.handles.each(function(a){l=100*((c.values(a)-c._valueMin())/(c._valueMax()-c._valueMin()));m["horizontal"===c.orientation?"left":"bottom"]=l+"%";f(this).stop(1,1)[b?"animate":"css"](m,d.animate);if(!0===c.options.range)if("horizontal"===c.orientation){if(0===a)c.range.stop(1,1)[b?"animate":"css"]({left:l+"%"},d.animate);if(1===a)c.range[b?"animate":"css"]({width:l-g+"%"},{queue:!1,duration:d.animate})}else{if(0===a)c.range.stop(1,
1)[b?"animate":"css"]({bottom:l+"%"},d.animate);if(1===a)c.range[b?"animate":"css"]({height:l-g+"%"},{queue:!1,duration:d.animate})}g=l});else{k=this.value();e=this._valueMin();p=this._valueMax();l=p!==e?100*((k-e)/(p-e)):0;m["horizontal"===c.orientation?"left":"bottom"]=l+"%";this.handle.stop(1,1)[b?"animate":"css"](m,d.animate);if("min"===a&&"horizontal"===this.orientation)this.range.stop(1,1)[b?"animate":"css"]({width:l+"%"},d.animate);if("max"===a&&"horizontal"===this.orientation)this.range[b?
"animate":"css"]({width:100-l+"%"},{queue:!1,duration:d.animate});if("min"===a&&"vertical"===this.orientation)this.range.stop(1,1)[b?"animate":"css"]({height:l+"%"},d.animate);if("max"===a&&"vertical"===this.orientation)this.range[b?"animate":"css"]({height:100-l+"%"},{queue:!1,duration:d.animate})}}})})(j);(function(f){function a(a){return function(){var c=this.element.val();a.apply(this,arguments);this._refresh();c!==this.element.val()&&this._trigger("change")}}f.widget("ui.spinner",{version:"1.9m6",
defaultElement:"<input>",widgetEventPrefix:"spin",options:{incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._value(this.element.val(),!0);this._draw();this._bind(this._events);this._refresh()},_getCreateOptions:function(){var a={},c=this.element;f.each(["min","max","step"],function(b,f){var m=c.attr(f);void 0!==m&&m.length&&(a[f]=m)});return a},_events:{keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},
keyup:"_stop",focus:function(){this.uiSpinner.addClass("ui-state-active");this.previous=this.element.val()},blur:function(a){this._refresh();this.uiSpinner.removeClass("ui-state-active");this.previous!==this.element.val()&&this._trigger("change",a)},mousewheel:function(a,c){if(c){if(!this.spinning&&!this._start(a))return!1;this._spin((0<c?1:-1)*this.options.step,a);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=setTimeout(function(){this.spinning&&this._stop(a)},100);a.preventDefault()}},
"mousedown .ui-spinner-button":function(a){a.preventDefault();document.activeElement!==this.element[0]&&this.element.focus();!1!==this._start(a)&&this._repeat(null,f(a.currentTarget).hasClass("ui-spinner-up")?1:-1,a)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(a){if(f(a.currentTarget).hasClass("ui-state-active")){if(!1===this._start(a))return!1;this._repeat(null,f(a.currentTarget).hasClass("ui-spinner-up")?1:-1,a)}},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var a=
this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this._hoverable(a);this.element.attr("role","spinbutton");this.buttons=a.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");this.buttons.height()===a.height()&&a.height(a.height());this.options.disabled&&this.disable()},_keydown:function(a){var c=this.options,b=f.ui.keyCode;switch(a.keyCode){case b.UP:return this._repeat(null,
1,a),!0;case b.DOWN:return this._repeat(null,-1,a),!0;case b.PAGE_UP:return this._repeat(null,c.page,a),!0;case b.PAGE_DOWN:return this._repeat(null,-c.page,a),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-state-default ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon ui-icon-triangle-1-n'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon ui-icon-triangle-1-s'>&#9660;</span></a>"},
_start:function(a){if(!this.spinning&&!1===this._trigger("start",a))return!1;this.counter||(this.counter=1);return this.spinning=!0},_repeat:function(a,c,b){a=a||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,c,b)},a);this._spin(c*this.options.step,b)},_spin:function(a,c){var b=this.value()||0;this.counter||(this.counter=1);b=this._adjustValue(b+a*this._increment(this.counter));if(!this.spinning||!1!==this._trigger("spin",c,{value:b}))this._value(b),this.counter++},
_increment:function(a){var c=this.options.incremental;return c?f.isFunction(c)?c(a):Math.floor(a*a*a/5E4-a*a/500+17*a/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min)));return a},_precisionOf:function(a){var a=a.toString(),c=a.indexOf(".");return-1===c?0:a.length-c-1},_adjustValue:function(a){var c,b=this.options;c=null!==b.min?b.min:0;a=Math.round((a-c)/b.step)*b.step;a=parseFloat((c+a).toFixed(this._precision()));
return null!==b.max&&a>b.max?b.max:null!==b.min&&a<b.min?b.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",a))},_setOption:function(a,c){this._super("_setOption",a,c);"disabled"===a&&(c?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:a(function(a){this._super("_setOptions",a);this._value(this.element.val())}),
_parse:function(a){"string"===typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a):+a);return""===a||isNaN(a)?null:a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(a,c){var b;""!==a&&(b=this._parse(a),null!==b&&
(c||(b=this._adjustValue(b)),a=this._format(b)));this.element.val(a);this._refresh()},destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this._super("destroy");this.uiSpinner.replaceWith(this.element)},stepUp:a(function(a){this._stepUp(a)}),_stepUp:function(a){this._spin((a||1)*this.options.step)},stepDown:a(function(a){this._stepDown(a)}),
_stepDown:function(a){this._spin((a||1)*-this.options.step)},pageUp:a(function(a){this._stepUp((a||1)*this.options.page)}),pageDown:a(function(a){this._stepDown((a||1)*this.options.page)}),value:function(d){if(!arguments.length)return this._parse(this.element.val());a(this._value).call(this,d)},widget:function(){return this.uiSpinner}})})(j);(function(f,a){var d=0,c=function(){var a=/#.*$/,b=location.href.replace(a,"");return function(c){c=c.cloneNode(!1);return 1<c.hash.length&&c.href.replace(a,
"")===b}}();f.widget("ui.tabs",{version:"1.9m6",options:{active:null,collapsible:!1,event:"click",fx:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var a=this,b=a.options,c=b.active;a.running=!1;a.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");a._processTabs();if(null===c&&(location.hash&&a.anchors.each(function(a,b){if(b.hash===location.hash)return c=a,!1}),null===c&&(c=a.lis.filter(".ui-tabs-active").index()),null===c||-1===c))c=a.lis.length?
0:!1;!1!==c&&(c=this.lis.eq(c).index(),-1===c&&(c=b.collapsible?!1:0));b.active=c;!b.collapsible&&(!1===b.active&&this.anchors.length)&&(b.active=0);f.isArray(b.disabled)&&(b.disabled=f.unique(b.disabled.concat(f.map(this.lis.filter(".ui-state-disabled"),function(b){return a.lis.index(b)}))).sort());this._setupFx(b.fx);this._refresh();this.panels.hide();this.lis.removeClass("ui-tabs-active ui-state-active");!1!==b.active&&this.anchors.length?(this.active=this._findActive(b.active),a._getPanelForTab(this.active).show(),
this.lis.eq(b.active).addClass("ui-tabs-active ui-state-active"),this.load(b.active)):this.active=f()},_setOption:function(a,b){"active"==a?this._activate(b):"disabled"===a?this._setupDisabled(b):(this._super("_setOption",a,b),"collapsible"===a&&(!b&&!1===this.options.active)&&this._activate(0),"event"===a&&this._setupEvents(b),"fx"===a&&this._setupFx(b))},_tabId:function(a){return f(a).attr("aria-controls")||"ui-tabs-"+ ++d},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@[\]^`{|}~]/g,
"\\$&"):""},refresh:function(){var a=this.options,b=this.list.children(":has(a[href])");a.disabled=f.map(b.filter(".ui-state-disabled"),function(a){return b.index(a)});this._processTabs();this._refresh();this.panels.not(this._getPanelForTab(this.active)).hide();!1===a.active||!this.anchors.length?(a.active=!1,this.active=f()):this.active.length&&!f.contains(this.list[0],this.active[0])?(a=a.active-1,this._activate(0<=a?a:0)):a.active=this.anchors.index(this.active)},_refresh:function(){var a=this.options;
this.element.toggleClass("ui-tabs-collapsible",a.collapsible);this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");this._setupDisabled(a.disabled);this._setupEvents(a.event);this.lis.unbind(".tabs");this._focusable(this.lis);this._hoverable(this.lis)},_processTabs:function(){var a=this;this.list=this.element.find("ol,ul").eq(0);
this.lis=f(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return f("a",this)[0]});this.panels=f([]);this.anchors.each(function(b,g){var d,e;if(c(g))d=g.hash,e=a.element.find(a._sanitizeSelector(d));else{var p=a._tabId(g);d="#"+p;e=a.element.find(d);e.length||(e=a._createPanel(p),e.insertAfter(a.panels[b-1]||a.list))}e.length&&(a.panels=a.panels.add(e));f(g).attr("aria-controls",d.substring(1))})},_createPanel:function(a){return f("<div></div>").attr("id",a).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("destroy.tabs",
!0)},_setupDisabled:function(a){f.isArray(a)&&(a.length?a.length===this.anchors.length&&(a=!0):a=!1);for(var b=0,c;c=this.lis[b];b++)f(c).toggleClass("ui-state-disabled",!0===a||-1!==f.inArray(b,a));this.options.disabled=a},_setupFx:function(a){a&&(f.isArray(a)?(this.hideFx=a[0],this.showFx=a[1]):this.hideFx=this.showFx=a)},_resetStyle:function(a,b){!f.support.opacity&&b.opacity&&a[0].style.removeAttribute("filter")},_setupEvents:function(a){this.anchors.unbind(".tabs");a&&this.anchors.bind(a.split(" ").join(".tabs ")+
".tabs",f.proxy(this,"_eventHandler"));this.anchors.bind("click.tabs",function(a){a.preventDefault()})},_eventHandler:function(a){var b=this.options,c=this.active,d=f(a.currentTarget),e=d[0]===c[0],p=e&&b.collapsible,o=p?f():this._getPanelForTab(d),j=!c.length?f():this._getPanelForTab(c),q=d.closest("li"),c={oldTab:c,oldPanel:j,newTab:p?f():d,newPanel:o};a.preventDefault();if(q.hasClass("ui-state-disabled")||q.hasClass("ui-tabs-loading")||this.running||e&&!b.collapsible||!1===this._trigger("beforeActivate",
a,c))d[0].blur();else{b.active=p?!1:this.anchors.index(d);this.active=e?f():d;this.xhr&&this.xhr.abort();if(!j.length&&!o.length)throw"jQuery UI Tabs: Mismatching fragment identifier.";o.length&&(this.load(this.anchors.index(d),a),d[0].blur());this._toggle(a,c)}},_toggle:function(a,b){function c(){e.running=!1;e._trigger("activate",a,b)}function d(){b.newTab.closest("li").addClass("ui-tabs-active ui-state-active");p.length&&e.showFx?p.animate(e.showFx,e.showFx.duration||"normal",function(){e._resetStyle(f(this),
e.showFx);c()}):(p.show(),c())}var e=this,p=b.newPanel,o=b.oldPanel;e.running=!0;o.length&&e.hideFx?o.animate(e.hideFx,e.hideFx.duration||"normal",function(){b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");e._resetStyle(f(this),e.hideFx);d()}):(b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),o.hide(),d())},_activate:function(a){a=this._findActive(a)[0];a!==this.active[0]&&(a=a||this.active[0],this._eventHandler({target:a,currentTarget:a,preventDefault:f.noop}))},
_findActive:function(a){return"number"===typeof a?this.anchors.eq(a):"string"===typeof a?this.anchors.filter("[href$='"+a+"']"):f()},_getIndex:function(a){"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$="+a+"]")));return a},_destroy:function(){this.xhr&&this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.unbind(".tabs").removeData("href.tabs").removeData("load.tabs");
this.lis.unbind(".tabs").add(this.panels).each(function(){f.data(this,"destroy.tabs")?f(this).remove():f(this).removeClass("ui-state-default ui-corner-top ui-tabs-active ui-state-active ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom")});return this},enable:function(b){var c=this.options.disabled;!1!==c&&(b===a?c=!1:(b=this._getIndex(b),c=f.isArray(c)?f.map(c,function(a){return a!==b?a:null}):f.map(this.lis,function(a,c){return c!==b?c:null})),this._setupDisabled(c))},disable:function(b){var c=
this.options.disabled;if(!0!==c){if(b===a)c=!0;else{b=this._getIndex(b);if(-1!==f.inArray(b,c))return;c=f.isArray(c)?f.merge([b],c).sort():[b]}this._setupDisabled(c)}},load:function(a,b){var a=this._getIndex(a),g=this,d=this.anchors.eq(a),e=g._getPanelForTab(d),p={tab:d,panel:e};if(!c(d[0])){if(this.xhr=f.ajax({url:d.attr("href"),beforeSend:function(a,c){return g._trigger("beforeLoad",b,f.extend({jqXHR:a,ajaxSettings:c},p))}}))this.lis.eq(a).addClass("ui-tabs-loading"),this.xhr.success(function(a){e.html(a);
g._trigger("load",b,p)}).complete(function(b,c){"abort"===c&&g.panels.stop(!1,!0);g.lis.eq(a).removeClass("ui-tabs-loading");b===g.xhr&&delete g.xhr});return this}},_getPanelForTab:function(a){return this.element.find(this._sanitizeSelector("#"+f(a).attr("aria-controls")))}});if(!1!==f.uiBackCompat){f.ui.tabs.prototype._ui=function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}};(function(a,b){b.url=function(a,b){this.anchors.eq(a).attr("href",b)}})(j,j.ui.tabs.prototype);(function(a,b){a.extend(b.options,
{ajaxOptions:null,cache:!1});var c=b._create,d=b._setOption,e=b._destroy,f=b.url||a.noop;a.extend(b,{_create:function(){c.call(this);var b=this;this.element.bind("tabsbeforeload.tabs",function(c,e){a.data(e.tab[0],"cache.tabs")?c.preventDefault():(a.extend(e.ajaxSettings,b.options.ajaxOptions,{error:function(a,c){try{b.options.ajaxOptions.error(a,c,e.tab.closest("li").index(),e.tab[0])}catch(g){}}}),e.jqXHR.success(function(){b.options.cache&&a.data(e.tab[0],"cache.tabs",!0)}))})},_setOption:function(a,
b){"cache"===a&&!1===b&&this.anchors.removeData("cache.tabs");d.apply(this,arguments)},_destroy:function(){this.anchors.removeData("cache.tabs");e.call(this)},url:function(a,b){this.anchors.eq(a).removeData("cache.tabs");f.apply(this,arguments)}})})(j,j.ui.tabs.prototype);(function(a,b){b.abort=function(){this.xhr&&this.xhr.abort()}})(j,j.ui.tabs.prototype);f.widget("ui.tabs",f.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super("_create");this._bind({tabsbeforeload:function(a,
b){if(this.options.spinner){var c=b.tab.find("span"),d=c.html();c.html(this.options.spinner);b.jqXHR.complete(function(){c.html(d)})}}})}});(function(a,b){a.extend(b.options,{enable:null,disable:null});var c=b.enable,d=b.disable;b.enable=function(b){var d=this.options,k;if(b&&!0===d.disabled||a.isArray(d.disabled)&&-1!==a.inArray(b,d.disabled))k=!0;c.apply(this,arguments);k&&this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b]))};b.disable=function(b){var c=this.options,g;if(b&&!1===
c.disabled||a.isArray(c.disabled)&&-1===a.inArray(b,c.disabled))g=!0;d.apply(this,arguments);g&&this._trigger("disable",null,this._ui(this.anchors[b],this.panels[b]))}})(j,j.ui.tabs.prototype);(function(b,c){b.extend(c.options,{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"});c.add=function(c,d,e){e===a&&(e=this.anchors.length);var f=this.options,d=b(f.tabTemplate.replace(/#\{href\}/g,c).replace(/#\{label\}/g,d)),c=!c.indexOf("#")?c.replace("#",""):this._tabId(d.find("a")[0]);
d.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);d.find("a").attr("aria-controls",c);var m=e>=this.lis.length,j=this.element.find("#"+c);j.length||(j=this._createPanel(c),m?0<e?j.insertAfter(this.panels.eq(-1)):j.appendTo(this.element):j.insertBefore(this.panels[e]));j.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide();m?d.appendTo(this.list):d.insertBefore(this.lis[e]);f.disabled=b.map(f.disabled,function(a){return a>=e?++a:a});this.refresh();1===this.lis.length&&
!1===f.active&&this.option("active",0);this._trigger("add",null,this._ui(this.anchors[e],this.panels[e]));return this};c.remove=function(a){var a=this._getIndex(a),c=this.options,e=this.lis.eq(a).remove(),d=this._getPanelForTab(e.find("a[aria-controls]")).remove();e.hasClass("ui-tabs-active")&&2<this.anchors.length&&this._activate(a+(a+1<this.anchors.length?1:-1));c.disabled=b.map(b.grep(c.disabled,function(b){return b!==a}),function(b){return b>=a?--b:b});this.refresh();this._trigger("remove",null,
this._ui(e.find("a")[0],d[0]));return this}})(j,j.ui.tabs.prototype);(function(a,b){b.length=function(){return this.anchors.length}})(j,j.ui.tabs.prototype);(function(a,b){a.extend(b.options,{idPrefix:"ui-tabs-"});b._tabId=function(b){return a(b).attr("aria-controls")||b.title&&b.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+ ++d}})(j,j.ui.tabs.prototype);(function(a,b){a.extend(b.options,{panelTemplate:"<div></div>"});b._createPanel=function(b){return a(this.options.panelTemplate).attr("id",
b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("destroy.tabs",!0)}})(j,j.ui.tabs.prototype);(function(b,c){var d=c._create,k=c._setOption,e=c._eventHandler;c._create=function(){var b=this.options;null===b.active&&b.selected!==a&&(b.active=-1===b.selected?!1:b.selected);d.call(this);b.selected=b.active;!1===b.selected&&(b.selected=-1)};c._setOption=function(a,b){if("selected"!==a)return k.apply(this,arguments);var c=this.options;k.call(this,"active",-1===b?!1:b);c.selected=c.active;
!1===c.selected&&(c.selected=-1)};c._eventHandler=function(a){e.apply(this,arguments);this.options.selected=this.options.active;!1===this.options.selected&&(this.options.selected=-1)}})(j,j.ui.tabs.prototype);(function(a,b){a.extend(b.options,{show:null,select:null});var c=b._create,d=b._trigger;b._create=function(){c.call(this);!1!==this.options.active&&this._trigger("show",null,this._ui(this.active[0],this._getPanelForTab(this.active)[0]))};b._trigger=function(a,b,c){if(!d.apply(this,arguments))return!1;
"beforeActivate"===a&&c.newTab.length?d.call(this,"select",b,{tab:c.newTab[0],panel:c.newPanel[0],index:c.newTab.closest("li").index()}):"activate"===a&&c.newTab.length&&d.call(this,"show",b,{tab:c.newTab[0],panel:c.newPanel[0],index:c.newTab.closest("li").index()})}})(j,j.ui.tabs.prototype);(function(a,b){b.select=function(a){a=this._getIndex(a);if(-1===a)if(this.options.collapsible&&-1!==this.options.selected)a=this.options.selected;else return;this.anchors.eq(a).trigger(this.options.event+".tabs")}})(j,
j.ui.tabs.prototype);var b=0;f.widget("ui.tabs",f.ui.tabs,{options:{cookie:null},_create:function(){var a=this.options,b;null==a.active&&a.cookie&&(b=parseInt(this._cookie(),10),-1===b&&(b=!1),a.active=b);this._super("_create")},_cookie:function(a){var c=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++b)];arguments.length&&(c.push(!1===a?-1:a),c.push(this.options.cookie));return f.cookie.apply(null,c)},_refresh:function(){this._super("_refresh");this.options.cookie&&this._cookie(this.options.active,
this.options.cookie)},_eventHandler:function(a){this._superApply("_eventHandler",arguments);this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super("_destroy");this.options.cookie&&this._cookie(null,this.options.cookie)}});f.widget("ui.tabs",f.ui.tabs,{_trigger:function(a,b,c){c=f.extend({},c);"load"===a&&(c.panel=c.panel[0],c.tab=c.tab[0]);return this._super("_trigger",a,b,c)}})}})(j);(function(f){var a=0;f.widget("ui.tooltip",{version:"1.9m6",
options:{content:function(){return f(this).attr("title")},hide:!0,items:"[title]",position:{my:"left+15 center",at:"right center",collision:"flipfit flipfit"},show:!0,tooltipClass:null,close:null,open:null},_create:function(){this._bind({mouseover:"open",focusin:"open"});this.tooltips={}},_setOption:function(a,c){"disabled"===a?(this[c?"_disable":"_enable"](),this.options[a]=c):this._super("_setOption",a,c)},_disable:function(){var a=this;f.each(this.tooltips,function(c,b){var l=f.Event("blur");l.target=
l.currentTarget=b[0];a.close(l,!0)});this.element.find(this.options.items).andSelf().each(function(){var a=f(this);a.is("[title]")&&a.data("tooltip-title",a.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var a=f(this);a.data("tooltip-title")&&a.attr("title",a.data("tooltip-title"))})},open:function(a){var c,b=this,l=f(a?a.target:this.element).closest(this.options.items);l.length&&!l.attr("aria-describedby")&&(l.data("tooltip-title")||
l.data("tooltip-title",l.attr("title")),(c=this.options.content.call(l[0],function(c){setTimeout(function(){b._open(a,l,c)},1)}))&&b._open(a,l,c))},_open:function(a,c,b){if(b){c.is("[title]")&&c.attr("title","");var l=this._find(c);l.length||(l=this._tooltip(c),c.attr("aria-describedby",l.attr("id")));l.find(".ui-tooltip-content").html(b);l.stop(!0).position(f.extend({of:c},this.options.position)).hide();this._show(l,this.options.show);this._trigger("open",a,{tooltip:l});this._bind(c,{mouseleave:"close",
blur:"close",keyup:function(a){if(a.keyCode==f.ui.keyCode.ESCAPE){a=f.Event(a);a.currentTarget=c[0];this.close(a,true)}}})}},close:function(a,c){var b=this,l=f(a?a.currentTarget:this.element),m=this._find(l);if(c||document.activeElement!==l[0])l.data("tooltip-title")&&l.attr("title",l.data("tooltip-title")),l.removeAttr("aria-describedby"),m.stop(!0),this._hide(m,this.options.hide,function(){f(this).remove();delete b.tooltips[this.id]}),l.unbind("mouseleave.tooltip blur.tooltip keyup.tooltip"),this._trigger("close",
a,{tooltip:m})},_tooltip:function(d){var c="ui-tooltip-"+a++,b=f("<div>").attr({id:c,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));f("<div>").addClass("ui-tooltip-content").appendTo(b);b.appendTo(document.body);f.fn.bgiframe&&b.bgiframe();this.tooltips[c]=d;return b},_find:function(a){return(a=a.attr("aria-describedby"))?f("#"+a):f()},_destroy:function(){f.each(this.tooltips,function(a){f("#"+a).remove()})}})})(j);return j.ui});
define("ui/tab","aloha/core jquery ui/container ui/component PubSub jqueryui".split(" "),function(j,f,a,d,c){var b=0,l={},j=a.extend({_elemBySlot:null,_groupBySlot:null,_groupByComponent:null,_constructor:function(a,c,d){var e,l,o,j,q;this._elemBySlot={};this._groupBySlot={};this._groupByComponent={};this._super(a,c);this.container=c.container;this.list=this.container.data("list");this.panels=this.container.data("panels");this.id="tab-ui-container-"+ ++b;this.panel=f("<div>",{id:this.id,unselectable:"on"});
this.handle=f('<li><a href="#'+this.id+'">'+c.label+"</a></li>");for(a=0;a<d.length;a++)if(typeof d[a]==="string")if(1===d[a].length&&d[a].charCodeAt(0)===10)this.panel.append("<div>",{unselectable:"on"});else{l=f("<span>",{unselectable:"on"});this._elemBySlot[d[a]]=l;this.panel.append(l)}else{j=f("<div>",{"class":"aloha-ui-component-group aloha-ui-hidden",unselectable:"on"}).appendTo(this.panel);q={element:j,visibleCounter:0};o=d[a];for(e=0;e<o.length;e++){this._groupBySlot[o[e]]=q;if(o[e]&&1===
o[e].length&&o[e].charCodeAt(0)===10)j.append(f("<div>",{unselectable:"on"}));else{l=f("<span>",{unselectable:"on"});this._elemBySlot[o[e]]=l;j.append(l)}}}this.panel.append(f("<div>",{"class":"aloha-ui-clear",unselectable:"on"}));this.handle.appendTo(this.list);this.panel.appendTo(this.panels);this.container.tabs("refresh");c=c.container.data("aloha-tabs");this.index=c.length;c.push(this)},adoptInto:function(a,b){var c=this._elemBySlot[a];if(!c)return false;l[a]=b;b.adoptParent(this);c.append(b.element);
if(c=this._groupBySlot[a]){this._groupByComponent[b.id]=c;if(b.isVisible()){c.visibleCounter||c.element.removeClass("aloha-ui-hidden");c.visibleCounter=c.visibleCounter+1}}return true},foreground:function(){this.container.tabs("select",this.index)},childForeground:function(){this.foreground()},hasVisibleComponents:function(){var a=this._elemBySlot,b;for(b in a)if(a.hasOwnProperty(b)&&l[b]&&l[b].visible)return true;return false},childVisible:function(a,b){b?a.container.show():a.container.hasVisibleComponents()||
a.container.hide();var c=this._groupByComponent[a.id];if(c)if(b){0===c.visibleCounter&&c.element.removeClass("aloha-ui-hidden");c.visibleCounter=c.visibleCounter+1}else{c.visibleCounter=c.visibleCounter-1;0===c.visibleCounter&&c.element.addClass("aloha-ui-hidden")}},show:function(){if(this.list.children().length){this.handle.show();this.visible=true;this.container.show();(!this.container.find(".ui-tabs-active").length||this.container.tabs("option","selected")===this.index)&&this.foreground()}},hide:function(){var a=
this.list.children();if(0!==a.length){this.handle.hide();this.visible=false;if(this.index===this.container.tabs("option","selected")){var a=this.container.data("aloha-tabs"),b;for(b=0;b<a.length;++b)if(a[b].visible){this.container.tabs("select",b);return}this.handle.removeClass("ui-tabs-active");this.container.hide()}}}});f.extend(j,{createContainer:function(){var a=f("<div>",{unselectable:"on"}),b=f("<ul>",{unselectable:"on"}).appendTo(a),d=f("<div>",{unselectable:"on"}).appendTo(a);a.data("list",
b).data("panels",d).data("aloha-tabs",[]).tabs({select:function(b,d){var g=a.data("aloha-tabs");a.data("aloha-active-container",g[d.index]);c.pub("aloha.ui.container.selected",{data:g[d.index]})}});return a}});return j});define("ui/subguarded",["aloha/core","jquery","PubSub"],function(j,f,a){function d(a){a.alohaUid||(a.alohaUid=++m);return a.alohaUid}function c(a,b){g[a.alohaUid]||(g[a.alohaUid]=[]);g[a.alohaUid].push(b);return g[a.alohaUid]}function b(a,b){k[a]||(k[a]=[]);k[a].push(b);return k[a]}
function l(a){var b=k[a]||[],c;for(c=0;c<b.length;c++)b[c].apply(null,[g[b[c].alohaUid]||[]].concat(arguments))}var m=0,g={},k={};return function(){var e=Array.prototype.slice.call(arguments),g=e.shift();"string"===typeof g&&(g=[g]);var k=e.shift();d(k);c(k,e);for(var f,m=function(a,b,c){l(f,a,b,c)},u=function(){l(f)},e=0;e<g.length;e++)f=g[e],b(f,k),j.bind(f,m),a.sub(f,u)}});define("vendor/amplify.store",["util/json2"],function(){var j={};(function(f,a){function d(d,e){c.addType(d,function(g,f,l){var m,
j=f,t=(new Date).getTime();if(!g){j={};l=[];f=0;try{for(g=e.length;g=e.key(f++);)b.test(g)&&(m=ka.parse(e.getItem(g)),m.expires&&m.expires<=t?l.push(g):j[g.replace(b,"")]=m.data);for(;g=l.pop();)e.removeItem(g)}catch(v){}return j}g="__amplify__"+g;if(f===a)if(m=(m=e.getItem(g))?ka.parse(m):{expires:-1},m.expires&&m.expires<=t)e.removeItem(g);else return m.data;else if(null===f)e.removeItem(g);else{m=ka.stringify({data:f,expires:l.expires?t+l.expires:null});try{e.setItem(g,m)}catch(z){c[d]();try{e.setItem(g,
m)}catch(x){throw c.error();}}}return j})}var c=f.store=function(a,b,d,g){g=c.type;d&&(d.type&&d.type in c.types)&&(g=d.type);return c.types[g](a,b,d||{})};c.types={};c.type=null;c.addType=function(a,b){c.type||(c.type=a);c.types[a]=b;c[a]=function(b,e,d){d=d||{};d.type=a;return c(b,e,d)}};c.error=function(){return"amplify.store quota exceeded"};var b=/^__amplify__/,l;for(l in{localStorage:1,sessionStorage:1})try{window[l].getItem&&d(l,window[l])}catch(m){}if(window.globalStorage)try{d("globalStorage",
window.globalStorage[window.location.hostname]),"sessionStorage"===c.type&&(c.type="globalStorage")}catch(g){}(function(){if(!c.types.localStorage){var b=document.createElement("div");b.style.display="none";document.getElementsByTagName("head")[0].appendChild(b);try{b.addBehavior("#default#userdata"),b.load("amplify")}catch(e){b.parentNode.removeChild(b);return}c.addType("userData",function(e,d,g){b.load("amplify");var f,l,m=d,j=(new Date).getTime();if(!e){m={};l=[];for(e=0;d=b.XMLDocument.documentElement.attributes[e++];)f=
ka.parse(d.value),f.expires&&f.expires<=j?l.push(d.name):m[d.name]=f.data;for(;e=l.pop();)b.removeAttribute(e);b.save("amplify");return m}e=e.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-");if(d===a)if(f=(d=b.getAttribute(e))?ka.parse(d):{expires:-1},f.expires&&f.expires<=j)b.removeAttribute(e);else return f.data;else null===d?b.removeAttribute(e):(l=b.getAttribute(e),f=ka.stringify({data:d,expires:g.expires?j+g.expires:null}),b.setAttribute(e,
f));try{b.save("amplify")}catch(z){null===l?b.removeAttribute(e):b.setAttribute(e,l);c.userData();try{b.setAttribute(e,f),b.save("amplify")}catch(x){throw null===l?b.removeAttribute(e):b.setAttribute(e,l),c.error();}}return m})}})();(function(){var b={},e={};c.addType("memory",function(c,d,g){if(!c)return b===a?a:ka.parse(ka.stringify(b));if(d===a)return b[c]===a?a:ka.parse(ka.stringify(b[c]));e[c]&&(clearTimeout(e[c]),delete e[c]);if(null===d)return delete b[c],null;b[c]=d;g.expires&&(e[c]=setTimeout(function(){delete b[c];
delete e[c]},g.expires));return d})})()})(j);return j});define("ui/floating",["jquery","aloha/core","ui/surface","ui/subguarded","vendor/amplify.store"],function(j,f,a,d,c){function b(a,b,c,d){a.stop().animate(b,c,function(){d(b)})}function l(a){c.store("Aloha.FloatingMenu.pinned","true");c.store("Aloha.FloatingMenu.top",a.top);c.store("Aloha.FloatingMenu.left",a.left)}function m(a,b,c,d,g){for(b=0;b<a.length;b++)if(a[b][0].isActive())a[b][1](c,d,g)}var g=j(window);return{getPinState:function(){return"true"===
c.store("Aloha.FloatingMenu.pinned")?{top:parseInt(c.store("Aloha.FloatingMenu.top"),10),left:parseInt(c.store("Aloha.FloatingMenu.left"),10),isPinned:!0}:{top:null,left:null,isPinned:!1}},makeFloating:function(a,b){d(["aloha-selection-changed","aloha.ui.container.selected"],m,a,function(){a._move()});var c=function(){var c;c=b.pinLeft;var d=b.pinTop;0>d?d=0:d>g.height()&&(d=g.height()/2);0>c?c=0:c>g.width()&&(c=g.width()/2);c={top:d,left:c};b.setFloatingPosition(c);a.$element.css({top:c.top,left:c.left})};
g.scroll(function(){a._move(0)});g.resize(function(){b.isFloatingMode||c()});a.addPin();if(j.browser.msie){var f=a.$element.parent();a.$element.appendTo("body");a.$element.css("position","fixed");f.length?a.$element.appendTo(f):a.$element.detach()}else a.$element.css("position","fixed");b.isFloatingMode||c();a.$element.css("z-index",10100).draggable({distance:20,stop:function(a,c){b.setFloatingPosition(c.position);b.isFloatingMode||l(c.position)}})},floatSurface:function(a,c,d,f){"number"!==typeof d&&
(d=500);var l=(parseInt(j("body").css("marginTop"),10)||0)+(parseInt(j("body").css("paddingTop"),10)||0),a=a.$element;a.offset();var m=c.obj.offset(),u=g.scrollTop(),t=m.top-u-l,v=m.left,z=v+a.width()-g.width()-10;0<z&&(v-=z);t>=a.height()?(m.top-=u,m.top-=a.height()+10,b(a,m,d,f)):(c=t+a.height()>m.top+c.obj.height()?{top:m.top+c.obj.height(),left:v}:{top:l,left:v},c.top+=10,b(a,c,d,f))},togglePinSurface:function(a,b,d){a=a.$element;d?(c.store("Aloha.FloatingMenu.pinned",null),c.store("Aloha.FloatingMenu.top",
null),c.store("Aloha.FloatingMenu.left",null),a.find(".aloha-ui-pin").removeClass("aloha-ui-pin-down")):(l(b),a.find(".aloha-ui-pin").addClass("aloha-ui-pin-down"));a.css({position:"fixed",top:b.top})}}});(function(){function j(a,b,d,f,g,k){b[a]&&(d.push(a),(!0===b[a]||1===b[a])&&f.push(g+a+"/"+k))}function f(a,b,d,f,g){b=f+b+"/"+g;require._fileExists(a.toUrl(b))&&d.push(b)}function a(c,b,d){for(var f in b)b.hasOwnProperty(f)&&(!c.hasOwnProperty(f)||d)?c[f]=b[f]:"object"===typeof b[f]&&a(c[f],b[f],
d)}var d=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(c){var b=c.config();return{version:"2.0.1",load:function(c,m,g,k){k=k||{};k.locale&&(b.locale=k.locale);var e=d.exec(c),p=e[1],o=e[4],r=e[5],q=o.split("-"),u=[],t={},v,z="";e[5]?(p=e[1],c=p+r):(r=e[4],o=b.locale,o||(o=b.locale="undefined"===typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),q=o.split("-"));if(k.isBuild){u.push(c);f(m,"root",u,p,r);for(v=0;v<q.length;v++)k=
q[v],z+=(z?"-":"")+k,f(m,z,u,p,r);m(u,function(){g()})}else m([c],function(b){var c=[],e;j("root",b,c,u,p,r);for(v=0;v<q.length;v++){e=q[v];z=z+((z?"-":"")+e);j(z,b,c,u,p,r)}m(u,function(){var e,d,k;for(e=c.length-1;e>-1&&c[e];e--){k=c[e];d=b[k];if(d===true||d===1)d=m(p+k+"/"+r);a(t,d)}t.t=function(a,b){return this[a]?this[a]:b?b:a};g(t)})})}}})})();define("ui/nls/i18n",{root:{"button.bold.label":"Bold","button.italic.label":"Italic","button.strikethrough.label":"Strikethrough","button.subscript.label":"Subscript",
"button.superscript.label":"Superscript","button.underline.label":"Underline","button.p.label":"Paragraph","button.h1.label":"Heading 1","button.h2.label":"Heading 2","button.h3.label":"Heading 3","button.h4.label":"Heading 4","button.h5.label":"Heading 5","button.h6.label":"Heading 6","button.pre.label":"Preformatted text","button.removeFormatting.label":"Remove formatting","button.ol.label":"Insert ordered list","button.ul.label":"Insert unordered list","button.indent.label":"Indent list","button.outdent.label":"Outdent list",
"button.createLink.label":"Insert link","button.removeLink.label":"Remove link","button.createAbbr.label":"Insert abbreviation","button.characterPicker.label":"Pick special characters","button.justifyLeft.label":"Align to the left","button.justifyRight.label":"Align to the right","button.justifyCenter.label":"Center","button.justifyFull.label":"Justify","button.horizontalRule.label":"Insert horizontal rule","button.createLanguageAnnotation.label":"Insert language annotation","button.metaview.label":"Switch between meta and normal view",
"button.quote.label":"Format selection as quote","button.blockquote.label":"Format selection as blockquote","tab.format.label":"Format","tab.insert.label":"Insert","tab.abbr.label":"Abbreviation","tab.img.label":"Image","tab.link.label":"Link","tab.list.label":"List","tab.table.label":"Table","tab.col.label":"Table Column","tab.row.label":"Table Row","tab.wai-lang.label":"Language annotation"},de:!0});define("ui/toolbar","jquery aloha/core ui/surface ui/tab ui/floating ui/context i18n!ui/nls/i18n jqueryui".split(" "),
function(j,f,a,d,c,b,l){var m=a.extend({_moveTimeout:null,$_container:null,_tabBySlot:null,_tabs:[],_constructor:function(a,b){var e,f,o,r;this._super(a);this.$element=j("<div>",{"class":"aloha-ui aloha-ui-toolbar",unselectable:"on"});this.$_container=d.createContainer().appendTo(this.$element);this._tabBySlot={};for(o=0;o<b.length;o++){e=b[o];f=new d(a,{label:l.t(e.label,e.label),showOn:e.showOn,container:this.$_container},e.components);for(r in f._elemBySlot)f._elemBySlot.hasOwnProperty(r)&&(this._tabBySlot[r]=
f);this._tabs.push({tab:f,settings:e})}c.makeFloating(this,m)},adoptInto:function(a,b){var c=this._tabBySlot[a];return c&&c.adoptInto(a,b)},getActiveContainer:function(){return this.$_container.data("aloha-active-container")},getContainers:function(){return this.$_container.data("aloha-tabs")},_move:function(a){var b=this;this._moveTimeout&&clearTimeout(this._moveTimeout);this._moveTimeout=setTimeout(function(){b._moveTimeout=null;if(f.activeEditable&&m.isFloatingMode){b.$element.stop();c.floatSurface(b,
f.activeEditable,a,function(a){m.setFloatingPosition(a)})}},20)},addPin:function(){var a=j('<div class="aloha-ui-pin">'),b=this.$element;b.find(".ui-tabs").append(a);b.find(".ui-tabs").hover(function(){b.addClass("aloha-ui-hover")},function(){b.removeClass("aloha-ui-hover")});m.isFloatingMode||a.addClass("aloha-ui-pin-down");var e=this;a.click(function(){m.isFloatingMode=!m.isFloatingMode;var a;if(m.isFloatingMode)a={top:m.pinTop,left:m.pinLeft};else{a=e.$element.offset();a.top=a.top-j(window).scrollTop()}m.setFloatingPosition(a);
c.togglePinSurface(e,a,m.isFloatingMode)})},show:function(){m.$surfaceContainer.children().detach();m.$surfaceContainer.append(this.$element);m.$surfaceContainer.stop().fadeTo(200,1);var a=m.getFloatingPosition();this.$element.stop().css({top:a.top,left:a.left});this._move()},hide:function(){m.$surfaceContainer.stop().fadeOut(200,function(){m.$surfaceContainer.children().detach()})}});j.extend(m,{$surfaceContainer:null,isFloatingMode:true,pinLeft:0,pinTop:0,init:function(){m.$surfaceContainer=j("<div>",
{"class":"aloha aloha-surface aloha-toolbar",unselectable:"on"}).hide();j(function(){m.$surfaceContainer.appendTo("body")});a.trackRange(m.$surfaceContainer);var b=c.getPinState();m.pinTop=b.top;m.pinLeft=b.left;m.isFloatingMode=!b.isPinned},setFloatingPosition:function(a){m.pinTop=a.top;m.pinLeft=a.left},getFloatingPosition:function(){return{top:m.pinTop,left:m.pinLeft}}});m.init();return m});define("util/maps",[],function(){return{isEmpty:function(j){for(var f in j)if(j.hasOwnProperty(f))return!1;
return!0},fillTuples:function(j,f){for(var a=f.length,d;a--;)d=f[a],j[d[0]]=d[1];return j},fillKeys:function(j,f,a){for(var d=f.length;d--;)j[f[d]]=a;return j}}});define("util/functions",[],function(){return{identity:function(j){return j}}});define("util/trees",["jquery","util/functions"],function(j,f){function a(a,b,c){var d=j.type(a);if("array"===d)for(var c=[],g=0,d=a.length;g<d;g++)b(a[g],c.length,c);else if("object"===d)for(g in c={},a)a.hasOwnProperty(g)&&b(a[g],g,c);else c=c(a);return c}function d(a,
b,c){if(1===a.nodeType){for(var c=a.cloneNode(!1),a=a.firstChild,d=[];a;)b(a,0,d),0!==d.length&&c.appendChild(d[0]),a=a.nextSibling;b=c}else b=c(a.cloneNode(!0));return b}function c(a,b,c,d,g,f,l){f[g]=l(b(a),d,c)}function b(a,b,c,d,g,f,l){f[g]=b(l(a,d,c))}function l(a,b,c,d,g,f,l){b(a)||(f[g]=l(a,d,c))}function m(a,b,c,d,g,f,l){a=l(a,d,c);b(a)||(f[g]=a)}function g(a,b,c,d,g){var f=[null];(function t(a,k,f){d(a,b,c,t,k,f,g)})(a,0,f);return f[0]}return{prewalk:function(b,e,d){return g(b,e,d||f.identity,
c,a)},postwalk:function(c,e,d){return g(c,e,d||f.identity,b,a)},preprune:function(b,c,d){return g(b,c,d||f.identity,l,a)},postprune:function(b,c,d){return g(b,c,d||f.identity,m,a)},leaves:function(c,e){return g(c,f.identity,e,b,a)},prepruneNodes:function(a,b,c){return g(a,b,c||f.identity,l,d)},postpruneNodes:function(a,b,c){return g(a,b,c||f.identity,m,d)},flatten:function(c){var e=[];g(c,f.identity,function(a){e.push(a)},b,a);return e}}});define("ui/settings",["jquery","util/arrays","util/maps",
"util/trees"],function(j,f,a,d){function c(a,b,c){var e,f,l=[],r;for(e=0;e<a.length;e++)if(f=a[e],!b[f.label]&&(r=d.postprune(f.components,c)))f=j.extend({},f),f.components=r,l.push(f);return l}function b(a,b,c){var e,f,l=[],r,q,u;for(e=0;e<a.length;e++)f=a[e],r=f.components||[],q=b[f.label],!f.exclusive&&q&&(u=d.postprune(q.components,c))&&(r=r.concat(u)),f=j.extend({},q||{},f),f.components=r,l.push(f);return l}function l(b,c){var k,e=a.fillKeys({},c,!0);for(k=0;k<b.length;k++)e[b[k].label]=!0,a.fillKeys(e,
d.flatten(b[k].components),!0);return e}return{defaultToolbarSettings:{tabs:[{label:"tab.format.label",showOn:{scope:"Aloha.continuoustext"},components:["bold strong italic emphasis \n subscript superscript strikethrough quote".split(" "),"formatLink formatAbbr formatNumeratedHeaders \n toggleMetaView wailang toggleFormatlessPaste \n toggleDragDrop".split(" "),"alignLeft alignCenter alignRight alignJustify \n orderedList unorderedList indentList outdentList".split(" "),["formatBlock"]]},{label:"tab.insert.label",
showOn:{scope:"Aloha.continuoustext"},components:["createTable characterPicker insertLink insertImage insertAbbr insertToc insertHorizontalRule insertTag".split(" ")]},{label:"tab.link.label",showOn:{scope:"link"},components:["editLink","removeLink","linkBrowser"]},{label:"tab.img.label",showOn:{scope:"image"},components:[["imageSource","\n","imageTitle"],["imageResizeWidth","\n","imageResizeHeight"],"imageAlignLeft imageAlignRight imageAlignNone imageIncPadding \n imageCropButton imageCnrReset imageCnrRatio imageDecPadding".split(" "),
["imageBrowser"]]},{label:"tab.abbr.label",showOn:{scope:"abbr"},components:[["abbrText","removeAbbr"]]},{label:"tab.wai-lang.label",showOn:{scope:"wai-lang"},components:[["wailangfield","removewailang"]]},{label:"tab.table.label",showOn:{scope:"table.cell"},components:[["mergecells","splitcells","tableCaption","tableSummary","formatTable"]]},{label:"tab.col.label",showOn:{scope:"table.column"},components:["addcolumnleft addcolumnright deletecolumns columnheader mergecellsColumn splitcellsColumn formatColumn".split(" ")]},
{label:"tab.row.label",showOn:{scope:"table.row"},components:["addrowbefore addrowafter deleterows rowheader mergecellsRow splitcellsRow formatRow".split(" ")]}]},combineToolbarSettings:function(d,g,k){function e(a){return"array"===j.type(a)?!a.length:o[a]}var p=a.fillTuples({},f.map(g,function(a){return[a.label,a]})),o=l(d,k),d=b(d,p,e),g=c(g,o,e);return d.concat(g)}}});define("ui/ui-plugin","jquery aloha ui/context ui/container ui/surface ui/toolbar ui/scopes ui/settings PubSub jqueryui".split(" "),
function(j,f,a,d,c,b,l,m,g){var k=new a,e=new b(k,function(){var a=f.settings.toolbar,b=m.defaultToolbarSettings;return!a?b.tabs:m.combineToolbarSettings(a.tabs||[],b.tabs,a.exclude||[])}());f.bind("aloha-editable-activated",function(a){c.show(k);d.showContainersForContext(k,a)});f.bind("aloha-editable-deactivated",function(){c.suppressHide||c.hide(k)});g.sub("aloha.ui.scope.change",function(){d.showContainersForContext(k);l.getPrimaryScope();var a=e._tabs,b=l.getPrimaryScope(),c,g;for(g=0;g<a.length;g++){c=
a[g].settings;if("object"===j.type(c.showOn)&&c.showOn.scope===b){a[g].tab.foreground();break}}});return{adoptInto:function(a,b){return e.adoptInto(a,b)},showToolbar:function(a){c.show(k);d.showContainersForContext(k,a)}}});define("ui/ui",["jquery","ui/ui-plugin"],function(j,f){var a={};return{adopt:function(d,c,b){"string"!==j.type(d)&&(b=c,c=d,d=b.name);c.isInstance||(c=b?c.extend(b):c,c=new c);a[d]=c;f.adoptInto(d,c);return c},getAdoptedComponent:function(d){return a[d]||null}}});define("ui/utils",
["jquery","jqueryui"],function(j){function f(a){return a.html||a.text||a.tooltip}function a(a){return'<img class="aloha-ui-inline-icon" src="'+a+'">'}return{wrapWithLabel:function(a,c){return j("<label>",{"class":"aloha-ui-label"}).append(j("<span>",{"class":"aloha-ui-label-text",text:a})).append(c)},makeButton:function(d,c,b){d.button({label:f(c),text:!(!c.text&&!c.html),icons:{primary:c.icon||c.iconUrl&&"aloha-ui-inline-icon-container"||null,secondary:b&&"aloha-jqueryui-icon ui-icon-triangle-1-s"||
null}});c.iconUrl&&d.button("widget").children(".ui-button-icon-primary").append(a(c.iconUrl));return d},makeButtonElement:function(a){return j("<button>",a).attr("type","button")},makeButtonLabel:f,makeButtonLabelWithIcon:function(d){var c=f(d);d.iconUrl&&(c=a(d.iconUrl)+c);return c},makeButtonIconFromUrl:a}});define("ui/vendor/jquery-ui-autocomplete-html",["jquery","jqueryui"],function(j){(function(f){function a(a,c){var d=RegExp(f.ui.autocomplete.escapeRegex(c),"i");return f.grep(a,function(a){return d.test(f("<div>").html(a.label||
a.value||a).text())})}var d=f.ui.autocomplete.prototype,c=d._initSource;f.extend(d,{_initSource:function(){this.options.html&&f.isArray(this.options.source)?this.source=function(b,c){c(a(this.options.source,b.term))}:c.call(this)},_renderItem:function(a,c){return f("<li></li>").data("item.autocomplete",c).append(f("<a></a>")[this.options.html?"html":"text"](c.label)).appendTo(a)}})})(j)});define("ui/port-helper-attribute-field","jquery ui/ui ui/component ui/scopes ui/context ui/utils aloha/repositorymanager aloha/selection aloha/console ui/vendor/jquery-ui-autocomplete-html".split(" "),
function(j,f,a,d,c,b,l,m){return function(d){function k(a,b){b.item&&u(b.item.obj);e()}function e(){if(!B){var a=j(R),b=a.attr("data-original-background-color");b?a.css("background-color",b):a.css("background-color","");a.removeAttr("data-original-background-color")}if(R&&ba!==j(R).attr(I)){K||l.markObject(R);r()===""&&o()}}function p(a,b){return a.replace(/\{([^}]+)\}/g,function(a,c){return c in b?b[c]:""})}function o(){if(null!=y){A.css("color","#AAA");A.val(y)}}function r(){return A.val()}function q(a){A.val(a);
A.css("color","black")}function u(a){if(K=a){var b=a[z];q(b);G=b;t(I,a[v]);l.markObject(R,a)}else G=null}function t(a,b,c,e){if(R){var d=true;typeof e!="undefined"&&(e.match(RegExp(c))||(d=false));d?j(R).attr(a,b):j(R).removeAttr(a)}}var v=d.valueField||"id",z=d.displayField||"name",x=d.objectTypeFilter||["all"],y=d.placeholder,B=!!d.noTargetHighlight,A=j('<input id="aloha-attribute-field-'+d.name+'">'),F,N,K,G,R,I,ba;d.cls&&A.addClass(d.cls);d.width&&A.width(d.width);F=f.adopt(d.name,a,{scope:d.scope,
init:function(){if(d.label){this.element=b.wrapWithLabel(d.label,A);d.labelClass&&this.element.addClass(d.labelClass)}else this.element=j("<span>").append(A);A.autocomplete({html:true,appendTo:c.selector,source:function(a,b){l.query({queryString:a.term,objectTypeFilter:x},function(a){b(j.map(a.items,function(a){return{label:p(N,a),value:a.name,obj:a}}))})},select:k})}});A.bind("focus",function(a){if(j(a.target).is(":visible")){if(!B){(a=j(R))&&(a.context&&a.context.style&&a.context.style["background-color"])&&
a.attr("data-original-background-color",a.context.style["background-color"]);a.css("background-color","#80B5F2")}r()===y&&q("")}}).bind("blur",function(){e()}).bind("keydown",function(a){(a.keyCode==13||a.keyCode==27)&&a.preventDefault()}).bind("keyup",function(a){if(K&&G!==r())G=K=null;K||t(I,r());if(a.keyCode==13||a.keyCode==27){m.getRangeObject().select();e()}});o();var T={getInputElem:function(){return A[0]},hasInputElem:function(){return true},getInputId:function(){return A.attr("id")},hide:function(){A.hide()},
show:function(){A.show()},foreground:function(){F.foreground()},focus:function(){F.focus();A.focus()},getTargetObject:function(){return R},setTargetObject:function(a,b){R=a;I=b;u(null);if(a&&b){ba=j(a).attr(b);q(j(R).attr(I));l.getObject(a,function(a){a&&a.length>0&&u(a[0])})}else q("")},setAttribute:t,getItem:function(){return K},setItem:u,setValue:q,getValue:r,addListener:function(a,b){A.bind(a,j.proxy(b,T))},setObjectTypeFilter:function(a){x=a},setTemplate:function(a){N=a},setPlaceholder:o};return T}});
define("ui/button",["jquery","ui/component","ui/utils","jqueryui"],function(j,f,a){return f.extend({init:function(){this._super();this.createButtonElement();a.makeButton(this.buttonElement,this).button("widget").tooltip({tooltipClass:"aloha aloha-ui-tooltip",position:{my:"left top",at:"right bottom"}}).click(j.proxy(function(){this.buttonElement.tooltip("close",null,!0);this._onClick()},this))},_onClick:function(){this.click()},click:function(){},createButtonElement:function(){var d=a.makeButtonElement();
this["class"]&&d.addClass(this["class"]);return this.element=this.buttonElement=d},disable:function(){this.element.button("option","disabled",!1)},enable:function(a){this.element.button("option","disabled",!1===a)}})});define("ui/toggleButton",["jquery","ui/button","jqueryui"],function(j,f){return f.extend({_checked:!1,setState:function(a){this._checked!==a&&((this._checked=a)?this.element.addClass("aloha-button-active"):this.element.removeClass("aloha-button-active"))},getState:function(){return this._checked},
_onClick:function(){this.setState(!this._checked);this.click()}})});define("link/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link","button.removelink.tooltip":"Remove Link","newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link","link.target.self":"Self","link.target.blank":"Blank","link.target.parent":"Parent","link.target.top":"Top","link.target.framename":"Framename","link.target.legend":"Target","link.title.legend":"Title",insertLink:"ctrl+k"},de:!0,fr:!0,pl:!0,ru:!0});define("aloha/nls/i18n",
{root:{"plugin.abbr.floatingmenu.tab.abbr":"Abbreviation","floatingmenu.tab.format":"Format","floatingmenu.tab.insert":"Insert",yes:"Yes",no:"No",cancel:"Cancel","repository.no_item_found":"No item found.","repository.loading":"Loading","repository.no_items_found_yet":"No items found yet..."},de:!0});define("link/../extra/linklist",["aloha","jquery"],function(j,f){var a=[{name:"Aloha Editor - The HTML5 Editor",url:"http://aloha-editor.org",type:"website"},{name:"Aloha Editor - Wiki",url:"http://github.com/alohaeditor/Aloha-Editor/wiki",
type:"website"},{name:"Aloha Editor - GitHub",url:"http://github.com/alohaeditor/Aloha-Editor",type:"website"},{name:"Aloha Logo",url:"http://www.aloha-editor.com/images/aloha-editor-logo.png",type:"image"}];new (j.AbstractRepository.extend({_constructor:function(){this._super("linklist")},folder:[],init:function(){j.settings.repositories&&(j.settings.repositories.linklist&&j.settings.repositories.linklist.data)&&(a=a.concat(j.settings.repositories.linklist.data));"filter"in Array.prototype||(a.filter=
function(a,b){for(var c=[],d,g=0,f=this.length;g<f;g++)g in this&&a.call(b,d=this[g],g,this)&&c.push(d);return c});for(var d=a.length,c=0;c<d;++c){var b=a[c];b.repositoryId=this.repositoryId;b.id=b.id?b.id:b.url;for(var f=b.uri=this.parseUri(b.url),m=this.addFolder("",f.host),f=f.path.split("/"),g=0;g<f.length;g++)f[g]&&0>f[g].lastIndexOf(".")&&(m=this.addFolder(m,f[g]));b.parentId=m;a[c]=new j.RepositoryDocument(b)}this.repositoryName="Linklist"},addFolder:function(a,c){var b=a?a+"/"+c:c;c&&!this.folder[b]&&
(this.folder[b]=new j.RepositoryFolder({id:b,name:c||b,parentId:a,type:"host",repositoryId:this.repositoryId}));return b},query:function(d,c){var b=RegExp(d.queryString,"i"),l=a.filter(function(a){return(!d.queryString||a.name.match(b)||a.url.match(b))&&(!d.objectTypeFilter||!d.objectTypeFilter.length||-1<f.inArray(a.type,d.objectTypeFilter))&&!0});c.call(this,l)},getChildren:function(a,c){var b=[],f;for(f in this.folder)"function"!=typeof this.folder[f]&&(this.folder[f].parentId==a.inFolderId||!this.folder[f].parentId&&
a.inFolderId==this.repositoryId)&&b.push(this.folder[f]);c.call(this,b)},parseUri:function(a){for(var c="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(a),b={},f=14;f--;)b[c[f]]=a[f]||"";b.queryKey={};b[c[12]].replace(/(?:^|&)([^&=]*)=?([^&]*)/g,
function(a,c,d){c&&(b.queryKey[c]=d)});return b},getObjectById:function(d,c){for(var b=0,f=a.length,m=[];b<f;b++)a[b].id==d&&m.push(a[b]);c.call(this,m)}}))});define("link/link-plugin","aloha aloha/plugin jquery ui/port-helper-attribute-field ui/ui ui/scopes ui/surface ui/button ui/toggleButton i18n!link/nls/i18n i18n!aloha/nls/i18n aloha/console link/../extra/linklist".split(" "),function(j,f,a,d,c,b,l,m,g,k){function e(b,c){var e,d=false;if(!b.ignoreNextSelectionChangedEvent&&j.Selection.isSelectionEditable()&&
j.activeEditable!=null)if(e=b.findLinkMarkup(c)){b.toggleLinkScope(true);b.hrefField.setTargetObject(e,"href");if(a("#"+b.hrefField.getInputId()).length==0){b.hrefUpdateInt!==null&&clearInterval(b.hrefUpdateInt);b.hrefUpdateInt=setInterval(function(){if(a("#"+b.hrefField.getInputId()).length>0){b.hrefField.setTargetObject(e,"href");clearInterval(b.hrefUpdateInt)}},200)}j.trigger("aloha-link-selected");d=true}else{b.toggleLinkScope(false);b.hrefField.setTargetObject(null);j.trigger("aloha-link-unselected")}else b.toggleLinkScope(false);
b.ignoreNextSelectionChangedEvent=false;return d}var p=window.GENTICS,o="",r;return f.create("link",{languages:["en","de","fr","ru","pl"],config:["a"],targetregex:"",target:"",cssclassregex:"",cssclass:"",objectTypeFilter:[],onHrefChange:null,ignoreNextSelectionChangedEvent:false,hrefUpdateInt:null,hotKey:{insertLink:k.t("insertLink","ctrl+k")},hrefValue:"http://",init:function(){var b=this;if(typeof this.settings.targetregex!="undefined")this.targetregex=this.settings.targetregex;if(typeof this.settings.target!=
"undefined")this.target=this.settings.target;if(typeof this.settings.cssclassregex!="undefined")this.cssclassregex=this.settings.cssclassregex;if(typeof this.settings.cssclass!="undefined")this.cssclass=this.settings.cssclass;if(typeof this.settings.objectTypeFilter!="undefined")this.objectTypeFilter=this.settings.objectTypeFilter;if(typeof this.settings.onHrefChange!="undefined")this.onHrefChange=this.settings.onHrefChange;typeof this.settings.hotKey!="undefined"&&a.extend(true,this.hotKey,this.settings.hotKey);
if(typeof this.settings.hrefValue!="undefined")this.hrefValue=this.settings.hrefValue;this.createButtons();this.subscribeEvents();this.bindInteractions();j.ready(function(){b.initSidebar(j.Sidebar.right)})},nsSel:function(){var b=[];a.each(arguments,function(){b.push("."+(this==""?"aloha-link":"aloha-link-"+this))});return a.trim(b.join(" "))},nsClass:function(){var b=[];a.each(arguments,function(){b.push(this==""?"aloha-link":"aloha-link-"+this)});return a.trim(b.join(" "))},initSidebar:function(b){var c=
this;c.sidebar=b;b.addPanel({id:c.nsClass("sidebar-panel-target"),title:k.t("floatingmenu.tab.link"),content:"",expanded:true,activeOn:"a, link",onInit:function(){var b=this;this.setContent('<div class="'+c.nsClass("target-container")+'"><fieldset><legend>'+k.t("link.target.legend")+'</legend><ul><li><input type="radio" name="targetGroup" class="'+c.nsClass("radioTarget")+'" value="_self" /><span>'+k.t("link.target.self")+'</span></li><li><input type="radio" name="targetGroup" class="'+c.nsClass("radioTarget")+
'" value="_blank" /><span>'+k.t("link.target.blank")+'</span></li><li><input type="radio" name="targetGroup" class="'+c.nsClass("radioTarget")+'" value="_parent" /><span>'+k.t("link.target.parent")+'</span></li><li><input type="radio" name="targetGroup" class="'+c.nsClass("radioTarget")+'" value="_top" /><span>'+k.t("link.target.top")+'</span></li><li><input type="radio" name="targetGroup" class="'+c.nsClass("radioTarget")+'" value="framename" /><span>'+k.t("link.target.framename")+'</span></li><li><input type="text" class="'+
c.nsClass("framename")+'" /></li></ul></fieldset></div><div class="'+c.nsClass("title-container")+'" ><fieldset><legend>'+k.t("link.title.legend")+'</legend><input type="text" class="'+c.nsClass("linkTitle")+'" /></fieldset></div>');a(c.nsSel("framename")).live("keyup",function(){a(b.effective).attr("target",a(this).val().replace('"',"&quot;").replace("'","&#39;"))});a(c.nsSel("radioTarget")).live("change",function(){if(a(this).val()=="framename")a(c.nsSel("framename")).slideDown();else{a(c.nsSel("framename")).slideUp().val("");
a(b.effective).attr("target",a(this).val())}});a(c.nsSel("linkTitle")).live("keyup",function(){a(b.effective).attr("title",a(this).val().replace('"',"&quot;").replace("'","&#39;"))})},onActivate:function(b){var e=this;e.effective=b;if(a(e.effective).attr("target")!=null){var d=true;a(c.nsSel("framename")).hide().val("");a(c.nsSel("radioTarget")).each(function(){a(this).removeAttr("checked");if(a(this).val()===a(e.effective).attr("target")){d=false;a(this).attr("checked","checked")}});if(d){a(c.nsSel('radioTarget[value="framename"]')).attr("checked",
"checked");a(c.nsSel("framename")).val(a(e.effective).attr("target")).show()}}else{a(c.nsSel("radioTarget")).first().attr("checked","checked");a(e.effective).attr("target",a(c.nsSel("radioTarget")).first().val())}e=this;e.effective=b;a(c.nsSel("linkTitle")).val(a(e.effective).attr("title"))}});b.show()},subscribeEvents:function(){var b=this,c={};j.bind("aloha-editable-created",function(e,d){var g=b.getEditableConfig(d.obj),g=a.inArray("a",g)!==-1;if(c[d.getId()]=g){d.obj.bind("keydown",b.hotKey.insertLink,
function(){if(b.findLinkMarkup()){b.hrefField.foreground();b.hrefField.focus()}else b.insertLink(true);return false});d.obj.find("a").each(function(){b.addLinkEventHandlers(this)})}});j.bind("aloha-editable-activated",function(){if(c[j.activeEditable.getId()]){b._formatLinkButton.show(true);b._insertLinkButton.show(true)}else{b._formatLinkButton.show(false);b._insertLinkButton.show(false)}});var d=false;j.bind("aloha-selection-changed",function(a,g){var k=false;if(j.activeEditable&&c[j.activeEditable.getId()])(k=
e(b,g))&&d!==k&&b.hrefField.foreground();d=k})},toggleLinkScope:function(a){if(this._isScopeActive!==a)if(this._isScopeActive=a){this.hrefField.show();this._insertLinkButton.show(false);this._removeLinkButton.show(true);this._formatLinkButton.setState(true);b.enterScope(this.name)}else{this.hrefField.hide();this._insertLinkButton.show(true);this._removeLinkButton.show(false);this._formatLinkButton.setState(false);b.leaveScope(this.name)}},addLinkEventHandlers:function(b){var c=this;a(b).mouseenter(function(){j.Log.debug(c,
"mouse over link.");c.mouseOverLink=b;c.updateMousePointer()});a(b).mouseleave(function(){j.Log.debug(c,"mouse left link.");c.mouseOverLink=null;c.updateMousePointer()});a(b).click(function(a){if(a.metaKey){j.activeEditable.blur();window.setTimeout(function(){location.href=a.target},0);a.stopPropagation();return false}})},createButtons:function(){var a=this;this._formatLinkButton=c.adopt("formatLink",g,{tooltip:k.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",
click:function(){a.formatLink()}});this._insertLinkButton=c.adopt("insertLink",m,{tooltip:k.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){a.insertLink(false)}});this.hrefField=d({name:"editLink",width:320,valueField:"url",cls:"aloha-link-href-field",scope:"Aloha.continuoustext"});this.hrefField.setTemplate("<span><b>{name}</b><br/>{url}</span>");this.hrefField.setObjectTypeFilter(this.objectTypeFilter);this._removeLinkButton=c.adopt("removeLink",
m,{tooltip:k.t("button.removelink.tooltip"),icon:"aloha-icon aloha-icon-unlink",scope:"Aloha.continuoustext",click:function(){a.removeLink()}})},bindInteractions:function(){var c=this;this.hrefField.addListener("keyup",function(e){if(e.keyCode==27){var d=c.hrefField.getValue();if(!(d[0]=="/"||d[0]=="#"||d.match(/^.*\.([a-z]){2,4}$/i)||d.match(/^([a-z]){3,10}:\/\/.+/i)||d.match(/^(mailto|tel):.+/i))){d=c.hrefField.getValue();c.hrefField.setValue(d);(d==c.hrefValue||d=="")&&c.removeLink(false)}}c.hrefChange();
if(e.keyCode==13){e=j.Selection.getRangeObject();c.ignoreNextSelectionChangedEvent=true;e.startContainer=e.endContainer;e.startOffset=e.endOffset;e.select();c.ignoreNextSelectionChangedEvent=true;d=a(c.hrefField.getInputElem()).attr("value");(d==c.hrefValue||d=="")&&c.removeLink(false);window.setTimeout(function(){b.setScope("Aloha.continuoustext")},100)}else{r=a(c.hrefField.getInputElem()).attr("value");o!=r&&(o=r)}});a(document).keydown(function(a){j.Log.debug(c,"Meta key down.");c.metaKey=a.metaKey;
c.updateMousePointer()}).keyup(function(a){j.Log.debug(c,"Meta key up.");c.metaKey=a.metaKey;c.updateMousePointer()})},updateMousePointer:function(){if(this.metaKey&&this.mouseOverLink){j.Log.debug(this,"set pointer");a(this.mouseOverLink).removeClass("aloha-link-text");a(this.mouseOverLink).addClass("aloha-link-pointer")}else{a(this.mouseOverLink).removeClass("aloha-link-pointer");a(this.mouseOverLink).addClass("aloha-link-text")}},findLinkMarkup:function(a){typeof a=="undefined"&&(a=j.Selection.getRangeObject());
return j.activeEditable?a.findMarkup(function(){return this.nodeName.toLowerCase()=="a"},j.activeEditable.obj):null},formatLink:function(){j.activeEditable&&(this.findLinkMarkup(j.Selection.getRangeObject())?this.removeLink():this.insertLink())},insertLink:function(b){var c=this,e=j.Selection.getRangeObject(),d;if(e.startContainer&&e.endContainer&&!this.findLinkMarkup(e)){this.hrefField.foreground();e.isCollapsed()&&b!==false&&p.Utils.Dom.extendToWord(e);if(e.isCollapsed()){b=k.t("newlink.defaulttext");
d=a('<a href="'+c.hrefValue+'" class="aloha-new-link">'+b+"</a>");p.Utils.Dom.insertIntoDOM(d,e,a(j.activeEditable.obj));e.startContainer=e.endContainer=d.contents().get(0);e.startOffset=0;e.endOffset=b.length}else{d=a('<a href="'+c.hrefValue+'" class="aloha-new-link"></a>');p.Utils.Dom.addMarkup(e,d,false)}j.activeEditable.obj.find("a.aloha-new-link").each(function(){c.addLinkEventHandlers(this);a(this).removeClass("aloha-new-link")});e.select();this.hrefField.focus();this.hrefField.hasInputElem()&&
a(this.hrefField.getInputElem()).attr("value",c.hrefValue).select();this.hrefChange()}},removeLink:function(a){var c=j.Selection.getRangeObject(),e=this.findLinkMarkup();this.hrefField.setItem(null);if(e){p.Utils.Dom.removeFromDOM(e,c,true);c.startContainer=c.endContainer;c.startOffset=c.endOffset;c.select();(typeof a=="undefined"||a===true)&&b.setScope("Aloha.continuoustext")}},hrefChange:function(){this.target!=""&&this.hrefField.setAttribute("target",this.target,this.targetregex,this.hrefField.getValue());
this.hrefField.setAttribute("class",this.cssclass,this.cssclassregex,this.hrefField.getValue());j.trigger("aloha-link-href-change",{obj:this.hrefField.getTargetObject(),href:this.hrefField.getValue(),item:this.hrefField.getItem()});typeof this.onHrefChange=="function"&&this.onHrefChange.call(this,this.hrefField.getTargetObject(),this.hrefField.getValue(),this.hrefField.getItem())},makeClean:function(b){b.find("a").each(function(){a(this).removeClass("aloha-link-pointer").removeClass("aloha-link-text")})}})});
define("ui/dialog",["jquery","ui/component"],function(j){function f(a){var b={};a.text&&(b.text=a.text);a.html&&(b.html=a.html);return j("<div>",b)}function a(a){for(var b in a)a.hasOwnProperty(b)&&(a[b]=function(a){return function(){a.apply(this);j(this).dialog("destroy").remove()}}(a[b]));return a}function d(a,b){var d="aloha aloha-dialog";a.cls&&(d+=" "+a.cls);return{resizable:!1,modal:!0,title:a.title||b,dialogClass:d,zIndex:10200}}return{confirm:function(c){var b=c.buttons||{};b.Yes=b.Yes||c.yes||
j.noop;b.No=b.No||c.no||j.noop;if(c.answer){var l=b.Yes,m=b.No;b.Yes=function(){l();c.answer(!0)};b.No=function(){m();c.answer(!1)}}var g=f(c).dialog(j.extend(d(c,"Confirm"),{buttons:a(b)}));return function(){g.dialog("destroy").remove()}},alert:function(c){var b=f(c).dialog(j.extend(d(c,"Alert"),{buttons:a({Dismiss:j.noop})}));return function(){b.dialog("destroy").remove()}},progress:function(a){var b=j("<div>").progressbar({value:null!=a.value?a.value:100}),l=f(a).dialog(j.extend(d(a,"Progress"),
{open:function(){j(this).append(b)}}));return function(a){null!=a?b.progressbar({value:a}):l.dialog("destroy").remove()}}}});define("ui/multiSplit",["jquery","ui/component","ui/button","ui/utils"],function(j,f,a,d){return f.extend({_activeButton:null,_isOpen:!1,init:function(){this._super();var a=this,b=this.element=j("<div>",{"class":"aloha-multisplit"});this.contentElement=j("<div>",{"class":"aloha-multisplit-content"}).appendTo(b);this.toggleButton=d.makeButtonElement({"class":"aloha-multisplit-toggle",
click:function(){a.toggle()}}).button().appendTo(b);this.buttons=[];var f=this.getButtons();0===f.length&&b.hide();for(b=0;b<f.length;b++)this.addButton(f[b]);j("body").click(function(b){a._isOpen&&(!a.element.is(b.target)&&0===a.element.find(b.target).length)&&a.close()})},addButton:function(c){var b=this,d=new (a.extend({tooltip:c.tooltip,icon:c.wide?c.icon:"aloha-large-icon "+c.icon,iconOnly:c.wide?!1:!0,init:function(){this._super();c.init&&c.init.call(this)},click:function(){c.click.apply(b,
arguments);b.close()}}));c.wide||d.element.addClass("aloha-large-button");b.buttons[c.name]={settings:c,component:d,element:d.element,visible:!0};var f=this.contentElement.children(".aloha-ui-multisplit-fullwidth");!c.wide&&f.length?f.before(d.element[0]):this.contentElement.append(d.element[0])},setActiveButton:function(a){a||(a=null);null!==this._activeButton&&this.buttons[this._activeButton].element.removeClass("aloha-multisplit-active");this._activeButton=a;null!==a&&this.buttons[a].element.addClass("aloha-multisplit-active")},
toggle:function(){this.element.toggleClass("aloha-multisplit-open");this._isOpen=!this._isOpen},open:function(){this.element.addClass("aloha-multisplit-open");this._isOpen=!0},close:function(){this.element.removeClass("aloha-multisplit-open");this._isOpen=!1},show:function(a){a||(a=null);null!==a&&void 0!==this.buttons[a]&&(this.buttons[a].element.show(),this.buttons[a].visible=!0,this.element.show())},hide:function(a){var b,d=!1;a||(a=null);if(null!==a&&void 0!==this.buttons[a]){this.buttons[a].element.hide();
this.buttons[a].visible=!1;for(b in this.buttons)if(this.buttons.hasOwnProperty(b)&&this.buttons[b].visible){this.element.show();d=!0;break}d||this.element.hide()}}})});define("ui/port-helper-multi-split",["aloha/core","jquery","ui/ui","ui/multiSplit"],function(j,f,a,d){return function(c){var b;b=a.adopt(c.name,d,{scope:c.scope,getButtons:function(){var a=[];f.each(c.items,function(b,c){a.push({tooltip:c.tooltip,text:c.text,name:c.name,icon:c.iconClass,click:c.click,init:function(){c.cls&&this.element.addClass(c.cls);
c.init&&c.init.call(this)},wide:c.wide})});return a}});return{pushItem:function(a){b.addButton(a)},showItem:function(a){b.show(a)},hideItem:function(a){b.hide(a)},setActiveItem:function(a){b.setActiveButton(a)}}}});define("table/nls/i18n",{root:{"floatingmenu.tab.table":"Table","floatingmenu.tab.tablelayout":"Table Layout","deleterows.confirm":"Do you really want to delete the selected rows?","deletecolumns.confirm":"Do you really want to delete the selected columns?","deletetable.confirm":"Do you really want to delete the table?",
Table:"Table","button.createtable.tooltip":"Insert Table","button.addcolleft.tooltip":"Add Column left","button.addcolright.tooltip":"Add Column right","button.delcols.tooltip":"Delete Columns","button.addrowbefore.tooltip":"Add Row before","button.addrowafter.tooltip":"Add Row after","button.delrows.tooltip":"Delete Rows","button.caption.tooltip":"Table caption","empty.caption":"Table caption","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting","button.rowheader.tooltip":"Format row as table header",
"button.columnheader.tooltip":"Format column as table header","button.mergecells.tooltip":"Merge Cells","button.splitcells.tooltip":"Split Cells","table.label.target":"Summary","table.sidebar.title":"Table","table.mergeCells.notRectangular":"Only a rectangular selection can be merged","table.addColumns.nonConsecutive":"Please select a single column or a consecutive range of columns","table.createTable.nestedTablesNoSupported":"Sorry, nested tables are not supported"},de:!0,eo:!0,fi:!0,fr:!0,it:!0,
pl:!0,ru:!0});define("table/table-create-layer",["jquery"],function(j){CreateLayer=function(f){this.TablePlugin=f};CreateLayer.prototype.parameters={elemId:"aloha-table-createLayer",className:"aloha-table-createdialog",numX:10,numY:10,layer:void 0,target:void 0};CreateLayer.prototype.config={};CreateLayer.prototype.visible=!1;CreateLayer.prototype.show=function(){var f=this.get("layer");null==f?this.create():(this.setPosition(f),f.find("td").removeClass("hover"),f.show());this.visible=!0};CreateLayer.prototype.create=
function(){var f=this,a=j("<div></div>");a.id=this.get("elemId");a.addClass(this.get("className"));var d=j("<table></table>");d.css("width",15*(this.get("numX")+6));for(var c,b,l=0;l<this.get("numY");l++){c=j("<tr></tr>");for(var m=0;m<this.get("numX");m++)b=j("<td> </td>"),0==l&&0==m&&b.addClass("hover"),b.bind("mouseover",{rowId:l,colId:m},function(a){f.handleMouseOver(a,d)}),b.bind("click",{rowId:l,colId:m},function(a){f.TablePlugin.createTable(a.data.colId+1,a.data.rowId+1);f.hide()}),c.append(b);
d.append(c)}a.append(d);this.set("layer",a);this.setPosition();a.bind("click",function(a){a.stopPropagation()}).mousedown(function(a){a.stopPropagation()});j("body").append(a).bind("click",function(a){f.visible&&!(a.target===f.get("target")[0]||j.contains(f.get("target")[0],a.target))&&f.hide()})};CreateLayer.prototype.handleMouseOver=function(f,a){for(var d=f.data.rowId,c=f.data.colId,b=a.find("tr"),l=0;l<=b.length;l++)for(var m=j(b[l]).find("td"),g=0;g<=m.length;g++)l<=d&&g<=c?j(m[g]).addClass("hover"):
j(m[g]).removeClass("hover")};CreateLayer.prototype.setPosition=function(){var f=j(this.get("target")),a=f.offset();this.get("layer").css("left",a.left+"px");this.get("layer").css("top",a.top+f.height()+"px")};CreateLayer.prototype.hide=function(){this.get("layer").hide();this.visible=!1};CreateLayer.prototype.get=function(f){if(this.config[f])return this.config[f];if(this.parameters[f])return this.parameters[f]};CreateLayer.prototype.set=function(f,a){this.config[f]?this.config[f]=a:this.parameters[f]=
a};return CreateLayer});define("table/table-plugin-utils",["jquery"],function(j){var f={cellIndexToGridColumn:function(a,d,c){var b=null;f.walkCells(a,function(a,f,g){if(a===d&&f===c)return b=g,!1});return b},walkCells:function(a,d){for(var c=[],b=0;b<a.length;b++){for(var l=a[b].cells,m=0,g=0;g<l.length;g++){for(var k=l[g],e=f.colspan(k),k=f.rowspan(k);c[g+m];)c[g+m]-=1,m+=1;if(!1===d(b,g,g+m,e,k))return;for(var p=0;p<e;p++){if(c[g+m+p])throw"an impossible case has occurred";c[g+m+p]=k-1}m+=e-1}for(;g+
m<c.length;m++)c[g+m]&&(c[g+m]-=1)}},makeGrid:function(a){var d=[];f.walkCells(a,function(c,b,f,m,g){for(var b=a[c].cells[b],k=0;k<g;k++){d[c+k]=d[c+k]||[];for(var e=0;e<m;e++)d[c+k][f+e]={cell:b,colspan:m,rowspan:g,spannedX:e,spannedY:k}}});return d},containsDomCell:function(a){return 0===a.spannedX&&0===a.spannedY},leftDomCell:function(a,d,c){do{var b=a[d][c];if(0===b.spannedY)return b.cell;c-=b.spannedX+1}while(0<=c);return null},splitCell:function(a,d){var c=j(a),b=f.colspan(a),l=f.rowspan(a);
if(!(1===b&&1===l)){for(var m=c.parent(),g=m.parent().children(),m=m.index(),k=c.index(),e=f.makeGrid(g),k=f.cellIndexToGridColumn(g,m,k),p=0;p<l;p++)for(var o=0===p?1:0;o<b;o++){var r=f.leftDomCell(e,m+p,k);null==r?g.eq(m+p).prepend(d()):j(r).after(d())}c.removeAttr("colSpan");c.removeAttr("rowSpan")}},rowspan:function(a){return parseInt(j(a).attr("rowspan"))||1},colspan:function(a){return parseInt(j(a).attr("colspan"))||1},walkGrid:function(a,d){for(var c=0;c<a.length;c++)for(var b=0;b<a[c].length;b++)if(!1===
d(a[c][b],b,c))return},walkGridInsideRect:function(a,d,c){f.walkGrid(a,function(a,f,m){if(m>=d.top&&m<d.bottom&&f>=d.left&&f<d.right)return c(a,f,m)})},leftTrimArray:function(a){for(var d=0;d<a.length;d++)if(null!=a[d])return a.slice(d,a.length);return[]},makeContour:function(a,d){var c=[],b=[],l=[],m=[];f.walkGrid(a,function(a,k,e){if(d(a,k,e)){if(null==c[e]||k<c[e])c[e]=k;if(null==b[e]||k>b[e])b[e]=k;if(null==l[k]||e<l[k])l[k]=e;if(null==m[k]||e>m[k])m[k]=e}});c=f.leftTrimArray(c);b=f.leftTrimArray(b);
l=f.leftTrimArray(l);m=f.leftTrimArray(m);return{left:c,right:b,top:l,bottom:m}},indexOfAnyBut:function(a,d){for(var c=0;c<a.length;c++)if(d!==a[c])return c;return-1},isConsecutive:function(a){for(var d=1;d<a.length;d++)if(1!==Math.abs(a[d]-a[d-1]))return!1;return!0}};return f});define("table/table-cell",["jquery","table/table-plugin-utils"],function(j,f){var a=function(a,c){null==a&&(a="<td>&nbsp;</td>");a=j(a).get(0);this.obj=j(a);this.tableObj=c;c.cells.push(this)};a.prototype.tableObj=void 0;
a.prototype.obj=void 0;a.prototype.wrapper=void 0;a.prototype.hasFocus=!1;a.prototype.activate=function(){this.obj.wrapInner("<div/>");var a=this.obj.children("div").eq(0);a.contentEditable(!0);a.addClass("aloha-table-cell-editable");var c=this;a.bind("focus",function(a){a.currentTarget&&(a.currentTarget.indexOf=function(){return-1});c._editableFocus(a)});a.bind("mousedown",function(a){a.currentTarget&&(a.currentTarget.indexOf=function(){return-1});c._editableMouseDown(a);c._startCellSelection()});
a.bind("blur",function(a){c._editableBlur(a)});a.bind("keyup",function(a){c._editableKeyUp(a)});a.bind("keydown",function(a){c._editableKeyDown(a)});a.bind("mouseover",function(){c._selectCellRange()});a.contentEditableSelectionChange(function(b){Aloha.Selection.onChange(a,b);return a});this.obj.bind("mousedown",function(a){window.setTimeout(function(){c.wrapper.trigger("focus")},1);c.tableObj.selection.unselectCells();c._startCellSelection();a.stopPropagation()});this.obj.get(0)&&(this.obj.get(0).onselectstart=
function(){return!1});this.wrapper=this.obj.children();this.wrapper.get(0)&&(this.wrapper.get(0).onselectstart=function(){window.event.cancelBubble=true},this.wrapper.get(0).ondragstart=function(){return false});return this};a.prototype.deactivate=function(){var a=j(this.obj.children(".aloha-table-cell-editable"));a.length&&(a.parent().append(a.contents()),a.remove(),this.obj.unbind("click"),this.obj.unbind("mousedown"),""==j.trim(this.obj.attr("class"))&&this.obj.removeAttr("class"))};a.prototype.toString=
function(){return"TableCell"};a.prototype._editableFocus=function(){this.hasFocus||(this.tableObj.focus(),this.obj.addClass("aloha-table-cell_active"),this.hasFocus=!0,this.tableObj.selection.selectionType="cell")};a.prototype._editableBlur=function(){this.hasFocus=!1;this.obj.removeClass("aloha-table-cell_active")};a.prototype._virtualX=function(){var a=this.tableObj.obj.children().children("tr"),c=this.obj.parent().index(),b=this.obj.index();return f.cellIndexToGridColumn(a,c,b)};a.prototype._virtualY=
function(){return this.obj.parent("tr").index()};a.prototype._startCellSelection=function(){if(!this.tableObj.selection.cellSelectionMode){this.tableObj.selection.unselectCells();this.tableObj.selection.cellSelectionMode=!0;var a=this;j("body").bind("mouseup.cellselection",function(){a._endCellSelection()});this.tableObj.selection.baseCellPosition=[this._virtualY(),this._virtualX()]}};a.prototype._endCellSelection=function(){this.tableObj.selection.cellSelectionMode&&(this.tableObj.selection.cellSelectionMode=
!1,this.tableObj.selection.baseCellPosition=null,this.tableObj.selection.lastSelectionRange=null,this.tableObj.selection.selectionType="cell",j("body").unbind("mouseup.cellselection"))};a.prototype._getSelectedRect=function(){var a=this._virtualX(),c=this._virtualY(),b=this.tableObj.selection.baseCellPosition,f=b[1];f>a&&(f=a,a=b[1]);var m=b[0];m>c&&(m=c,c=b[0]);return{top:m,right:a,bottom:c,left:f}};a.prototype._selectCellRange=function(){if(this.tableObj.selection.cellSelectionMode){var a=this._getSelectedRect(),
c=this.tableObj,b=c.obj.children().children("tr"),b=f.makeGrid(b);c.selection.selectedCells=[];var l=c.get("classCellSelected");f.walkGrid(b,function(b,g,k){f.containsDomCell(b)&&(k>=a.top&&k<=a.bottom&&g>=a.left&&g<=a.right?(j(b.cell).addClass(l),c.selection.selectedCells.push(b.cell)):j(b.cell).removeClass(l))});c.selection.notifyCellsSelected()}};a.prototype._selectAll=function(a){a=a.jquery?a.get(0):a;if(j.browser.msie)document.getSelection?(c=document.getSelection(),b=document.createRange(),
b.selectNodeContents(a),c.removeAllRanges(),c.addRange(b)):document.selection&&(b=document.body.createTextRange(),b.moveToElementText(a),b.select());else{var c=window.getSelection();if(c.setBaseAndExtent)c.setBaseAndExtent(a,0,a,Math.max(0,a.innerText.length-1));else{window.opera&&"<BR>"==a.innerHTML.substring(a.innerHTML.length-4)&&(a.innerHTML+="&#160;");var b=document.createRange();b.selectNodeContents(a);c.removeAllRanges();c.addRange(b)}}};a.prototype._editableMouseDown=function(a){this.tableObj.selection.unselectCells();
this.tableObj.hasFocus&&a.stopPropagation()};a.prototype._editableKeyUp=function(){};a.prototype._editableKeyDown=function(a){this._checkForEmptyEvent(a);this.obj[0]===this.tableObj.obj.find("tr:last td:last")[0]&&(9==a.keyCode&&!a.altKey&&!a.shiftKey&&!a.ctrlKey)&&(this.tableObj.addRow(this.obj.parent().index()+1),this.tableObj.cells[this.tableObj.cells.length-1]._selectAll(this.wrapper.get(0)),a.stopPropagation())};a.prototype._checkForEmptyEvent=function(){var a=j(this.wrapper),c=a.text();!(0<
a.children().length)&&""===c&&(this.wrapper.text(" "),this.wrapper.get(0).blur(),this.wrapper.get(0).focus())};a.getContainer=function(a){return j(a.firstChild).hasClass("aloha-table-cell-editable")?a.firstChild:a};return a});define("table/table-selection","aloha jquery table/table-plugin-utils table/table-cell ui/dialog i18n!table/nls/i18n".split(" "),function(j,f,a,d,c,b){function l(a){return{top:a.top[0],right:a.right[0]+1,bottom:a.bottom[0]+1,left:a.left[0]}}function m(b,c,d){var g=true;if(-1!==
a.indexOfAnyBut(c.top,c.top[0])||-1!==a.indexOfAnyBut(c.right,c.right[0])||-1!==a.indexOfAnyBut(c.bottom,c.bottom[0])||-1!==a.indexOfAnyBut(c.left,c.left[0]))g=false;else{c=l(c);a.walkGridInsideRect(b,c,function(a){if(!d(a))return g=false})}return g}var g=function(a){this.table=a};g.prototype.selectionType=void 0;g.prototype.selectedCells=[];g.prototype.selectedColumnIdxs=[];g.prototype.selectedRowIdxs=[];g.prototype.cellSelectionMode=false;g.prototype.baseCellPosition=null;g.prototype.lastSelectionRange=
null;g.prototype.selectColumns=function(b){this.unselectCells();var c=this.table.getRows();c.shift();for(var c=a.makeGrid(c),d=0;d<b.length;d++)if(-1===f.inArray(b[d],this.selectedColumnIdxs)){this.selectedColumnIdxs.push(b[d]);for(var g=0;g<c.length;g++){var l=c[g][b[d]];if(a.containsDomCell(l)){f(l.cell).addClass(this.table.get("classCellSelected"));this.selectedCells.push(l.cell)}}}this.selectionType="column"};g.prototype.selectRows=function(a){this.unselectCells();var b=this.table.getRows();a.sort(function(a,
b){return a-b});for(var c=0;c<a.length;c++)if(b[a[c]]){for(var d=0;d<this.selectedRowIdxs.length;d++)if(a[c]==this.selectedRowIdxs[d])return;this.selectedRowIdxs.push(a[c]);for(d=1;d<b[a[c]].cells.length;d++){this.selectedCells.push(b[a[c]].cells[d]);f(b[a[c]].cells[d]).addClass(this.table.get("classCellSelected"))}}this.selectionType="row"};g.prototype.selectAll=function(){var a=f.map(this.table.getRows(),function(a,b){return b});a.shift();this.selectRows(a)};g.prototype.notifyCellsSelected=function(){j.trigger("aloha-table-selection-changed")};
g.prototype._notifyCellsUnselected=function(){j.trigger("aloha-table-selection-changed")};g.prototype.isHeader=function(){if(this.selectedCells.length==0)return false;for(var a=0;a<this.selectedCells.length;a++)if(!this.selectedCells[a]||this.selectedCells[a].nodeName.toLowerCase()!="th")return false;return true};g.prototype.unselectCells=function(){var a;if(!this.cellSelectionMode&&this.selectedCells.length>0){a=this.table.getRows();for(var b=0;b<a.length;b++)for(var c=1;c<a[b].cells.length;c++)f(a[b].cells[c]).removeClass(this.table.get("classCellSelected"));
this.selectedCells=[];this.selectedColumnIdxs=[];this.selectedRowIdxs=[];this.selectionType="cell";this._notifyCellsUnselected()}};g.prototype.selectionIndex=function(a){for(var b=0;b<this.selectedCells.length;b++)if(this.selectedCells[b]===a)return b;return-1};g.prototype.mergeCells=function(){var g=this.selectedCells;if(0!==g.length){var e=function(a){return-1!=f.inArray(a.cell,g)},p=a.makeGrid(this.table.getRows()),o=a.makeContour(p,e);if(m(p,o,e)){var r=l(o),e=f(p[r.top][r.left].cell),q=f(d.getContainer(e.get(0)));
a.walkGridInsideRect(p,r,function(a,b,c){if(!(b-a.spannedX===r.left&&c-a.spannedY===r.top)){a=a.cell;b=f(d.getContainer(a)).contents();for(c=0;c<b.length;c++)if("string"!==typeof b[c]||""!==f.trim(b[c])){q.append(" ");q.append(b);break}f(a).remove()}});e.attr({rowspan:r.bottom-r.top,colspan:r.right-r.left});this.selectedCells=[e.get(0)];this.cellSelectionMode=false;this.lastSelectionRange=this.baseCellPosition=null;this.selectionType="cell";j.trigger("aloha-table-selection-changed")}else c.alert({title:b.t("Table"),
text:b.t("table.mergeCells.notRectangular")})}};g.prototype.splitCells=function(){var b=this,c=this.selectedCells;if(c.length>0){f(c).each(function(){a.splitCell(this,function(){return b.table.newActiveCell().obj})});this.cellSelectionMode=false;this.lastSelectionRange=this.baseCellPosition=null;this.selectionType="cell";j.trigger("aloha-table-selection-changed")}};g.prototype.cellsAreMergeable=function(){var b=this.selectedCells;if(b.length<2)return false;var c=function(a){return-1!=f.inArray(a.cell,
b)},d=a.makeGrid(this.table.getRows()),g=a.makeContour(d,c);return m(d,g,c)?true:false};g.prototype.cellsAreSplitable=function(){var b=0;if(this.selectedCells.length>0){f(this.selectedCells).each(function(){var c=a.colspan(this),d=a.rowspan(this);(c>1||d>1)&&b++});return b>0?true:false}return false};return g});define("table/table","aloha jquery ui/scopes ui/dialog i18n!table/nls/i18n table/table-cell table/table-selection table/table-plugin-utils".split(" "),function(j,f,a,d,c,b,l,m){function g(a,
b){var c=-1,e=null;"before"===a?e=b.selectedCells[0]:"after"===a&&(e=b.selectedCells[b.selectedCells.length-1]);if(e&&e.nodeType==1)c=e.parentNode.rowIndex;return c}var k=window.GENTICS,e=function(a,b){this.obj=f(a);var c,e,d=this.getRows(),g=d.length,j,z=0,x=[],y;for(c=0;c<g;c++){e=f(d[c]);e=e.children("td, th");j=e.length;j=m.cellIndexToGridColumn(d,c,j-1)+1;y=parseInt(e.last().attr("colspan"),10);if(y!=0&&!isNaN(y)){y==1&&e.last().removeAttr("colspan");j=j+(y-1)}x.push(j);j>z&&(z=j)}for(c=0;c<
g;c++){e=z-x[c];e>0&&f(d[c]).append(Array(e+1).join("<td></td>"))}this.obj.attr("id")||this.obj.attr("id",k.Utils.guid());this.tablePlugin=b;this.selection=new l(this);this.refresh()};f.extend(e.prototype,{obj:void 0,tableWrapper:void 0,cells:void 0,numRows:void 0,numCols:void 0,isActive:false,hasFocus:false,parentEditable:void 0,mousedown:false,clickedColumnId:-1,clickedRowId:-1,columnsToSelect:[],rowsToSelect:[],fmPluginId:void 0});e.prototype.refresh=function(){this.numCols=this.countVirtualCols();
var a=this.getRows();this.numRows=a.length;this.cells=[];for(var b=0;b<a.length;b++)for(var c=f(a[b]).children(),e=0;e<c.length;e++)this.newCell(c[e])};e.prototype.countVirtualCols=function(){var a=this.obj.children().children("tr:first-child").children();return a.length-a.filter("."+this.get("classLeftUpperCorner")).length};e.prototype.get=function(a){return this.tablePlugin.get(a)};e.prototype.set=function(a,b){this.tablePlugin.set(a,b)};e.prototype.activate=function(){if(!this.isActive){var a=
this,b;this.obj.addClass(this.get("className"));this.obj.contentEditable(false);this.obj.attr("id")==""&&this.obj.attr("id",k.Utils.guid());this.selection.selectionType=void 0;b=this.obj.children("tbody");if(b.length===0)b=this.obj;b.bind("keydown",function(b){!b.ctrlKey&&!b.shiftKey&&a.selection.selectedCells.length>0&&a.selection.selectedCells[0].length>0&&a.selection.selectedCells[0][0].firstChild.focus()});b.bind("mousedown",function(b){a.hasFocus||a.focus();b.stopPropagation();b.preventDefault();
return false});this.obj.wrap(f('<div class="'+this.get("classTableWrapper")+'" data-block-skip-scope="true"></div>'));b=this.obj.parent();b.alohaBlock&&b.alohaBlock();b=this.obj.parents("."+this.get("classTableWrapper"));b.get(0).onresizestart=function(){return false};b.get(0).oncontrolselect=function(){return false};b.get(0).ondragstart=function(){return false};b.get(0).onmovestart=function(){return false};this.tableWrapper=this.obj.parents("."+this.get("classTableWrapper")).get(0);f(this.cells).each(function(){this.activate()});
this.attachSelectionColumn();this.attachSelectionRow();this.makeCaptionEditable();this.checkWai();this.isActive=true;j.trigger("aloha-table-activated")}};e.prototype.makeCaptionEditable=function(){var a=this.obj.find("caption").eq(0);a&&this.tablePlugin.makeCaptionEditable(a)};e.prototype.checkWai=function(){var a=this.wai;if(a){a.removeClass(this.get("waiGreen"));a.removeClass(this.get("waiRed"));f.trim(this.obj[0].summary)!=""?a.addClass(this.get("waiGreen")):a.addClass(this.get("waiRed"))}};e.prototype.attachSelectionColumn=
function(){var a=f("<td>"),b,c,e,d;a.html(" ");e=this.obj.context.rows;for(d=0;d<e.length;d++){c=f(e[d]);b=a.clone();b.addClass(this.get("classSelectionColumn"));b.css("width",this.get("selectionArea")+"px");c.prepend(b);this.attachRowSelectionEventsToCell(b)}};e.prototype.attachRowSelectionEventsToCell=function(a){var b=this;a.unbind("mousedown");a.unbind("mouseover");a.get(0).onselectstart=function(){return false};a.bind("mousedown",function(a){return b.rowSelectionMouseDown(a)});a.bind("mouseover",
function(a){if(b.mousedown)return b.rowSelectionMouseOver(a)})};e.prototype.rowSelectionMouseDown=function(a){this.focus();if(this.selection.selectedCells.length==0)this.rowsToSelect=[];this.clickedRowId=a.currentTarget.parentNode.rowIndex;if(a.metaKey){var b=f.inArray(this.clickedRowId,this.rowsToSelect);b>=0?this.rowsToSelect.splice(b,1):this.rowsToSelect.push(this.clickedRowId)}else if(a.shiftKey){this.rowsToSelect.sort(function(a,b){return a-b});var c=this.rowsToSelect[0],b=this.clickedRowId;
if(c>b){c=b;b=this.rowsToSelect[0]}for(this.rowsToSelect=[];c<=b;c++)this.rowsToSelect.push(c)}else this.rowsToSelect=[this.clickedRowId];this.selectRows();a.preventDefault();a.stopPropagation();this.tablePlugin.summary.focus();return false};e.prototype.rowSelectionMouseOver=function(a){var b=a.currentTarget.parentNode.rowIndex,c;if(this.mousedown&&this.clickedRowId>=0){f.inArray(b,this.rowsToSelect);c=b<this.clickedRowId?b:this.clickedRowId;b=b<this.clickedRowId?this.clickedRowId:b;for(this.rowsToSelect=
[];c<=b;c++)this.rowsToSelect.push(c);this.selectRows();a.preventDefault();a.stopPropagation();return false}};e.prototype.attachSelectionRow=function(){var a=this,b=f("<td>");b.html(" ");for(var c=0,e=0;e<this.obj.context.rows.length;e++){for(var d=0,g=0;g<this.obj.context.rows[e].cells.length;g++)var k=m.colspan(this.obj.context.rows[e].cells[g]),d=d+k;c<d&&(c=d)}d=f("<tr>");d.addClass(this.get("classSelectionRow"));d.css("height",this.get("selectionArea")+"px");for(e=0;e<c;e++){g=b.clone();if(e>
0)this.attachColumnSelectEventsToCell(g);else{g=f("<td>").clone();g.addClass(this.get("classLeftUpperCorner"));this.wai=f("<div/>").width(25).height(12).click(function(b){a.focus();a.selection.selectAll();a.tablePlugin.activeTable.selection.selectionType="cell";a.tablePlugin.updateFloatingMenuScope();a._removeCursorSelection();if(a.tablePlugin.settings.summaryinsidebar){a.tablePlugin.sidebar.open();a.tablePlugin.sidebarPanel.activate(a.obj);a.tablePlugin.sidebar.correctHeight()}try{a.tablePlugin.summary.focus();
b.stopPropagation();b.preventDefault()}catch(c){}return false});g.append(this.wai)}d.append(g)}f(document).bind("mouseup",function(b){a.columnSelectionMouseUp(b)});this.obj.find("tr:first").before(d)};e.prototype.attachColumnSelectEventsToCell=function(a){var b=this;a.unbind("mousedown");a.unbind("mouseover");a.get(0).onselectstart=function(){return false};a.bind("mousedown",function(a){b.columnSelectionMouseDown(a)});a.bind("mouseover",function(a){b.columnSelectionMouseOver(a)})};e.prototype.columnSelectionMouseDown=
function(a){this.focus();if(this.selection.selectedCells.length==0)this.columnsToSelect=[];this.clickedColumnId=f(a.currentTarget.parentNode).children().index(a.currentTarget);if(a.metaKey){var b=f.inArray(this.clickedColumnId,this.columnsToSelect);b>=0?this.columnsToSelect.splice(b,1):this.columnsToSelect.push(this.clickedColumnId)}else if(a.shiftKey){this.columnsToSelect.sort(function(a,b){return a-b});var c=this.columnsToSelect[0],b=this.clickedColumnId;if(c>b){c=b;b=this.columnsToSelect[0]}for(this.columnsToSelect=
[];c<=b;c++)this.columnsToSelect.push(c)}else this.columnsToSelect=[this.clickedColumnId];this.selectColumns();a.preventDefault();a.stopPropagation();return false};e.prototype.columnSelectionMouseOver=function(a){var b=a.currentTarget.cellIndex,a=[],c;if(this.mouseDownColIdx){c=b<this.mouseDownColIdx?b:this.mouseDownColIdx;for(b=b<this.mouseDownColIdx?this.mouseDownColIdx:b;c<=b;c++)a.push(c);this.selectColumns(a)}};e.prototype.columnSelectionMouseUp=function(){this.mouseDownColIdx=false};e.prototype.deleteRows=
function(){var a=[],b={},e=this;if(0!==this.selection.selectedCells.length){for(var g=0;g<this.selection.selectedCells.length;g++)b[this.selection.selectedCells[g].parentNode.rowIndex]=true;for(rowId in b)a.push(rowId);b=false;a.length==this.numRows&&(b=true);if(b){var k=this;d.confirm({title:c.t("Table"),text:c.t("deletetable.confirm"),yes:function(){k.deleteTable()}})}else{a.sort(function(a,b){return a-b});var l=a[0];l>this.numRows-a.length&&l--;var j=this.getRows();f.each(a,function(a,b){for(var c=
j[b],d=0;d<c.cells.length;d++)m.splitCell(c.cells[d],function(){return e.newActiveCell().obj})});var z=m.makeGrid(j);f.each(a,function(a,b){for(var c=z[b],e=0;e<c.length;){var d=c[e],g=m.rowspan(d.cell);1<g&&f(d.cell).attr("rowspan",g-1);e=e+d.colspan}f(j[b]).remove()});this.numRows=this.numRows-a.length;window.setTimeout(function(){f(j[1].cells[l+1]).focus()},5);this.selection.unselectCells()}}};e.prototype.deleteColumns=function(){var a=[],b=this.getRows(),e=this,g,k=m.makeGrid(b);if(this.selection.selectedColumnIdxs.length==
k[0].length-1)d.confirm({title:c.t("Table"),text:c.t("deletetable.confirm"),yes:function(){e.deleteTable()}});else{a.sort(function(a,b){return a-b});for(var l=this.selection.selectedColumnIdxs.sort(function(a,b){return b-a}),j=0;j<l.length;j++){for(var z=l[j],x=0;x<b.length;x++)if(g=k[x][z]){if(0===g.spannedX){if(1<g.colspan){var y=this.newActiveCell().obj;f(g.cell).after(y);y.attr("rowspan",g.rowspan);y.attr("colspan",g.colspan-1)}f(g.cell).remove()}else f(g.cell).attr("colspan",g.colspan-1);x=x+
(g.rowspan-1)}k=m.makeGrid(b)}this.numCols=this.numCols-a.length;window.setTimeout(function(){f(b[1].cells[1]).focus()},5);this.selection.unselectCells()}};e.prototype.deleteTable=function(){for(var a=-1,b=0;b<this.tablePlugin.TableRegistry.length;b++)if(this.tablePlugin.TableRegistry[b].obj.attr("id")==this.obj.attr("id")){a=b;break}if(a>=0){this.deactivate();this.selection.selectionType=void 0;this.tablePlugin.TableRegistry.splice(b,1);a=j.Selection.rangeObject;a.endContainer=this.obj.get(0).parentNode;
a.startContainer=a.endContainer;a.endOffset=k.Utils.Dom.getIndexInParent(this.obj.get(0));a.startOffset=a.endOffset;a.clearCaches();this.obj.remove();this.parentEditable.obj.focus();a.correctRange();a.select()}};e.prototype.addRowBeforeSelection=function(){var a=g("before",this.selection);-1!==a&&this.addRow(a)};e.prototype.addRowAfterSelection=function(){var a=g("after",this.selection);-1!==a&&this.addRow(a+1)};e.prototype.addRow=function(a){this.countVirtualCols();for(var b=this.obj.children().children("tr"),
c=0;c<1;c++){var e=f("<tr>"),d=f("<td>");d.addClass(this.get("classSelectionColumn"));this.attachRowSelectionEventsToCell(d);e.append(d);d=m.makeGrid(b);if(a>=d.length)for(var g=1;g<d[0].length;g++)e.append(this.newActiveCell().obj);else for(g=1;g<d[a].length;){var k=d[a][g];if(m.containsDomCell(k))for(var l=k.colspan;l--;)e.append(this.newActiveCell().obj);else f(k.cell).attr("rowspan",k.rowspan+1);g=g+k.colspan}a>=b.length?b.eq(b.length-1).after(e):b.eq(a).before(e)}this.numRows=this.numRows+1};
e.prototype.addColumnsRight=function(){this.addColumns("right")};e.prototype.addColumnsLeft=function(){this.addColumns("left")};e.prototype.addColumns=function(a){var b=f("<td>"),e=this.getRows(),g,k;g=this.selection.selectedColumnIdxs;if(0!==g.length){g.sort(function(a,b){return a-b});if(m.isConsecutive(g)){if("left"===a){k=g[0];for(var l=0;l<this.selection.selectedColumnIdxs.length;l++)this.selection.selectedColumnIdxs[l]=this.selection.selectedColumnIdxs[l]+1}else k=g[g.length-1];for(var j=m.makeGrid(e),
l=0;l<e.length;l++){g=b.clone();g.html(" ");if(l==0)this.attachColumnSelectEventsToCell(g);else{cellObj=this.newActiveCell(g.get(0));g=cellObj.obj}var z=m.leftDomCell(j,l,k);null==z?f(e[l]).prepend(g):"left"===a&&m.containsDomCell(j[l][k])?f(z).before(g):f(z).after(g);this.numCols++}}else d.alert({title:c.t("Table"),text:c.t("table.addColumns.nonConsecutive")})}};e.prototype.focus=function(){if(!this.hasFocus){this.parentEditable.isActive||this.parentEditable.obj.focus();this.tablePlugin.setFocusedTable(this)}};
e.prototype.focusOut=function(){if(this.hasFocus){this.tablePlugin.setFocusedTable(void 0);this.selection.selectionType=void 0}};e.prototype._removeCursorSelection=function(){var a=j.getSelection();if(a&&a._nativeSelection&&a._nativeSelection._ranges.length!=0){a=a.getRangeAt(0);if(null!=a.startContainer&&0===f(a.startContainer).closest("table").length&&0!==this.selection.selectedCells.length){a=b.getContainer(this.selection.selectedCells[0]);f(a).focus()}}};e.prototype.selectColumns=function(b){for(var b=
b?b:this.columnsToSelect,c=0;c<this.tablePlugin.columnMSItems.length;c++)this.tablePlugin.columnMSButton.showItem(this.tablePlugin.columnMSItems[c].name);a.setScope(this.tablePlugin.name+".column");this.tablePlugin._columnheaderButton.setState(this.selection.isHeader());c=this.getRows();this.tablePlugin.columnMSButton.setActiveItem();for(var e=0;e<this.tablePlugin.columnConfig.length;e++)if(f(c[0].cells[0]).hasClass(this.tablePlugin.columnConfig[e].cssClass)){this.tablePlugin.columnMSButton.setActiveItem(this.tablePlugin.columnConfig[e].name);
e=this.tablePlugin.columnConfig.length}this.obj.find("div.aloha-ui-table-cell-editable").blur();this.selection.selectColumns(b);this.selection.notifyCellsSelected();this._removeCursorSelection()};e.prototype.selectRows=function(){for(var b=0;b<this.tablePlugin.rowMSItems.length;b++)this.tablePlugin.rowMSButton.showItem(this.tablePlugin.rowMSItems[b].name);for(b=0;b<this.rowsToSelect.length;b++){var c=this.rowsToSelect[b],c=f(this.getRows()[c].cells).toArray();if(b==0)for(var e=0;e<c.length;e++){this.tablePlugin.rowMSButton.setActiveItem();
for(var d=0;d<this.tablePlugin.rowConfig.length;d++)if(f(c[e]).hasClass(this.tablePlugin.rowConfig[d].cssClass)){this.tablePlugin.rowMSButton.setActiveItem(this.tablePlugin.rowConfig[d].name);d=this.tablePlugin.rowConfig.length}}}a.setScope(this.tablePlugin.name+".row");this.selection.selectRows(this.rowsToSelect);this.tablePlugin._rowheaderButton.setState(this.selection.isHeader());this.obj.find("div.aloha-ui-table-cell-editable").blur();this.selection.notifyCellsSelected();this._removeCursorSelection()};
e.prototype.deactivate=function(){var a=this.obj.parent();a.mahaloBlock&&a.mahaloBlock();this.obj.removeClass(this.get("className"));f.trim(this.obj.attr("class"))==""&&this.obj.removeAttr("class");this.obj.removeAttr("contenteditable");this.obj.parents("."+this.get("classTableWrapper")).length&&this.obj.unwrap();this.obj.find("tr."+this.get("classSelectionRow")+":first").remove();var b=this;f.each(this.obj.context.rows,function(){f(this).children("td."+b.get("classSelectionColumn")).remove()});this.obj.find("td, th").removeClass(this.get("classCellSelected"));
this.obj.find("td, th").removeClass("aloha-table-cell_active");this.obj.unbind();this.obj.children("tbody").unbind();for(a=0;a<this.cells.length;a++)this.cells[a].deactivate();this.obj.find("caption div").each(function(){f(this).contents().unwrap()});this.isActive=false};e.prototype.toString=function(){return"Table"};e.prototype.newCell=function(a){return new b(a,this)};e.prototype.newActiveCell=function(a){a=new b(a,this);a.activate();return a};e.prototype.getRows=function(){var a=this.obj.get(0).rows;
return f.makeArray(a)};return e});define("table/table-plugin","aloha jquery aloha/plugin aloha/pluginmanager ui/ui ui/scopes ui/button ui/toggleButton ui/dialog ui/port-helper-attribute-field ui/port-helper-multi-split i18n!table/nls/i18n i18n!aloha/nls/i18n table/table-create-layer table/table table/table-plugin-utils".split(" "),function(j,f,a,d,c,b,l,m,g,k,e,p,o,r,q){function u(){var a=[],b=B;f.each(arguments,function(){a.push("."+(this==""?b:b+"-"+this))});return f.trim(a.join(" "))}function t(){var a=
[],b=B;f.each(arguments,function(){a.push(this==""?b:b+"-"+this)});return f.trim(a.join(" "))}function v(a,b){var c=a.endContainer,e=a.startContainer,d=c.nodeType==3?c.length:c.childNodes.length;if(e.nodeType==3&&e.parentNode.tagName=="P"&&e.parentNode.childNodes.length==1&&/^(\s|%A0)$/.test(escape(e.data))){e.data="";a.startOffset=0;if(c==e)a.endOffset=0}if(!x.Utils.Dom.allowsNesting(e.nodeType==3?e.parentNode:e,b)){a.startOffset==0&&f(e.nodeType==3?e.parentNode:e).addClass("aloha-table-cleanme");
a.endOffset==d&&f(c.nodeType==3?c.parentNode:c).addClass("aloha-table-cleanme")}}function z(){for(var a=f(".aloha-table-cleanme").removeClass("aloha-table-cleanme"),b=0;b<a.length;b++)f.trim(f(a[b]).html())==""&&!x.Utils.Dom.isEditingHost(a[b])&&f(a[b]).remove()}var x=window.GENTICS,y=new a("table");y.createLayer=void 0;y.languages=["en","de","fr","eo","fi","ru","it","pl"];y.config=["table"];y.TableRegistry=[];y.activeTable=void 0;y.parameters={className:"aloha-table",classSelectionRow:"aloha-table-selectcolumn",
classSelectionColumn:"aloha-table-selectrow",classLeftUpperCorner:"aloha-table-leftuppercorner",classTableWrapper:"aloha-table-wrapper",classCellSelected:"aloha-cell-selected",waiRed:"aloha-wai-red",waiGreen:"aloha-wai-green",selectionArea:10};y.checkConfig=function(a){if(typeof a=="object"&&a.length){for(var b=[],c=0;c<a.length;c++)a[c]&&b.push({text:a[c].text?a[c].text:a[c].name,tooltip:a[c].tooltip?a[c].tooltip:a[c].text,iconClass:a[c].iconClass?a[c].iconClass:"aloha-icon-"+a[c].name,cssClass:a[c].cssClass?
a[c].cssClass:a[c].name});a=b}else a=[];return a};y.init=function(){var a=this,b={};this.tableConfig=this.checkConfig(this.tableConfig||this.settings.tableConfig);this.columnConfig=this.checkConfig(this.columnConfig||this.settings.columnConfig);this.rowConfig=this.checkConfig(this.rowConfig||this.settings.rowConfig);this.createLayer=new r(this);j.bind("aloha-editable-created",function(c,e){var d=a.getEditableConfig(e.obj);b[e.getId()]=-1!==f.inArray("table",d);e.obj.bind("mousedown",function(){y.setFocusedTable(void 0)});
e.obj.find("table").each(function(){if(a.isEditableTable(this)&&!y.isWithinTable(this)){var b=new q(this,y);b.parentEditable=e;y.TableRegistry.push(b)}y.checkForNestedTables(e.obj)})});this.initTableButtons();j.bind("aloha-table-selection-changed",function(){null!=y.activeTable&&0!==y.activeTable.selection.selectedCells.length&&y.updateFloatingMenuScope();if(typeof y.activeTable!=="undefined"&&y.activeTable.selection){if(y.activeTable.selection.cellsAreSplitable()){a._splitcellsButton.enable(true);
a._splitcellsRowButton.enable(true);a._splitcellsColumnButton.enable(true)}else{a._splitcellsButton.enable(false);a._splitcellsRowButton.enable(false);a._splitcellsColumnButton.enable(false)}if(y.activeTable.selection.cellsAreMergeable()){a._mergecellsButton.enable(true);a._mergecellsRowButton.enable(true);a._mergecellsColumnButton.enable(true)}else{a._mergecellsButton.enable(false);a._mergecellsRowButton.enable(false);a._mergecellsColumnButton.enable(false)}}});j.bind("aloha-selection-changed",function(c,
e){if(e.startContainer&&j.activeEditable){b[j.activeEditable.getId()]&&j.Selection.mayInsertTag("table")?a._createTableButton.show():a._createTableButton.hide();if(a.activeTable)if(e.findMarkup(function(){return this.nodeName==="TABLE"},j.activeEditable.obj))y.updateFloatingMenuScope();else{a.activeTable.selection.cellSelectionMode=false;a.activeTable.selection.baseCellPosition=null;a.activeTable.selection.lastSelectionRange=null;a.activeTable.focusOut()}}});j.bind("aloha-editable-activated",function(b,
c){a._splitcellsButton.enable(false);a._mergecellsButton.enable(false);a._splitcellsRowButton.enable(false);a._mergecellsRowButton.enable(false);a._splitcellsColumnButton.enable(false);a._mergecellsColumnButton.enable(false);c.editable.obj.find("table").each(function(){for(var b=y.TableRegistry,e=0;e<b.length;e++)if(b[e].obj.attr("id")==f(this).attr("id")){b[e].activate();return true}if(a.isEditableTable(this)&&!y.isWithinTable(this)){b=new q(this,y);b.parentEditable=c.editable;b.activate();y.TableRegistry.push(b)}y.checkForNestedTables(c.editable.obj)})});
j.bind("aloha-editable-deactivated",function(){y.activeTable&&y.activeTable.selection.unselectCells();y.setFocusedTable(void 0);for(var a=y.TableRegistry,b=0;b<a.length;b++)a[b].deactivate()});j.bind("aloha-smart-content-changed",function(){j.activeEditable&&j.activeEditable.obj.find("table").each(function(){if(y.indexOfTableInRegistry(this)==-1&&!y.isWithinTable(this)){this.id=x.Utils.guid();var a=new q(this,y);a.parentEditable=j.activeEditable;y.TableRegistry.push(a);a.activate()}y.checkForNestedTables(j.activeEditable.obj)})});
this.settings.summaryinsidebar&&j.ready(function(){a.initSidebar(j.Sidebar.right.show())})};var B="aloha-table";y.initSidebar=function(a){var b=this;b.sidebar=a;b.sidebarPanel=a.addPanel({id:t("sidebar-panel"),title:p.t("table.sidebar.title"),content:"",expanded:true,activeOn:"table",onInit:function(){var a=this;this.setContent('<label class="'+t("label")+'" for="'+t("textarea")+'" >'+p.t("table.label.target")+'</label><textarea id="'+t("textarea")+'" class="'+t("textarea")+'" />');f(u("textarea")).live("keyup",
function(){f(a.effective).attr("summary",f(u("textarea")).val());var c=f('div[class*="wai"]',"table#"+f(a.effective).attr("id"));c.removeClass(b.get("waiGreen"));c.removeClass(b.get("waiRed"));f(u("textarea")).val().trim()!=""?c.addClass(b.get("waiGreen")):c.addClass(b.get("waiRed"))})},onActivate:function(a){this.effective=a;f(u("textarea")).val(f(this.effective).attr("summary"))}});a.show()};y.isEditableTable=function(a){return x.Utils.Dom.isEditable(a)};y.indexOfTableInRegistry=function(a){for(var b=
this.TableRegistry,c=0;c<b.length;c++)if(b[c].obj[0].id==a.id)return c;return-1};y.getTableFromRegistry=function(a){a=this.indexOfTableInRegistry(a);return a>-1?this.TableRegistry[a]:null};y.isSelectionInTable=function(){var a=j.Selection.getRangeObject(),a=f(a.commonAncestorContainer);return a.length==0?false:a.parents(".aloha-editable table").length?true:false};y.preventNestedTables=function(){if(this.isSelectionInTable()){g.alert({title:p.t("Table"),text:p.t("table.createTable.nestedTablesNoSupported")});
return true}return false};y.isWithinTable=function(a){return f(a).parents(".aloha-editable table").length>0};y.checkForNestedTables=function(a){a.find("table table")};y.initMergeSplitCellsBtns=function(){this._mergecellsButton=c.adopt("mergecells",l,{tooltip:p.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".cell",click:function(){y.activeTable&&y.activeTable.selection.mergeCells()}});this._splitcellsButton=c.adopt("splitcells",l,{tooltip:p.t("button.splitcells.tooltip"),
icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".cell",click:function(){y.activeTable&&y.activeTable.selection.splitCells()}});this._mergecellsRowButton=c.adopt("mergecellsRow",l,{tooltip:p.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".row",click:function(){y.activeTable&&y.activeTable.selection.mergeCells()}});this._splitcellsRowButton=c.adopt("splitcellsRow",l,{tooltip:p.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+
".row",click:function(){y.activeTable&&y.activeTable.selection.splitCells()}});this._mergecellsColumnButton=c.adopt("mergecellsColumn",l,{tooltip:p.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".column",click:function(){y.activeTable&&y.activeTable.selection.mergeCells()}});this._splitcellsColumnButton=c.adopt("splitcellsColumn",l,{tooltip:p.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".column",click:function(){y.activeTable&&
y.activeTable.selection.splitCells()}})};y.initRowsBtns=function(){var a=this;this._addrowbeforeButton=c.adopt("addrowbefore",l,{tooltip:p.t("button.addrowbefore.tooltip"),icon:"aloha-icon aloha-icon-addrowbefore",scope:this.name+".row",click:function(){a.activeTable&&a.activeTable.addRowBeforeSelection()}});this._addrowafterButton=c.adopt("addrowafter",l,{tooltip:p.t("button.addrowafter.tooltip"),icon:"aloha-icon aloha-icon-addrowafter",scope:this.name+".row",click:function(){a.activeTable&&a.activeTable.addRowAfterSelection()}});
this._deleterowsButton=c.adopt("deleterows",l,{tooltip:p.t("button.delrows.tooltip"),icon:"aloha-icon aloha-icon-deleterows",scope:this.name+".row",click:function(){if(a.activeTable){var b=a.activeTable;g.confirm({title:p.t("Table"),text:p.t("deleterows.confirm"),yes:function(){b.deleteRows()}})}}});this._rowheaderButton=c.adopt("rowheader",m,{tooltip:p.t("button.rowheader.tooltip"),icon:"aloha-icon aloha-icon-rowheader",scope:this.name+".row",click:function(){if(a.activeTable){for(var b=a.activeTable.selection.selectedRowIdxs,
c,e=a.activeTable.selection.isHeader(),d=true,g=0;g<a.activeTable.selection.selectedCells.length;g++){c=a.activeTable.selection.selectedCells[g];if(!e){d=false;break}}for(g=0;g<a.activeTable.selection.selectedCells.length;g++){c=a.activeTable.selection.selectedCells[g];c=d?j.Markup.transformDomObject(c,"td").removeAttr("scope").get(0):j.Markup.transformDomObject(c,"th").attr("scope","row").get(0);f(a.activeTable.selection.selectedCells[g]).bind("mousedown",function(){var a=f(this).children("div").eq(0);
window.setTimeout(function(){a.trigger("focus")},1)})}a.activeTable.refresh();a.activeTable.selection.unselectCells();a.activeTable.selection.selectRows(b)}}});this.rowMSItems=[];f.each(this.rowConfig,function(b,c){a.rowMSItems.push({name:c.name,text:p.t(c.text),tooltip:p.t(c.tooltip),iconClass:"aloha-icon aloha-row-layout "+c.iconClass,click:function(){if(a.activeTable){for(var b=a.activeTable.selection.selectedCells,e=0;e<b.length;e++)if(f(b[e]).attr("class").indexOf(c.cssClass)>-1)f(b[e]).removeClass(c.cssClass);
else{f(b[e]).addClass(c.cssClass);for(var d=0;d<a.rowConfig.length;d++)a.rowConfig[d].cssClass!=c.cssClass&&f(b[e]).removeClass(a.rowConfig[d].cssClass)}a.activeTable.selectRows()}}})});this.rowMSItems.length>0&&this.rowMSItems.push({name:"removeFormat",text:p.t("button.removeFormat.text"),tooltip:p.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:true,click:function(){if(a.activeTable){for(var b=a.activeTable.selection.selectedCells,c=0;c<b.length;c++)for(var e=0;e<a.rowConfig.length;e++)f(b[c]).removeClass(a.rowConfig[e].cssClass);
a.activeTable.selectRows()}}});this.rowMSButton=e({items:this.rowMSItems,name:"formatRow",hideIfEmpty:true,scope:this.name+".row"})};y.initColumnBtns=function(){var a=this;this._addcolumnleftButton=c.adopt("addcolumnleft",l,{tooltip:p.t("button.addcolleft.tooltip"),icon:"aloha-icon aloha-icon-addcolumnleft",scope:this.name+".column",click:function(){a.activeTable&&a.activeTable.addColumnsLeft()}});this._addcolumnrightButton=c.adopt("addcolumnright",l,{tooltip:p.t("button.addcolright.tooltip"),icon:"aloha-icon aloha-icon-addcolumnright",
scope:this.name+".column",click:function(){a.activeTable&&a.activeTable.addColumnsRight()}});this._deletecolumnsButton=c.adopt("deletecolumns",l,{tooltip:p.t("button.delcols.tooltip"),icon:"aloha-icon aloha-icon-deletecolumns",scope:this.name+".column",click:function(){if(a.activeTable){var b=a.activeTable;g.confirm({title:p.t("Table"),text:p.t("deletecolumns.confirm"),yes:function(){b.deleteColumns()}})}}});this._columnheaderButton=c.adopt("columnheader",m,{tooltip:p.t("button.columnheader.tooltip"),
icon:"aloha-icon aloha-icon-columnheader",scope:this.name+".column",click:function(){if(a.activeTable){for(var b=a.activeTable.selection.selectedColumnIdxs,c,e=a.activeTable.selection.isHeader(),d=true,g=0;g<a.activeTable.selection.selectedCells.length;g++){c=a.activeTable.selection.selectedCells[g];if(!e){d=false;break}}for(g=0;g<a.activeTable.selection.selectedCells.length;g++){c=a.activeTable.selection.selectedCells[g];c=d?j.Markup.transformDomObject(c,"td").removeAttr("scope").get(0):j.Markup.transformDomObject(c,
"th").attr("scope","row").get(0);f(a.activeTable.selection.selectedCells[g]).bind("mousedown",function(){var a=f(this).children("div").eq(0);window.setTimeout(function(){a.trigger("focus")},1)})}a.activeTable.refresh();a.activeTable.selection.unselectCells();a.activeTable.selection.selectColumns(b)}}});this.columnMSItems=[];f.each(this.columnConfig,function(b,c){var e={name:c.name,text:p.t(c.text),tooltip:p.t(c.tooltip),iconClass:"aloha-icon aloha-column-layout "+c.iconClass,click:function(){if(a.activeTable){for(var b=
a.activeTable.selection.selectedCells,e=0;e<b.length;e++)if(f(b[e]).attr("class").indexOf(c.cssClass)>-1)f(b[e]).removeClass(c.cssClass);else{f(b[e]).addClass(c.cssClass);for(var d=0;d<a.columnConfig.length;d++)a.columnConfig[d].cssClass!=c.cssClass&&f(b[e]).removeClass(a.columnConfig[d].cssClass)}a.activeTable.selectColumns()}}};a.columnMSItems.push(e)});this.columnMSItems.length>0&&this.columnMSItems.push({name:"removeFormat",text:p.t("button.removeFormat.text"),tooltip:p.t("button.removeFormat.tooltip"),
cls:"aloha-ui-multisplit-fullwidth",wide:true,click:function(){if(a.activeTable){for(var b=a.activeTable.selection.selectedCells,c=0;c<b.length;c++)for(var e=0;e<a.columnConfig.length;e++)f(b[c]).removeClass(a.columnConfig[e].cssClass);a.activeTable.selectColumns()}}});this.columnMSButton=e({items:this.columnMSItems,name:"formatColumn",hideIfEmpty:true,scope:this.name+".column"})};y.initTableButtons=function(){var a=this;b.createScope(this.name+".row","Aloha.continuoustext");b.createScope(this.name+
".column","Aloha.continuoustext");b.createScope(this.name+".cell","Aloha.continuoustext");this._createTableButton=c.adopt("createTable",l,{tooltip:p.t("button.createtable.tooltip"),icon:"aloha-icon aloha-icon-createTable",scope:"Aloha.continuoustext",click:function(){y.createDialog(this.element)}});this.initColumnBtns();this.initRowsBtns();this.initMergeSplitCellsBtns();this.tableMSItems=[];var d=this.tableConfig;f.each(d,function(b,c){a.tableMSItems.push({name:c.name,text:p.t(c.text),tooltip:p.t(c.tooltip),
iconClass:"aloha-icon aloha-table-layout "+c.iconClass,click:function(){if(a.activeTable){for(var b=0;b<d.length;b++)a.activeTable.obj.removeClass(d[b].cssClass);a.activeTable.obj.addClass(c.cssClass)}}})});this.tableMSItems.length>0&&this.tableMSItems.push({name:"removeFormat",text:p.t("button.removeFormat.text"),tooltip:p.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:true,click:function(){if(a.activeTable)for(var b=0;b<d.length;b++)a.activeTable.obj.removeClass(a.tableConfig[b].cssClass)}});
this.tableMSButton=e({items:this.tableMSItems,name:"formatTable",hideIfEmpty:true,scope:this.name+".cell"});this._tableCaptionButton=c.adopt("tableCaption",m,{tooltip:p.t("button.caption.tooltip"),icon:"aloha-icon aloha-icon-table-caption",scope:this.name+".cell",click:function(){if(a.activeTable)if(a.activeTable.obj.children("caption").is("caption"))a.activeTable.obj.children("caption").remove();else{var b=p.t("empty.caption"),c=f("<caption></caption>");a.activeTable.obj.prepend(c);a.makeCaptionEditable(c,
b);b=c.find("div").eq(0);c=b.contents().eq(0);if(c.length>0){var e=new x.Utils.RangeObject;e.startContainer=e.endContainer=c.get(0);e.startOffset=0;e.endOffset=c.text().length;a.activeTable.obj.find("div.aloha-table-cell-editable").blur();b.focus();e.select();j.Selection.updateSelection()}}}});this.summary=k({width:275,name:"tableSummary",noTargetHighlight:true,scope:this.name+".cell"});this.summary.addListener("keyup",function(){a.activeTable.checkWai()})};y.makeCaptionEditable=function(a,b){var c=
a.children("div");if(c.length===0){c=f("<div></div>");f(c).addClass("aloha-ui");f(c).addClass("aloha-editable-caption");a.contents().length>0?c.append(a.contents()):b&&c.text(b);a.append(c)}else if(c.length>1){a.children("div:not(:first-child)").each(function(){$this=f(this);c.eq(0).append($this.contents());$this.remove()});c=c.eq(0)}c.contentEditable(true)};y.createDialog=function(a){this.createLayer.set("target",a);this.createLayer.show()};y.createTable=function(a,b){if(!this.preventNestedTables())if(j.activeEditable&&
typeof j.activeEditable.obj!=="undefined"){for(var c=document.createElement("table"),e=c.id=x.Utils.guid(),d=document.createElement("tbody"),g=0;g<b;g++){for(var k=document.createElement("tr"),l=0;l<a;l++){var m=document.createTextNode(" "),p=document.createElement("td");p.appendChild(m);k.appendChild(p)}d.appendChild(k)}c.appendChild(d);v(j.Selection.getRangeObject(),c);x.Utils.Dom.insertIntoDOM(f(c),j.Selection.getRangeObject(),j.activeEditable.obj);z();c=document.getElementById(e);if(!y.isWithinTable(c)){var o=
new q(c,y);o.parentEditable=j.activeEditable;o.activate();f.browser.msie?window.setTimeout(function(){o.cells[0].wrapper.get(0).focus()},20):o.cells[0].wrapper.get(0).focus();y.TableRegistry.push(o)}y.checkForNestedTables(j.activeEditable.obj);o.focus();y.activeTable.selection.selectionType="cell";y.updateFloatingMenuScope()}else this.error("There is no active Editable where the table can be\t\t\t\tinserted!")};y.setFocusedTable=function(a){null==a&&null!=this.activeTable&&this.activeTable.selection.unselectCells();
for(var b=0;b<y.TableRegistry.length;b++)y.TableRegistry[b].hasFocus=false;if(typeof a!="undefined"){this.summary.setTargetObject(a.obj,"summary");if(a.obj.children("caption").is("caption")){this._tableCaptionButton.setState(true);this.makeCaptionEditable(a.obj.children("caption"))}a.hasFocus=true}y.activeTable=a;for(b=0;b<this.tableMSItems.length;b++)this.tableMSButton.showItem(this.tableMSItems[b].name);this.tableMSButton.setActiveItem();if(this.activeTable)for(b=0;b<this.tableConfig.length;b++)this.activeTable.obj.hasClass(this.tableConfig[b].cssClass)&&
this.tableMSButton.setActiveItem(this.tableConfig[b].name)};y.error=function(a){j.Log.error(this,a)};y.debug=function(a){j.Log.debug(this,a)};y.info=function(a){j.Log.info(this,a)};y.log=function(a){j.log("log",this,a)};y.get=function(a){if(this.config[a])return this.config[a];if(this.parameters[a])return this.parameters[a]};y.set=function(a,b){this.config[a]?this.config[a]=b:this.parameters[a]=b};y.makeClean=function(a){var b=this;a.find("table").each(function(){if(b.getTableFromRegistry(this)){(new q(this,
b)).deactivate();f(this).attr("id",null)}})};y.toString=function(){return this.prefix};y.updateFloatingMenuScope=function(){null!=y.activeTable&&null!=y.activeTable.selection.selectionType&&b.setScope(y.name+"."+y.activeTable.selection.selectionType)};d.register(y);return y});define("format/nls/i18n",{root:{"button.strong.tooltip":"Strong","button.em.tooltip":"Emphasize","button.b.tooltip":"Bold","button.i.tooltip":"Italic","button.u.tooltip":"Underline","button.cite.tooltip":"Cite","button.q.tooltip":"",
"button.code.tooltip":"Code","button.abbr.tooltip":"Abbreviation","button.del.tooltip":"Strikethrough","button.s.tooltip":"Strikethrough","button.sub.tooltip":"Subscript","button.sup.tooltip":"Superscript","button.p.tooltip":"Paragraph","button.h1.tooltip":"Heading 1","button.h2.tooltip":"Heading 2","button.h3.tooltip":"Heading 3","button.h4.tooltip":"Heading 4","button.h5.tooltip":"Heading 5","button.h6.tooltip":"Heading 6","button.pre.tooltip":"Pre formated text","button.title.tooltip":"Title",
"button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting",GENTICS_button_p:"GENTICS_button_p",GENTICS_button_h1:"GENTICS_button_h1",GENTICS_button_h2:"GENTICS_button_h2",GENTICS_button_h3:"GENTICS_button_h3",GENTICS_button_h4:"GENTICS_button_h4",GENTICS_button_h5:"GENTICS_button_h5",GENTICS_button_h6:"GENTICS_button_h6",GENTICS_button_pre:"GENTICS_button_pre",GENTICS_button_title:"GENTICS_button_title",formatBold:"Ctrl+b",formatItalic:"Ctrl+i",formatUnderline:"Ctrl+u",
formatParagraph:"Alt+Ctrl+0",formatH1:"Alt+Ctrl+1",formatH2:"Alt+Ctrl+2",formatH3:"Alt+Ctrl+3",formatH4:"Alt+Ctrl+4",formatH5:"Alt+Ctrl+5",formatH6:"Alt+Ctrl+6",formatPre:"Alt+Ctrl+P",formatDel:"Ctrl+\\",formatSub:"Ctrl+,",formatSup:"Ctrl+.","floatingmenu.tab.format":"Format","format.class.legend":"CSS class","format.class.none":"none"},de:!0,eo:!0,fi:!0,fr:!0,it:!0,pl:!0,ru:!0});define("format/format-plugin","aloha aloha/plugin jquery ui/ui ui/toggleButton ui/port-helper-multi-split PubSub i18n!format/nls/i18n i18n!aloha/nls/i18n aloha/selection".split(" "),
function(j,f,a,d,c,b,l,m){function g(b,c){var e=false,d,g,k,f,l;a.each(b.buttons,function(a,b){e=false;for(k=0;k<c.markupEffectiveAtStart.length;k++){d=c.markupEffectiveAtStart[k];if(j.Selection.standardTextLevelSemanticsComparator(d,b.markup)){b.handle.setState(true);e=true}}e||b.handle.setState(false)});if(b.multiSplitItems.length>0){g=false;for(k=0;k<c.markupEffectiveAtStart.length&&!g;k++){d=c.markupEffectiveAtStart[k];for(f=0;f<b.multiSplitItems.length&&!g;f++){l=b.multiSplitItems[f];if(l.markup&&
j.Selection.standardTextLevelSemanticsComparator(d,l.markup)){b.multiSplitButton.setActiveItem(l.name);g=true}}}g||b.multiSplitButton.setActiveItem(null)}}var k=window.GENTICS,e={b:"bold",strong:"bold",i:"italic",em:"italic",del:"strikethrough",sub:"subscript",sup:"superscript",u:"underline",s:"strikethrough"},p={strong:"strong",em:"emphasis",s:"strikethrough2"},o={u:true,em:true,strong:true,b:true,i:true,cite:true,q:true,code:true,abbr:true,del:true,s:true,sub:true,sup:true},r={p:true,h1:true,h2:true,
h3:true,h4:true,h5:true,h6:true,pre:true};return f.create("format",{languages:["en","de","fr","eo","fi","ru","it","pl"],config:["b","i","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],availableButtons:["u","strong","del","em","b","i","s","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],hotKey:{formatBold:"ctrl+b",formatItalic:"ctrl+i",formatParagraph:"alt+ctrl+0",formatH1:"alt+ctrl+1",formatH2:"alt+ctrl+2",formatH3:"alt+ctrl+3",formatH4:"alt+ctrl+4",formatH5:"alt+ctrl+5",
formatH6:"alt+ctrl+6",formatPre:"ctrl+p",formatDel:"ctrl+d",formatSub:"alt+shift+s",formatSup:"ctrl+shift+s"},init:function(){var b=this;typeof this.settings.hotKey!=="undefined"&&a.extend(true,this.hotKey,this.settings.hotKey);this.initButtons();j.ready(function(){b.initSidebar(j.Sidebar.right)});j.bind("aloha-editable-activated",function(a,c){b.applyButtonConfig(c.editable.obj);c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatBold,function(){b.addMarkup("b");return false});c.editable.obj.bind("keydown.aloha.format",
b.hotKey.formatItalic,function(){b.addMarkup("i");return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatParagraph,function(){b.changeMarkup("p");return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH1,function(){b.changeMarkup("h1");return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH2,function(){b.changeMarkup("h2");return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH3,function(){b.changeMarkup("h3");return false});
c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH4,function(){b.changeMarkup("h4");return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH5,function(){b.changeMarkup("h5");return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH6,function(){b.changeMarkup("h6");return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatPre,function(){b.changeMarkup("pre");return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatDel,function(){b.addMarkup("del");
return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatSub,function(){b.addMarkup("sub");return false});c.editable.obj.bind("keydown.aloha.format",b.hotKey.formatSup,function(){b.addMarkup("sup");return false})});j.bind("aloha-editable-deactivated",function(a,b){b.editable.obj.unbind("keydown.aloha.format")})},applyButtonConfig:function(b){var b=this.getEditableConfig(b),c,e;if(typeof b==="object"){var d=[];a.each(b,function(a,b){typeof a==="number"&&typeof b==="string"||d.push(a)});
d.length>0&&(b=d)}this.formatOptions=b;for(c in this.buttons)this.buttons.hasOwnProperty(c)&&(a.inArray(c,b)!==-1?this.buttons[c].handle.show():this.buttons[c].handle.hide());e=this.multiSplitItems.length;for(c=0;c<e;c++)a.inArray(this.multiSplitItems[c].name,b)!==-1?this.multiSplitButton.showItem(this.multiSplitItems[c].name):this.multiSplitButton.hideItem(this.multiSplitItems[c].name)},initButtons:function(){var k=this;this.buttons={};this.multiSplitItems=[];a.each(this.availableButtons,function(b,
g){var f=false;if(typeof b!=="number"&&typeof g!=="string"){f=g;g=b}if(o[g]){var l=e[g];p.hasOwnProperty(g)&&(l=p[g]);l=d.adopt(l,c,{tooltip:m.t("button."+g+".tooltip"),icon:"aloha-icon aloha-icon-"+l,scope:"Aloha.continuoustext",click:function(){var b=a(".aloha-cell-selected");if(b.length>0){var c=0;b.each(function(){var b=a(this).find("div"),e=b.find(g);if(e.length>0){e.contents().unwrap();c++}b.contents().wrap("<"+g+"></"+g+">")});c===b.length&&b.find(g).contents().unwrap();return false}k.addMarkup(g);
return false}});k.buttons[g]={handle:l,markup:a("<"+g+">",{"class":f||""})}}else r[g]?k.multiSplitItems.push({name:g,tooltip:m.t("button."+g+".tooltip"),iconClass:"aloha-icon "+m.t("aloha-large-icon-"+g),markup:a("<"+g+">"),click:function(){var b=a(".aloha-cell-selected");if(b.length>0){var c=0;b.each(function(){var b=a(this).find("div"),e=b.find(g);if(e.length>0){e.contents().unwrap();c++}b.contents().wrap("<"+g+"></"+g+">")});c===b.length&&b.find(g).contents().unwrap();return false}k.changeMarkup(g);
j.activeEditable&&a.browser.mozilla&&j.activeEditable.obj.focus();j.activeEditable&&j.trigger("aloha-format-block")}}):"removeFormat"===g?k.multiSplitItems.push({name:g,text:m.t("button."+g+".text"),tooltip:m.t("button."+g+".tooltip"),wide:true,cls:"aloha-ui-multisplit-fullwidth",click:function(){k.removeFormat()}}):j.log("warn",this,'Button "'+g+'" is not defined')});this.multiSplitButton=b({name:"formatBlock",items:this.multiSplitItems,hideIfEmpty:true,scope:"Aloha.continuoustext"});l.sub("aloha.selection.context-change",
function(a){g(k,a.range)})},initSidebar:function(b){var c=this;c.sidebar=b;b.addPanel({id:c.nsClass("sidebar-panel-class"),title:m.t("floatingmenu.tab.format"),content:"",expanded:true,activeOn:this.formatOptions||false,onInit:function(){},onActivate:function(b){var e=this;e.effective=b;if(b[0]){e.format=b[0].nodeName.toLowerCase();var d=a("<div>").attr("class",c.nsClass("target-container")),g=a("<fieldset>");g.append(a("<legend>"+e.format+" "+m.t("format.class.legend")).append(a("<select>")));d.append(g);
var k='<div class="'+c.nsClass("target-container")+'"><fieldset><legend>'+m.t("format.class.legend")+'</legend><select name="targetGroup" class="'+c.nsClass("radioTarget")+'"><option value="">'+m.t("format.class.none")+"</option>";c.config[e.format]&&c.config[e.format]["class"]&&a.each(c.config[e.format]["class"],function(a,b){k=k+('<option value="'+a+'" >'+b+"</option>")});k=k+"</select></fieldset></div>";e=this;this.setContent(k);a(c.nsSel("framename")).live("keyup",function(){a(e.effective).attr("target",
a(this).val().replace('"',"&quot;").replace("'","&#39;"))});e=this;e.effective=b;a(c.nsSel("linkTitle")).val(a(e.effective).attr("title"))}}});b.show()},nsClass:function(){var b=[];a.each(arguments,function(){b.push(this==""?"aloha-format":"aloha-format-"+this)});return a.trim(b.join(" "))},nsSel:function(){var b=[];a.each(arguments,function(){b.push("."+(this==""?"aloha-format":"aloha-format-"+this))});return a.trim(b.join(" "))},addMarkup:function(b){var c=a("<"+b+">"),e=j.Selection.rangeObject;
if(typeof b==="undefined"||b=="")return false;if(b=e.findMarkup(function(){return this.nodeName===c[0].nodeName},j.activeEditable.obj))e.isCollapsed()?k.Utils.Dom.removeFromDOM(b,e,true):k.Utils.Dom.removeMarkup(e,c,j.activeEditable.obj);else{e.isCollapsed()&&k.Utils.Dom.extendToWord(e);k.Utils.Dom.addMarkup(e,c)}e.select();g(this,j.Selection.getRangeObject());return false},changeMarkup:function(b){j.Selection.changeMarkupOnSelection(a("<"+b+">"))},removeFormat:function(){var b=["u","strong","em",
"b","i","q","del","s","code","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","quote","blockquote"],c=j.Selection.rangeObject,e;if(this.settings.removeFormats)b=this.settings.removeFormats;if(!c.isCollapsed()){for(e=0;e<b.length;e++)k.Utils.Dom.removeMarkup(c,a("<"+b[e]+">"),j.activeEditable.obj);c.select()}},toString:function(){return"format"}})});define("list/nls/i18n",{root:{"button.createulist.tooltip":"Insert Unordered List","button.createolist.tooltip":"Insert Ordered List","button.indentlist.tooltip":"Indent List",
"button.outdentlist.tooltip":"Outdent List","floatingmenu.tab.list":"Lists"},de:!0,eo:!0,fi:!0,fr:!0,it:!0,ru:!0});define("list/list-plugin","aloha jquery aloha/plugin ui/ui ui/scopes ui/button ui/toggleButton i18n!list/nls/i18n i18n!aloha/nls/i18n aloha/engine PubSub".split(" "),function(j,f,a,d,c,b,l,m,g,k,e){function p(a,b){f(a).find(a.nodeName).each(function(){var a=j.Selection.getSelectionTree();o(a,this)&&j.Markup.transformDomObject(this,b,j.Selection.rangeObject)});j.Markup.transformDomObject(a,
b,j.Selection.rangeObject)}function o(a,b){var c=false;f.each(a,function(a,e){if(e.domobj===b&&e.selection!=="none"||o(e.children,b))c=true});return c}var r=window.GENTICS,q=a.create("list",{languages:["en","de","fr","eo","fi","ru","it"],config:["ul","ol"],transformableElements:{p:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,ul:true,ol:true},init:function(){var a=this;this._orderedListButton=d.adopt("orderedList",l,{tooltip:m.t("button.createolist.tooltip"),icon:"aloha-icon aloha-icon-orderedlist",
scope:"Aloha.continuoustext",click:function(){a.transformList(true)}});this._unorderedListButton=d.adopt("unorderedList",l,{tooltip:m.t("button.createulist.tooltip"),icon:"aloha-icon aloha-icon-unorderedlist",scope:"Aloha.continuoustext",click:function(){a.transformList(false)}});this._indentListButton=d.adopt("indentList",b,{tooltip:m.t("button.indentlist.tooltip"),icon:"aloha-icon aloha-icon-indent",scope:"Aloha.continuoustext",click:function(){a.indentList()}});this._outdentListButton=d.adopt("outdentList",
b,{tooltip:m.t("button.outdentlist.tooltip"),icon:"aloha-icon aloha-icon-outdent",scope:"Aloha.continuoustext",click:function(){a.outdentList()}});c.createScope("Aloha.List","Aloha.continuoustext");e.sub("aloha.selection.context-change",function(b){var c,e=b.range;a._outdentListButton.show(false);a._indentListButton.show(false);a._unorderedListButton.setState(false);a._orderedListButton.setState(false);for(b=0;b<e.markupEffectiveAtStart.length;b++){c=e.markupEffectiveAtStart[b];if(j.Selection.standardTagNameComparator(c,
f("<ul></ul>"))){a._unorderedListButton.setState(true);a._outdentListButton.show(true);a._indentListButton.show(true);break}if(j.Selection.standardTagNameComparator(c,f("<ol></ol>"))){a._orderedListButton.setState(true);a._outdentListButton.show(true);a._indentListButton.show(true);break}}j.activeEditable&&a.applyButtonConfig(j.activeEditable.obj)});j.Markup.addKeyHandler(9,function(b){return a.processTab(b)})},applyButtonConfig:function(a){a=this.getEditableConfig(a);if(j.Selection.rangeObject.unmodifiableMarkupAtStart[0]){f.inArray("ul",
a)!=-1&&j.Selection.canTag1WrapTag2(j.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ul")!=-1?this._unorderedListButton.show(true):this._unorderedListButton.show(false);f.inArray("ol",a)!=-1&&j.Selection.canTag1WrapTag2(j.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ol")!=-1?this._orderedListButton.show(true):this._orderedListButton.show(false)}},makeClean:function(a){a.find("li").each(function(){f(this).removeAttr("hidefocus");f(this).removeAttr("hideFocus");f(this).removeAttr("tabindex");
f(this).removeAttr("tabIndex")})},processTab:function(a){return a.keyCode===9?a.shiftKey?this.outdentList():this.indentList():true},getStartingDomObjectToTransform:function(){var a=j.Selection.rangeObject,b,c;for(b=0;b<a.markupEffectiveAtStart.length;b++){c=a.markupEffectiveAtStart[b];if(this.transformableElements[c.nodeName.toLowerCase()])return c}return false},getNearestSelectedListItem:function(){var a=j.Selection.rangeObject,b,c;for(b=0;b<a.markupEffectiveAtStart.length;b++){c=a.markupEffectiveAtStart[b];
if(r.Utils.Dom.isListElement(c))return c}return false},transformList:function(a){var b=this.getStartingDomObjectToTransform(),c,e,d,g;this._outdentListButton.show(true);this._indentListButton.show(true);if(!b){j.Selection.changeMarkupOnSelection(f("<p></p>"));b=this.getStartingDomObjectToTransform();if(!b){if(j.Selection.rangeObject.startContainer.contentEditable){a=a?f("<ol></ol>"):f("<ul></ul>");e=f("<li></li>");a.append(e);d=e.get(0);b=j.getActiveEditable().obj;d.appendChild(document.createTextNode(""));
b.append(a);b.focus();a=j.createRange();b=j.getSelection();a.setStart(d.firstChild,0);a.setEnd(d.firstChild,0);b.removeAllRanges();b.addRange(a);j.Selection.updateSelection()}else j.Log.error(this,"Could not transform selection into a list");return}}d=b.nodeName.toLowerCase();if(d=="ul"&&!a){a=f(b);d=a.parent();if(d.length>0&&r.Utils.Dom.isListElement(d.get(0)))if(d.get(0).nodeName.toLowerCase()==="li"){d.after(a.children());a.remove()}else a.children().unwrap();else{a=f(b);f.each(a.children("li"),
function(a,b){g=j.Markup.transformDomObject(b,"p",j.Selection.rangeObject);g.after(g.children("ol,ul"));k.ensureContainerEditable(g.get(0))});a.children().unwrap()}}else if(d=="ul"&&a){p(b,"ol");this.mergeAdjacentLists(f(b))}else if(d=="ol"&&!a){p(b,"ul");this.mergeAdjacentLists(f(b))}else if(d=="ol"&&a){a=f(b);d=a.parent();if(d.length>0&&r.Utils.Dom.isListElement(d.get(0)))if(d.get(0).nodeName.toLowerCase()==="li"){d.after(a.children());a.remove()}else a.children().unwrap();else{a=f(b);f.each(a.children("li"),
function(a,b){g=j.Markup.transformDomObject(b,"p",j.Selection.rangeObject);g.after(g.children("ol,ul"));k.ensureContainerEditable(g.get(0))});a.children().unwrap()}}else{d=j.Selection.rangeObject.getSelectedSiblings(b);a=a?f("<ol></ol>"):f("<ul></ul>");e=f("<li></li>");a.append(e);f(b).contents().appendTo(e);f(b).replaceWith(a);if(j.Selection.rangeObject.startContainer==b)j.Selection.rangeObject.startContainer=e.get(0);if(j.Selection.rangeObject.endContainer==b)j.Selection.rangeObject.endContainer=
e.get(0);if(d){b=false;for(c=0;c<d.length;++c)if(r.Utils.Dom.isBlockLevelElement(d[c])){b&&(b=false);e=j.Markup.transformDomObject(d[c],"li",j.Selection.rangeObject);a.append(e)}else if(!(d[c].nodeType==3&&f.trim(d[c].data).length===0)){if(!b){b=f("<li></li>");a.append(b);e=b}b.append(d[c])}}this.mergeAdjacentLists(a);d=e.get(0);if(r.Utils.Dom.isEmpty(d)){a=j.createRange();b=j.getSelection();d.appendChild(document.createTextNode(""));a.selectNodeContents(d.lastChild);b.removeAllRanges();b.addRange(a);
j.Selection.updateSelection()}}this.refreshSelection()},indentList:function(){var a=this.getNearestSelectedListItem(),b,c,e;if(a){e=f(a).prev("li");if(e.length===0)return false;f(a).parent();c=j.Selection.rangeObject.getSelectedSiblings(a);b=f(a).parent().clone(false).empty();b.append(a);e.append(b);if(c)for(a=0;a<c.length;++a)b.append(f(c[a]));this.mergeAdjacentLists(b,true);this.refreshSelection();return false}return true},outdentList:function(){var a=this.getNearestSelectedListItem(),b,c,e,d,g;
if(a){c=f(a);e=c.parent();b=e.parents("ul,ol");d=e.parent("li");if(b.length>0&&r.Utils.Dom.isListElement(b.get(0))){g=(a=j.Selection.rangeObject.getSelectedSiblings(a))&&a.length>0?f(a[a.length-1]):c;if(g.nextAll("li").length>0){b=e.clone(false).empty();b.append(g.nextAll());g.append(b)}d.length>0?d.after(c):e.before(c);if(a&&a.length>0)for(b=a.length-1;b>=0;--b)c.after(f(a[b]));e.contents("li").length===0&&e.remove();d.length>0&&d.contents().length===0&&d.remove();this.refreshSelection()}return false}return true},
refreshSelection:function(){j.Selection.rangeObject.update();j.Selection.rangeObject.select();j.Selection.updateSelection()},mergeAdjacentLists:function(a,b){for(var c=a.get(0),e;c.previousSibling&&c.previousSibling.nodeType===1&&this.isMergable(c.previousSibling,c,b);)c=c.previousSibling;for(a=f(c);c.nextSibling&&(c.nextSibling.nodeType===1&&this.isMergable(c.nextSibling,c,b)||c.nextSibling.nodeType===3&&f.trim(c.nextSibling.data).length===0);){e=f(c.nextSibling);c.nextSibling.nodeType==1&&e.contents().appendTo(a);
e.remove()}},isMergable:function(a,b,c){return c?a.nodeName.toLowerCase()=="ul"||a.nodeName.toLowerCase()=="ol":a.nodeName==b.nodeName}});k.commands.insertorderedlist={action:function(a,b){q.transformList(true);if(b&&j.Selection.rangeObject){b.startContainer=j.Selection.rangeObject.startContainer;b.startOffset=j.Selection.rangeObject.startOffset;b.endContainer=j.Selection.rangeObject.endContainer;b.endOffset=j.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=
rangeObject.markupEffectiveAtStart[i];if(j.Selection.standardTagNameComparator(effectiveMarkup,f("<ul></ul>")))break;if(j.Selection.standardTagNameComparator(effectiveMarkup,f("<ol></ol>")))return true}return false}};k.commands.insertunorderedlist={action:function(a,b){q.transformList(false);if(b&&j.Selection.rangeObject){b.startContainer=j.Selection.rangeObject.startContainer;b.startOffset=j.Selection.rangeObject.startOffset;b.endContainer=j.Selection.rangeObject.endContainer;b.endOffset=j.Selection.rangeObject.endOffset}},
indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=rangeObject.markupEffectiveAtStart[i];if(j.Selection.standardTagNameComparator(effectiveMarkup,f("<ul></ul>")))return true;if(j.Selection.standardTagNameComparator(effectiveMarkup,f("<ol></ol>")))break}return false}};k.commands.indent={action:function(a,b){q.indentList();if(b&&j.Selection.rangeObject){b.startContainer=j.Selection.rangeObject.startContainer;b.startOffset=j.Selection.rangeObject.startOffset;
b.endContainer=j.Selection.rangeObject.endContainer;b.endOffset=j.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){return false}};k.commands.outdent={action:function(a,b){q.outdentList();if(b&&j.Selection.rangeObject){b.startContainer=j.Selection.rangeObject.startContainer;b.startOffset=j.Selection.rangeObject.startOffset;b.endContainer=j.Selection.rangeObject.endContainer;b.endOffset=j.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){return false}};
return q});define("image/nls/i18n",{root:{"size.natural":"Original size","button.addimg.tooltip":"add image ref","floatingmenu.tab.img":"Image","floatingmenu.tab.formatting":"Formatting","floatingmenu.tab.resize":"Resize","floatingmenu.tab.crop":"Crop","button.uploadimg.tooltip":"Upload img","button.uploadimg.label":"Upload","button.img.align.left.tooltip":"Left align","button.img.align.right.tooltip":"Right Align","button.img.align.none.tooltip":"No alignment","field.img.title.label":"Title","field.img.title.tooltip":"Title",
"field.img.src.label":"URL","field.img.src.tooltip":"Source",border:"Add Border to Image","padding.increase":"Increase Padding","padding.decrease":"Decrease Padding","size.increase":"Increase Size","size.decrease":"Decrease Size",Resize:"Resize",Crop:"Crop",Reset:"Reset",Accept:"Accept",Cancel:"Cancel",height:"Height",width:"Width","button.toggle.tooltip":"Toggle keep aspect ratio"},cz:!0,de:!0,fr:!0,ru:!0});define("image/image-floatingMenu","jquery util/class i18n!image/nls/i18n i18n!aloha/nls/i18n ui/ui ui/scopes ui/button ui/toggleButton ui/port-helper-attribute-field".split(" "),
function(j,f,a,d,c,b,l,m,g){return f.extend({_constructor:function(){},init:function(a){a.floatingMenuControl=this;this.plugin=a;b.createScope(a.name,"Aloha.empty");this._addUIInsertButton();this._addUIMetaButtons();this._addUIResetButton();this._addUIAlignButtons();this._addUIMarginButtons();this._addUICropButtons();this._addUIResizeButtons();this._addUIAspectRatioToggleButton()},_addUIAspectRatioToggleButton:function(){var b=this.plugin;this._imageCnrRatioButton=c.adopt("imageCnrRatio",m,{tooltip:a.t("button.toggle.tooltip"),
icon:"aloha-icon-cnr-ratio",scope:b.name,click:function(){b.toggleKeepAspectRatio()}});if(b.settings.fixedAspectRatio!==false){this._imageCnrRatioButton.setState(true);b.keepAspectRatio=true}},_addUIResetButton:function(){var b=this.plugin;this._imageCnrResetButton=c.adopt("imageCnrReset",l,{tooltip:a.t("Reset"),icon:"aloha-icon-cnr-reset",scope:b.name,click:function(){b.reset()}})},_addUIInsertButton:function(){var b=this.plugin;this._insertImageButton=c.adopt("insertImage",l,{tooltip:a.t("button.addimg.tooltip"),
icon:"aloha-button aloha-image-insert",scope:"Aloha.continuoustext",click:function(){b.insertImg()}})},_addUIMetaButtons:function(){var b=this.plugin;this.imgSrcField=g({label:a.t("field.img.src.label"),labelClass:"aloha-image-input-label",tooltip:a.t("field.img.src.tooltip"),name:"imageSource",scope:b.name});this.imgSrcField.setObjectTypeFilter(b.objectTypeFilter);this.imgTitleField=g({label:a.t("field.img.title.label"),labelClass:"aloha-image-input-label",tooltip:a.t("field.img.title.tooltip"),
name:"imageTitle",scope:b.name});this.imgTitleField.setObjectTypeFilter()},_addUIAlignButtons:function(){var b=this.plugin;this._imageAlignLeftButton=c.adopt("imageAlignLeft",l,{tooltip:a.t("button.img.align.left.tooltip"),icon:"aloha-img aloha-image-align-left",scope:b.name,click:function(){var a=j(b.getPluginFocus());a.add(a.parent()).css("float","left")}});this._imageAlignRightButton=c.adopt("imageAlignRight",l,{tooltip:a.t("button.img.align.right.tooltip"),icon:"aloha-img aloha-image-align-right",
scope:b.name,click:function(){var a=j(b.getPluginFocus());a.add(a.parent()).css("float","right")}});this._imageAlignNoneButton=c.adopt("imageAlignNone",l,{tooltip:a.t("button.img.align.none.tooltip"),icon:"aloha-img aloha-image-align-none",scope:b.name,click:function(){var a=j(b.getPluginFocus());a.add(a.parent()).css({"float":"none",display:"inline-block"})}})},_addUIMarginButtons:function(){var b=this.plugin;this._imageIncPaddingButton=c.adopt("imageIncPadding",l,{tooltip:a.t("padding.increase"),
icon:"aloha-img aloha-image-padding-increase",scope:b.name,click:function(){j(b.getPluginFocus()).increase("padding")}});this._imageDecPaddingButton=c.adopt("imageDecPadding",l,{tooltip:a.t("padding.decrease"),icon:"aloha-img aloha-image-padding-decrease",scope:b.name,click:function(){j(b.getPluginFocus()).decrease("padding")}})},_addUICropButtons:function(){var d=this.plugin;b.createScope("Aloha.img",["Aloha.global"]);this._imageCropButton=c.adopt("imageCropButton",m,{tooltip:a.t("Crop"),icon:"aloha-icon-cnr-crop",
scope:d.name,click:function(){this.getState()?d.crop():d.endCrop()}})},_addUIResizeButtons:function(){var b=this.plugin;this.imgResizeHeightField=g({label:a.t("height"),labelClass:"aloha-image-input-label",name:"imageResizeHeight",width:50,scope:b.name});this.imgResizeHeightField.maxValue=b.settings.maxHeight;this.imgResizeHeightField.minValue=b.settings.minHeight;this.imgResizeWidthField=g({label:a.t("width"),labelClass:"aloha-image-input-label",name:"imageResizeWidth",width:50,scope:b.name});this.imgResizeWidthField.maxValue=
b.settings.maxWidth;this.imgResizeWidthField.minValue=b.settings.minWidth},setScope:function(){b.setScope(this.plugin.name)},doLayout:function(){}})});define("image/vendor/jcrop/jquery.jcrop.min",["jquery"],function(j){(function(f){f.Jcrop=function(a,d){function c(a){return""+parseInt(a)+"px"}function b(a){a=f(a).offset();return[a.left,a.top]}function l(a){return[a.pageX-L[0],a.pageY-L[1]]}function m(a,b){return function(c){if(x.aspectRatio)switch(a){case "e":c[1]=b.y+1;break;case "w":c[1]=b.y+1;
break;case "n":c[0]=b.x+1;break;case "s":c[0]=b.x+1}else switch(a){case "e":c[1]=b.y2;break;case "w":c[1]=b.y2;break;case "n":c[0]=b.x2;break;case "s":c[0]=b.x2}X.setCurrent(c);S.update()}}function g(a){var b=a;Da.watchKeys();return function(a){X.moveOffset([a[0]-b[0],a[1]-b[1]]);b=a;S.update()}}function k(a){switch(a){case "n":return"sw";case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function e(a){return function(c){if(x.disabled||
"move"==a&&!x.allowMove)return!1;C=!0;var e=l(c);L=b(B);W.setCursor("move"==a?a:a+"-resize");if("move"==a)W.activateHandlers(g(e),j);else{var e=X.getFixed(),d=k(a),f=X.getCorner(k(d));X.setPressed(X.getCorner(d));X.setCurrent(f);W.activateHandlers(m(a,e),j)}c.stopPropagation();c.preventDefault();return!1}}function p(a){return{x:parseInt(a.x*E),y:parseInt(a.y*H),x2:parseInt(a.x2*E),y2:parseInt(a.y2*H),w:parseInt(a.w*E),h:parseInt(a.h*H)}}function j(){var a=X.getFixed();a.w>x.minSelect[0]&&a.h>x.minSelect[1]?
(S.enableHandles(),S.done()):S.release();W.setCursor(x.allowSelect?"crosshair":"default")}function r(a){X.setCurrent(a);S.update()}function q(){var a=f("<div></div>").addClass(x.baseClass+"-tracker");f.browser.msie&&a.css({opacity:0,backgroundColor:"white"});return a}function u(a){t([a[0]/E,a[1]/H,a[2]/E,a[3]/H])}function t(a){X.setPressed([a[0],a[1]]);X.setCurrent([a[2],a[3]]);S.update()}function v(a){"object"!=typeof a&&(a={});x=f.extend(x,a);"function"!==typeof x.onChange&&(x.onChange=function(){});
"function"!==typeof x.onSelect&&(x.onSelect=function(){})}function z(a){x.allowResize?a?S.enableOnly():S.enableHandles():S.disableHandles();W.setCursor(x.allowSelect?"crosshair":"default");S.setCursor(x.allowMove?"move":"default");N.css("backgroundColor",x.bgColor);"setSelect"in x&&(u(d.setSelect),S.done(),delete x.setSelect);"trueSize"in x&&(E=x.trueSize[0]/A,H=x.trueSize[1]/F);Y=x.maxSize[0]||0;D=x.maxSize[1]||0;M=x.minSize[0]||0;Z=x.minSize[1]||0;"outerImage"in x&&(B.attr("src",x.outerImage),delete x.outerImage);
S.refresh()}"object"!==typeof a&&(a=f(a)[0]);"object"!==typeof d&&(d={});"trackDocument"in d||(d.trackDocument=f.browser.msie?!1:!0,f.browser.msie&&"8"==f.browser.version.split(".")[0]&&(d.trackDocument=!0));"keySupport"in d||(d.keySupport=f.browser.msie?!1:!0);var x={trackDocument:!1,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,borderOpacity:0.4,handleOpacity:0.5,handlePad:5,handleSize:9,handleOffset:5,edgeMargin:14,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,
dragEdges:!0,boxWidth:0,boxHeight:0,boundary:8,animationDelay:20,swingSpeed:3,allowSelect:!0,allowMove:!0,allowResize:!0,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){}};v(d);var y=f(a),B=y.clone().removeAttr("id").css({position:"absolute"});B.width(y.width());B.height(y.height());y.after(B).hide();(function(a,b,c){var e=a.width(),d=a.height();if(e>b&&b>0){e=b;d=b/a.width()*a.height()}if(d>c&&c>0){d=c;e=c/a.height()*a.width()}E=a.width()/e;H=a.height()/d;a.width(e).height(d)})(B,
x.boxWidth,x.boxHeight);var A=B.width(),F=B.height(),N=f("<div />").width(A).height(F).addClass(x.baseClass+"-holder").css({position:"relative",backgroundColor:x.bgColor}).insertAfter(y).append(B);x.addClass&&N.addClass(x.addClass);var K=f("<img />").attr("src",B.attr("src")).css("position","absolute").width(A).height(F),G=f("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}).append(K),R=f("<div />").width("100%").height("100%").css("zIndex",320),I=f("<div />").css({position:"absolute",
zIndex:300}).insertBefore(B).append(G,R),ba=x.boundary,T=q().width(A+2*ba).height(F+2*ba).css({position:"absolute",top:c(-ba),left:c(-ba),zIndex:290}).mousedown(function(a){if(x.disabled||!x.allowSelect)return false;C=true;L=b(B);S.disableHandles();if("crosshair"!=O){W.setCursor("crosshair");O="crosshair"}var c=l(a);X.setPressed(c);W.activateHandlers(r,j);Da.watchKeys();S.update();a.stopPropagation();a.preventDefault();return false}),Y,D,M,Z,E,H,L=b(B),C,O,ha,aa,X=function(){function a(){if(!x.aspectRatio){var b=
k-d,l=f-g;Y&&Math.abs(b)>Y&&(k=b>0?d+Y:d-Y);D&&Math.abs(l)>D&&(f=l>0?g+D:g-D);Z&&Math.abs(l)<Z&&(f=l>0?g+Z:g-Z);M&&Math.abs(b)<M&&(k=b>0?d+M:d-M);if(d<0){k=k-d;d=d-d}if(g<0){f=f-g;g=g-g}if(k<0){d=d-k;k=k-k}if(f<0){g=g-f;f=f-f}if(k>A){b=k-A;d=d-b;k=k-b}if(f>F){b=f-F;g=g-b;f=f-b}if(d>A){b=d-F;f=f-b;g=g-b}if(g>F){b=g-F;f=f-b;g=g-b}return e(c(d,g,k,f))}var b=x.aspectRatio,l=x.minSize[0]/E,m=x.maxSize[0]/E,p=k-d,j=f-g,o=Math.abs(p),q=Math.abs(j);m==0&&(m=A*10);if(o/q<b){o=f;w=q*b;q=p<0?d-w:w+d;if(q<0){q=
0;h=Math.abs((q-d)/b);o=j<0?g-h:h+g}else if(q>A){q=A;h=Math.abs((q-d)/b);o=j<0?g-h:h+g}}else{q=k;h=o/b;o=j<0?g-h:g+h;if(o<0){o=0;w=Math.abs((o-g)*b);q=p<0?d-w:w+d}else if(o>F){o=F;w=Math.abs(o-g)*b;q=p<0?d-w:w+d}}if(q>d){q-d<l?q=d+l:q-d>m&&(q=d+m);o=o>g?g+(q-d)/b:g-(q-d)/b}else if(q<d){d-q<l?q=d-l:d-q>m&&(q=d-m);o=o>g?g+(d-q)/b:g-(d-q)/b}if(q<0){d=d-q;q=0}else if(q>A){d=d-(q-A);q=A}if(o<0){g=g-o;o=0}else if(o>F){g=g-(o-F);o=F}return last=e(c(d,g,q,o))}function b(a){a[0]<0&&(a[0]=0);a[1]<0&&(a[1]=
0);a[0]>A&&(a[0]=A);a[1]>F&&(a[1]=F);return[a[0],a[1]]}function c(a,b,e,d){var g=a,k=e,f=b,l=d;if(e<a){g=e;k=a}if(d<b){f=d;l=b}return[Math.round(g),Math.round(f),Math.round(k),Math.round(l)]}function e(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var d=0,g=0,k=0,f=0,l,m;return{flipCoords:c,setPressed:function(a){a=b(a);k=d=a[0];f=g=a[1]},setCurrent:function(a){a=b(a);l=a[0]-k;m=a[1]-f;k=a[0];f=a[1]},getOffset:function(){return[l,m]},moveOffset:function(a){var b=a[0],a=a[1];0>d+
b&&(b=b-(b+d));0>g+a&&(a=a-(a+g));F<f+a&&(a=a+(F-(f+a)));A<k+b&&(b=b+(A-(k+b)));d=d+b;k=k+b;g=g+a;f=f+a},getCorner:function(b){var c=a();switch(b){case "ne":return[c.x2,c.y];case "nw":return[c.x,c.y];case "se":return[c.x2,c.y2];case "sw":return[c.x,c.y2]}},getFixed:a}}(),S=function(){function a(b){b=f("<div />").css({position:"absolute",opacity:x.borderOpacity}).addClass(x.baseClass+"-"+b);G.append(b);return b}function b(a,c){var d=f("<div />").mousedown(e(a)).css({cursor:a+"-resize",position:"absolute",
zIndex:c});R.append(d);return d}function d(a){var e=x.handleSize,g=F,k=e;switch(a){case "n":case "s":e="100%";break;case "e":case "w":k="100%"}return b(a,z++).width(e).height(k).css({top:c(-g+1),left:c(-g+1)})}function g(a){for(i in a)y[a[i]]=b(a[i],z++).css({top:c(-F+1),left:c(-F+1),opacity:x.handleOpacity}).addClass(x.baseClass+"-handle")}function k(a){var b=Math.round(a.h/2-F),e=Math.round(a.w/2-F);west=-F+1;var d=a.w-F,a=a.h-F;"e"in y&&y.e.css({top:c(b),left:c(d)})&&y.w.css({top:c(b)})&&y.s.css({top:c(a),
left:c(e)})&&y.n.css({left:c(e)});"ne"in y&&y.ne.css({left:c(d)})&&y.se.css({top:c(a),left:c(d)})&&y.sw.css({top:c(a)});"b"in y&&y.b.css({top:c(a)})&&y.r.css({left:c(d)})}function l(){var a=X.getFixed();X.setPressed([a.x,a.y]);X.setCurrent([a.x2,a.y2]);m()}function m(){if(t)return j()}function j(){var a=X.getFixed(),b=a.h;I.width(a.w).height(b);var b=a.x,e=a.y;K.css({top:c(-e),left:c(-b)});I.css({top:c(e),left:c(b)});x.drawBorders&&v.right.css({left:c(a.w-1)})&&v.bottom.css({top:c(a.h-1)});A&&k(a);
if(!t){I.show();B.css("opacity",x.bgOpacity);t=true}x.onChange(p(a))}function o(){A=true;if(x.allowResize){k(X.getFixed());R.show();return true}}function r(){A=false;R.hide()}function u(a){(ha=a)?r():o()}var t,z=370,v={},y={},A=false,F=x.handleOffset;x.drawBorders&&(v={top:a("hline").css("top",f.browser.msie?c(-1):c(0)),bottom:a("hline"),left:a("vline"),right:a("vline")});if(x.dragEdges){y.t=d("n");y.b=d("s");y.r=d("e");y.l=d("w")}x.sideHandles&&g(["n","s","e","w"]);x.cornerHandles&&g(["sw","nw",
"ne","se"]);var C=q().mousedown(e("move")).css({cursor:"move",position:"absolute",zIndex:360});G.append(C);r();return{updateVisible:m,update:j,release:function(){r();I.hide();B.css("opacity",1);t=false},refresh:l,setCursor:function(a){C.css("cursor",a)},enableHandles:o,enableOnly:function(){A=true},showHandles:function(){if(A){k(X.getFixed());R.show()}},disableHandles:r,animMode:u,done:function(){u(false);l()}}}(),W=function(){function a(b){c(l(b))}function b(g){g.preventDefault();g.stopPropagation();
if(C){C=false;e(l(g));x.onSelect(p(X.getFixed()));T.css({zIndex:290});d&&f(document).unbind("mousemove",a).unbind("mouseup",b);c=function(){};e=function(){}}return false}var c=function(){},e=function(){},d=x.trackDocument;d||T.mousemove(a).mouseup(b).mouseout(b);B.before(T);return{activateHandlers:function(g,k){C=true;c=g;e=k;T.css({zIndex:450});d&&f(document).mousemove(a).mouseup(b);return false},setCursor:function(a){T.css("cursor",a)}}}(),Da=function(){function a(b,c,e){if(x.allowMove){X.moveOffset([c,
e]);S.updateVisible()}b.preventDefault();b.stopPropagation()}var b=f('<input type="radio" />').css({position:"absolute",left:"-30px"}).keypress(function(b){if(b.ctrlKey)return true;var c=(aa=b.shiftKey?true:false)?10:1;switch(b.keyCode){case 37:a(b,-c,0);break;case 39:a(b,c,0);break;case 38:a(b,0,-c);break;case 40:a(b,0,c);break;case 27:S.release();break;case 9:return true}return nothing(b)}).blur(function(){b.hide()}),c=f("<div />").css({position:"absolute",overflow:"hidden"}).append(b);x.keySupport&&
c.insertBefore(B);return{watchKeys:function(){if(x.keySupport){b.show();b.focus()}}}}();R.hide();z(!0);ba={animateTo:function(a){var b=a[0]/E,c=a[1]/H,e=a[2]/E,d=a[3]/H;if(!ha){var a=X.flipCoords(b,c,e,d),b=X.getFixed(),g=initcr=[b.x,b.y,b.x2,b.y2],k=x.animationDelay,f=g[0],l=g[1],e=g[2],d=g[3],m=a[0]-initcr[0],p=a[1]-initcr[1],j=a[2]-initcr[2],o=a[3]-initcr[3],q=0,r=x.swingSpeed;S.animMode(true);var u=function(){return function(){q=q+(100-q)/r;g[0]=f+q/100*m;g[1]=l+q/100*p;g[2]=e+q/100*j;g[3]=d+
q/100*o;q<100?window.setTimeout(u,k):S.done();q>=99.8&&(q=100);t(g)}}();window.setTimeout(u,k)}},setSelect:u,setOptions:function(a){v(a);z()},tellSelect:function(){return p(X.getFixed())},tellScaled:function(){return X.getFixed()},disable:function(){x.disabled=true;S.disableHandles();S.setCursor("default");W.setCursor("default")},enable:function(){x.disabled=false;z()},cancel:function(){S.done();W.activateHandlers(null,null)},focus:Da.watchKeys,getBounds:function(){return[A*E,F*H]},getWidgetSize:function(){return[A,
F]},release:S.release,destroy:function(){N.remove();y.show()}};y.data("Jcrop",ba);return ba};f.fn.Jcrop=function(a){function d(c){var b=a.useImg||c.src,d=new Image;d.onload=function(){f.Jcrop(c,a)};d.src=b}"object"!==typeof a&&(a={});this.each(function(){if(f(this).data("Jcrop")){if("api"==a)return f(this).data("Jcrop");f(this).data("Jcrop").setOptions(a)}else d(this)});return this}})(j)});define("image/vendor/mousewheel/mousewheel",["jquery"],function(j){(function(f){function a(a){var c=a||window.event,
d=[].slice.call(arguments,1),g=0,k=0,e=0,a=f.event.fix(c);a.type="mousewheel";c.wheelDelta&&(g=c.wheelDelta/120);c.detail&&(g=-c.detail/3);e=g;void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(e=0,k=-1*g);void 0!==c.wheelDeltaY&&(e=c.wheelDeltaY/120);void 0!==c.wheelDeltaX&&(k=-1*c.wheelDeltaX/120);d.unshift(a,g,k,e);return(f.event.dispatch||f.event.handle).apply(this,d)}var d=["DOMMouseScroll","mousewheel"];if(f.event.fixHooks)for(var c=d.length;c;)f.event.fixHooks[d[--c]]=f.event.mouseHooks;f.event.special.mousewheel=
{setup:function(){if(this.addEventListener)for(var b=d.length;b;)this.addEventListener(d[--b],a,!1);else this.onmousewheel=a},teardown:function(){if(this.removeEventListener)for(var b=d.length;b;)this.removeEventListener(d[--b],a,!1);else this.onmousewheel=null}};f.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(j)});define("image/image-plugin","jquery aloha/plugin image/image-floatingMenu i18n!aloha/nls/i18n i18n!image/nls/i18n jqueryui image/vendor/jcrop/jquery.jcrop.min image/vendor/mousewheel/mousewheel".split(" "),
function(j,f,a,d,c){var b=j,l=window.GENTICS,m=window.Aloha;String.prototype.toInteger=String.prototype.toInteger||function(){return parseInt((""+this).replace(/px$/,"")||0,10)};String.prototype.toFloat=String.prototype.toInteger||function(){return parseFloat((""+this).replace(/px$/,"")||0,10)};Number.prototype.toInteger=Number.prototype.toInteger||String.prototype.toInteger;Number.prototype.toFloat=Number.prototype.toFloat||String.prototype.toFloat;j.extend(true,j.fn,{increase:j.fn.increase||function(a){var b=
j(this),c,d;if(!b.length)return b;c=b.css(a).toFloat();d=Math.round((c||1)*1.2);c===d&&d++;b.css(a,d);return b},decrease:j.fn.decrease||function(a){var b=j(this),c,d;if(!b.length)return b;c=b.css(a).toFloat();d=Math.round((c||0)*0.8);c===d&&d>0&&d--;b.css(a,d);return b}});return f.create("image",{languages:["en","fr","de","ru","cz"],defaultSettings:{maxWidth:1600,minWidth:3,maxHeight:1200,minHeight:3,autoCorrectManualInput:true,fixedAspectRatio:false,autoResize:false,ui:{oneTab:false,insert:true,
reset:true,aspectRatioToggle:true,align:true,resize:true,meta:true,margin:true,crop:true,resizable:true,handles:"ne, se, sw, nw"},onCropped:function(a,b){m.Log.info("Default onCropped invoked",a,b)},onReset:function(a){m.Log.info("Default onReset invoked",a);return false},onResize:function(a){m.Log.info("Default onResize invoked",a)},onResized:function(a){m.Log.info("Default onResized invoked",a)}},_onCropped:function(a,c){b("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());b("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());
b("body").trigger("aloha-image-cropped",[a,c]);this.onCropped(a,c)},_onReset:function(a){b("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());b("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());b("body").trigger("aloha-image-reset",a);return this.onReset(a)},_onResize:function(a){b("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());b("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());b("body").trigger("aloha-image-resize",a);this.onResize(a)},_onResized:function(a){b("#"+
this.ui.imgResizeHeightField.getInputId()).val(a.height());b("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());b("body").trigger("aloha-image-resized",a);this.onResized(a)},imageObj:null,jcAPI:null,keepAspectRatio:false,startAspectRatio:false,restoreProps:[],objectTypeFilter:[],init:function(){m.getPluginUrl("image");this.startAspectRatio=this.settings.fixedAspectRatio;this.config=this.defaultSettings;this.settings=j.extend(true,this.defaultSettings,this.settings);this.initializeUI();this.bindInteractions();
this.subscribeEvents()},initializeUI:function(){this.ui=new a;this.ui.init(this)},bindInteractions:function(){var a=this;if(a.settings.ui.resizable)try{document.execCommand("enableObjectResizing",false,false)}catch(b){m.Log.info(b,"Could not disable enableObjectResizing")}if(a.settings.ui.meta){a.ui.imgSrcField.addListener("keyup",function(){a.srcChange()});a.ui.imgSrcField.addListener("blur",function(){var b=j(a.ui.imgSrcField.getTargetObject());b.attr("src")===""&&b.remove()})}if(a.settings.onCropped&&
typeof a.settings.onCropped==="function")a.onCropped=a.settings.onCropped;if(a.settings.onReset&&typeof a.settings.onReset==="function")a.onReset=a.settings.onReset;if(a.settings.onResized&&typeof a.settings.onResized==="function")a.onResized=a.settings.onResized;if(a.settings.onResize&&typeof a.settings.onResize==="function")a.onResize=this.settings.onResize},subscribeEvents:function(){var a=this,b=this.settings;j("img").filter(b.globalselector).unbind();j("img").filter(b.globalselector).click(function(b){a.clickImage(b)});
m.bind("aloha-drop-files-in-editable",function(b,c){for(var d,f=c.filesObjs.length,k;--f>=0;){k=c.filesObjs[f];if(k.file.type.match(/image\//)){a.getEditableConfig(c.editable);d=j("<img/>");d.css({"max-width":that.maxWidth,"max-height":that.maxHeight});d.attr("id",k.id);typeof k.src==="undefined"?d.attr("src",k.data):d.attr("src",k.src);l.Utils.Dom.insertIntoDOM(d,c.range,j(m.activeEditable.obj))}}});m.bind("aloha-selection-changed",function(b,c,d){if(d&&d.target&&a.settings.ui.resizable&&!j(d.target).hasClass("ui-resizable-handle")){a.endResize();
a.imageObj=null;m.trigger("aloha-image-unselected")}if(m.activeEditable!==null){c=a.findImgMarkup(c);b=a.getEditableConfig(m.activeEditable.obj);if(typeof b!=="undefined"){a.ui._insertImageButton.show();if(c){a.ui._insertImageButton.show();a.ui.setScope();if(a.settings.ui.meta){a.ui.imgSrcField.setTargetObject(c,"src");a.ui.imgTitleField.setTargetObject(c,"title")}a.ui.imgSrcField.foreground();a.ui.imgSrcField.focus()}else a.settings.ui.meta&&a.ui.imgSrcField.setTargetObject(null);a.ui.doLayout()}else a.ui._insertImageButton.hide()}});
m.bind("aloha-editable-created",function(b,c){try{document.execCommand("enableObjectResizing",false,false)}catch(d){m.Log.info(d,"Could not disable enableObjectResizing")}c.obj.delegate("img","mouseup",function(b){a.clickImage(b);b.stopPropagation()})});a._subscribeToResizeFieldEvents()},autoResize:function(){var a=this.imageObj.width(),b=this.imageObj.height(),c=false;if(a<this.settings.minWidth||a>this.settings.maxWidth||b<this.settings.minHeight||b>this.settings.maxHeight)c=true;if(c&&a>=b){this._setNormalizedFieldValues("width");
this.setSizeByFieldValue();return true}if(c&&a<b){this._setNormalizedFieldValues("height");this.setSizeByFieldValue();return true}return false},toggleKeepAspectRatio:function(){this.keepAspectRatio=!this.keepAspectRatio;this.endResize();this.startAspectRatio=this.keepAspectRatio?typeof this.settings.fixedAspectRatio!=="number"?this.imageObj.width()/this.imageObj.height():this.settings.fixedAspectRatio:false;this.startResize()},_subscribeToResizeFieldEvents:function(){function a(b,c,e,g){typeof g===
"undefined"&&(g=0);typeof e==="undefined"&&(e=8E3);var f=parseInt(b.val(),10);if(isNaN(f)){b.css("background-color","red");return false}var k=f+c;if(c>=0&&k>e){if(d.settings.autoCorrectManualInput){b.val(e);return true}b.css("background-color","red");return false}if(c<=0&&k<g){if(d.settings.autoCorrectManualInput){b.val(g);return true}b.css("background-color","red");return false}b.css("background-color","");b.val(f+c);return true}function c(e){var f=e.data.minValue,k=e.data.maxValue,l=e.data.fieldName;
if(e.keyCode===8||e.keyCode===46){if(b(this).val()>=f)if(typeof d.jcAPI!=="undefined"&&d.jcAPI!==null)d.setCropAreaByFieldValue();else{d._setNormalizedFieldValues(l);d.setSizeByFieldValue()}}else if(e.keyCode<=57&&e.keyCode>=48||e.keyCode<=105&&e.keyCode>=96){if(b(this).val()>=f)if(typeof d.jcAPI!=="undefined"&&d.jcAPI!==null)d.setCropAreaByFieldValue();else{d._setNormalizedFieldValues(l);d.setSizeByFieldValue()}}else{var m=0;if(e.keyCode===38||e.keyCode===107)m=1;else if(e.keyCode===40||e.keyCode===
109)m=-1;if(e.shiftKey||e.metaKey||e.ctrlKey)m=m*10;if(a(b(this),m,k,f))if(typeof d.jcAPI!=="undefined"&&d.jcAPI!==null)d.setCropAreaByFieldValue();else{d._setNormalizedFieldValues(l);d.setSizeByFieldValue()}}e.preventDefault();return false}function e(c,e){var f=c.data.minValue,k=c.data.maxValue,l=c.data.fieldName;if(c.shiftKey||c.metaKey||c.ctrlKey)e=e*10;if(a(b(this),e,k,f))if(typeof d.jcAPI!=="undefined"&&d.jcAPI!==null)d.setCropAreaByFieldValue();else{d._setNormalizedFieldValues(l);d.setSizeByFieldValue()}return false}
var d=this,f=b("#"+d.ui.imgResizeHeightField.getInputId()),l={fieldName:"height",maxValue:d.ui.imgResizeHeightField.maxValue,minValue:d.ui.imgResizeHeightField.minValue};f.live("keyup",l,c);f.live("mousewheel",l,e);f=b("#"+d.ui.imgResizeWidthField.getInputId());l={fieldName:"width",maxValue:d.ui.imgResizeWidthField.maxValue,minValue:d.ui.imgResizeWidthField.minValue};f.live("keyup",l,c);f.live("mousewheel",l,e)},_setNormalizedFieldValues:function(a){var b=j("#"+this.ui.imgResizeWidthField.getInputId()),
c=j("#"+this.ui.imgResizeHeightField.getInputId()),d=b.val(),f=c.val(),a=this._normalizeSize(d,f,a);b.val(a.width);c.val(a.height)},setSize:function(a,b){this.imageObj.width(a);this.imageObj.height(b);var c=this.imageObj.closest(".Aloha_Image_Resize");c.height(b);c.width(a);this._onResize(this.imageObj);this._onResized(this.imageObj)},clickImage:function(a){this.endResize();var c=this.imageObj=j(a.target);if(!c.hasClass("aloha-ui")){this.ui.setScope();c.closest(".aloha-editable");this.restoreProps.push({obj:a.srcElement,
src:this.imageObj.attr("src"),width:this.imageObj.width(),height:this.imageObj.height()});b("#"+this.ui.imgResizeHeightField.getInputId()).val(this.imageObj.height());b("#"+this.ui.imgResizeWidthField.getInputId()).val(this.imageObj.width());if(this.settings.ui.meta){this.ui.imgSrcField.setTargetObject(this.imageObj,"src");this.ui.imgTitleField.setTargetObject(this.imageObj,"title")}m.Selection.preventSelectionChanged();try{this.ui.imgSrcField.focus()}catch(e){}this.settings.ui.resizable&&this.startResize();
this.settings.autoResize&&this.autoResize();m.Selection.preventSelectionChangedFlag=false;m.trigger("aloha-image-selected")}},findImgMarkup:function(a){var b,c;typeof a==="undefined"&&(a=m.Selection.getRangeObject());c=j(a.startContainer);try{if(m.activeEditable&&(typeof a.startContainer!=="undefined"&&typeof a.startContainer.childNodes!=="undefined"&&typeof a.startOffset!=="undefined"&&typeof a.startContainer.childNodes[a.startOffset]!=="undefined"&&a.startContainer.childNodes[a.startOffset].nodeName.toLowerCase()===
"img"&&a.startOffset+1===a.endOffset||c.hasClass("Aloha_Image_Resize"))){b=c.find("img")[0];if(!b.css)b.css="";if(!b.title)b.title="";if(!b.src)b.src="";return b}}catch(d){m.Log.debug(d,"Error finding img markup.")}return null},getPluginFocus:function(){return this.imageObj},_normalizeSize:function(a,c,e){function d(e){if(c>l.settings.maxHeight){var j={org:c,"new":l.settings.maxHeight};b("body").trigger("aloha-image-resize-outofbounds",["height","max",j]);c=l.settings.maxHeight}else if(c<l.settings.minHeight){j=
{org:c,"new":l.settings.minHeight};b("body").trigger("aloha-image-resize-outofbounds",["height","min",j]);c=l.settings.minHeight}if(l.keepAspectRatio){a=c*m;e&&f(false)}}function f(e){if(a>l.settings.maxWidth){var j={org:a,"new":l.settings.maxWidth};b("body").trigger("aloha-image-resize-outofbounds",["width","max",j]);a=l.settings.maxWidth}else if(a<l.settings.minWidth){j={org:a,"new":l.settings.minWidth};b("body").trigger("aloha-image-resize-outofbounds",["width","min",j]);a=l.settings.minWidth}if(l.keepAspectRatio){c=
a/m;e&&d(false)}}var l=this,a=parseInt(a),c=parseInt(c),m=1.33333;l.keepAspectRatio&&(m=a/c);if(typeof l.startAspectRatio==="number")m=l.startAspectRatio;e=="width"&&f(true);e=="height"&&d(true);return{width:Math.floor(a),height:Math.floor(c)}},setSizeByFieldValue:function(){var a=b("#"+this.ui.imgResizeWidthField.getInputId()).val(),c=b("#"+this.ui.imgResizeHeightField.getInputId()).val();this.setSize(a,c)},setCropAreaByFieldValue:function(){var a=this.jcAPI.tellSelect(),c=b("#"+this.ui.imgResizeWidthField.getInputId()).val(),
c=parseInt(c,10),e=b("#"+this.ui.imgResizeHeightField.getInputId()).val(),e=parseInt(e,10);this.jcAPI.setSelect([a.x,a.y,a.x+c,a.y+e])},insertImg:function(){var a=m.Selection.getRangeObject(),b=this.getEditableConfig(m.activeEditable.obj),c=m.getPluginUrl("image");if(a.isCollapsed()){b="max-width: "+b.maxWidth+"; max-height: "+b.maxHeight;c=j('<img style="'+b+'" src="'+c+'/img/blank.jpg" title="" />');l.Utils.Dom.insertIntoDOM(c,a,j(m.activeEditable.obj))}else m.Log.error("img cannot markup a selection")},
srcChange:function(){this.imageObj.attr("src",this.ui.imgSrcField.getValue())},positionCropButtons:function(){var a=j(".jcrop-tracker:first"),b=a.offset(),c=b.top,b=b.left,d=a.height(),a=a.width(),f=j("#aloha-CropNResize-btns");c===0&&b===0&&f.hide();c=parseInt(c+d+3,10);b=parseInt(b+a/2-f.width()/2+10,10);(0!=b||0!=c)&&f.offset({top:c,left:b})},initCropButtons:function(){var a=this,b;j("body").append('<div id="aloha-CropNResize-btns" display="none"><button class="cnr-crop-apply" title="'+c.t("Accept")+
'"></button><button class="cnr-crop-cancel" title="'+c.t("Cancel")+'"></button></div>');b=j("#aloha-CropNResize-btns");b.find(".cnr-crop-apply").click(function(){a.acceptCrop()});b.find(".cnr-crop-cancel").click(function(){a.endCrop()});this.interval=setInterval(function(){a.positionCropButtons()},10)},destroyCropButtons:function(){j("#aloha-CropNResize-btns").remove();clearInterval(this.interval)},_disableSelection:function(a){a.find("*").attr("unselectable","on").css({"-moz-user-select":"none",
"-webkit-user-select":"none","user-select":"none"})},crop:function(){var a=this;a.initCropButtons();a.settings.ui.resizable&&a.endResize();a.jcAPI=j.Jcrop(a.imageObj,{onSelect:function(){a._onCropSelect();window.setTimeout(function(){a.ui.setScope()},10)}});a._disableSelection(b(".jcrop-holder"));a._disableSelection(b("#imageContainer"));a._disableSelection(b("#aloha-CropNResize-btns"));b("body").trigger("aloha-image-crop-start",[a.imageObj])},_onCropSelect:function(){j("#aloha-CropNResize-btns").fadeIn("slow");
j(".jcrop-handle").mousedown(function(){j("#aloha-CropNResize-btns").hide()});j(".jcrop-tracker").mousedown(function(){j("#aloha-CropNResize-btns").hide()});if(typeof this.jcAPI!=="undefined"&&this.jcAPI!==null){this.positionCropButtons();var a=this.jcAPI.tellSelect();j("#"+this.ui.imgResizeWidthField.getInputId()).val(a.w);j("#"+this.ui.imgResizeHeightField.getInputId()).val(a.h)}},endCrop:function(){if(this.jcAPI){this.jcAPI.destroy();this.jcAPI=null}this.destroyCropButtons();this.ui._imageCropButton.setState(false);
this.settings.ui.resizable&&this.startResize();if(this.keepAspectRatio)this.startAspectRatio=this.imageObj.width()/this.imageObj.height();b("body").trigger("aloha-image-crop-stop",[this.imageObj])},acceptCrop:function(){this._onCropped(this.imageObj,this.jcAPI.tellSelect());this.endCrop()},startResize:function(){var a=this,b=this.imageObj,b=this.imageObj.css({height:this.imageObj.height(),width:this.imageObj.width(),position:"relative","max-height":"","max-width":""});b.resizable({maxHeight:a.settings.maxHeight,
minHeight:a.settings.minHeight,maxWidth:a.settings.maxWidth,minWidth:a.settings.minWidth,aspectRatio:a.startAspectRatio,handles:a.settings.handles,grid:a.settings.grid,resize:function(){a._onResize(a.imageObj)},stop:function(b){a._onResized(a.imageObj);this.enableCrop&&window.setTimeout(function(){a.ui.setScope();that.done(b)},10)}});b.css("display","inline-block");j(".ui-wrapper").attr("contentEditable",false).addClass("aloha-image-box-active Aloha_Image_Resize aloha").css({position:"relative",display:"inline-block",
"float":a.imageObj.css("float")}).bind("resizestart",function(a){a.preventDefault()}).bind("mouseup",function(a){a.originalEvent.stopSelectionUpdate=true})},endResize:function(){this.imageObj&&this.imageObj.closest(".aloha-editable");this.imageObj&&this.imageObj.is(":ui-resizable")&&this.imageObj.resizable("destroy").css({top:0,left:0})},resetSize:function(){var a=this,b=new Image;b.onload=function(){var c=a.getPluginFocus();a.settings.ui.resizable&&a.endResize();j(c).add(c.parent()).css({width:b.width+
"px",height:b.height+"px","max-width":"","max-height":""});a.settings.ui.resizable&&a.resize()};b.src=a.getPluginFocus().attr("src")},reset:function(){this.settings.ui.crop&&this.endCrop();this.settings.ui.resizable&&this.endResize();if(!this._onReset(this.imageObj))for(var a=0;a<this.restoreProps.length;a++)if(this.imageObj.get(0)===this.restoreProps[a].obj){this.imageObj.attr("src",this.restoreProps[a].src);this.imageObj.width(this.restoreProps[a].width);this.imageObj.height(this.restoreProps[a].height);
break}}})});define("highlighteditables/highlighteditables-plugin",["aloha","jquery","aloha/plugin"],function(j,f,a){var d=window.GENTICS;return a.create("highlighteditables",{config:["highlight"],init:function(){var a=this,b;d.Utils.Position.addMouseMoveCallback(function(){var d,f;for(d=0;d<j.editables.length;d++)f=j.editables[d],b=a.getEditableConfig(f.obj),!j.activeEditable&&(!f.isDisabled()&&"highlight"==b)&&f.obj.addClass("aloha-editable-highlight")});d.Utils.Position.addMouseStopCallback(function(){a.fade()});
j.bind("aloha-editable-activated",function(){a.fade()})},fade:function(){var a,b,d=function(){f(this).css("outline","")};for(a=0;a<j.editables.length;a++)b=j.editables[a].obj,b.hasClass("aloha-editable-highlight")&&b.css("outline",b.css("outlineColor")+" "+b.css("outlineStyle")+" 5px").removeClass("aloha-editable-highlight").animate({outlineWidth:"0px"},300,"swing",d)}})});define("dom-to-xhtml/dom-to-xhtml",["aloha","jquery","aloha/console"],function(j,f,a){function d(a){for(var b=a.attributes,c=
[],d=0;d<b.length;d++){var g=b[d];if("undefined"===typeof g.specified||g.specified){var l=g.nodeName,g="style"===l?f.attr(a,l):g.nodeValue;c.push([l,g])}}a="";for(b=0;b<c.length;b++)if(d=c[b][0].toLowerCase(),l=c[b][1],(g=-1!==f.inArray(d.toLowerCase(),k))||!(""===l||null==l))a+=" "+d+'="'+(""+(g?d:l)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")+'"';return a}function c(a){for(var b="/"+a.nodeName,a=a.nextSibling;null!=a;){if(b==a.nodeName)return!0;a=a.nextSibling}return!1}function b(a,
b,d,g){for(;null!=b;)if(1===b.nodeType&&d&&"/"+a.nodeName==b.nodeName){b=b.nextSibling;break}else 1===b.nodeType&&c(b)?b=l(b,b.nextSibling,!0,g):(m(b,g),b=b.nextSibling);return b}function l(a,c,k,l){var m=a.nodeName.toLowerCase();a.scopeName&&("HTML"!=a.scopeName&&-1===m.indexOf(":"))&&(m=a.scopeName.toLowerCase()+":"+m);!k&&null==c&&-1!==f.inArray(m,g)?l.push("<"+m+d(a)+"/>"):(l.push("<"+m+d(a)+">"),c=b(a,c,k,l),l.push("</"+m+">"));return c}function m(b,d){1===b.nodeType?l(b,b.firstChild,c(b),d):
3===b.nodeType?d.push(b.nodeValue.replace(/&/g,"&amp;").replace(/</g,"&lt;")):8===b.nodeType?d.push("<\!--"+b.nodeValue+"--\>"):a.log("Unknown node type encountered during serialization, ignoring it: type="+b.nodeType+" name="+b.nodeName+" value="+b.nodeValue)}var g="area base basefont br col frame hr img input isindex link meta param embed".split(" "),k="checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected".split(" ");return{contentsToXhtml:function(a){var c=
[];b(a,a.firstChild,!1,c);return c.join("")},nodeToXhtml:function(a){var b=[];m(a,b);return b.join("")}}});define("dom-to-xhtml/dom-to-xhtml-plugin",["aloha","jquery","aloha/plugin","dom-to-xhtml/dom-to-xhtml"],function(j,f,a,d){return a.create("dom-to-xhtml",{init:function(){var a=this;j.Editable.setContentSerializer(function(b){return!a.settings.editables&&!a.settings.config?d.contentsToXhtml(b):a.settings.editables&&"dom-to-xhtml"==a.settings.editables["#"+f(b).attr("id")]?d.contentsToXhtml(b):
a.settings.config&&"dom-to-xhtml"==a.settings.config&&!a.settings.editables["#"+f(b).attr("id")]?d.contentsToXhtml(b):f(b).html()})}})});define("contenthandler/wordcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(j,f,a){return a.createHandler({handleContent:function(a){"string"===typeof a?a=f("<div>"+a+"</div>"):a instanceof f&&(a=f("<div>").append(a));this.detectWordContent(a)&&this.transformWordContent(a);return a.html()},detectWordContent:function(a){var c=!1;a.find("*").each(function(){var a=
f(this).attr("style");if(a&&0<=a.toLowerCase().indexOf("mso")||(a=f(this).attr("class"))&&0<=a.toLowerCase().indexOf("mso"))return c=!0,!1});return c},isOrderedList:function(a){return"Wingdings"==a.css("fontFamily")||"Symbol"==a.css("fontFamily")?!1:a.text().match(/^([0-9]{1,3}\.)|([0-9]{1,3}\)|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\)))$/)?!0:!1},transformListsFromWord:function(a){var c=this,b,l;l=a.find("p.MsoListParagraphCxSpFirst,p.MsoListParagraphCxSpMiddle,p.MsoListParagraphCxSpLast,p.MsoListParagraph,p span");
l.each(function(){var a=f(this),b=a.css("font-family")||"",c=a.css("mso-list")||"",e=a.attr("style")||"";a.hasClass("MsoListParagraphCxSpFirst")||a.hasClass("MsoListParagraph")?a.addClass("aloha-list-element"):0<=b.indexOf("Symbol")?a.closest("p").addClass("aloha-list-element"):0<=b.indexOf("Wingdings")?a.closest("p").addClass("aloha-list-element"):""!==c?a.closest("p").addClass("aloha-list-element"):0<=e.indexOf("mso-list")&&a.closest("p").addClass("aloha-list-element")});a.find("p span span span").each(function(){var a=
f(this),b;0===f.trim(a.text()).replace(/&nbsp;/g,"").length&&(b=f.trim(a.parent().parent().text()).replace(/&nbsp;/g,""),b.match(/^([0-9]{1,3}\.)|([0-9]{1,3}\))|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\))|(.)$/)&&(a.closest("p").addClass("aloha-list-element"),a.parent().parent().addClass("aloha-list-bullet")))});l="p.aloha-list-element";b=":not("+l+", font)";l=a.find(l);0<l.length&&l.each(function(){var a=f(this),d,k,e,l,j,r,q,u;a.removeClass("aloha-list-element");a.find("font").each(function(){f(this).contents().unwrap()});
u=[];q=parseFloat(a.css("marginLeft"));isNaN(q)&&(q=0);r=[];j=a.nextUntil(b);l=f(a.find("span.aloha-list-bullet"));0===l.length&&(l=a.find("span").eq(0));e=c.isOrderedList(l);l.remove();k=f(e?"<ol></ol>":"<ul></ul>");r.push(k);d=f("<li></li>");k.append(d);a.contents().appendTo(d);a.replaceWith(k);j.each(function(){var a=f(this),b,m;if(!a.is("font")){a.find("font").each(function(){f(this).contents().unwrap()});b=parseFloat(a.css("marginLeft"));isNaN(b)&&(b=0);l=f(a.find("span.aloha-list-bullet"));
0===l.length&&(l=a.find("span").eq(0));e=c.isOrderedList(l);l.remove();if(b>q)m=f(e?"<ol></ol>":"<ul></ul>"),k.children(":last").append(m),k=m,r.push(k),u.push(b),q=b;else if(b<q&&0<u.length){for(;0<u.length&&u[u.length-1]>b;)u.pop(),r.pop();k=r[r.length-1];q=b}d=f("<li></li>");k.append(d);a.contents().appendTo(d);a.remove()}})})},transformTitles:function(a){a.find("p.MsoTitle").each(function(){j.Markup.transformDomObject(f(this),"h1")});a.find("p.MsoSubtitle").each(function(){j.Markup.transformDomObject(f(this),
"h2")})},cleanHtml:function(a){a.find("*").filter(function(){return""==f.trim(f(this).text())&&!f(this).is("td")}).contents().unwrap();a.find("span").contents().unwrap();a.find("a").each(function(){f(this).attr("href")&&f.trim(f(this).attr("href")).match(/^#(.*)$/)&&f(this).contents().unwrap()});a.find("div").contents().unwrap();a.find("*").filter(function(){return""==f.trim(f(this).text())&&!f(this).is("td")}).remove()},removeParagraphNumbering:function(a){a=a.find("h1,h2,h3,h4,h5,h6");0<a.length&&
a.each(function(){var a=f(this),b=a.find("span"),a=a.find("a");b.each(function(){f.trim(f(this).text()).match(/^([\.\(]?[\d\D][\.\(]?){1,4}$/)&&f(this).remove()});a.each(function(){"undefined"===typeof f(this).attr("href")&&f(this).contents().unwrap()})})},transformToc:function(a){a.find("[class*=MsoToc]").each(function(){var a=f(this),b=a.find("span"),a=a.find("a");b.each(function(){f(this).attr("style")&&-1<f(this).attr("style").search("mso-hide")&&f(this).remove();f(this).contents().unwrap()});
a.each(function(){f(this).contents().unwrap()})})},transformWordContent:function(a){this.transformToc(a);this.removeParagraphNumbering(a);this.transformListsFromWord(a);this.transformTitles(a);this.cleanHtml(a)}})});define("contenthandler/genericcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(j,f,a){return a.createHandler({handleContent:function(a){if(null!=a){"string"===typeof a?a=f("<div>"+a+"</div>"):a instanceof f&&(a=f("<div>").append(a));if(0<a.find(".aloha-block").length)return a.html();
this.cleanLists(a);this.transformTables(a);this.removeComments(a);this.unwrapTags(a);this.removeStyles(a);this.removeNamespacedElements(a);var c=!0;j.settings&&(j.settings.contentHandler&&j.settings.contentHandler.handler&&j.settings.contentHandler.handler.generic&&"undefinded"!==typeof j.settings.contentHandler.handler.generic.transformFormattings&&!j.settings.contentHandler.handler.generic.transformFormattings)&&(c=!1);!0===c&&this.transformFormattings(a);return a.html()}},cleanLists:function(a){a.find("ul,ol").each(function(){f(this).contents(":not(li,ul,ol)").each(function(){f(this).remove()})})},
transformTables:function(a){a.find("table").each(function(){f(this).removeAttr("border").removeAttr("cellspacing").removeAttr("cellpadding")});a.find("td").each(function(){f(this).removeAttr("width").removeAttr("height").removeAttr("valign");"<p><br></p>"===this.innerHTML.replace(/[\s\xA0]+/g,"")&&(this.innerHTML="&nbsp;");1===f(this).find("p").length&&f(this).find("p").contents().unwrap()});a.find("tr").each(function(){f(this).removeAttr("width").removeAttr("height").removeAttr("valign")});a.find("colgroup").remove()},
transformFormattings:function(a){a.find("strong,em,s,u,strike").each(function(){"STRONG"===this.nodeName?j.Markup.transformDomObject(f(this),"b"):"EM"===this.nodeName?j.Markup.transformDomObject(f(this),"i"):"S"===this.nodeName||"STRIKE"==this.nodeName?j.Markup.transformDomObject(f(this),"del"):"U"===this.nodeName&&f(this).contents().unwrap()})},transformLinks:function(a){a.find("a").each(function(){"undefined"===typeof f(this).attr("href")&&f(this).contents().unwrap()})},removeComments:function(a){var c=
this;a.contents().each(function(){8===this.nodeType?f(this).remove():c.removeComments(f(this))})},unwrapTags:function(a){a.find("span,font,div").not(".aloha-wai-lang").each(function(){"DIV"==this.nodeName?"<br>"===this.innerHTML?f(this).contents().unwrap():f(j.Markup.transformDomObject(f(this),"p").append("<br>")).contents().unwrap():f(this).contents().unwrap()})},removeStyles:function(a){var c=this;a.children("style").filter(function(){return"false"!==this.contentEditable}).remove();a.children().filter(function(){return"false"!==
this.contentEditable}).each(function(){f(this).removeAttr("style").removeClass();c.removeStyles(f(this))})},removeNamespacedElements:function(a){a.find("*").each(function(){var a=this.prefix?this.prefix:this.scopeName?this.scopeName:void 0;if(a&&"HTML"!==a||0<=this.nodeName.indexOf(":")){var a=f(this),b=a.contents();b.length?b.unwrap():a.remove()}})}})});define("contenthandler/oembedcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(j,f,a){function d(a,b){var c=a.apiendpoint,
e="",d=a.callbackparameter||"callback",g,c=0>=c.indexOf("?")?c+"?":c+"&";null!=a.maxWidth&&null==a.params.maxwidth&&(a.params.maxwidth=a.maxWidth);null!=a.maxHeight&&null==a.params.maxheight&&(a.params.maxheight=a.maxHeight);for(g in a.params)g!=a.callbackparameter&&null!=a.params[g]&&(e+="&"+k(g)+"="+a.params[g]);return c+="format=json&url="+k(b)+e+"&"+d+"=?"}function c(a,b,c){var g=d(c,b),c=f.extend({url:g,type:"get",dataType:"json",success:function(c){c=f.extend({},c);switch(c.type){case "photo":c.code=
f.fn.oembed.getPhotoCode(b,c);break;case "video":c.code=f.fn.oembed.getVideoCode(b,c);break;case "rich":c.code=f.fn.oembed.getRichCode(b,c);break;default:c.code=f.fn.oembed.getGenericCode(b,c)}e.beforeEmbed.call(a,c);e.onEmbed.call(a,c);e.afterEmbed.call(a,c)},error:e.onError.call(a,b,c)},e.ajaxOptions||{});f.ajax(c)}function b(){p=[];var a;a=[];var b,c;if(g(e.allowedProviders))p=f.fn.oembed.providers;else{for(b=0;b<f.fn.oembed.providers.length;b++)0<=f.inArray(f.fn.oembed.providers[b].name,e.allowedProviders)&&
p.push(f.fn.oembed.providers[b]);e.greedy=!1}if(!g(e.disallowedProviders)){for(b=0;b<p.length;b++)0>f.inArray(p[b].name,e.disallowedProviders)&&a.push(p[b]);p=a;e.greedy=!1}g(e.customProviders)||f.each(e.customProviders,function(a,b){b instanceof f.fn.oembed.OEmbedProvider?p.push(c):(c=new f.fn.oembed.OEmbedProvider,c.fromJSON(b)&&p.push(c))});a=l(e.defaultOEmbedProvider);!0==e.greedy&&p.push(a);for(b=0;b<p.length;b++)null==p[b].apiendpoint&&(p[b].apiendpoint=a.apiendpoint)}function l(a){var b="http://oohembed.com/oohembed/";
"embed.ly"==a&&(b="http://api.embed.ly/v1/api/oembed?");return new f.fn.oembed.OEmbedProvider(a,null,null,b,"callback")}function m(a){if(null==a)return null;var b,c={};for(b in a)null!=b&&(c[b.toLowerCase()]=a[b]);return c}function g(a){return"undefined"==typeof a||null==a||f.isArray(a)&&0==a.length?!0:!1}var k=window.escape;f.fn.oembed=function(a,d,g){e=f.extend(!0,f.fn.oembed.defaults,d);b();return this.each(function(){var b=f(this),d=null!=a?a:b.attr("href"),k;e.onEmbed=g?g:function(a){f.fn.oembed.insertCode(this,
e.embedMethod,a)};null!=d&&(k=f.fn.oembed.getOEmbedProvider(d),null!=k?(k.params=m(e[k.name])||{},k.maxWidth=e.maxWidth,k.maxHeight=e.maxHeight,c(b,d,k)):e.onProviderNotFound.call(b,d));return b})};var e,p=[];f.fn.oembed.defaults={maxWidth:null,maxHeight:null,embedMethod:"replace",defaultOEmbedProvider:"oohembed",allowedProviders:null,disallowedProviders:null,customProviders:null,defaultProvider:null,greedy:!0,onProviderNotFound:function(){},beforeEmbed:function(){},afterEmbed:function(){},onEmbed:function(){},
onError:function(){},ajaxOptions:{}};f.fn.oembed.embedCode=!1;f.fn.oembed.insertCode=function(a,b,c){if(null!=c)switch(f.fn.oembed.embedCode=c.code,b){case "auto":null!=a.attr("href")?f.fn.oembed.insertCode(a,"append",c):f.fn.oembed.insertCode(a,"replace",c);break;case "replace":a.replaceWith(c.code);break;case "fill":a.html(c.code);break;case "append":b=a.next();if(null==b||!b.hasClass("oembed-container"))b=a.after('<div class="oembed-container"></div>').next(".oembed-container"),null!=c&&null!=
c.provider_name&&b.toggleClass("oembed-container-"+c.provider_name);b.html(c.code)}};f.fn.oembed.getInsertCode=function(a,b,c){if(null!=c)return c.code};f.fn.oembed.getPhotoCode=function(a,b){var c;c=b.title?b.title:"";c+=b.author_name?" - "+b.author_name:"";c+=b.provider_name?" - "+b.provider_name:"";c='<div><a href="'+a+"\" target='_blank'><img src=\""+b.url+'" alt="'+c+'"/></a></div>';b.html&&(c+="<div>"+b.html+"</div>");return c};f.fn.oembed.getVideoCode=function(a,b){return b.html};f.fn.oembed.getRichCode=
function(a,b){return b.html};f.fn.oembed.getGenericCode=function(a,b){var c='<a href="'+a+'">'+(null!=b.title?b.title:a)+"</a>";b.html&&(c+="<div>"+b.html+"</div>");return c};f.fn.oembed.isProviderAvailable=function(a){return null!=(void 0)(a)};f.fn.oembed.getOEmbedProvider=function(a){for(var b=0;b<p.length;b++)if(p[b].matches(a))return p[b];return null};f.fn.oembed.OEmbedProvider=function(a,b,c,e,d){this.name=a;this.type=b;this.urlschemes=g(c)?["."]:f.isArray(c)?c:c.split(";");this.apiendpoint=
e;this.callbackparameter=d;this.maxWidth=500;this.maxHeight=400;var k,l,m;this.matches=function(a){for(k=0;k<this.urlschemes.length;k++)if(m=RegExp(this.urlschemes[k],"i"),null!=a.match(m))return!0;return!1};this.fromJSON=function(a){for(l in a)this[l]="urlschemes"!=l?a[l]:g(a[l])?["."]:f.isArray(a[l])?a[l]:a[l].split(";");return!0}};f.fn.oembed.providers=[new f.fn.oembed.OEmbedProvider("youtube","video",["youtube\\.com/watch.+v=[\\w-]+&?"]),new f.fn.oembed.OEmbedProvider("flickr","photo",["flickr\\.com/photos/[-.\\w@]+/\\d+/?"],
"http://flickr.com/services/oembed","jsoncallback"),new f.fn.oembed.OEmbedProvider("viddler","video",["viddler.com"]),new f.fn.oembed.OEmbedProvider("blip","video",["blip\\.tv/.+"],"http://blip.tv/oembed/"),new f.fn.oembed.OEmbedProvider("hulu","video",["hulu\\.com/watch/.*"],"http://www.hulu.com/api/oembed.json"),new f.fn.oembed.OEmbedProvider("vimeo","video",["http://www.vimeo.com/groups/.*/videos/.*","http://www.vimeo.com/.*","http://vimeo.com/groups/.*/videos/.*","http://vimeo.com/.*"],"http://vimeo.com/api/oembed.json"),
new f.fn.oembed.OEmbedProvider("dailymotion","video",["dailymotion\\.com/.+"]),new f.fn.oembed.OEmbedProvider("scribd","rich",["scribd\\.com/.+"]),new f.fn.oembed.OEmbedProvider("slideshare","rich",["slideshare.net"],"http://www.slideshare.net/api/oembed/1"),new f.fn.oembed.OEmbedProvider("photobucket","photo",["photobucket\\.com/(albums|groups)/.*"],"http://photobucket.com/oembed/")];return a.createHandler({handleContent:function(a){"string"===typeof a?a=f("<div>"+a+"</div>").get(0):a instanceof
f&&(a=f("<div>").append(a).get(0));a=f(a).oembed(f(a).text(),{embedMethod:"replace"});setTimeout(function(){a=f.fn.oembed.embedCode;return f("<div>").append(a).html()},500)},replaceoEmbedContent:function(){}})});ya.REGEX_PROTOCOL=/^([A-Za-z0-9\+\-\.\&\;\*\s]*?)(?:\:|&*0*58|&*x0*3a)/i;ya.RELATIVE="__relative__";ya.prototype.clean_node=function(j){function f(a,c){var d;for(d=0;d<c.length;d++)if(c[d]==a)return d;return-1}function a(){var a=[],c={},d,g;for(d=0;d<arguments.length;d++)if(arguments[d]&&
arguments[d].length)for(g=0;g<arguments[d].length;g++)c[arguments[d][g]]||(c[arguments[d][g]]=!0,a.push(arguments[d][g]));return a}function d(b){for(var c,m=0;m<this.filters.length;m++)if(!this.filters[m](b)){c=b.cloneNode(!0);this.current_element.appendChild(c);return}switch(b.nodeType){case 1:var g,k,e,j,o,r,q;g=[];m=b;j=!1;for(k=0;k<this.transformers.length;k++)if(e=this.transformers[k]({allowed_elements:this.allowed_elements,config:this.config,node:b,node_name:b.nodeName.toLowerCase(),whitelist_nodes:this.whitelist_nodes,
dom:this.dom}),null!=e)if("object"==typeof e){if(e.whitelist_nodes&&e.whitelist_nodes instanceof Array)for(j=0;j<e.whitelist_nodes.length;j++)-1==f(e.whitelist_nodes[j],this.whitelist_nodes)&&this.whitelist_nodes.push(e.whitelist_nodes[j]);j=e.whitelist?!0:!1;e.attr_whitelist&&(g=a(g,e.attr_whitelist));m=e.node?e.node:m}else throw Error("transformer output must be an object or null");b=this.jQuery;b=b.browser.msie&&"7.0"===b.browser.version;e=m.nodeName.toLowerCase();k=this.current_element;if(this.allowed_elements[e]||
j){this.current_element=this.dom.createElement(m.nodeName);k.appendChild(this.current_element);j=a(this.config.attributes[e],this.config.attributes.__ALL__,g);for(g=0;g<j.length;g++)if(c=j[g],o=m.attributes[c])if(r=!0,this.config.protocols[e]&&this.config.protocols[e][c]&&(r=this.config.protocols[e][c],r=(q=o.nodeValue.toLowerCase().match(ya.REGEX_PROTOCOL))?-1!=f(q[1],r):-1!=f(ya.RELATIVE,r)),r&&(!b||b&&"style"!==c))r=document.createAttribute(c),r.value=o.nodeValue,this.current_element.setAttributeNode(r);
if(this.config.add_attributes[e])for(c in this.config.add_attributes[e])if(!b||b&&"style"!==c)r=document.createAttribute(c),r.value=this.config.add_attributes[e][c],this.current_element.setAttributeNode(r)}else if(-1!=f(m,this.whitelist_nodes)){for(this.current_element=m.cloneNode(!0);0<this.current_element.childNodes.length;)this.current_element.removeChild(this.current_element.firstChild);k.appendChild(this.current_element)}if(!this.config.remove_all_contents&&!this.config.remove_element_contents[e])for(g=
0;g<m.childNodes.length;g++)d.call(this,m.childNodes[g]);this.current_element.normalize&&this.current_element.normalize();this.current_element=k;break;case 3:c=b.cloneNode(!1);this.current_element.appendChild(c);break;case 5:c=b.cloneNode(!1);this.current_element.appendChild(c);break;case 8:this.config.allow_comments&&(c=b.cloneNode(!1),this.current_element.appendChild(c))}}var c=this.dom.createDocumentFragment();this.current_element=c;this.whitelist_nodes=[];for(i=0;i<j.childNodes.length;i++)d.call(this,
j.childNodes[i]);c.normalize&&c.normalize();return c};define("vendor/sanitize",function(){});define("contenthandler/sanitizecontenthandler","aloha/core jquery aloha/contenthandlermanager aloha/plugin aloha/console vendor/sanitize".split(" "),function(j,f,a){function d(a){var d=["restricted","basic","relaxed"],m=j.defaults.supports,m=j.settings.contentHandler.sanitize&&f.inArray(j.settings.contentHandler.sanitize,d)>-1?j.defaults.sanitize[j.settings.contentHandler.sanitize]:j.defaults.sanitize.relaxed;
if(j.settings.contentHandler.allows)m=j.settings.contentHandler.allows;a&&(m=a);m.filters=[function(a){return a.contentEditable!="false"}];c=new ya(m,f)}var c;if(!j.defaults.sanitize)j.defaults.sanitize={};j.defaults.sanitize.restricted={elements:["b","em","i","strong","u","del","p","span","div","br"]};j.defaults.sanitize.basic={elements:["a","abbr","b","blockquote","br","cite","code","dd","del","dl","dt","em","i","li","ol","p","pre","q","small","strike","strong","sub","sup","u","ul"],attributes:{a:["href"],
blockquote:["cite"],q:["cite"],abbr:["title"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}};j.defaults.sanitize.relaxed={elements:["a","abbr","b","blockquote","br","caption","cite","code","col","colgroup","dd","del","dl","dt","em","h1","h2","h3","h4","h5","h6","i","img","li","ol","p","pre","q","small","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","u","ul",
"span","hr","object","div"],attributes:{a:["href","title","id","class","target","data-gentics-aloha-repository","data-gentics-aloha-object-id"],div:["id","class","style"],abbr:["title"],blockquote:["cite"],br:["class"],col:["span","width"],colgroup:["span","width"],img:["align","alt","height","src","title","width","class","data-caption","data-align","data-width","data-original-image"],ol:["start","type"],p:["class","style","id"],q:["cite"],table:["summary","width"],td:["abbr","axis","colspan","rowspan",
"width"],th:["abbr","axis","colspan","rowspan","scope","width"],ul:["type"],span:["class","style","lang","xml:lang","role"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},img:{src:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}};return a.createHandler({handleContent:function(a){var l,m;if(j.activeEditable&&j.settings.contentHandler&&j.settings.contentHandler.handler&&j.settings.contentHandler.handler.sanitize){if(j.settings.contentHandler.handler.sanitize)m=
j.settings.contentHandler.handler.sanitize;if(typeof m["#"+j.activeEditable.getId()]!=="undefined")l=m;else for(var g=j.activeEditable.obj.attr("class").split(" "),k=0;k<g.length;k++)typeof m["."+g[k]]!=="undefined"&&(l=m["."+g[k]])}(typeof c==="undefined"||typeof l!=="undefined")&&d(l);typeof a==="string"?a=f("<div>"+a+"</div>").get(0):a instanceof f&&(a=f("<div>").append(a).get(0));return f("<div>").append(c.clean_node(a)).html()}})});define("contenthandler/blockelementcontenthandler",["aloha",
"jquery","aloha/contenthandlermanager"],function(j,f,a){var d={h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,p:!0,pre:!0,blockquote:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,P:!0,PRE:!0,BLOCKQUOTE:!0},c={br:!0,BR:!0},b=function(a,k){var e=f(k);e.filter("h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty,p:empty,pre:empty,blockquote:empty").remove();f.browser.msie?e.filter("br.aloha-end-br").remove():e.filter("li").each(function(){d[this.nodeName]&&(!this.lastChild||!c[this.lastChild.nodeName])&&f(this).append("<br/>")});
e.children(":not(.aloha-block)").each(b)},l=function(a,b){var c=f(b);c.filter("h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty,p:empty,pre:empty,blockquote:empty").append("​");c.children(":not(.aloha-block)").each(l)},m=function(a,b){var e=f(b);0<e.filter("p,h1,h2,h3,h4,h5,h6,pre,blockquote").length&&d[b.nodeName]&&(!b.lastChild||!c[b.lastChild.nodeName])&&f(b).append("<br/>");e.children(":not(.aloha-block)").each(m)};return a.createHandler({handleContent:function(a,c){"string"===typeof a?a=
f("<div>"+a+"</div>"):a instanceof f&&(a=f("<div>").append(a));c=c||{};"initEditable"===c.command?(a.children(":not(.aloha-block)").each(b),f.browser.msie&&7>=f.browser.version&&a.children(":not(.aloha-block)").each(l)):"getContents"===c.command&&(a.children(":not(.aloha-block)").each(m),a.find("li>br:last").remove());return a.html()}})});define("contenthandler/contenthandler-plugin","aloha aloha/plugin jquery aloha/contenthandlermanager contenthandler/wordcontenthandler contenthandler/genericcontenthandler contenthandler/oembedcontenthandler contenthandler/sanitizecontenthandler contenthandler/blockelementcontenthandler".split(" "),
function(j,f,a,d,c,b,l,m,g){return f.create("contenthandler",{settings:{},dependencies:[],init:function(){var a={word:c,generic:b,sanitize:m,blockelement:g},e;for(e in a)a.hasOwnProperty(e)&&d.register(e,a[e])}})});define("characterpicker/nls/i18n",{root:{"button.addcharacter.tooltip":"pick special characters"},de:!0});define("characterpicker/characterpicker-plugin","aloha jquery aloha/plugin ui/ui ui/button i18n!characterpicker/nls/i18n i18n!aloha/nls/i18n".split(" "),function(j,f,a,d,c,b){function l(a){this.$node=
f('<table class="aloha-character-picker-overlay" unselectable="on" role="dialog"><tbody></tbody></table>');this.$node.mousedown(function(){return false});this.onSelectCallback=a;this.$tbody=this.$node.find("tbody");this.$node.appendTo(f("body"));this._initHideOnDocumentClick();this._initHideOnEsc();this._initCursorFocus(a);this._initEvents()}function m(a){if(j.activeEditable){k.select();j.execCommand("insertHTML",false,a)}}var g={},k;l.prototype={show:function(a){this.$node.css(f(a).offset());this.$node.show();
this.$node.find(".focused").removeClass("focused");f(this.$node.find("td")[0]).addClass("focused");this._overlayActive=true},hide:function(){this.$node.hide();this._overlayActive=false},setCharacters:function(a){this._createCharacterButtons(a)},_initHideOnDocumentClick:function(){var a=this;a.$node.click(function(a){a.stopPropagation()});f("body").click(function(b){a._overlayActive&&b.target!==a.$node[0]&&(!f(b.target).is(".aloha-icon-characterpicker")&&!f(b.target).find(".aloha-icon-characterpicker").length)&&
a.hide()})},_initHideOnEsc:function(){var a=this;f(document).keyup(function(b){a.$node.css("display")==="table"&&b.keyCode===27&&a.hide()})},_initCursorFocus:function(a){var b=this,c,d,g,k,l,m={13:function(){c=b.$node.find(".focused");b.hide();a(c.text())},37:function(){c=b.$node.find(".focused");g=c.prev().addClass("focused");g.length>0&&c.removeClass("focused")},38:function(){c=b.$node.find(".focused");l=c.parent().prev();if(l.length>0){g=f(l.children()[c.index()]).addClass("focused");g.length>
0&&c.removeClass("focused")}},39:function(){c=b.$node.find(".focused");d=c.next().addClass("focused");d.length>0&&c.removeClass("focused")},40:function(){c=b.$node.find(".focused");k=c.parent().next();if(k.length>0){d=f(k.children()[c.index()]).addClass("focused");d.length>0&&c.removeClass("focused")}}};f(document).keydown(function(a){a.stopPropagation();if(b.$node.css("display")==="table")if(a=m[a.keyCode]){a();return false}})},_initEvents:function(){var a=this;j.bind("aloha-editable-deactivated",
function(){a.hide()})},_createCharacterButtons:function(a){var b=this,c=document.createElement("textarea");c.innerHTML=a;for(var a=c.value,a=f.grep(a.split(" "),function(a){return a!==""}),c=["<tr>"],d=0,g;g=a[d];){0!==d&&d%15===0&&c.push("</tr><tr>");c.push('<td unselectable="on">'+g+"</td>");d++}c.push("</tr>");b.$tbody.empty().append(c.join(""));b.$node.delegate("td","mouseover",function(){f(this).addClass("mouseover")}).delegate("td","mouseout",function(){f(this).removeClass("mouseover")}).delegate("td",
"click",function(){b.$node.hide();var a=f(this).text();b.onSelectCallback(a)})}};return a.create("characterpicker",{_constructor:function(){this._super("characterpicker")},languages:["en"],config:"&#38; &#34; &#162; &#8364; &#163; &#165; &#169; &#174; &#8482; &#8240; &#181; &#183; &#8226; &#8230; &#8242; &#8243; &#167; &#182; &#223; &#8249; &#8250; &#171; &#187; &#8216; &#8217; &#8220; &#8221; &#8218; &#8222; &#60; &#62; &#8804; &#8805; &#8211; &#8212; &#175; &#8254; &#164; &#166; &#168; &#161; &#191; &#710; &#732; &#176; &#8722; &#177; &#247; &#8260; &#215; &#185; &#178; &#179; &#188; &#189; &#190; &#402; &#8747; &#8721; &#8734; &#8730; &#8764; &#8773; &#8776; &#8800; &#8801; &#8712; &#8713; &#8715; &#8719; &#8743; &#8744; &#172; &#8745; &#8746; &#8706; &#8704; &#8707; &#8709; &#8711; &#8727; &#8733; &#8736; &#180; &#184; &#170; &#186; &#8224; &#8225; &#192; &#193; &#194; &#195; &#196; &#197; &#198; &#199; &#200; &#201; &#202; &#203; &#204; &#205; &#206; &#207; &#208; &#209; &#210; &#211; &#212; &#213; &#214; &#216; &#338; &#352; &#217; &#218; &#219; &#220; &#221; &#376; &#222; &#224; &#225; &#226; &#227; &#228; &#229; &#230; &#231; &#232; &#233; &#234; &#235; &#236; &#237; &#238; &#239; &#240; &#241; &#242; &#243; &#244; &#245; &#246; &#248; &#339; &#353; &#249; &#250; &#251; &#252; &#253; &#254; &#255; &#913; &#914; &#915; &#916; &#917; &#918; &#919; &#920; &#921; &#922; &#923; &#924; &#925; &#926; &#927; &#928; &#929; &#931; &#932; &#933; &#934; &#935; &#936; &#937; &#945; &#946; &#947; &#948; &#949; &#950; &#951; &#952; &#953; &#954; &#955; &#956; &#957; &#958; &#959; &#960; &#961; &#962; &#963; &#964; &#965; &#966; &#967; &#968; &#969; &#8501; &#982; &#8476; &#977; &#978; &#8472; &#8465; &#8592; &#8593; &#8594; &#8595; &#8596; &#8629; &#8656; &#8657; &#8658; &#8659; &#8660; &#8756; &#8834; &#8835; &#8836; &#8838; &#8839; &#8853; &#8855; &#8869; &#8901; &#8968; &#8969; &#8970; &#8971; &#9001; &#9002; &#9674; &#9824; &#9827; &#9829; &#9830;",
init:function(){function a(b){if(b<j.editables.length){g.getOverlayForEditable(j.editables[b]);setTimeout(function(){a(b+1)},100)}}var g=this;if(typeof j.settings.plugins!="undefined"&&typeof j.settings.plugins.characterpicker!="undefined")g.settings=j.settings.plugins.characterpicker;this._characterPickerButton=d.adopt("characterPicker",c,{tooltip:b.t("button.addcharacter.tooltip"),icon:"aloha-icon-characterpicker",scope:"Aloha.continuoustext",click:function(){if(false!==g.characterOverlay){k=j.Selection.rangeObject;
g.characterOverlay.show(this.element)}}});setTimeout(function(){a(0)},100);j.bind("aloha-editable-activated",function(a,b){g.characterOverlay=g.getOverlayForEditable(b.editable);g.characterOverlay?g._characterPickerButton.show():g._characterPickerButton.hide()})},getOverlayForEditable:function(a){var a=this.getEditableConfig(a.obj),b;if(!a)return false;f.isArray(a)&&(a=a.join(" "));b=g[a];if(!b){b=new l(m);b.setCharacters(a);g[a]=b}return b}})});define("commands/inserthtml","aloha/core jquery aloha/command aloha/selection util/dom aloha/contenthandlermanager aloha/console".split(" "),
function(j,f,a,d,c,b,l){a.register("inserthtml",{action:function(a,d){function k(a){var b=f(a);if(!c.insertIntoDOM(b,d,e,false)){b=b.contents();(c.isBlockLevelElement(a)||c.isListElement(a))&&k(f("<br/>").get(0));for(o=b.length-1;o>=0;--o)k(b[o])}}var e=f(c.getEditingHostOf(d.startContainer)),p=d.commonAncestorContainer,o,r=[],a=b.handleContent(a,{contenthandler:j.settings.contentHandler.insertHtml});if(typeof a==="string")a=f("<div>"+a+"</div>");else if(a instanceof f)a=f("<div>").append(a);else throw"INVALID_VALUE_ERR";
r=a.contents();c.removeRange(d);for(o=r.length-1;o>=0;--o)k(r[o]);r.length>0?d=c.setCursorAfter(r.get(r.length-1)):d.select();c.doCleanup({merge:true,removeempty:true},d,p);try{d.select()}catch(q){l.warn("Error:",q)}}})});define("commands/commands-plugin",["aloha/command","./inserthtml"],function(){});define("block/blockmanager","aloha jquery ui/scopes aloha/observable aloha/registry util/class util/strings util/maps".split(" "),function(j,f,a,d,c,b,l,m){var g=window.GENTICS,k=new (b.extend(d,{defaults:{"aloha-block-type":"DefaultBlock"},
blockTypes:null,blocks:null,_highlightedBlocks:null,_activeBlock:null,_dragdropEnabled:true,_constructor:function(){a.createScope("Aloha.Block");this.blockTypes=new c;this.blocks=new c;this._highlightedBlocks={}},registerEventHandlers:function(){var a=this;this._registerEventHandlersForDeactivatingAlohaBlock();this._registerEventHandlersForDeterminingCurrentlyActiveBlock();this._registerEventHandlersForBlockDeletion();this._registerEventHandlersForCutCopyPaste();j.bind("aloha-selection-changed",function(b,
c){c&&f(c.getCommonAncestorContainer()).parents(".aloha-block").length>0||a._deactivateHighlightedBlocks()})},_registerEventHandlersForDeactivatingAlohaBlock:function(){var a=this;f(document).bind("click",function(b){m.isEmpty(a._highlightedBlocks)||f(b.target).closest(".aloha-ui,.aloha-block-do-not-deactivate,.aloha-block").length>0||a._deactivateHighlightedBlocks()})},_registerEventHandlersForDeterminingCurrentlyActiveBlock:function(){var a=this;this.bind("block-selection-change",function(b){a._activeBlock=
b.length>0?b[0]:null})},_registerEventHandlersForBlockDeletion:function(){var a=this;j.bind("aloha-command-will-execute",function(b,c){var d=c.commandId,g=j.getSelection().getRangeCount()===0||j.getSelection().getRangeCount()===1&&j.getSelection().getRangeAt(0).endContainer===j.getSelection().getRangeAt(0).startContainer&&j.getSelection().getRangeAt(0).endContainer===f("body")[0]||j.getSelection().getRangeCount()===1&&j.getSelection().getRangeAt(0).endContainer===j.getSelection().getRangeAt(0).startContainer&&
j.getSelection().getRangeAt(0).startOffset+1===j.getSelection().getRangeAt(0).endOffset;if(a._activeBlock&&(d==="delete"||d==="forwarddelete")&&g){c.preventDefault=true;a._activeBlock.destroy()}else if(!a._activeBlock&&(d==="delete"||d==="forwarddelete")&&j.getSelection().getRangeCount()===1&&j.getSelection().getRangeAt(0).collapsed===false){var k;k=function(a){for(var b,c=0,e=a.length;c<e;c++){b=a[c];if(b.domobj.nodeType===1){var d=f(b.domobj);b.selection==="full"&&d.is(".aloha-block")?d.remove():
k(b.children)}}};k(j.Selection.getSelectionTree())}});f(window.document).keydown(function(b){if(typeof b.srcElement!=="undefined"&&typeof b.srcElement.form!=="undefined")return true;if(a._activeBlock&&(b.which===46||b.which===8)&&a._activeBlock._isInsideNestedEditable===false){if(f.browser.msie&&parseInt(f.browser.version,10)<=8&&a._activeBlock.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable")){a._activeBlock.destroy();b.preventDefault();return false}if(a._activeBlock.shouldDestroy()){a._activeBlock.destroy();
b.preventDefault();return false}}})},_registerEventHandlersForCutCopyPaste:function(){var a=this,b=false,c=false,d=null;f(window.document).keydown(function(d){if(a._activeBlock&&(d.ctrlKey||d.metaKey)&&d.which===67){b=true;a._activeBlock.$element.attr("data-aloha-block-copy-only-block","true");g.Utils.Dom.selectDomNode(a._activeBlock.$element[0])}if(a._activeBlock&&(d.ctrlKey||d.metaKey)&&d.which===88){c=true;a._activeBlock.$element.attr("data-aloha-block-copy-only-block","true");g.Utils.Dom.selectDomNode(a._activeBlock.$element[0])}});
f(window.document).keyup(function(g){if(!c&&b&&(g.which===67||g.which===18||g.which===91)){b=false;a._activeBlock.$element.removeAttr("data-aloha-block-copy-only-block");d&&(d=null)}if(c&&(g.which===67||g.which===18||g.which===88))c=false})},initializeBlockLevelDragDrop:function(){var a=this;f.each(j.editables,function(b,c){c.obj.data("block-dragdrop",a._dragdropEnabled);a.createBlockLevelSortableForEditableOrBlockCollection(c.obj)});j.bind("aloha-editable-created",function(b,c){c.obj.data("block-dragdrop",
a._dragdropEnabled);a.createBlockLevelSortableForEditableOrBlockCollection(c.obj)})},createBlockLevelSortableForEditableOrBlockCollection:function(a){if(!a.hasClass("aloha-block-blocklevel-sortable")){a.addClass("aloha-block-blocklevel-sortable").sortable({revert:100,handle:".aloha-block-draghandle-blocklevel",connectWith:".aloha-block-blocklevel-sortable.aloha-block-dropzone",disabled:!this._dragdropEnabled,start:function(a,b){b.item.data("block-sort-allowed",b.item.parents(".aloha-block-dropzone").length>
0)},change:function(a,b){b.item.data("block-sort-allowed",b.placeholder.parents(".aloha-block-dropzone").length>0)},stop:function(a,b){b.item.data("block-sort-allowed")||f(this).sortable("cancel");b.item.removeData("block-sort-allowed")}});a.get(0).ondragstart=function(a,b){if(!b||!b.helper||!b.helper.is(".aloha-block"))return false}}},setDragDropState:function(a){this._dragdropEnabled=a},getDragDropState:function(){return this._dragdropEnabled},registerBlockType:function(b,c){a.createScope("Aloha.Block."+
b,"Aloha.Block");this.blockTypes.register(b,c)},_blockify:function(a,b){var c=f(a),d=j.require("block/block-plugin"),g=c[0].tagName.toLowerCase();if(f.inArray(g,d.settings.rootTags)===-1)j.Log.error("block/blockmanager","Blocks can only be created from ["+d.settings.rootTags.join(", ")+"]] element. You passed "+g+".");else{d=this.getConfig(c,b);if(this.blockTypes.has(d["aloha-block-type"])){c=new (this.blockTypes.get(d["aloha-block-type"]))(c,d);c.$element.addClass("aloha-block-"+d["aloha-block-type"]);
this.blocks.register(c.getId(),c)}else j.Log.error("block/blockmanager","Block Type "+d["aloha-block-type"]+" not found!")}},_unblockify:function(a){(a=this.getBlock(a))&&a.unblock()},getConfig:function(a,b){var c=a.clone(true),d=c.data(),g={};c.removeData();for(var k in d)d.hasOwnProperty(k)&&(g[l.camelCaseToDashes(k)]=d[k]);return f.extend({},this.defaults,b,g)},getBlock:function(a){if(typeof a==="object"){a=f(a);a.hasClass("aloha-block-inner")&&(a=a.parent());a=a.attr("id")}return this.blocks.get(a)},
_unregisterBlock:function(a){this.blocks.unregister(typeof a==="object"?a.getId():a)},_deactivateHighlightedBlocks:function(){f.each(f.extend({},this._highlightedBlocks),function(a){(a=k.getBlock(a))&&a.deactivate()})},_getHighlightedBlocks:function(){var a={};f.each(this.blocks.getEntries(),function(b,c){c.isActive()&&(a[b]=c)});return a},_setHighlighted:function(a){this._highlightedBlocks[a.id]=true},_setUnhighlighted:function(a){delete this._highlightedBlocks[a.id]}}));j.Block=j.Block||{};return j.Block.BlockManager=
k});define("block/editormanager",["aloha/registry"],function(j){return new (j.extend({createEditor:function(f){if(!this.has(f.type))throw'Editor for type "'+f.type+'" not found.';return new (this.get(f.type))(f)}}))});define("block/sidebarattributeeditor",["jquery","block/blockmanager","aloha/sidebar","block/editormanager","util/class"],function(j,f,a,d,c){return new (c.extend({_sidebar:null,init:function(){this._sidebar=a.right.show();f.bind("block-selection-change",this._onBlockSelectionChange,
this)},_onBlockSelectionChange:function(a){var c=this;this._sidebar&&j.each(a,function(){var a=this.getSchema(),b=this,f=[];a&&c._sidebar.addPanel({title:b.getTitle(),expanded:!0,onInit:function(){var c=j("<form />");c.submit(function(){return!1});j.each(a,function(a,l){var m=d.createEditor(l);m.bind("change",function(c){b.attr(a,c)});b.bind("change",function(){m.setValue(b.attr(a))});c.append(m.render());m.setValue(b.attr(a));f.push(m)});this.setContent(c)},deactivate:function(){j.each(f,function(a,
b){b._deactivate()});this.isActive=!1;this.effectiveElement=null}})})}}))});define("block/block","aloha jquery block/blockmanager aloha/observable ui/scopes util/class PubSub".split(" "),function(j,f,a,d,c,b,l){function m(a){a=a.closest(".aloha-editable");return a.length?!!a.data("block-dragdrop"):true}var g=window.GENTICS,d=b.extend(d,{title:null,id:null,$element:null,_currentlyRendering:false,_initialized:false,_isInsideNestedEditable:false,_constructor:function(a,b){var c=this;this.$element=a;
if(a.attr("id"))this.id=a.attr("id");else{this.id=g.Utils.guid();a.attr("id",this.id)}a.contentEditable(false);a.addClass("aloha-block");if(this.isDraggable()){a.find("img").attr("draggable","false");a.find("a").attr("draggable","false")}f.each(b,function(a,b){c._setAttribute(a,b)});this._onElementClickHandler=function(a){if(f(a.target).closest(".aloha-block").get(0)===c.$element.get(0)){c._fixScrollPositionBugsInIE();c.activate(a.target,a)}};this._connectThisBlockToDomElement(a,function(){l.pub("aloha.block.initialized",
{block:c})});this._initialized=true},_onElementClickHandler:null,_preventSelectionChangedEventHandler:function(){j.Selection.preventSelectionChanged()},_connectThisBlockToDomElement:function(a,b){var c=this,e=f(a);this._disconnectFromDomElement();this.$element=e;this.$element.bind("click",this._onElementClickHandler);this.$element.bind("mousedown",this._preventSelectionChangedEventHandler);this.$element.bind("focus",this._preventSelectionChangedEventHandler);this.$element.bind("dblclick",this._preventSelectionChangedEventHandler);
this.init(this.$element,function(){window.setTimeout(function(){c._postProcessElementIfNeeded();b&&b()},5)})},_disconnectFromDomElement:function(){if(this.$element){this.$element.unbind("click",this._onElementClickHandler);this.$element.unbind("mousedown",this._preventSelectionChangedEventHandler);this.$element.unbind("focus",this._preventSelectionChangedEventHandler);this.$element.unbind("dblclick",this._preventSelectionChangedEventHandler)}},_fixScrollPositionBugsInIE:function(){var a=f(window).scrollTop();
window.setTimeout(function(){f(window).scrollTop()!==a&&f(window).scrollTop(a)},10)},init:function(a,b){b()},shouldDestroy:function(){var a=this.$element.parent().closest(".aloha-block,.aloha-editable,.aloha-block-collection");return a.hasClass("aloha-block-collection")&&this.$element[0].tagName.toLowerCase()==="div"?true:a.hasClass("aloha-editable")},destroy:function(b){if(this.shouldDestroy()||b===true){var c=this,e=new g.Utils.RangeObject;e.startContainer=e.endContainer=this.$element.parent()[0];
e.startOffset=e.endOffset=g.Utils.Dom.getIndexInParent(this.$element[0]);a.trigger("block-delete",this);this.free();var d=this.$element[0].tagName.toLowerCase()==="span";this.$element.fadeOut("fast",function(){c.$element.remove();a.trigger("block-selection-change",[]);window.setTimeout(function(){d&&e.select()},5)})}},unblock:function(){this.deactivate();this._disconnectFromDomElement();this.$element.removeClass("aloha-block");this.$element.children(".aloha-block-handle").remove();this.free()},free:function(){a._unregisterBlock(this);
this.unbindAll()},getId:function(){return this.id},getSchema:function(){return null},getTitle:function(){return this.title},isDraggable:function(){return this.$element[0].tagName.toLowerCase()==="div"&&this.$element.parents(".aloha-editable,.aloha-block,.aloha-block-collection").first().hasClass("aloha-block-collection")?true:this.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable")},activate:function(b,e){var d=[];f.each(a._getHighlightedBlocks(),function(){this.deactivate()});
this.$element.attr("data-block-skip-scope")!=="true"&&c.setScope("Aloha.Block."+this.attr("aloha-block-type"));this.$element.addClass("aloha-block-active");this._highlight();d.push(this);this.$element.parents(".aloha-block").each(function(){var b=a.getBlock(this);if(b){b._highlight();d.push(b)}});if(f(b).closest(".aloha-editable,.aloha-block,.aloha-table-cell-editable").first().hasClass("aloha-block")){this._isInsideNestedEditable=false;j.getSelection().removeAllRanges()}else{this._isInsideNestedEditable=
true;e&&j.Selection.updateSelection(e)}a.trigger("block-activate",d);a.trigger("block-selection-change",d)},deactivate:function(){var b=this,c=[this];this._unhighlight();this.$element.parents(".aloha-block").each(function(){c.push(this);b._unhighlight()});this.$element.removeClass("aloha-block-active");a.trigger("block-deactivate",c);a.trigger("block-selection-change",[])},isActive:function(){return this.$element.hasClass("aloha-block-active")},_highlight:function(){this.$element.addClass("aloha-block-highlighted");
a._setHighlighted(this)},_unhighlight:function(){this.$element.removeClass("aloha-block-highlighted");a._setUnhighlighted(this)},_update:function(){var a=this;if(!this._currentlyRendering&&this._initialized){this._currentlyRendering=true;this.update(this.$element,function(){a._postProcessElementIfNeeded()});this._currentlyRendering=false}},update:function(a,b){b()},_postProcessElementIfNeeded:function(){this.createEditablesIfNeeded();this._checkThatNestedBlocksAreStillConsistent();this._makeNestedBlockCollectionsSortable();
this.renderBlockHandlesIfNeeded();if(this.isDraggable()&&this.$element[0].tagName.toLowerCase()==="span"){this._setupDragDropForInlineElements();this._disableUglyInternetExplorerDragHandles()}else if(this.isDraggable()&&this.$element[0].tagName.toLowerCase()==="div"){this._setupDragDropForBlockElements();this._disableUglyInternetExplorerDragHandles()}this._hideDragHandlesIfDragDropDisabled();this._attachDropzoneHighlightEvents()},_checkThatNestedBlocksAreStillConsistent:function(){this.$element.find(".aloha-block").each(function(){var b=
a.getBlock(this);b&&b.$element[0]!==this&&b._connectThisBlockToDomElement(this)})},_makeNestedBlockCollectionsSortable:function(){var b=this;this.$element.find(".aloha-block-collection").each(function(){var c=f(this);c.closest(".aloha-block").get(0)===b.$element.get(0)&&a.createBlockLevelSortableForEditableOrBlockCollection(c)})},_disableUglyInternetExplorerDragHandles:function(){if(f.browser.msie){this.$element.get(0).onresizestart=function(){return false};this.$element.get(0).oncontrolselect=function(){return false};
this.$element.get(0).onmovestart=function(){return false}}},_hideDragHandlesIfDragDropDisabled:function(){this._dd_isDragdropEnabled()||this.$element.find(".aloha-block-draghandle").each(function(){var a=f(this);m(a)||a.removeClass("aloha-block-draghandle")})},_attachDropzoneHighlightEvents:function(){var a=this;this.$element.delegate(".aloha-block-draghandle","mousedown",function(){var b=a.$element.parents(".aloha-editable").first().data("block-dropzones")||[];f.each(b,function(a,b){var c=f(b);f(c).each(function(){f(this).data("block-dragdrop")&&
f(this).addClass("aloha-block-dropzone")})});f(document).one("mouseup.aloha-block-dropzone",function(){var b=a.$element.parents(".aloha-editable").first().data("block-dropzones")||[];f.each(b,function(a,b){f(b).removeClass("aloha-block-dropzone")})})})},_setupDragDropForInlineElements:function(){var a=this,b=null,c=false,e=null,d=null,g=function(){if(b){var g=f(b);if(g.is(".aloha-block-dropInlineElementIntoEmptyBlock")){g.children().remove();g.append(e)}else if(g.is(".aloha-block-droppable-right")){g.html(g.html()+
" ");g.after(e)}else{g.prev("[data-i]").length>0&&g.prev("[data-i]").html(g.prev("[data-i]").html()+" ");g.html(" "+g.html());g.before(e)}e.removeClass("ui-draggable").css({left:0,top:0});a._fixScrollPositionBugsInIE()}f(".aloha-block-dropInlineElementIntoEmptyBlock").removeClass("aloha-block-dropInlineElementIntoEmptyBlock");d.droppable("destroy");d=null;c=true},k=[];this.$element.draggable({handle:".aloha-block-draghandle",scope:"aloha-block-inlinedragdrop",disabled:!this._dd_isDragdropEnabled(),
revert:function(){return b===null||!c},revertDuration:250,stop:function(){f.browser.msie&&7===parseInt(f.browser.version,10)&&g();f.each(k,function(){a._dd_traverseDomTreeAndRemoveSpans(this)});e=null;k=[]},start:function(){c=false;k=[];f(".aloha-editable").children("p:empty").html("&nbsp;");var l={tolerance:"pointer",addClasses:false,scope:"aloha-block-inlinedragdrop",over:function(c,d){f.inArray(this,k)===-1&&k.push(this);var g=1===f(this).contents().length&&1===f(this).children("br").length;e=
d.draggable;if(f(this).is(":empty")||g||f(this).html()==="&nbsp;"){f(this).addClass("aloha-block-dropInlineElementIntoEmptyBlock");b=this}else{a._dd_traverseDomTreeAndWrapCharactersWithSpans(this);f("span[data-i]",this).droppable({tolerance:"pointer",addClasses:false,scope:"aloha-block-inlinedragdrop",over:function(){b&&f(b).removeClass("aloha-block-droppable");b=this;f(this).addClass("aloha-block-droppable")},out:function(){f(this).removeClass("aloha-block-droppable");b===this&&(b=null)}});f.ui.ddmanager.prepareOffsets(d.draggable.data("draggable"),
c)}},out:function(){f(this).removeClass("aloha-block-dropInlineElementIntoEmptyBlock")},drop:function(){f.browser.msie&&7===parseInt(f.browser.version,10)||g()}};d=f(".aloha-editable.aloha-block-dropzone").children(":not(.aloha-block)");d.droppable(l);f(".aloha-table-cell-editable").droppable(l)}})},_dd_traverseDomTreeAndWrapCharactersWithSpans:function(a){for(var b,c=0,e=a.childNodes.length;c<e;c++){b=a.childNodes[c];if(b.nodeType===1)if(!~b.className.indexOf("aloha-block")&&b.attributes["data-i"]===
void 0)this._dd_traverseDomTreeAndWrapCharactersWithSpans(b);else{if(b.attributes["data-i"])break}else if(b.nodeType===3){b=this._dd_insertSpans(b);c=c+b;e=e+b}}},_dd_splitText:function(a){for(var a=a.split(/(?=\b)/),b=[],c=false,e=0,d=a.length;e<d;e++)if(/[^\t\n\r ]/.test(a[e]))if(c){b.push(" "+a[e]);c=false}else b.push(a[e]);else c=true;c&&(b[b.length-1]=b[b.length-1]+" ");return b},_dd_insertSpans:function(a){var b=a.nodeValue;if(!/[^\t\n\r ]/.test(b))return 0;for(var c=document.createDocumentFragment(),
b=this._dd_splitText(b),e=b.length,d,g,k,l=0,m=0;m<e;m++){g=b[m];if(g.length!==0){k=Math.floor(g.length/2);d=parseInt(f.browser.version,10);if(f.browser.msie&&(7===d||8===d))k=0;if(k>0){d=document.createElement("span");d.appendChild(document.createTextNode(g.substr(0,k)));d.setAttribute("data-i",m);c.appendChild(d);l++}d=document.createElement("span");g=g.substr(k);d.appendChild(document.createTextNode(g));d.setAttribute("data-i",m);d.setAttribute("class","aloha-block-droppable-right");c.appendChild(d);
l++}}a.parentNode.replaceChild(c,a);return l-1},_dd_traverseDomTreeAndRemoveSpans:function(a){var b=[],c;c=function(a){for(var e=false,d,g,f,k=0,l=a.childNodes.length;k<l;k++){f=a.childNodes[k];if(f.nodeType===1)if(f.attributes["data-i"]!==void 0){if(!e){e=true;d="";g=void 0}if(e){d=d+f.firstChild.nodeValue;g&&b.push(g);g=f}}else{if(e){e=false;g.parentNode.replaceChild(document.createTextNode(d),g)}~f.className.indexOf("aloha-block")||c(f)}}e&&g.parentNode.replaceChild(document.createTextNode(d),
g)};c(a);for(var a=0,e=b.length;a<e;a++)b[a].parentNode.removeChild(b[a])},_dd_isDragdropEnabled:function(){return m(this.$element.parent())},_setupDragDropForBlockElements:function(){this.$element.find(".aloha-block-draghandle").addClass("aloha-block-draghandle-blocklevel")},createEditablesIfNeeded:function(){this.$element.find(".aloha-editable").aloha()},renderBlockHandlesIfNeeded:function(){this.isDraggable()&&this.$element.children(".aloha-block-draghandle").length===0&&this.$element.prepend('<span class="aloha-block-handle aloha-block-draghandle"></span>')},
attr:function(a,b,c){var e=this,d=false;if(arguments.length>=2){if(a.substr(0,12)==="aloha-block-"){j.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+a+")");return}this._getAttribute(a)!==b&&(d=true);this._setAttribute(a,b)}else if(typeof a==="object")f.each(a,function(a,b){if(a.substr(0,12)==="aloha-block-")j.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+
a+")");else{e._getAttribute(a)!==b&&(d=true);e._setAttribute(a,b)}});else return typeof a==="string"?this._getAttribute(a):this._getAttributes();if(d&&!c){this._update();this.trigger("change")}return null},_setAttribute:function(a,b){this.$element.attr("data-"+a.toLowerCase(),b)},_getAttribute:function(a){return this.$element.attr("data-"+a.toLowerCase())},_getAttributes:function(){var a={};f.each(this.$element[0].attributes,function(b,c){if(c.name.substr(0,5)==="data-")a[c.name.substr(5).toLowerCase()]=
c.value});return a}}),b=d.extend({update:function(a,b){b()}}),k=d.extend({title:"Debugging",init:function(a,b){this.update(a,b)},update:function(a,b){a.css({display:"block"});var c='<table class="debug-block">';f.each(this.attr(),function(a,b){c=c+("<tr><th>"+a+"</th><td>"+b+"</td></tr>")});c=c+"</table>";a.html(c);b()}}),e=d.extend({title:"EmptyBlock",init:function(){},activate:function(){},deactivate:function(){},renderBlockHandlesIfNeeded:function(){}});return{AbstractBlock:d,DefaultBlock:b,DebugBlock:k,
EmptyBlock:e}});define("block/blockcontenthandler",["jquery","aloha/contenthandlermanager","block/blockmanager"],function(j,f,a){return f.createHandler({handleContent:function(d){"string"===typeof d?d=j("<div>"+d+"</div>"):d instanceof j&&(d=j("<div>").append(d));0<d.find('.aloha-block[data-aloha-block-copy-only-block="true"]').length&&(d.find(".aloha-block:not([id])").remove(),d.find(".aloha-block + span:empty").remove(),d.find("div:empty").remove(),d.find("br.Apple-interchange-newline").remove(),
d.find(".aloha-block").prev("br").remove(),d.find("div > br:only-child").parent().remove());d.find(".aloha-block").each(function(){var c=j(this),b={},d={};j.each(c[0].attributes,function(a,c){if(c.nodeName!=="id")c.nodeName.match(/^data-/)?d[c.nodeName.substr(5)]=c.nodeValue:b[c.nodeName]=c.nodeValue});var f=GENTICS.Utils.guid(),g=j("<"+this.tagName+"/>").attr(b).attr("id",f).removeClass("aloha-block-active").removeClass("aloha-block").html(c.html());c.replaceWith(g);window.setTimeout(function(){a._blockify(j("#"+
f),d)},50)});return d.html()}})});define("block/editor",["jquery","aloha/observable","util/class"],function(j,f,a){var f=a.extend(f,{schema:null,_constructor:function(a){this.schema=a},render:function(){},getValue:function(){},setValue:function(){},destroy:function(){},_deactivate:function(){this.trigger("change",this.getValue());this.destroy()}}),a=f.extend({formInputElementDefinition:null,_$formInputElement:null,render:function(){var a=j('<div class="aloha-block-editor" />'),b=GENTICS.Utils.guid();
a.append(this.renderLabel().attr("id",b));a.append(this.renderFormElement().attr("id",b));return a},renderLabel:function(){var a=j("<label />");a.html(this.schema.label);return a},renderFormElement:function(){var a=this;this._$formInputElement=j(this.formInputElementDefinition);this.afterRenderFormElement(this._$formInputElement);this._$formInputElement.change(function(){a.trigger("change",a.getValue())});return this._$formInputElement},afterRenderFormElement:function(){},getValue:function(){return this._$formInputElement.val()},
setValue:function(a){this._$formInputElement.val(a)},destroy:function(){this._$formInputElement.remove()}}),d=a.extend({formInputElementDefinition:'<input type="text" />'}),c=a.extend({formInputElementDefinition:'<input type="range" />',afterRenderFormElement:function(a){this.schema.range&&(this.schema.range.min&&a.attr("min",this.schema.range.min),this.schema.range.max&&a.attr("max",this.schema.range.max),this.schema.range.step&&a.attr("step",this.schema.range.step))}}),b=a.extend({formInputElementDefinition:'<input type="url" />'}),
l=a.extend({formInputElementDefinition:'<input type="email" />'}),m=a.extend({formInputElementDefinition:"<select />",afterRenderFormElement:function(a){j.each(this.schema.values,function(){a.append(j("<option />").attr("value",this.key).html(this.label))})}}),g=a.extend({formInputElementDefinition:"<button />",afterRenderFormElement:function(a){var b=this;a.html(this.schema.buttonLabel);a.click(function(){b.schema.callback()})}});return{AbstractEditor:f,AbstractFormElementEditor:a,StringEditor:d,
NumberEditor:c,UrlEditor:b,EmailEditor:l,SelectEditor:m,ButtonEditor:g}});define("block/nls/i18n",{root:{"button.toggledragdrop.tooltip":"Toggle Drag & Drop"},fr:!0,en:!0});define("block/block-plugin","aloha aloha/plugin jquery aloha/contenthandlermanager block/blockmanager block/sidebarattributeeditor block/block block/editormanager block/blockcontenthandler block/editor ui/ui ui/toggleButton i18n!block/nls/i18n i18n!aloha/nls/i18n jqueryui".split(" "),function(j,f,a,d,c,b,l,m,g,k,e,p,o){var r=["div",
"span"],f=f.create("block",{config:[],settings:{},init:function(){var a=this;if(!this.settings.rootTags)this.settings.rootTags=r;c.registerBlockType("DebugBlock",l.DebugBlock);c.registerBlockType("DefaultBlock",l.DefaultBlock);c.registerBlockType("EmptyBlock",l.EmptyBlock);m.register("string",k.StringEditor);m.register("number",k.NumberEditor);m.register("url",k.UrlEditor);m.register("email",k.EmailEditor);m.register("select",k.SelectEditor);m.register("button",k.ButtonEditor);d.register("block",
g);c.setDragDropState(a.isDragDropEnabled());c.registerEventHandlers();c.initializeBlockLevelDragDrop();j.bind("aloha-ready",function(){a._createBlocks();a.settings.sidebarAttributeEditor!==false&&b.init()});this.createButtons();j.bind("aloha-editable-created",function(b,c){a.setDropzones(c.obj)});j.bind("aloha-editable-activated",function(b,c){a.applyButtonConfig(c.editable)})},applyButtonConfig:function(a){if(this._isDragdropToggleEnabled(a)){this._toggleDragDropButton.show();this._toggleDragDropButton.setState(this._getDragdropState(a))}else this._toggleDragDropButton.hide()},
_isDragdropToggleEnabled:function(a){a=this.getEditableConfig(a.obj);return(this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal||a[0]==="toggleDragdrop"||a.toggleDragdrop==true||a.toggleDragdrop=="true"||a.toggleDragdrop==1||a.toggleDragdrop=="1")&&this.isDragDropEnabled()},_getDragdropState:function(a){return this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal?c.getDragDropState():a.obj.data("block-dragdrop")},_toggleDragdropState:function(a){if(this.settings&&
this.settings.config&&this.settings.config.toggleDragdropGlobal){var b=!c.getDragDropState();c.setDragDropState(b);for(var e=0;e<j.editables.length;e++){a=j.editables[e];this._setDragDropStateForEditable(a.obj,b)}}else{b=!a.obj.data("block-dragdrop");this._setDragDropStateForEditable(a.obj,b)}},createButtons:function(){var a=this;this._toggleDragDropButton=e.adopt("toggleDragDrop",p,{tooltip:o.t("button.toggledragdrop.tooltip"),icon:"aloha-icon aloha-icon-toggledragdrop",scope:"Aloha.continuoustext",
click:function(){a._toggleDragdropState(j.activeEditable)}})},setDropzones:function(a){var b=this.getEditableConfig(a);(b=b&&b.dropzones||this.settings.dropzones)?a.data("block-dropzones",b):a.data("block-dropzones",[".aloha-editable"])},isDragDropEnabled:function(){return this.settings&&typeof this.settings.dragdrop!=="undefined"?this.settings.dragdrop===true||this.settings.dragdrop==="true"||this.settings.dragdrop===1||this.settings.dragdrop==="1":true},_createBlocks:function(){if(!this.settings.defaults)this.settings.defaults=
{};a.each(this.settings.defaults,function(b,c){a(b).alohaBlock(c)})},_setDragDropStateForEditable:function(b,c){b.data("block-dragdrop",c);b.hasClass("ui-sortable")&&b.sortable("option","disabled",!c);b.find(".aloha-block.ui-draggable").each(function(){a(this).draggable("option","disabled",!c)});b.find(".aloha-block-handle").each(function(){c?a(this).addClass("aloha-block-draghandle"):a(this).removeClass("aloha-block-draghandle")})}});a.fn.alohaBlock=function(b){b=b||{};a(this).each(function(a,e){c._blockify(e,
b)});return a(this)};a.fn.mahaloBlock=function(){a(this).each(function(a,b){c._unblockify(b)})};return f});define("align/nls/i18n",{root:{"button.alignright.tooltip":"Align to the right","button.alignleft.tooltip":"Align to the left","button.aligncenter.tooltip":"Center","button.alignjustify.tooltip":"Justify"},fr:!0,en:!0});define("align/align-plugin","aloha aloha/plugin ui/ui ui/toggleButton i18n!align/nls/i18n i18n!aloha/nls/i18n jquery PubSub".split(" "),function(j,f,a,d,c,b,l,m){var g=window.GENTICS;
return f.create("align",{_constructor:function(){this._super("align")},languages:["en","fr"],config:{alignment:["right","left","center","justify"]},alignment:"",lastAlignment:"",init:function(){this.createButtons();var a=this;j.bind("aloha-editable-activated",function(b,c){a.applyButtonConfig(c.editable.obj)});m.sub("aloha.selection.context-change",function(b){b=b.range;j.activeEditable&&a.buttonPressed(b)})},buttonPressed:function(a){var b=this;a.findMarkup(function(){b.alignment=l(this).css("text-align")},
j.activeEditable.obj);if(this.alignment!=this.lastAlignment){this._alignRightButton.setState(false);this._alignLeftButton.setState(false);this._alignCenterButton.setState(false);this._alignJustifyButton.setState(false);switch(this.alignment){case "right":this._alignRightButton.setState(true);break;case "center":this._alignCenterButton.setState(true);break;case "justify":this._alignJustifyButton.setState(true);break;default:this._alignLeftButton.setState(true);this.alignment="left"}this.lastAlignment=
this.alignment}},applyButtonConfig:function(a){a=this.getEditableConfig(a);if(!a||!a.alignment||this.settings.alignment)if(a[0]&&a[0].alignment)a=a[0];else if(this.settings.alignment)a.alignment=this.settings.alignment;if(typeof a.alignment==="undefined")a=this.config;l.inArray("right",a.alignment)!=-1?this._alignRightButton.show(true):this._alignRightButton.show(false);l.inArray("left",a.alignment)!=-1?this._alignLeftButton.show(true):this._alignLeftButton.show(false);l.inArray("center",a.alignment)!=
-1?this._alignCenterButton.show(true):this._alignCenterButton.show(false);l.inArray("justify",a.alignment)!=-1?this._alignJustifyButton.show(true):this._alignJustifyButton.show(false)},createButtons:function(){var b=this;this._alignLeftButton=a.adopt("alignLeft",d,{tooltip:c.t("button.alignleft.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-left",scope:"Aloha.continuoustext",click:function(){b.align("left")}});this._alignCenterButton=a.adopt("alignCenter",d,{tooltip:c.t("button.aligncenter.tooltip"),
icon:"aloha-icon aloha-icon-align aloha-icon-align-center",scope:"Aloha.continuoustext",click:function(){b.align("center")}});this._alignRightButton=a.adopt("alignRight",d,{tooltip:c.t("button.alignright.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-right",scope:"Aloha.continuoustext",click:function(){b.align("right")}});this._alignJustifyButton=a.adopt("alignJustify",d,{tooltip:c.t("button.alignjustify.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-justify",scope:"Aloha.continuoustext",
click:function(){b.align("justify")}})},findAlignMarkup:function(a){var b=this;typeof a==="undefined"&&(a=j.Selection.getRangeObject());return j.activeEditable?a.findMarkup(function(){return l(this).css("text-align")==b.alignment},j.activeEditable.obj):null},align:function(a){var b=j.Selection.getRangeObject();this.lastAlignment=this.alignment;this.alignment=a;j.activeEditable&&(this.findAlignMarkup(b)?this.removeAlign():this.insertAlign())},insertAlign:function(){var a=this;if(!this.findAlignMarkup(b)){var b=
j.Selection.getRangeObject();g.Utils.Dom.isEditingHost(b.getCommonAncestorContainer())?l.each(j.Selection.getRangeObject().getSelectionTree(),function(){this.selection!=="none"&&this.domobj.nodeType!==3&&l(this.domobj).css("text-align",a.alignment)}):l(b.getCommonAncestorContainer()).css("text-align",this.alignment);if(this.alignment!=this.lastAlignment)switch(this.lastAlignment){case "right":this._alignRightButton.setState(false);break;case "left":this._alignLeftButton.setState(false);break;case "center":this._alignCenterButton.setState(false);
break;case "justify":this._alignJustifyButton.setState(false)}b.select()}},removeAlign:function(){var a=j.Selection.getRangeObject();if(this.findAlignMarkup(a)){a.findMarkup(function(){l(this).css("text-align","")},j.activeEditable.obj);a.select()}}})});define("abbr/nls/i18n",{root:{"floatingmenu.tab.abbr":"Abbreviation","button.addabbr.tooltip":"insert abbreviation","button.remabbr.tooltip":"remove abbreviation","button.abbr.tooltip":"format as abbreviation","newabbr.defaulttext":"Abbr"},de:!0});
define("abbr/abbr-plugin","aloha jquery aloha/plugin ui/ui ui/toggleButton ui/button ui/scopes ui/port-helper-attribute-field i18n!abbr/nls/i18n i18n!aloha/nls/i18n".split(" "),function(j,f,a,d,c,b,l,m,g){var k=window.GENTICS;return a.create("abbr",{languages:["en","de"],config:["abbr"],init:function(){this.createButtons();this.subscribeEvents();this.bindInteractions()},createButtons:function(){var a=this;this._formatAbbrButton=d.adopt("formatAbbr",c,{tooltip:g.t("button.abbr.tooltip"),icon:"aloha-icon aloha-icon-abbr",
scope:"Aloha.continuoustext",click:function(){a.formatAbbr()}});this._insertAbbrButton=d.adopt("insertAbbr",b,{tooltip:g.t("button.addabbr.tooltip"),icon:"aloha-icon aloha-icon-abbr",scope:"Aloha.continuoustext",click:function(){a.insertAbbr(false)}});l.createScope("abbr","Aloha.continuoustext");this.abbrField=m({width:320,name:"abbrText",scope:"abbr"});this.remAbbrButton=d.adopt("removeAbbr",b,{tooltip:g.t("button.remabbr.tooltip"),icon:"aloha-icon aloha-icon-abbr-rem",scope:"abbr",click:function(){a.removeAbbr()}})},
bindInteractions:function(){var a=this;this.abbrField.addListener("blur",function(){this.getValue()==""&&a.removeAbbr()});for(var b=0;b<j.editables.length;b++)j.editables[b].obj.keydown(function(b){if(b.metaKey&&b.which==71){if(a.findAbbrMarkup()){a.abbrField.foreground();a.abbrField.focus()}else a.insertAbbr();b.stopPropagation();b.preventDefault();return false}})},subscribeEvents:function(){var a=this,b={};j.bind("aloha-editable-activated",function(){if(j.activeEditable&&j.activeEditable.obj){var c=
a.getEditableConfig(j.activeEditable.obj);b[j.activeEditable.getId()]=f.inArray("abbr",c)!==-1}});j.bind("aloha-editable-destroyed",function(){j.activeEditable&&j.activeEditable.obj&&delete b[j.activeEditable.getId()]});j.bind("aloha-selection-changed",function(c,d){if(j.activeEditable)if(b[j.activeEditable.getId()]){a._formatAbbrButton.show();a._insertAbbrButton.show();var g=a.findAbbrMarkup(d);if(g){a._insertAbbrButton.hide();a._formatAbbrButton.setState(true);l.setScope("abbr");a.abbrField.setTargetObject(g,
"title")}else{a._formatAbbrButton.setState(false);a.abbrField.setTargetObject(null)}}else{a._formatAbbrButton.hide();a._insertAbbrButton.hide()}})},findAbbrMarkup:function(a){typeof a=="undefined"&&(a=j.Selection.getRangeObject());return j.activeEditable?a.findMarkup(function(){return this.nodeName.toLowerCase()=="abbr"},j.activeEditable.obj):null},formatAbbr:function(){var a=j.Selection.getRangeObject();j.activeEditable&&(this.findAbbrMarkup(a)?this.removeAbbr():this.insertAbbr())},insertAbbr:function(a){var b=
j.Selection.getRangeObject();if(!this.findAbbrMarkup(b)){b.isCollapsed()&&a!=false&&k.Utils.Dom.extendToWord(b);if(b.isCollapsed()){var a=g.t("newabbr.defaulttext"),c=f('<abbr title="">'+a+"</abbr>");k.Utils.Dom.insertIntoDOM(c,b,f(j.activeEditable.obj));b.startContainer=b.endContainer=c.contents().get(0);b.startOffset=0;b.endOffset=a.length}else{c=f('<abbr title=""></abbr>');k.Utils.Dom.addMarkup(b,c,false)}b.select();this.abbrField.foreground();this.abbrField.focus()}},removeAbbr:function(){var a=
j.Selection.getRangeObject(),b=this.findAbbrMarkup();if(b){k.Utils.Dom.removeFromDOM(b,a,true);a.select()}},makeClean:function(){},toString:function(){return"abbr"}})});define("horizontalruler/nls/i18n",{root:{"button.addhr.tooltip":"Add a horizontal ruler"},de:!0});define("horizontalruler/horizontalruler-plugin","aloha jquery aloha/plugin ui/ui ui/button i18n!horizontalruler/nls/i18n i18n!aloha/nls/i18n".split(" "),function(j,f,a,d,c,b){var l=window.GENTICS;return a.create("horizontalruler",{_constructor:function(){this._super("horizontalruler")},
languages:["en"],config:["hr"],init:function(){var a=this;this._insertHorizontalRuleButton=d.adopt("insertHorizontalRule",c,{tooltip:b.t("button.addhr.tooltip"),iconOnly:true,icon:"aloha-icon-horizontalruler",scope:"Aloha.continuoustext",click:function(){a.insertHR()}});j.bind("aloha-editable-activated",function(){if(j.activeEditable){a.cfg=a.getEditableConfig(j.activeEditable.obj);f.inArray("hr",a.cfg)!=-1?a._insertHorizontalRuleButton.show(true):a._insertHorizontalRuleButton.show(false)}})},insertHR:function(){var a=
j.Selection.getRangeObject();if(j.activeEditable){var b=f("<hr>");l.Utils.Dom.insertIntoDOM(b,a,f(j.activeEditable.obj),true);a.select()}}})});define("paste/paste-plugin",["aloha/core","aloha/plugin","jquery","aloha/command","aloha/console"],function(j,f,a,d,c){function b(){g=j.getSelection().getRangeAt(0);k=j.activeEditable;e.css({top:m.scrollTop(),left:m.scrollLeft()-200});e.contents().remove();k&&k.obj.blur();j.getSelection().removeAllRanges();var a=j.createRange();a.setStart(e.get(0),0);a.setEnd(e.get(0),
0);j.getSelection().addRange(a);e.focus()}function l(){var b;if(g&&k){k.obj.focus();j.getSelection().removeAllRanges();b=j.createRange();b.setStart(g.startContainer,g.startOffset);b.setEnd(g.endContainer,g.endOffset);j.getSelection().addRange(b);b=e.html();a.browser.msie&&/^&nbsp;/.test(b)&&(b=b.substring(6));var d=g.startContainer;3==d.nodeType&&("P"==d.parentNode.nodeName&&1==d.parentNode.childNodes.length&&/^(\s|%A0)$/.test(escape(d.data)))&&(d.data="",g.startOffset=0,g.endContainer==d&&(g.endOffset=
0));j.queryCommandSupported("insertHTML")?j.execCommand("insertHTML",!1,b):c.error("Common.Paste",'Command "insertHTML" not available. Enable the plugin "common/commands".')}k=g=void 0;e.contents().remove()}var m=a(window),g=null,k=null,e=a('<div id="pasteContainer" style="position:absolute; clip:rect(0px, 0px, 0px, 0px); width: 1px; height: 1px;"></div>').contentEditable(!0);return f.create("paste",{settings:{},init:function(){a("body").append(e);j.bind("aloha-editable-created",function(c,e){a.browser.msie?
e.obj.bind("beforepaste",function(a){b();a.stopPropagation()}):e.obj.bind("paste",function(a){b();window.setTimeout(function(){l();j.activeEditable.smartContentChange(a)},10);a.stopPropagation()})});a.browser.msie&&e.bind("paste",function(a){window.setTimeout(function(){l();j.activeEditable.smartContentChange(a)},10);a.stopPropagation()})},register:function(){c.deprecated("Plugins.Paste","register() for pasteHandler is deprecated. Use the ContentHandler Plugin instead.")}})});define("toc/nls/i18n",
{root:{"button.addtoc.tooltip":"Table of contents"},de:!0});define("toc/toc-plugin","aloha aloha/plugin jquery ui/ui ui/button i18n!toc/nls/i18n i18n!aloha/nls/i18n aloha/console".split(" "),function(j,f,a,d,c,b){function l(a,b){return m(a,function(a){return a===b})}function m(a,b){for(var c=0;c<a.length;c++)if(b(a[c]))return a[c];return null}function g(a,b){for(var c=[],e=0;e<a.length;e++)c.push(b(a[e]));return c}function k(a,b){g(a,b)}function e(){return a(g(j.editables,function(a){return document.getElementById(a.getId())}))}
function p(b){var c;typeof b=="object"?c=a(b).text().replace(/[^a-zA-Z-]+/g,"-").replace(/^[^a-zA-Z]+/,""):b&&(c=b);for(var e=0;;e++){var d=c;e&&(d=d+("-"+e));var g=document.getElementById(d);if(!g||typeof b=="object"&&g===b)return d}}var o=window.GENTICS,r=null,q=[];return f.create("toc",{languages:["en","de"],minEntries:0,updateInterval:5E3,config:["toc"],init:function(){var b=this;if(typeof this.settings.minEntries==="undefined")this.settings.minEntries=this.minEntries;if(typeof this.settings.updateInterval===
"undefined")this.settings.updateInterval=this.updateInterval;j.bind("aloha-editable-activated",function(){if(j.activeEditable){b.cfg=b.getEditableConfig(j.activeEditable.obj);a.inArray("toc",b.cfg)!=-1?b._insertTocButton.show(true):b._insertTocButton.show(false)}});this.initButtons();a(document).ready(function(){b.spawn()})},initButtons:function(){var a=this;this._insertTocButton=d.adopt("insertToc",c,{tooltip:b.t("button.addtoc.tooltip"),icon:"aloha-icon aloha-icon-orderedlist",scope:"Aloha.continuoustext",
click:function(){a.insertAtSelection(r)}})},register:function(a){r=a},insertAtSelection:function(b){var b=b||e(),c=p("toc"),d=a("<ol class='toc_root'></ol>").attr("id",c).attr("contentEditable","false"),g=j.Selection.getRangeObject(),f=a(document.getElementById(j.activeEditable.getId()));o.Utils.Dom.insertIntoDOM(d,g,f);this.create(c).register(b).update().tickTock()},spawn:function(b,c){b=b||a("body");c=c||e();b.find("ol.toc_root").each(function(){var b=a(this).attr("id");if(!b){b=p("toc");a(this).attr("id",
b)}that.create(b).register(c).tickTock()})},create:function(b){q.push(this);return{id:b,$containers:a(),settings:this.settings,root:function(){return a(document.getElementById(this.id))},register:function(b){var c=this;c.$containers=c.$containers.add(b);c.$containers.filter(function(){return!a(this).data("toc."+c.id+".listening")}).each(function(){var b=a(this);b.data("toc."+c.id+".listening",true);b.bind("blur",function(){c.cleanupIds(b.get(0));c.update(b)})});return c},tickTock:function(a){var b=
this;if(a=a||this.settings.updateInterval){window.setInterval(function(){b.register(e());b.update()},a);return b}},cleanupIds:function(b){var c=[];this.headings(this.$containers).each(function(){var e=a(this).attr("id");(e&&-1!=a.inArray(e,c)||b&&(a.contains(b,this)||b===this))&&a(this).attr("id",p(this));c.push(e)});return this},update:function(){var a=this,b=this.outline(a.$containers),c=[a.root()];c[c.length-1].empty();(function y(b){var e=[];k(b,function(b){var d=a.linkSection(b[0],c,e);c.push(d);
y(b.slice(1));c.pop();e.push(d)})})(b.slice(1));b=a.root().attr("data-TOC-minEntries")||this.settings.minEntries;a.root().find("li").length>=b?a.root().show():a.root().hide();return this},linkSection:function(b,c,e){var d=b.eq(0).attr("id");if(!d){d=p(b.get(0));b.eq(0).attr("id",d)}var g=this.root(),f=d?g.find('a[href $= "#'+d+'"]'):a();f.length||(f=a("<li><a/></li>"));f.find("a").attr("href","#"+d).text(b.eq(0).text());if(e[e.length-1])e[e.length-1].after(f);else if(c[c.length-1].get(0)==g.get(0))g.append(f);
else{b=a("<ol/>").append(f);c[c.length-1].append(b)}return f},outline:function(b){var c=[a()],e=[c];this.headings(b).each(function(){var b=a(this),c=this.nodeName.toLowerCase(),d=["h6","h5","h4","h3","h2","h1"],c=a.inArray(c,d),d=d.slice(c).join(","),d=[b.nextUntil(d).andSelf()],c=m(e,function(c){c=c[0];return!c.length||m(c,function(c){return b.get(0)===c||a.contains(c,b.get(0))})});c.push(d);e.splice(0,l(e,c),d)});return c},headings:function(a){return a.find(":header").add(a.filter(":header"))}}}})});
define("cite/nls/i18n",{de:!0,en:!0});define("cite/cite-plugin","aloha jquery aloha/plugin ui/ui ui/toggleButton format/format-plugin util/dom PubSub i18n!cite/nls/i18n i18n!aloha/nls/i18n".split(" "),function(j,f,a,d,c,b,l,m,g){function k(a,b){return a.replace(/\{([a-z0-9\-\_]+)\}/ig,function(a,c){var e=b[c]||a;return typeof e==="function"?e():e})}function e(){var a=[],b=o;f.each(arguments,function(){a.push("."+(""===this?b:b+"-"+this))});return f.trim(a.join(" "))}function p(){var a=[],b=o;f.each(arguments,
function(){a.push(""===this?b:b+"-"+this)});return f.trim(a.join(" "))}var o="aloha-cite",r=(new Date).getTime(),q={quote:p("quote"),blockquote:p("blockquote"),"panel-label":p("panel-label"),"panel-field":p("panel-field"),"panel-btns":p("panel-btns"),"link-field":p("link-field"),"note-field":p("note-field"),references:p("references")};return a.create("cite",{citations:[],referenceContainer:null,settings:null,sidebar:null,config:["quote","blockquote"],init:function(){var a=this;if(j.settings&&j.settings.plugins&&
j.settings.plugins.cite){var l=f(j.settings.plugins.cite.referenceContainer);if(l.length)a.referenceContainer=l;if(typeof j.settings.plugins.cite!=="undefined")a.settings=j.settings.plugins.cite;if(typeof a.settings.sidebar==="undefined")a.settings.sidebar={};if(typeof a.settings.sidebar.open==="undefined")a.settings.sidebar.open=true;if(typeof a.settings.sidebar.open==="string"){a.settings.sidebar.open=a.settings.sidebar.open.toLowerCase();a.settings.sidebar.open=a.settings.sidebar.open==="false"||
a.settings.sidebar.open==="0"?false:true}}this._quoteButton=d.adopt("quote",c,{tooltip:g.t("cite.button.add.quote"),icon:p("button","inline-button"),scope:"Aloha.continuoustext",click:function(){a.addInlineQuote()}});b.multiSplitButton.pushItem({name:"blockquote",tooltip:g.t("cite.button.add.blockquote"),icon:p("button","block-button"),click:function(){a.addBlockQuote()}});var o=this;j.ready(function(){o.sidebar=j.Sidebar.right.show();o.sidebar.addPanel({id:p("sidebar-panel"),title:"Citation",content:"",
expanded:true,activeOn:"q, blockquote",onInit:function(){var a=this,b="";o.referenceContainer&&(b='<div class="{panel-label}">Note:</div> <div class="{panel-field} {note-field}" style="margin: 5px;"><textarea></textarea></div>');this.setContent(typeof('<div class="{panel-label}">Link:</div><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" /></div>'+b)==="string"?k('<div class="{panel-label}">Link:</div><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" /></div>'+
b,q):'<div class="{panel-label}">Link:</div><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" /></div>'+b).content.find("input, textarea").bind("keypress change",function(){o.addCiteDetails(a.content.attr("data-cite-id"),a.content.find(e("link-field input")).val(),a.content.find(e("note-field textarea")).val())})},onActivate:function(b){var c=b.attr("data-cite-id");if(!c){var c=++r,d=""+p("wrapper");b.addClass(d);b.attr("data-cite-id",c)}d=a.getIndexOfCitation(c);-1===
d&&(d=a.citations.push({uid:c,link:null,notes:null})-1);this.content.attr("data-cite-id",c);this.content.find(e("link-field input")).val(b.attr("cite"));this.content.find(e("note-field textarea")).val(a.citations[d].note)}})});j.bind("aloha-editable-activated",function(c,e){var d=a.getEditableConfig(e.editable.obj);if(d){f.inArray("quote",d)!==-1?a._quoteButton.show(true):a._quoteButton.show(false);f.inArray("blockquote",d)!==-1?b.multiSplitButton.showItem("blockquote"):b.multiSplitButton.hideItem("blockquote")}});
m.sub("aloha.selection.context-change",function(c){for(var e=c.range,c=f("button.aloha-cite-button"),d=false,g,e=e.markupEffectiveAtStart,k=e.length;k;){g=e[--k].nodeName;if(g==="Q"||g==="BLOCKQUOTE"){d=true;break}}c.filter(".aloha-cite-block-button").removeClass("aloha-cite-pressed");a._quoteButton.setState(false);if(d){"Q"===g?a._quoteButton.setState(true):c.filter(".aloha-cite-block-button").addClass("aloha-cite-pressed");return false}g=[];j.activeEditable&&(g=a.getEditableConfig(j.activeEditable.obj));
f.inArray("quote",g)!=-1?a._quoteButton.show(true):a._quoteButton.show(false);f.inArray("blockquote",g)!=-1?b.multiSplitButton.showItem("blockquote"):b.multiSplitButton.hideItem("blockquote")})},getIndexOfCitation:function(a){for(var b=this.citations,c=b.length,e=0,d,g;e<c;){d=e+c>>1;g=b[d].uid;if(g==a)return d;g>a?c=d:g<a&&(e=d+1)}return-1},addBlockQuote:function(){var a=[p("wrapper"),p(++r)].join(" "),a=f(k('<blockquote class="{classes}" data-cite-id="{uid}"></blockquote>',{uid:r,classes:a}));j.activeEditable&&
f(j.activeEditable.obj[0]).click();j.Selection.changeMarkupOnSelection(a);this.referenceContainer&&this.addCiteToReferences(r);this.sidebar&&(this.settings&&this.settings.sidebar&&this.settings.sidebar.open)&&this.sidebar.open()},addInlineQuote:function(){var a=[p("wrapper"),p(++r)].join(" "),b=f(k('<q class="{classes}" data-cite-id="{uid}"></q>',{uid:r,classes:a})),a=j.Selection.rangeObject,c;j.activeEditable&&f(j.activeEditable.obj[0]).click();if(c=a.findMarkup(function(){return this.nodeName&&
b.length&&typeof this.nodeName==="string"&&typeof b[0].nodeName==="string"?this.nodeName.toLowerCase()===b[0].nodeName.toLowerCase():false},j.activeEditable.obj))a.isCollapsed()?l.removeFromDOM(c,a,true):l.removeMarkup(a,b,j.activeEditable.obj);else{a.isCollapsed()&&l.extendToWord(a);l.addMarkup(a,b)}a.select();this.referenceContainer&&this.addCiteToReferences(r);this.sidebar&&(this.settings&&this.settings.sidebar&&this.settings.sidebar.open)&&this.sidebar.open();return false},addCiteToReferences:function(a){var b=
this.getIndexOfCitation(a);if(-1!==b){var c=f(".aloha-editable-active "+e(a)),d="cite-note-"+a,a="cite-ref-"+a;c.append(k('<sup id="{ref}" contenteditable="false"><a href="#{note}">[{count}]</a></sup>',{ref:a,note:d,count:b+1}));0===this.referenceContainer.find("ol.references").length&&this.referenceContainer.append("<h2>References</h2>").append('<ol class="references"></ol>');this.referenceContainer.find("ol.references").append(k('<li id="{note}"><a href="#{ref}">^</a> &nbsp; <span></span></li>',
{ref:a,note:d}))}},addCiteDetails:function(a,b,c){this.citations[this.getIndexOfCitation(a)]={uid:a,link:b,note:c};b&&f(e(a)).attr("cite",b);this.referenceContainer&&f("li#cite-note-"+a+" span").html(k(b?'<a class="external" target="_blank" href="{url}">{url}</a>':"",{url:b})+(c?". "+c:""))},toString:function(){return"aloha-citiation-plugin"},makeClean:function(a){a.find("q, blockquote").each(function(){f.trim(f(this).attr("class"))===""&&f(this).removeAttr("class");if(!this.referenceContainer){f(this).removeClass("aloha-cite-"+
f(this).attr("data-cite-id"));f(this).attr("data-cite-id")!=null&&f(this).removeAttr("data-cite-id")}f(this).removeClass("aloha-cite-wrapper")})}})});define("flag-icons/flag-icons-plugin",[],function(){return{path:Aloha.getPluginUrl("flag-icons")}});define("numerated-headers/nls/i18n",{root:{"button.numeratedHeaders.tooltip":"Toggle header numeration."},de:!0,en:!0});define("numerated-headers/numerated-headers-plugin","aloha/core jquery aloha/plugin ui/ui ui/toggleButton i18n!numerated-headers/nls/i18n i18n!aloha/nls/i18n".split(" "),
function(j,f,a,d,c,b){var l={};j.bind("aloha-editable-destroyed",function(a,b){delete l[b.getId()]});return a.create("numerated-headers",{config:{numeratedactive:true,headingselector:"h1, h2, h3, h4, h5, h6",trailingdot:false},init:function(){var a=this;this._formatNumeratedHeadersButton=d.adopt("formatNumeratedHeaders",c,{tooltip:b.t("button.numeratedHeaders.tooltip"),icon:"aloha-icon aloha-icon-numerated-headers",scope:"Aloha.continuoustext",click:function(){a._formatNumeratedHeadersButton.getState()?
a.createNumeratedHeaders():a.removeNumerations()}});j.bind("aloha-smart-content-changed",function(){a.cleanNumerations();a.showNumbers()&&a.createNumeratedHeaders()});j.bind("aloha-format-block",function(){a.cleanNumerations();a.showNumbers()&&a.createNumeratedHeaders()});j.bind("aloha-editable-activated",function(){if(a.isNumeratingOn()){a._formatNumeratedHeadersButton.show();a.initForEditable(j.activeEditable.obj)}else a._formatNumeratedHeadersButton.hide()})},initForEditable:function(a){var b=
a.attr("aloha-numerated-headers");if(b!=="true"&&b!=="false"){b=true===this.getCurrentConfig().numeratedactive?"true":"false";a.attr("aloha-numerated-headers",b)}if(b==="true"){this.createNumeratedHeaders();this._formatNumeratedHeadersButton.setState(true)}else this._formatNumeratedHeadersButton.setState(false)},getCurrentConfig:function(){var a=this.getEditableConfig(j.activeEditable.obj);a.numeratedactive=a.numeratedactive===true||a.numeratedactive==="true"||a.numeratedactive==="1"?true:false;if(typeof a.headingselector!==
"string")a.headingselector="h1, h2, h3, h4, h5, h6";a.headingselector=f.trim(a.headingselector);a.trailingdot=a.trailingdot===true||a.trailingdot==="true"||a.trailingdot==="1"?true:false;return a},isNumeratingOn:function(){return this.getCurrentConfig().headingselector!==""},showNumbers:function(){return j.activeEditable&&this.isNumeratingOn()&&j.activeEditable.obj.attr("aloha-numerated-headers")==="true"},cleanNumerations:function(){var a=this.getBaseElement();a&&this._saveRemoveAnnotations(f(a).find("span[role=annotation]"))},
_saveRemoveAnnotations:function(a){var b=this,c=j.Selection.getRangeObject(),e=false;a.each(function(){if(c.startContainer===this||f.inArray(this,f(c.startContainer).parents())>-1){c.startContainer=b._prevNode(this);c.startOffset=0;e=true}if(c.startContainer===this.parentNode&&c.startOffset>=f(this).index()&&c.startOffset>0){c.startOffset--;e=true}if(c.endContainer===this||f.inArray(this,f(c.endContainer).parents())>-1){c.endContainer=b._prevNode(this);c.endOffset=0;e=true}if(c.endContainer===this.parentNode&&
c.endOffset>=f(this).index()&&c.endOffset>0){c.endOffset--;e=true}f(this).remove()});if(e===true){c.update();c.select()}},_prependAnnotation:function(a,b){var c=j.Selection.getRangeObject(),e=false;if(c.startContainer===b){c.startOffset++;e=true}if(c.endContainer===b){c.endOffset++;e=true}f(b).prepend('<span role="annotation">'+a+"</span>");if(e===true){c.update();c.select()}},_prevNode:function(a){var b=a.previousSibling;if(!b)return a.parentNode;for(;b.lastChild;)b=b.lastChild;return b},removeNumerations:function(){f(j.activeEditable.obj).attr("aloha-numerated-headers",
"false");this.cleanNumerations()},getBaseElement:function(){return typeof this.baseobjectSelector!=="undefined"?f(this.baseobjectSelector).length>0?f(this.baseobjectSelector):null:j.activeEditable?j.activeEditable.obj:null},hasNote:function(a){return!a||f(a).length<=0?false:f(a).find("span[role=annotation]").length>0},hasContent:function(a){if(!a||0===f(a).length)return false;a=f(a).clone().find("span[role=annotation]").remove().end();return f.trim(a.text()).length>0},createNumeratedHeaders:function(){var a=
this.getBaseElement();if(a){var b=this.getCurrentConfig(),a=a.find(b.headingselector);j.activeEditable.obj.attr("aloha-numerated-headers","true");if(!(typeof a==="undefined"||a.length===0)){var c=7,e=this;a.each(function(){if(e.hasContent(this)){var a=parseInt(this.nodeName.substr(1),10);a<c&&(c=a)}});if(!(c>6)){var d=null,l=[],r=0,q;for(q=0;q<6-c+1;q++)l[q]=0;a.each(function(){if(e.hasContent(this)){var a=parseInt(this.nodeName.substr(1),10);if(d===null&&a!==c)e._saveRemoveAnnotations(f(this).find("span[role=annotation]"));
else{if(d===null)l[r]++;else if(a>d)l[++r]++;else if(a===d)l[r]++;else if(a<d){var m=a-c,j;for(j=r;j>m;j--)l[j]=0;r=m;l[r]++}d=a;a="";if(b.trailingdot===true){a="";for(m=0;m<l.length;m++)l[m]!==0&&(a=a+(l[m]+"."))}else{a=l[0];for(m=1;m<l.length;m++)l[m]!==0&&(a=a+("."+l[m]))}a=a+"&nbsp;";e.hasNote(this)?f(this).find("span[role=annotation]").html(a):e._prependAnnotation(a,this)}}else e.hasNote(this)&&e._saveRemoveAnnotations(f(this).find("span[role=annotation]"))})}}}}})});define("formatlesspaste/formatlesshandler",
["aloha","jquery","aloha/contenthandlermanager"],function(j,f,a){return a.createHandler({enabled:!1,handleContent:function(a){"string"===typeof a?a=f("<div>"+a+"</div>"):a instanceof f&&(a=f("<div>").append(a));if(!(0<a.find(".aloha-block").length))return this.enabled&&this.removeFormatting(a),a.html()},removeFormatting:function(a){a.find(this.strippedElements.join(",")).each(function(){f(this).contents().unwrap()})}})});define("formatlesspaste/nls/i18n",{root:{"button.formatlessPaste.tooltip":"Toggle Formatless Pasting"},
de:!0,fr:!0,pl:!0,ru:!0});define("formatlesspaste/formatlesspaste-plugin","aloha/core aloha/plugin jquery ui/ui ui/toggleButton formatlesspaste/formatlesshandler aloha/contenthandlermanager i18n!formatlesspaste/nls/i18n i18n!aloha/nls/i18n".split(" "),function(j,f,a,d,c,b,l,m){return f.create("formatlesspaste",{formatlessPasteOption:false,button:true,strippedElements:["a","em","strong","small","s","cite","q","dfn","abbr","time","code","var","samp","kbd","sub","sup","i","b","u","mark","ruby","rt",
"rp","bdi","bdo","ins","del"],init:function(){var a=this;if(typeof this.settings.formatlessPasteOption!=="undefined")this.formatlessPasteOption=this.settings.formatlessPasteOption;if(typeof this.settings.strippedElements!=="undefined")this.strippedElements=this.settings.strippedElements;if(this.settings.config){if(this.settings.config.formatlessPasteOption)this.formatlessPasteOption=this.settings.config.formatlessPasteOption;if(this.settings.config.strippedElements)this.strippedElements=this.settings.config.strippedElements;
if(this.settings.config.button===false)this.button=false}this.registerFormatlessPasteHandler();j.bind("aloha-editable-activated",function(c,e){var d=a.getEditableConfig(e.editable.obj);if(d){if(typeof d.button==="string"){d.button=d.button.toLowerCase();d.button=d.button==="false"||d.button==="0"?false:true}if(typeof d.formatlessPasteOption==="string"){d.formatlessPasteOption=d.formatlessPasteOption.toLowerCase();d.formatlessPasteOption=d.formatlessPasteOption==="false"||d.formatlessPasteOption===
"0"?false:true}if(d.strippedElements)b.strippedElements=d.strippedElements;if(d.formatlessPasteOption===true){a._toggleFormatlessPasteButton.setState(true);b.enabled=true}else if(d.formatlessPasteOption===false){a._toggleFormatlessPasteButton.setState(false);b.enabled=false}d.button===false?a._toggleFormatlessPasteButton.show(false):a._toggleFormatlessPasteButton.show(true)}})},registerFormatlessPasteHandler:function(){l.register("formatless",b);b.strippedElements=this.strippedElements;this._toggleFormatlessPasteButton=
d.adopt("toggleFormatlessPaste",c,{tooltip:m.t("button.formatlessPaste.tooltip"),icon:"aloha-icon aloha-icon-formatless-paste",scope:"Aloha.continuoustext",click:function(){b.enabled=!b.enabled}});if(this.formatlessPasteOption===true){this._toggleFormatlessPasteButton.setState(true);b.enabled=true}this.button===false&&this._toggleFormatlessPasteButton.show(false)}})});(function(){var j=!1,f=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(){function a(){!j&&
this.init&&this.init.apply(this,arguments)}var d=this.prototype;j=!0;var c=new this;j=!1;for(var b=0;b<arguments.length;b++){var l=arguments[b],m;for(m in l)c[m]="function"==typeof l[m]&&"function"==typeof d[m]&&f.test(l[m])?function(a,b){return function(){var c=this._super;this._super=d[a];var f=b.apply(this,arguments);this._super=c;return f}}(m,l[m]):l[m]}a.prototype=c;a.constructor=a;a.extend=arguments.callee;return a}})();"function"===typeof define&&define("Class",[],function(){return Class});
define("jstree",["jquery"],function(j){(function(){if(!j||!j.jstree){var f=!1,a=!1,d=!1;(function(c){c.vakata={};c.vakata.css={get_css:function(a,b,c){var a=a.toLowerCase(),d=c.cssRules||c.rules,g=0;do{if(d.length&&g>d.length+5)break;if(d[g].selectorText&&d[g].selectorText.toLowerCase()==a)return!0===b?(c.removeRule&&c.removeRule(g),c.deleteRule&&c.deleteRule(g),!0):d[g]}while(d[++g]);return!1},add_css:function(a,b){if(c.jstree.css.get_css(a,!1,b))return!1;b.insertRule?b.insertRule(a+" { }",0):b.addRule(a,
null,0);return c.vakata.css.get_css(a)},remove_css:function(a,b){return c.vakata.css.get_css(a,!0,b)},add_sheet:function(a){var b=!1,d=!0;if(a.str)return a.title&&(b=c("style[id='"+a.title+"-stylesheet']")[0]),b?d=!1:(b=document.createElement("style"),b.setAttribute("type","text/css"),a.title&&b.setAttribute("id",a.title+"-stylesheet")),b.styleSheet?d?(document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet.cssText=a.str):b.styleSheet.cssText=b.styleSheet.cssText+" "+a.str:(b.appendChild(document.createTextNode(a.str)),
document.getElementsByTagName("head")[0].appendChild(b)),b.sheet||b.styleSheet;if(a.url)if(document.createStyleSheet)try{document.createStyleSheet(a.url)}catch(g){}else return b=document.createElement("link"),b.rel="stylesheet",b.type="text/css",b.media="all",b.href=a.url,document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet}};var b=[],l=-1,m={},g={};c.fn.jstree=function(a){var e="string"==typeof a,d=Array.prototype.slice.call(arguments,1),g=this;if(e){if("_"==a.substring(0,1))return g;
this.each(function(){var e=b[c.data(this,"jstree-instance-id")],e=e&&c.isFunction(e[a])?e[a].apply(e,d):e;if("undefined"!==typeof e&&(0===a.indexOf("is_")||!0!==e&&!1!==e))return g=e,!1})}else this.each(function(){var e=c.data(this,"jstree-instance-id"),g=[],f=a?c.extend({},!0,a):{},l=c(this),j=!1,o=[],g=g.concat(d);l.data("jstree")&&g.push(l.data("jstree"));f=g.length?c.extend.apply(null,[!0,f].concat(g)):f;"undefined"!==typeof e&&b[e]&&b[e].destroy();e=parseInt(b.push({}),10)-1;c.data(this,"jstree-instance-id",
e);f.plugins=c.isArray(f.plugins)?f.plugins:c.jstree.defaults.plugins.slice();f.plugins.unshift("core");f.plugins=f.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");j=c.extend(!0,{},c.jstree.defaults,f);j.plugins=f.plugins;c.each(m,function(a){-1===c.inArray(a,j.plugins)?(j[a]=null,delete j[a]):o.push(a)});j.plugins=o;b[e]=new c.jstree._instance(e,c(this).addClass("jstree jstree-"+e),j);c.each(b[e]._get_settings().plugins,function(a,
c){b[e].data[c]={}});c.each(b[e]._get_settings().plugins,function(a,c){m[c]&&m[c].__init.apply(b[e])});setTimeout(function(){b[e].init()},0)});return g};c.jstree={defaults:{plugins:[]},_focused:function(){return b[l]||null},_reference:function(a){if(b[a])return b[a];var e=c(a);!e.length&&"string"===typeof a&&(e=c("#"+a));return!e.length?null:b[e.closest(".jstree").data("jstree-instance-id")]||null},_instance:function(a,b,d){this.data={core:{}};this.get_settings=function(){return c.extend(!0,{},d)};
this._get_settings=function(){return d};this.get_index=function(){return a};this.get_container=function(){return b};this.get_container_ul=function(){return b.children("ul:eq(0)")};this._set_settings=function(a){d=c.extend(!0,{},d,a)}},_fn:{},plugin:function(a,b){b=c.extend({},{__init:c.noop,__destroy:c.noop,_fn:{},defaults:!1},b);m[a]=b;c.jstree.defaults[a]=b.defaults;c.each(b._fn,function(b,e){e.plugin=a;e.old=c.jstree._fn[b];c.jstree._fn[b]=function(){var a,d=e,g=Array.prototype.slice.call(arguments);
a=new c.Event("before.jstree");var f=!1;if(!(!0===this.data.core.locked&&"unlock"!==b&&"is_locked"!==b)){do{if(d&&d.plugin&&-1!==c.inArray(d.plugin,this._get_settings().plugins))break;d=d.old}while(d);if(d){if(0===b.indexOf("_"))a=d.apply(this,g);else{a=this.get_container().triggerHandler(a,{func:b,inst:this,args:g,plugin:d.plugin});if(!1===a)return;"undefined"!==typeof a&&(g=a);a=d.apply(c.extend({},this,{__callback:function(a){this.get_container().triggerHandler(b+".jstree",{inst:this,args:g,rslt:a,
rlbk:f})},__rollback:function(){return f=this.get_rollback()},__call_old:function(a){return d.old.apply(this,a?Array.prototype.slice.call(arguments,1):g)}}),g)}return a}}};c.jstree._fn[b].old=e.old;c.jstree._fn[b].plugin=a})},rollback:function(a){a&&(c.isArray(a)||(a=[a]),c.each(a,function(a,c){b[c.i].set_rollback(c.h,c.d)}))}};c.jstree._fn=c.jstree._instance.prototype={};c(function(){var b=navigator.userAgent.toLowerCase(),e=(b.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],g=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";
if(/msie/.test(b)&&6==parseInt(e,10)){f=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(l){}g+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(b)&&
7==parseInt(e,10)&&(a=!0,g+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } ");!/compatible/.test(b)&&(/mozilla/.test(b)&&1.9>parseFloat(e,10))&&(d=!0,g+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } ");c.vakata.css.add_sheet({str:g,title:"jstree"})});c.jstree.plugin("core",{__init:function(){this.data.core.locked=!1;this.data.core.to_open=
this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl");this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+
this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",c.proxy(function(a){var b=c(a.target);b.is("ins")&&a.pageY-b.offset().top<this.data.core.li_height&&this.toggle_node(b)},this)).bind("mousedown.jstree",c.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(){var a;if(document.selection&&document.selection.empty)document.selection.empty();
else if(window.getSelection){a=window.getSelection();try{a.removeAllRanges(),a.collapse()}catch(b){}}});this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",c.proxy(function(a,b){var d=this._get_node(b.rslt.obj),g=this;-1===d&&(d=this.get_container_ul());d.length&&d.find("li").each(function(){var a=c(this);a.data("jstree")&&c.each(a.data("jstree"),function(b,e){g.data[b]&&c.isFunction(g["_"+b+"_notify"])&&g["_"+b+"_notify"].call(g,a,e)})})},this));this._get_settings().core.load_open&&
this.get_container().bind("load_node.jstree",c.proxy(function(a,b){var d=this._get_node(b.rslt.obj),g=this;-1===d&&(d=this.get_container_ul());d.length&&d.find("li.jstree-open:not(:has(ul))").each(function(){g.load_node(this,c.noop,c.noop)})},this));this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var a,e=this.get_index(),d=this._get_settings(),g=this;c.each(d.plugins,function(a,b){try{m[b].__destroy.apply(g)}catch(c){}});this.__callback();if(this.is_focused())for(a in b)if(b.hasOwnProperty(a)&&
a!=e){b[a].set_focus();break}e===l&&(l=-1);this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});c(document).unbind(".jstree-"+e).undelegate(".jstree-"+e);b[e]=null;delete b[e]},_core_notify:function(a,b){b.opened&&this.open_node(a,!1,!0)},lock:function(){this.data.core.locked=!0;this.get_container().children("ul").addClass("jstree-locked").css("opacity",
"0.7");this.__callback({})},unlock:function(){this.data.core.locked=!1;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var a=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){this.id&&a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,
"\\.").replace(/\:/g,"\\:"))});this.__callback(a.data.core.to_open)},save_loaded:function(){},reload_nodes:function(a){var b=this,d=!0,g=[],f=[];a||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=c.map(c.makeArray(this.data.core.to_open),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=c.map(c.makeArray(this.data.core.to_load),function(a){return"#"+
a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)));this.data.core.to_load.length&&(c.each(this.data.core.to_load,function(a,b){if(b=="#")return true;c(b).length?g.push(b):f.push(b)}),g.length&&(this.data.core.to_load=f,c.each(g,function(a,c){if(!b._is_loaded(c)){b.load_node(c,function(){b.reload_nodes(true)},
function(){b.reload_nodes(true)});d=false}})));this.data.core.to_open.length&&c.each(this.data.core.to_open,function(a,c){b.open_node(c,false,true)});d&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){b.__callback({},b)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var a=this;this.data.core.to_open.length&&c.each(this.data.core.to_open,function(b,c){a.open_node(c,!1,!0)});this.__callback({})},refresh:function(a){var b=this;
this.save_opened();a||(a=-1);(a=this._get_node(a))||(a=-1);-1!==a?a.children("UL").remove():this.get_container_ul().empty();this.load_node(a,function(){b.__callback({obj:a});b.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(!this.is_focused()){var a=c.jstree._focused();a&&a.unset_focus();this.get_container().addClass("jstree-focused");l=this.get_index();this.__callback()}},is_focused:function(){return l==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),
l=-1);this.__callback()},_get_node:function(a){var b=c(a,this.get_container());if(b.is(".jstree")||-1==a)return-1;b=b.closest("li",this.get_container());return b.length?b:!1},_get_next:function(a,b){a=this._get_node(a);return-1===a?this.get_container().find("> ul > li:first-child"):!a.length?!1:b?0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):!1:a.hasClass("jstree-open")?a.find("li:eq(0)"):0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):a.parentsUntil(".jstree","li").next("li").eq(0)},_get_prev:function(a,
b){a=this._get_node(a);if(-1===a)return this.get_container().find("> ul > li:last-child");if(!a.length)return!1;if(b)return 0<a.prevAll("li").length?a.prevAll("li:eq(0)"):!1;if(a.prev("li").length){for(a=a.prev("li").eq(0);a.hasClass("jstree-open");)a=a.children("ul:eq(0)").children("li:last");return a}var c=a.parentsUntil(".jstree","li:eq(0)");return c.length?c:!1},_get_parent:function(a){a=this._get_node(a);if(-1==a||!a.length)return!1;a=a.parentsUntil(".jstree","li:eq(0)");return a.length?a:-1},
_get_children:function(a){a=this._get_node(a);return-1===a?this.get_container().children("ul:eq(0)").children("li"):!a.length?!1:a.children("ul:eq(0)").children("li")},get_path:function(a,b){var c=[],d=this,a=this._get_node(a);if(-1===a||!a||!a.length)return!1;a.parentsUntil(".jstree","li").each(function(){c.push(b?this.id:d.get_text(this))});c.reverse();c.push(b?a.attr("id"):this.get_text(a));return c},_get_string:function(a){return this._get_settings().core.strings[a]||a},is_open:function(a){return(a=
this._get_node(a))&&-1!==a&&a.hasClass("jstree-open")},is_closed:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-closed")},is_leaf:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-leaf")},correct_state:function(a){a=this._get_node(a);if(!a||-1===a)return!1;a.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},open_node:function(a,b,c){a=this._get_node(a);if(!a.length)return!1;if(!a.hasClass("jstree-closed"))return b&&
b.call(),!1;var d=c||f?0:this._get_settings().core.animation,g=this;this._is_loaded(a)?(this._get_settings().core.open_parents&&a.parentsUntil(".jstree",".jstree-closed").each(function(){g.open_node(this,!1,!0)}),d&&a.children("ul").css("display","none"),a.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),d?a.children("ul").stop(!0,!0).slideDown(d,function(){this.style.display="";g.after_open(a)}):g.after_open(a),this.__callback({obj:a}),b&&b.call()):
(a.children("a").addClass("jstree-loading"),this.load_node(a,function(){g.open_node(a,b,c)},b))},after_open:function(a){this.__callback({obj:a})},close_node:function(a,b){var a=this._get_node(a),c=b||f?0:this._get_settings().core.animation,d=this;if(!a.length||!a.hasClass("jstree-open"))return!1;c&&a.children("ul").attr("style","display:block !important");a.removeClass("jstree-open").addClass("jstree-closed");c?a.children("ul").stop(!0,!0).slideUp(c,function(){this.style.display="";d.after_close(a)}):
d.after_close(a);this.__callback({obj:a})},after_close:function(a){this.__callback({obj:a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed"))return this.open_node(a);if(a.hasClass("jstree-open"))return this.close_node(a)},open_all:function(a,b,c){a=a?this._get_node(a):-1;if(!a||-1===a)a=this.get_container_ul();c?a=a.find("li.jstree-closed"):(c=a,a=a.is(".jstree-closed")?a.find("li.jstree-closed").andSelf():a.find("li.jstree-closed"));var d=this;a.each(function(){var a=this;
d._is_loaded(this)?d.open_node(this,false,!b):d.open_node(this,function(){d.open_all(a,b,c)},!b)});0===c.find("li.jstree-closed").length&&this.__callback({obj:c})},close_all:function(a,b){var c=this,a=a?this._get_node(a):this.get_container();if(!a||-1===a)a=this.get_container_ul();a.find("li.jstree-open").andSelf().each(function(){c.close_node(this,!b)});this.__callback({obj:a})},clean_node:function(a){a=a&&-1!=a?c(a):this.get_container_ul();a=a.is("li")?a.find("li").andSelf():a.find("li");a.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");
a.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(a,b){this.get_container().empty().append(a);this.data=b;this.__callback()},load_node:function(a){this.__callback({obj:a})},_is_loaded:function(){return!0},create_node:function(a,b,d,g,f){var a=this._get_node(a),b="undefined"===typeof b?"last":
b,l=c("<li />"),m=this._get_settings().core,j;if(-1!==a&&!a.length)return!1;if(!f&&!this._is_loaded(a))return this.load_node(a,function(){this.create_node(a,b,d,g,!0)}),!1;this.__rollback();"string"===typeof d&&(d={data:d});d||(d={});d.attr&&l.attr(d.attr);d.metadata&&l.data(d.metadata);d.state&&l.addClass("jstree-"+d.state);d.data||(d.data=this._get_string("new_node"));c.isArray(d.data)||(j=d.data,d.data=[],d.data.push(j));c.each(d.data,function(a,b){j=c("<a />");c.isFunction(b)&&(b=b.call(this,
d));if(typeof b=="string")j.attr("href","#")[m.html_titles?"html":"text"](b);else{if(!b.attr)b.attr={};if(!b.attr.href)b.attr.href="#";j.attr(b.attr)[m.html_titles?"html":"text"](b.title);b.language&&j.addClass(b.language)}j.prepend("<ins class='jstree-icon'>&#160;</ins>");b.icon&&(b.icon.indexOf("/")===-1?j.children("ins").addClass(b.icon):j.children("ins").css("background","url('"+b.icon+"') center center no-repeat"));l.append(j)});l.prepend("<ins class='jstree-icon'>&#160;</ins>");-1===a&&(a=this.get_container(),
"before"===b&&(b="first"),"after"===b&&(b="last"));switch(b){case "before":a.before(l);j=this._get_parent(a);break;case "after":a.after(l);j=this._get_parent(a);break;case "inside":case "first":a.children("ul").length||a.append("<ul />");a.children("ul").prepend(l);j=a;break;case "last":a.children("ul").length||a.append("<ul />");a.children("ul").append(l);j=a;break;default:a.children("ul").length||a.append("<ul />"),b||(b=0),j=a.children("ul").children("li").eq(b),j.length?j.before(l):a.children("ul").append(l),
j=a}if(-1===j||j.get(0)===this.get_container().get(0))j=-1;this.clean_node(j);this.__callback({obj:l,parent:j});g&&g.call(this,l);return l},get_text:function(a){a=this._get_node(a);if(!a.length)return!1;var b=this._get_settings().core.html_titles,a=a.children("a:eq(0)");if(b)return a=a.clone(),a.children("INS").remove(),a.html();a=a.contents().filter(function(){return 3==this.nodeType})[0];return a.nodeValue},set_text:function(a,b){a=this._get_node(a);if(!a.length)return!1;a=a.children("a:eq(0)");
if(this._get_settings().core.html_titles){var c=a.children("INS").clone();a.html(b).prepend(c);this.__callback({obj:a,name:b});return!0}a=a.contents().filter(function(){return 3==this.nodeType})[0];this.__callback({obj:a,name:b});return a.nodeValue=b},rename_node:function(a,b){a=this._get_node(a);this.__rollback();a&&(a.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments)))&&this.__callback({obj:a,name:b})},delete_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.__rollback();
var b=this._get_parent(a),d=c([]),g=this;a.each(function(){d=d.add(g._get_prev(this))});a=a.detach();-1!==b&&0===b.find("> ul > li").length&&b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");this.clean_node(b);this.__callback({obj:a,prev:d,parent:b});return a},prepare_move:function(a,b,d,f,l){var m={};m.ot=c.jstree._reference(a)||this;m.o=m.ot._get_node(a);m.r=-1===b?-1:this._get_node(b);m.p="undefined"===typeof d||!1===d?"last":d;if(l||!g.o||!(g.o[0]===m.o[0]&&g.r[0]===m.r[0]&&g.p===
m.p)){m.ot=c.jstree._reference(m.o)||this;m.rt=c.jstree._reference(m.r)||this;if(-1===m.r||!m.r)switch(m.cr=-1,m.p){case "first":case "before":case "inside":m.cp=0;break;case "after":case "last":m.cp=m.rt.get_container().find(" > ul > li").length;break;default:m.cp=m.p}else{if(!/^(before|after)$/.test(m.p)&&!this._is_loaded(m.r))return this.load_node(m.r,function(){this.prepare_move(a,b,d,f,!0)});switch(m.p){case "before":m.cp=m.r.index();m.cr=m.rt._get_parent(m.r);break;case "after":m.cp=m.r.index()+
1;m.cr=m.rt._get_parent(m.r);break;case "inside":case "first":m.cp=0;m.cr=m.r;break;case "last":m.cp=m.r.find(" > ul > li").length;m.cr=m.r;break;default:m.cp=m.p,m.cr=m.r}}m.np=-1==m.cr?m.rt.get_container():m.cr;m.op=m.ot._get_parent(m.o);m.cop=m.o.index();-1===m.op&&(m.op=m.ot?m.ot.get_container():this.get_container());!/^(before|after)$/.test(m.p)&&(m.op&&m.np&&m.op[0]===m.np[0]&&m.o.index()<m.cp)&&m.cp++;m.or=m.np.find(" > ul > li:nth-child("+(m.cp+1)+")");g=m}this.__callback(g);f&&f.call(this,
g)},check_move:function(){var a=g,b=!0,c=-1===a.r?this.get_container():a.r;if(!a||(!a.o||a.or[0]===a.o[0])||a.op&&a.np&&a.op[0]===a.np[0]&&a.cp-1===a.o.index())return!1;a.o.each(function(){if(-1!==c.parentsUntil(".jstree","li").andSelf().index(this))return b=!1});return b},move_node:function(a,b,d,f,l,m){if(!l)return this.prepare_move(a,b,d,function(a){this.move_node(a,!1,!1,f,!0,m)});f&&(g.cy=!0);if(!m&&!this.check_move())return!1;this.__rollback();b=!1;f?(b=a.o.clone(!0),b.find("*[id]").andSelf().each(function(){if(this.id)this.id=
"copy_"+this.id})):b=a.o;a.or.length?a.or.before(b):(a.np.children("ul").length||c("<ul />").appendTo(a.np),a.np.children("ul:eq(0)").append(b));try{a.ot.clean_node(a.op),a.rt.clean_node(a.np),a.op.find("> ul > li").length||a.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(j){}f&&(g.cy=!0,g.oc=b);this.__callback(g);return g},_get_move:function(){return g}}})})(j);(function(a){var b,d,f;a(function(){/msie/.test(navigator.userAgent.toLowerCase())?(d=
a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),f=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),b=d.width()-f.width(),d.add(f).remove()):(d=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1E3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),b=100-d.width(),d.parent().remove())});a.jstree.plugin("ui",
{__init:function(){this.data.ui.selected=a();this.data.ui.last_selected=!1;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",a.proxy(function(b){b.preventDefault();b.currentTarget.blur();a(b.currentTarget).hasClass("jstree-loading")||this.select_node(b.currentTarget,!0,b)},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){a(b.currentTarget).hasClass("jstree-loading")||this.hover_node(b.target)},this)).delegate("a",
"mouseleave.jstree",a.proxy(function(b){a(b.currentTarget).hasClass("jstree-loading")||this.dehover_node(b.target)},this)).bind("reopen.jstree",a.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",a.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",a.proxy(function(){this.reselect()},this)).bind("close_node.jstree",a.proxy(function(b,d){var e=this._get_settings().ui,f=this._get_node(d.rslt.obj),l=f&&f.length?f.children("ul").find("a.jstree-clicked"):
a(),m=this;!1!==e.selected_parent_close&&l.length&&l.each(function(){m.deselect_node(this);"select_parent"===e.selected_parent_close&&m.select_node(f)})},this)).bind("delete_node.jstree",a.proxy(function(a,b){var c=this._get_settings().ui.select_prev_on_delete,d=this._get_node(b.rslt.obj),d=d&&d.length?d.find("a.jstree-clicked"):[],f=this;d.each(function(){f.deselect_node(this)});c&&d.length&&b.rslt.prev.each(function(){if(this.parentNode)return f.select_node(this),!1})},this)).bind("move_node.jstree",
a.proxy(function(a,b){b.rslt.cy&&b.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(b,d){if("undefined"===typeof b||null===b)return d?this.data.ui.selected:this.data.ui.last_selected;var e=a(b,this.get_container());if(e.is(".jstree")||
-1==b)return-1;e=e.closest("li",this.get_container());return e.length?e:!1},_ui_notify:function(a,b){b.selected&&this.select_node(a,!1)},save_selected:function(){var a=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){this.id&&a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))});this.__callback(this.data.ui.to_select)},reselect:function(){var b=this,d=this.data.ui.to_select,
d=a.map(a.makeArray(d),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});a.each(d,function(a,c){c&&"#"!==c&&b.select_node(c)});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(){this.save_selected();return this.__call_old()},hover_node:function(a){a=this._get_node(a);if(!a.length)return!1;a.hasClass("jstree-hovered")||
this.dehover_node();this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent();this._fix_scroll(a);this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered;if(!a||!a.length)return!1;this.data.ui.hovered[0]===a.children("a").removeClass("jstree-hovered").parent()[0]&&(this.data.ui.hovered=null);this.__callback({obj:a})},select_node:function(a,b,c){a=this._get_node(a);if(-1==a||!a||!a.length)return!1;var d=this._get_settings().ui,f="on"==d.select_multiple_modifier||
!1!==d.select_multiple_modifier&&c&&c[d.select_multiple_modifier+"Key"],l=!1!==d.select_range_modifier&&c&&c[d.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==a[0]&&this.data.ui.last_selected.parent()[0]===a.parent()[0],m=this.is_selected(a),j=!0,t=this;if(b){if(d.disable_selecting_children&&f&&(a.parentsUntil(".jstree","li").children("a.jstree-clicked").length||a.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;j=!1;switch(!0){case l:this.data.ui.last_selected.addClass("jstree-last-selected");
a=a[a.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf();-1==d.select_limit||a.length<d.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==t.data.ui.last_selected[0]&&t.deselect_node(this)}),m=!1,j=!0):j=!1;break;case m&&!f:this.deselect_all();m=!1;j=!0;break;case !m&&!f:if(-1==d.select_limit||0<d.select_limit)this.deselect_all(),j=!0;break;case m&&f:this.deselect_node(a);break;
case !m&&f:if(-1==d.select_limit||this.data.ui.selected.length+1<=d.select_limit)j=!0}}j&&!m&&(l||(this.data.ui.last_selected=a),a.children("a").addClass("jstree-clicked"),d.selected_parent_open&&a.parents(".jstree-closed").each(function(){t.open_node(this,false,true)}),this.data.ui.selected=this.data.ui.selected.add(a),this._fix_scroll(a.eq(0)),this.__callback({obj:a,e:c}))},_fix_scroll:function(a){var c=this.get_container()[0];if(c.scrollHeight>c.offsetHeight&&(a=this._get_node(a))&&!(-1===a||!a.length||
!a.is(":visible")))if(a=a.offset().top-this.get_container().offset().top,0>a&&(c.scrollTop=c.scrollTop+a-1),a+this.data.core.li_height+(c.scrollWidth>c.offsetWidth?b:0)>c.offsetHeight)c.scrollTop+=a-c.offsetHeight+this.data.core.li_height+1+(c.scrollWidth>c.offsetWidth?b:0)},deselect_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)&&(a.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(a),this.data.ui.last_selected.get(0)===a.get(0)&&
(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:a}))},toggle_select:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)?this.deselect_node(a):this.select_node(a)},is_selected:function(a){return 0<=this.data.ui.selected.index(this._get_node(a))},get_selected:function(b){return b?a(b).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(b){b=b?a(b).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();
b.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=a([]);this.data.ui.last_selected=!1;this.__callback({obj:b})}}});a.jstree.defaults.plugins.push("ui")})(j);(function(a){a.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",a.proxy(function(a,c){if(this._get_settings().crrm.move.open_onmove){var d=this;c.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){d.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,
move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(){return!0}}},_fn:{_show_input:function(b,d){var b=this._get_node(b),f=this._get_settings().core.rtl,g=this._get_settings().crrm.input_width_limit,k=b.children("ins").width(),e=b.find("> a:visible > ins").width()*b.find("> a:visible > ins").length,j=this.get_text(b),o=a("<div />",{css:{position:"absolute",top:"-200px",left:f?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),r=b.css("position","relative").append(a("<input />",
{value:j,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:f?"auto":k+e+4+"px",right:f?k+e+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:a.proxy(function(){var a=b.children(".jstree-rename-input"),c=a.val();""===c&&(c=j);o.remove();a.remove();this.set_text(b,j);this.rename_node(b,c);d.call(this,b,c,j);b.css("position","")},this),keyup:function(a){a=a.keyCode||a.which;27==
a?(this.value=j,this.blur()):13==a?this.blur():r.width(Math.min(o.text("pW"+this.value).width(),g))},keypress:function(a){if(13==(a.keyCode||a.which))return!1}})).children(".jstree-rename-input");this.set_text(b,"");o.css({fontFamily:r.css("fontFamily")||"",fontSize:r.css("fontSize")||"",fontWeight:r.css("fontWeight")||"",fontStyle:r.css("fontStyle")||"",fontStretch:r.css("fontStretch")||"",fontVariant:r.css("fontVariant")||"",letterSpacing:r.css("letterSpacing")||"",wordSpacing:r.css("wordSpacing")||
""});r.width(Math.min(o.text("pW"+r[0].value).width(),g))[0].select()},rename:function(a){a=this._get_node(a);this.__rollback();var c=this.__callback;this._show_input(a,function(a,b,d){c.call(this,{obj:a,new_name:b,old_name:d})})},create:function(b,d,f,g,k){var e=this;(b=this._get_node(b))||(b=-1);this.__rollback();return this.create_node(b,d,f,function(b){var d=this._get_parent(b),f=a(b).index();g&&g.call(this,b);d.length&&d.hasClass("jstree-closed")&&this.open_node(d,!1,!0);k?e.__callback({obj:b,
name:this.get_text(b),parent:d,position:f}):this._show_input(b,function(a,b){e.__callback({obj:a,name:b,parent:d,position:f})})})},remove:function(a){var a=this._get_node(a,!0),c=this._get_parent(a),d=this._get_prev(a);this.__rollback();a=this.delete_node(a);!1!==a&&this.__callback({obj:a,prev:d,parent:c})},check_move:function(){return!this.__call_old()||!this._get_settings().crrm.move.check_move.call(this,this._get_move())?!1:!0},move_node:function(a,c,d,g,f,e){var j=this._get_settings().crrm.move;
if(!f)return"undefined"===typeof d&&(d=j.default_position),"inside"===d&&!j.default_position.match(/^(before|after)$/)&&(d=j.default_position),this.__call_old(!0,a,c,d,g,!1,e);if(!0===j.always_copy||"multitree"===j.always_copy&&a.rt.get_index()!==a.ot.get_index())g=!0;this.__call_old(!0,a,c,d,g,!0,e)},cut:function(a){a=this._get_node(a,!0);if(!a||!a.length)return!1;this.data.crrm.cp_nodes=!1;this.data.crrm.ct_nodes=a;this.__callback({obj:a})},copy:function(a){a=this._get_node(a,!0);if(!a||!a.length)return!1;
this.data.crrm.ct_nodes=!1;this.data.crrm.cp_nodes=a;this.__callback({obj:a})},paste:function(a){a=this._get_node(a);if(!a||!a.length)return!1;var c=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,a),this.data.crrm.ct_nodes=!1);this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,a,!1,!0);this.__callback({obj:a,nodes:c})}}})})(j);(function(a){var b=
[];a.jstree._themes=!1;a.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",a.proxy(function(){var a=this._get_settings().themes;this.data.themes.dots=a.dots;this.data.themes.icons=a.icons;this.set_theme(a.theme,a.url)},this)).bind("loaded.jstree",a.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(d,f){if(!d)return!1;
f||(f=a.jstree._themes+d+"/style.css");-1==a.inArray(f,b)&&(a.vakata.css.add_sheet({url:f}),b.push(f));this.data.themes.theme!=d&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=d);this.get_container().addClass("jstree-"+d);this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons();this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0;this.get_container().children("ul").removeClass("jstree-no-dots")},
hide_dots:function(){this.data.themes.dots=!1;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}});
a(function(){!1===a.jstree._themes&&a("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return a.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1});!1===a.jstree._themes&&(a.jstree._themes="themes/")});a.jstree.defaults.plugins.push("themes")})(j);(function(a){var b=[];a.jstree.plugin("hotkeys",{__init:function(){if("undefined"===typeof a.hotkeys)throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";
a.each(this._get_settings().hotkeys,function(d,f){!1!==f&&-1==a.inArray(d,b)&&(a(document).bind("keydown",d,function(b){var f;var e=a.jstree._focused(),m;e&&e.data&&e.data.hotkeys&&e.data.hotkeys.enabled&&(m=e._get_settings().hotkeys[d])&&(f=m.call(e,b));return f}),b.push(d))});this.get_container().bind("lock.jstree",a.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",a.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=
!0)},this));this.enable_hotkeys()},defaults:{up:function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"ctrl+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},down:function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},
"ctrl+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},"ctrl+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?
this.close_node(a):this.hover_node(this._get_prev(a)));return!1},"shift+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},"ctrl+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&
(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},"shift+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},space:function(){this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click();return!1},"ctrl+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);return!1},
"shift+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);return!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})})(j);(function(a){a.jstree.plugin("json_data",{__init:function(){this._get_settings().json_data.progressive_unload&&
this.get_container().bind("after_close.jstree",function(a,c){c.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(a,c,d){var g=this;this.load_node_json(a,function(){g.__callback({obj:g._get_node(a)});c.call(this)},d)},_is_loaded:function(b){var d=this._get_settings().json_data,b=this._get_node(b);return-1==b||!b||!d.ajax&&!d.progressive_render&&!a.isFunction(d.data)||b.is(".jstree-open, .jstree-leaf")||
0<b.children("ul").children("li").length},refresh:function(b){var b=this._get_node(b),d=this._get_settings().json_data;b&&(-1!==b&&d.progressive_unload&&(a.isFunction(d.data)||d.ajax))&&b.removeData("jstree-children");return this.__call_old()},load_node_json:function(b,d,f){var g=this.get_settings().json_data,k,e=function(){};k=function(){};if((b=this._get_node(b))&&-1!==b&&(g.progressive_render||g.progressive_unload)&&!b.is(".jstree-open, .jstree-leaf")&&0===b.children("ul").children("li").length&&
b.data("jstree-children")){if(k=this._parse_json(b.data("jstree-children"),b))b.append(k),g.progressive_unload||b.removeData("jstree-children");this.clean_node(b);d&&d.call(this)}else{if(b&&-1!==b){if(b.data("jstree-is-loading"))return;b.data("jstree-is-loading",!0)}switch(!0){case !g.data&&!g.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(g.data):g.data.call(this,b,a.proxy(function(a){if(a=this._parse_json(a,b)){if(b===-1||!b)this.get_container().children("ul").empty().append(a.children());
else{b.append(a).children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading")}this.clean_node(b);d&&d.call(this)}else{if(b===-1||!b)g.correct_state&&this.get_container().children("ul").empty();else{b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");g.correct_state&&this.correct_state(b)}f&&f.call(this)}},this));break;case !!g.data&&!g.ajax||!!g.data&&!!g.ajax&&(!b||-1===b):if(!b||-1==b)(k=this._parse_json(g.data,b))?(this.get_container().children("ul").empty().append(k.children()),
this.clean_node()):g.correct_state&&this.get_container().children("ul").empty();d&&d.call(this);break;case !g.data&&!!g.ajax||!!g.data&&!!g.ajax&&b&&-1!==b:e=function(a,c,e){var d=this.get_settings().json_data.ajax.error;d&&d.call(this,a,c,e);if(b!=-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");c==="success"&&g.correct_state&&this.correct_state(b)}else c==="success"&&g.correct_state&&this.get_container().children("ul").empty();f&&f.call(this)},
k=function(f,k,m){var j=this.get_settings().json_data.ajax.success;j&&(f=j.call(this,f,k,m)||f);if(f===""||f&&f.toString&&f.toString().replace(/^[\s\n]+$/,"")===""||!a.isArray(f)&&!a.isPlainObject(f))return e.call(this,m,k,"");if(f=this._parse_json(f,b)){if(b===-1||!b)this.get_container().children("ul").empty().append(f.children());else{b.append(f).children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading")}this.clean_node(b);d&&d.call(this)}else if(b===-1||!b){if(g.correct_state){this.get_container().children("ul").empty();
d&&d.call(this)}}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(g.correct_state){this.correct_state(b);d&&d.call(this)}}},g.ajax.context=this,g.ajax.error=e,g.ajax.success=k,g.ajax.dataType||(g.ajax.dataType="json"),a.isFunction(g.ajax.url)&&(g.ajax.url=g.ajax.url.call(this,b)),a.isFunction(g.ajax.data)&&(g.ajax.data=g.ajax.data.call(this,b)),a.ajax(g.ajax)}}},_parse_json:function(b,d,f){var g=!1,k=this._get_settings(),e=k.json_data,j=k.core.html_titles,
o;if(!b)return g;e.progressive_unload&&(d&&-1!==d)&&d.data("jstree-children",g);if(a.isArray(b)){g=a();if(!b.length)return!1;k=0;for(e=b.length;k<e;k++)o=this._parse_json(b[k],d,!0),o.length&&(g=g.add(o))}else{"string"==typeof b&&(b={data:b});if(!b.data&&""!==b.data)return g;g=a("<li />");b.attr&&g.attr(b.attr);b.metadata&&g.data(b.metadata);b.state&&g.addClass("jstree-"+b.state);a.isArray(b.data)||(o=b.data,b.data=[],b.data.push(o));a.each(b.data,function(e,d){o=a("<a />");a.isFunction(d)&&(d=d.call(this,
b));if(typeof d=="string")o.attr("href","#")[j?"html":"text"](d);else{if(!d.attr)d.attr={};if(!d.attr.href)d.attr.href="#";o.attr(d.attr)[j?"html":"text"](d.title);d.language&&o.addClass(d.language)}o.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!d.icon&&b.icon)d.icon=b.icon;d.icon&&(d.icon.indexOf("/")===-1?o.children("ins").addClass(d.icon):o.children("ins").css("background","url('"+d.icon+"') center center no-repeat"));g.append(o)});g.prepend("<ins class='jstree-icon'>&#160;</ins>");b.children&&
(e.progressive_render&&"open"!==b.state?g.addClass("jstree-closed").data("jstree-children",b.children):(e.progressive_unload&&g.data("jstree-children",b.children),a.isArray(b.children)&&b.children.length&&(o=this._parse_json(b.children,d,!0),o.length&&(d=a("<ul />"),d.append(o),g.append(d)))))}f||(f=a("<ul />"),f.append(g),g=f);return g},get_json:function(b,d,f,g){var k=[],e=this._get_settings(),j=this,o,r,q,u,t,v,b=this._get_node(b);if(!b||-1===b)b=this.get_container().find("> ul > li");d=a.isArray(d)?
d:["id","class"];!g&&this.data.types&&d.push(e.types.type_attr);f=a.isArray(f)?f:[];b.each(function(){q=a(this);o={data:[]};d.length&&(o.attr={});a.each(d,function(a,b){(r=q.attr(b))&&(r.length&&r.replace(/jstree[^ ]*/ig,"").length)&&(o.attr[b]=(" "+r).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))});q.hasClass("jstree-open")&&(o.state="open");q.hasClass("jstree-closed")&&(o.state="closed");q.data()&&(o.metadata=q.data());u=q.children("a");u.each(function(){t=
a(this);if(f.length||a.inArray("languages",e.plugins)!==-1||t.children("ins").get(0).style.backgroundImage.length||t.children("ins").get(0).className&&t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length){v=false;a.inArray("languages",e.plugins)!==-1&&(a.isArray(e.languages)&&e.languages.length)&&a.each(e.languages,function(a,b){if(t.hasClass(b)){v=b;return false}});r={attr:{},title:j.get_text(t,v)};a.each(f,function(a,b){r.attr[b]=(" "+(t.attr(b)||"")).replace(/ jstree[^ ]*/ig,
"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")});a.inArray("languages",e.plugins)!==-1&&(a.isArray(e.languages)&&e.languages.length)&&a.each(e.languages,function(a,b){if(t.hasClass(b)){r.language=b;return true}});if(t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length)r.icon=t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"");if(t.children("ins").get(0).style.backgroundImage.length)r.icon=
t.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")}else r=j.get_text(t);u.length>1?o.data.push(r):o.data=r});q=q.find("> ul > li");q.length&&(o.children=j.get_json(q,d,f,!0));k.push(o)});return k}}})})(j);(function(a){a.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(b){var d=this._get_settings().languages,f=!1,g=".jstree-"+this.get_index()+" a";if(!a.isArray(d)||0===d.length)return!1;if(-1==a.inArray(b,d))if(d[b])b=
d[b];else return!1;if(b==this.data.languages.current_language)return!0;f=a.vakata.css.get_css(g+"."+this.data.languages.current_language,!1,this.data.languages.language_css);!1!==f&&(f.style.display="none");f=a.vakata.css.get_css(g+"."+b,!1,this.data.languages.language_css);!1!==f&&(f.style.display="");this.data.languages.current_language=b;this.__callback(b);return!0},get_lang:function(){return this.data.languages.current_language},_get_string:function(b,d){var f=this._get_settings().languages,g=
this._get_settings().core.strings;a.isArray(f)&&f.length&&(d=d&&-1!=a.inArray(d,f)?d:this.data.languages.current_language);return g[d]&&g[d][b]?g[d][b]:g[b]?g[b]:b},get_text:function(b,d){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size())return!1;var f=this._get_settings().languages,g=this._get_settings().core.html_titles;a.isArray(f)&&f.length?(d=d&&-1!=a.inArray(d,f)?d:this.data.languages.current_language,b=b.children("a."+d)):b=b.children("a:eq(0)");if(g)return b=b.clone(),b.children("INS").remove(),
b.html();b=b.contents().filter(function(){return this.nodeType==3})[0];return b.nodeValue},set_text:function(b,d,f){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size())return!1;var g=this._get_settings().languages,k=this._get_settings().core.html_titles;a.isArray(g)&&g.length?(f=f&&-1!=a.inArray(f,g)?f:this.data.languages.current_language,b=b.children("a."+f)):b=b.children("a:eq(0)");if(k)return g=b.children("INS").clone(),b.html(d).prepend(g),this.__callback({obj:b,name:d,lang:f}),!0;b=
b.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:b,name:d,lang:f});return b.nodeValue=d},_load_css:function(){var b=this._get_settings().languages,d="/* languages css */",f=".jstree-"+this.get_index()+" a",g;if(a.isArray(b)&&b.length){this.data.languages.current_language=b[0];for(g=0;g<b.length;g++)d+=f+"."+b[g]+" {",b[g]!=this.data.languages.current_language&&(d+=" display:none; "),d+=" } ";this.data.languages.language_css=a.vakata.css.add_sheet({str:d,title:"jstree-languages"})}},
create_node:function(b,d,f,g){return this.__call_old(!0,b,d,f,function(b){var e=this._get_settings().languages,d=b.children("a"),f;if(a.isArray(e)&&e.length){for(f=0;f<e.length;f++)d.is("."+e[f])||b.append(d.eq(0).clone().removeClass(e.join(" ")).addClass(e[f]));d.not("."+e.join(", .")).remove()}g&&g.call(this,b)})}}})})(j);(function(a){a.jstree.plugin("cookies",{__init:function(){if("undefined"===typeof a.cookie)throw"jsTree cookie: jQuery cookie plugin not included.";var b=this._get_settings().cookies,
d;if(b.save_loaded&&(d=a.cookie(b.save_loaded))&&d.length)this.data.core.to_load=d.split(",");if(b.save_opened&&(d=a.cookie(b.save_opened))&&d.length)this.data.core.to_open=d.split(",");if(b.save_selected&&(d=a.cookie(b.save_selected))&&d.length&&this.data.ui)this.data.ui.to_select=d.split(",");this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",a.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",a.proxy(function(a){this._get_settings().cookies.auto_save&&
this.save_cookie((a.handleObj.namespace+a.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(b){if(!this.data.core.refreshing){var d=this._get_settings().cookies;if(b)switch(b){case "open_node":case "close_node":d.save_opened&&(this.save_opened(),a.cookie(d.save_opened,this.data.core.to_open.join(","),d.cookie_options));d.save_loaded&&(this.save_loaded(),
a.cookie(d.save_loaded,this.data.core.to_load.join(","),d.cookie_options));break;case "select_node":case "deselect_node":d.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(d.save_selected,this.data.ui.to_select.join(","),d.cookie_options))}else if(d.save_loaded&&(this.save_loaded(),a.cookie(d.save_loaded,this.data.core.to_load.join(","),d.cookie_options)),d.save_opened&&(this.save_opened(),a.cookie(d.save_opened,this.data.core.to_open.join(","),d.cookie_options)),d.save_selected&&this.data.ui)this.save_selected(),
a.cookie(d.save_selected,this.data.ui.to_select.join(","),d.cookie_options)}}}})})(j);(function(a){a.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",a.proxy(function(a,c){var d=this._get_node(c.rslt.obj),d=-1===d?this.get_container().children("ul"):d.children("ul");this.sort(d)},this)).bind("rename_node.jstree create_node.jstree create.jstree",a.proxy(function(a,c){this.sort(c.rslt.obj.parent())},this)).bind("move_node.jstree",a.proxy(function(a,c){this.sort((-1==
c.rslt.np?this.get_container():c.rslt.np).children("ul"))},this))},defaults:function(a,c){return this.get_text(a)>this.get_text(c)?1:-1},_fn:{sort:function(b){var d=this._get_settings().sort,f=this;b.append(a.makeArray(b.children("li")).sort(a.proxy(d,f)));b.find("> li > ul").each(function(){f.sort(a(this))});this.clean_node(b)}}})})(j);(function(a){var b=!1,d=!1,f=!1,g=!1,k=!1,e=!1,j=!1,o=!1,r=!1;a.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,
helper_top:10,user_data:{},drag_start:function(b,e,d){a.vakata.dnd.is_drag&&a.vakata.drag_stop({});try{b.currentTarget.unselectable="on",b.currentTarget.onselectstart=function(){return!1},b.currentTarget.style&&(b.currentTarget.style.MozUserSelect="none")}catch(g){}a.vakata.dnd.init_x=b.pageX;a.vakata.dnd.init_y=b.pageY;a.vakata.dnd.user_data=e;a.vakata.dnd.is_down=!0;a.vakata.dnd.helper=a("<div id='vakata-dragged' />").html(d);a(document).bind("mousemove",a.vakata.dnd.drag);a(document).bind("mouseup",
a.vakata.dnd.drag_stop);return!1},drag:function(b){if(a.vakata.dnd.is_down){if(!a.vakata.dnd.is_drag)if(5<Math.abs(b.pageX-a.vakata.dnd.init_x)||5<Math.abs(b.pageY-a.vakata.dnd.init_y))a.vakata.dnd.helper.appendTo("body"),a.vakata.dnd.is_drag=!0,a(document).triggerHandler("drag_start.vakata",{event:b,data:a.vakata.dnd.user_data});else return;if("mousemove"===b.type){var d=a(document),g=d.scrollTop(),d=d.scrollLeft();if(20>b.pageY-g){if(e&&"down"===j&&(clearInterval(e),e=!1),!e)j="up",e=setInterval(function(){a(document).scrollTop(a(document).scrollTop()-
a.vakata.dnd.scroll_spd)},150)}else e&&"up"===j&&(clearInterval(e),e=!1);if(20>a(window).height()-(b.pageY-g)){if(e&&"up"===j&&(clearInterval(e),e=!1),!e)j="down",e=setInterval(function(){a(document).scrollTop(a(document).scrollTop()+a.vakata.dnd.scroll_spd)},150)}else e&&"down"===j&&(clearInterval(e),e=!1);if(20>b.pageX-d){if(k&&"right"===o&&(clearInterval(k),k=!1),!k)o="left",k=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()-a.vakata.dnd.scroll_spd)},150)}else k&&"left"===
o&&(clearInterval(k),k=!1);if(20>a(window).width()-(b.pageX-d)){if(k&&"left"===o&&(clearInterval(k),k=!1),!k)o="right",k=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()+a.vakata.dnd.scroll_spd)},150)}else k&&"right"===o&&(clearInterval(k),k=!1)}a.vakata.dnd.helper.css({left:b.pageX+a.vakata.dnd.helper_left+"px",top:b.pageY+a.vakata.dnd.helper_top+"px"});a(document).triggerHandler("drag.vakata",{event:b,data:a.vakata.dnd.user_data})}},drag_stop:function(b){k&&clearInterval(k);
e&&clearInterval(e);a(document).unbind("mousemove",a.vakata.dnd.drag);a(document).unbind("mouseup",a.vakata.dnd.drag_stop);a(document).triggerHandler("drag_stop.vakata",{event:b,data:a.vakata.dnd.user_data});a.vakata.dnd.helper.remove();a.vakata.dnd.init_x=0;a.vakata.dnd.init_y=0;a.vakata.dnd.user_data={};a.vakata.dnd.is_down=!1;a.vakata.dnd.is_drag=!1}};a(function(){a.vakata.css.add_sheet({str:"#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ",
title:"vakata"})});a.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1};this.get_container().bind("mouseenter.jstree",a.proxy(function(e){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.themes&&(f.attr("class","jstree-"+this.data.themes.theme),g&&g.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),
e.currentTarget===e.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target))e=a.jstree._reference(e.target),e.data.dnd.foreign?(e=e._get_settings().dnd.drag_check.call(this,{o:b,r:e.get_container(),is_root:!0}),(!0===e||!0===e.inside||!0===e.before||!0===e.after)&&a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(e.prepare_move(b,e.get_container(),"last"),e.check_move()&&a.vakata.dnd.helper.children("ins").attr("class",
"jstree-ok"))},this)).bind("mouseup.jstree",a.proxy(function(e){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&e.currentTarget===e.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target){var d=a.jstree._reference(e.currentTarget);d.data.dnd.foreign?(e=d._get_settings().dnd.drag_check.call(this,{o:b,r:d.get_container(),is_root:!0}),(!0===e||!0===e.inside||!0===e.before||!0===e.after)&&d._get_settings().dnd.drag_finish.call(this,
{o:b,r:d.get_container(),is_root:!0})):d.move_node(b,d.get_container(),"last",e[d._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",a.proxy(function(b){if(b.relatedTarget&&b.relatedTarget.id&&"jstree-marker-line"===b.relatedTarget.id)return!1;a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),
a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){var e=this.get_container()[0];b.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft+=a.vakata.dnd.scroll_spd},e),100)):b.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&
clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft-=a.vakata.dnd.scroll_spd},e),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1);b.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop=this.scrollTop+a.vakata.dnd.scroll_spd},e),100)):b.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop=
this.scrollTop-a.vakata.dnd.scroll_spd},e),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",a.proxy(function(){a.vakata.dnd.is_drag&&(a.vakata.dnd.user_data.jstree&&f&&g)&&(f.hide(),g.hide())},this)).delegate("a","mousedown.jstree",a.proxy(function(a){if(1===a.which)return this.start_drag(a.currentTarget,a),!1},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_enter(b.currentTarget)},this)).delegate("a",
"mousemove.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&((!d||!d.length||d.children("a")[0]!==b.currentTarget)&&this.dnd_enter(b.currentTarget),"undefined"===typeof this.data.dnd.off.top&&(this.data.dnd.off=a(b.target).offset()),this.data.dnd.w=(b.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,0>this.data.dnd.w&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&
a.vakata.dnd.user_data.jstree){if(b.relatedTarget&&b.relatedTarget.id&&"jstree-marker-line"===b.relatedTarget.id)return!1;f&&f.hide();g&&g.hide();this.data.dnd.mto=setTimeout(function(a){return function(){a.dnd_leave(b)}}(this),0)}},this)).delegate("a","mouseup.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_finish(b)},this));a(document).bind("drag_stop.vakata",a.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1);this.data.dnd.to2&&clearTimeout(this.data.dnd.to2);
this.data.dnd.i1&&clearInterval(this.data.dnd.i1);this.data.dnd.i2&&clearInterval(this.data.dnd.i2);this.data.dnd.after=!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;this.data.dnd.off=!1;this.data.dnd.prepared=!1;this.data.dnd.w=!1;this.data.dnd.to1=!1;this.data.dnd.to2=!1;this.data.dnd.i1=!1;this.data.dnd.i2=!1;this.data.dnd.active=!1;this.data.dnd.foreign=!1;f&&f.css({top:"-2000px"});g&&g.css({top:"-2000px"})},this)).bind("drag_start.vakata",a.proxy(function(b,e){if(e.data.jstree){var d=a(e.event.target);
d.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(d)}},this));var e=this._get_settings().dnd;e.drag_target&&a(document).delegate(e.drag_target,"mousedown.jstree-"+this.get_index(),a.proxy(function(e){b=e.target;a.vakata.dnd.drag_start(e,{jstree:!0,obj:e.target},"<ins class='jstree-icon'></ins>"+a(e.target).text());this.data.themes&&(f&&f.attr("class","jstree-"+this.data.themes.theme),g&&g.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+
this.data.themes.theme));a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var d=this.get_container();this.data.dnd.cof=d.offset();this.data.dnd.cw=parseInt(d.width(),10);this.data.dnd.ch=parseInt(d.height(),10);this.data.dnd.foreign=!0;e.preventDefault()},this));e.drop_target&&a(document).delegate(e.drop_target,"mouseenter.jstree-"+this.get_index(),a.proxy(function(e){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:b,r:a(e.target),e:e})&&a.vakata.dnd.helper.children("ins").attr("class",
"jstree-ok")},this)).delegate(e.drop_target,"mouseleave.jstree-"+this.get_index(),a.proxy(function(){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(e.drop_target,"mouseup.jstree-"+this.get_index(),a.proxy(function(e){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:b,r:a(e.target),e:e})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,
drop_target:".jstree-drop",drop_check:function(){return!0},drop_finish:a.noop,drag_target:".jstree-draggable",drag_finish:a.noop,drag_check:function(){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(d&&d.length){this.data.dnd.off=d.offset();this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+d.width());if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:b,r:d});this.data.dnd.after=a.after;this.data.dnd.before=a.before;this.data.dnd.inside=
a.inside;this.data.dnd.prepared=!0;return this.dnd_show()}this.prepare_move(b,d,"before");this.data.dnd.before=this.check_move();this.prepare_move(b,d,"after");this.data.dnd.after=this.check_move();this._is_loaded(d)?(this.prepare_move(b,d,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1;this.data.dnd.prepared=!0;return this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var b=["before","inside","after"],e=!1,d=this._get_settings().core.rtl,b=this.data.dnd.w<
this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=2*this.data.core.li_height/3?this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"];a.each(b,a.proxy(function(b,d){if(this.data.dnd[d])return a.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),e=d,!1},this));!1===e&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");b=d?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(e){case "before":f.css({left:b+
"px",top:this.data.dnd.off.top-6+"px"}).show();g&&g.css({left:b+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case "after":f.css({left:b+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show();g&&g.css({left:b+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case "inside":f.css({left:b+(d?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();g&&g.hide();break;default:f.hide(),g&&g.hide()}return r=e}},dnd_open:function(){this.data.dnd.to2=
!1;this.open_node(d,a.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(a){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:b,r:d,p:r}):(this.dnd_prepare(),this.move_node(b,d,r,a[this._get_settings().dnd.copy_modifier+"Key"]));d=b=!1;f.hide();g&&g.hide()},dnd_enter:function(b){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var e=this._get_settings().dnd;this.data.dnd.prepared=!1;
d=this._get_node(b);e.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(a.proxy(this.dnd_prepare,this),e.check_timeout)):this.dnd_prepare();e.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),d&&(d.length&&d.hasClass("jstree-closed"))&&(this.data.dnd.to2=setTimeout(a.proxy(this.dnd_open,this),e.open_timeout))):d&&(d.length&&d.hasClass("jstree-closed"))&&this.dnd_open()},dnd_leave:function(b){this.data.dnd.after=!1;this.data.dnd.before=!1;
this.data.dnd.inside=!1;a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");f.hide();g&&g.hide();if(d&&d[0]===b.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2))clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1},start_drag:function(e,d){b=this._get_node(e);this.data.ui&&this.is_selected(b)&&(b=this._get_node(null,!0));var k=1<b.length?this._get_string("multiple_selection"):this.get_text(b),l=this.get_container();this._get_settings().core.html_titles||
(k=k.replace(/</ig,"&lt;").replace(/>/ig,"&gt;"));a.vakata.dnd.drag_start(d,{jstree:!0,obj:b},"<ins class='jstree-icon'></ins>"+k);this.data.themes&&(f&&f.attr("class","jstree-"+this.data.themes.theme),g&&g.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));this.data.dnd.cof=l.offset();this.data.dnd.cw=parseInt(l.width(),10);this.data.dnd.ch=parseInt(l.height(),10);this.data.dnd.active=!0}}});a(function(){a.vakata.css.add_sheet({str:"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }",
title:"jstree"});f=a("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(a){f.hide();g.hide();a.preventDefault();a.stopImmediatePropagation();return!1}).appendTo("body");g=a("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(a){if(d&&d.length)return d.children("a").trigger(a),a.preventDefault(),a.stopImmediatePropagation(),!1}).bind("mouseleave",function(b){var e=a(b.relatedTarget);if((e.is(".jstree")||0===e.closest(".jstree").length)&&
d&&d.length)return d.children("a").trigger(b),f.hide(),g.hide(),b.preventDefault(),b.stopImmediatePropagation(),!1}).appendTo("body");a(document).bind("drag_start.vakata",function(a,b){b.data.jstree&&(f.show(),g&&g.show())});a(document).bind("drag_stop.vakata",function(a,b){b.data.jstree&&(f.hide(),g&&g.hide())})})})(j);(function(a){a.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;this.data.ui&&this.data.checkbox.noui&&(this.select_node=
this.deselect_node=this.deselect_all=a.noop,this.get_selected=this.get_checked);this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",a.proxy(function(a,c){this._prepare_checkboxes(c.rslt.obj)},this)).bind("loaded.jstree",a.proxy(function(){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",a.proxy(function(a){a.preventDefault();this._get_node(a.target).hasClass("jstree-checked")?this.uncheck_node(a.target):
this.check_node(a.target);if(this.data.ui&&this.data.checkbox.noui){this.save_selected();this.data.cookies&&this.save_cookie("select_node")}else{a.stopImmediatePropagation();return false}},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(a){return["check_"+(a[0].id||Math.ceil(1E4*Math.random())),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},
_fn:{_checkbox_notify:function(a,c){c.checked&&this.check_node(a,!1)},_prepare_checkboxes:function(b){b=!b||-1==b?this.get_container().find("> ul > li"):this._get_node(b);if(!1!==b){var d,f=this,g,k=this._get_settings().checkbox.two_state,e=this._get_settings().checkbox.real_checkboxes,j=this._get_settings().checkbox.real_checkboxes_names;b.each(function(){g=a(this);d=g.is("li")&&(g.hasClass("jstree-checked")||e&&g.children(":checked").length)?"jstree-checked":"jstree-unchecked";g.find("li").andSelf().each(function(){var b=
a(this),g;b.children("a"+(f.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(k?"jstree-unchecked":d);e&&(b.children(":checkbox").length?b.children(":checkbox").addClass("jstree-real-checkbox"):(g=j.call(f,b),b.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+g[0]+"' name='"+g[0]+"' value='"+g[1]+"' />")),"jstree-checked"===d&&b.children(":checkbox").attr("checked",
"checked"));"jstree-checked"===d&&!k&&b.find("li").addClass("jstree-checked")})});k||(1===b.length&&b.is("li")&&this._repair_state(b),b.is("li")?b.each(function(){f._repair_state(this)}):b.find("> ul > li").each(function(){f._repair_state(this)}),b.find(".jstree-checked").parent().parent().each(function(){f._repair_state(this)}))}},change_state:function(b,d){var b=this._get_node(b),f=!1,g=this._get_settings().checkbox.real_checkboxes;if(!b||-1===b)return!1;d=!1===d||!0===d?d:b.hasClass("jstree-checked");
if(this._get_settings().checkbox.two_state)d?(b.removeClass("jstree-checked").addClass("jstree-unchecked"),g&&b.children(":checkbox").removeAttr("checked")):(b.removeClass("jstree-unchecked").addClass("jstree-checked"),g&&b.children(":checkbox").attr("checked","checked"));else{if(d){f=b.find("li").andSelf();if(!f.filter(".jstree-checked, .jstree-undetermined").length)return!1;f.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");g&&f.children(":checkbox").removeAttr("checked")}else{f=
b.find("li").andSelf();if(!f.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;f.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");g&&f.children(":checkbox").attr("checked","checked");this.data.ui&&(this.data.ui.last_selected=b);this.data.checkbox.last_selected=b}b.parentsUntil(".jstree","li").each(function(){var b=a(this);if(d){if(b.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return b.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),
g&&b.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"),!1;b.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");g&&b.children(":checkbox").removeAttr("checked")}else{if(b.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return b.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),g&&b.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"),
!1;b.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");g&&b.children(":checkbox").attr("checked","checked")}})}this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked());this.__callback(b);return!0},check_node:function(a){if(this.change_state(a,!1)){a=this._get_node(a);if(this._get_settings().checkbox.checked_parent_open){var c=this;a.parents(".jstree-closed").each(function(){c.open_node(this,!1,!0)})}this.__callback({obj:a})}},uncheck_node:function(a){this.change_state(a,
!0)&&this.__callback({obj:this._get_node(a)})},check_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!1)});this.__callback()},uncheck_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!0)});this.__callback()},is_checked:function(a){a=this._get_node(a);
return a.length?a.is(".jstree-checked"):!1},get_checked:function(a,c){a=!a||-1===a?this.get_container():this._get_node(a);return c||this._get_settings().checkbox.two_state?a.find(".jstree-checked"):a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a,c){a=!a||-1===a?this.get_container():this._get_node(a);return c||this._get_settings().checkbox.two_state?a.find(".jstree-unchecked"):a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},
show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(a){a=this._get_node(a);if(a.length){var c=this._get_settings().checkbox.real_checkboxes,d=a.find("> ul > .jstree-checked").length,g=a.find("> ul > .jstree-undetermined").length,f=a.find("> ul > li").length;0===f?a.hasClass("jstree-undetermined")&&this.change_state(a,!1):0===d&&0===
g?this.change_state(a,!0):d===f?this.change_state(a,!1):(a.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),c&&a.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"))}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var b=this,d=this.data.ui.to_select,d=a.map(a.makeArray(d),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,
"\\.").replace(/\:/g,"\\:")});this.deselect_all();a.each(d,function(a,c){b.check_node(c)});this.__callback()}else this.__call_old()},save_loaded:function(){var a=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&a.data.core.to_load.push("#"+this.id)})}}});a(function(){a.vakata.css.add_sheet({str:".jstree .jstree-real-checkbox { display:none; } ",title:"jstree"})})})(j);(function(a){a.vakata.xslt=function(b,d,f){var e="",l;
if(document.recalc)return l=document.createElement("xml"),e=document.createElement("xml"),l.innerHTML=b,e.innerHTML=d,a("body").append(l).append(e),setTimeout(function(b,e,d){return function(){d.call(null,b.transformNode(e.XMLDocument));setTimeout(function(b,e){return function(){a(b).remove();a(e).remove()}}(b,e),200)}}(l,e,f),100),!0;"undefined"!==typeof window.DOMParser&&("undefined"!==typeof window.XMLHttpRequest&&"undefined"===typeof window.XSLTProcessor)&&(b=(new DOMParser).parseFromString(b,
"text/xml"),d=(new DOMParser).parseFromString(d,"text/xml"));if("undefined"!==typeof window.DOMParser&&"undefined"!==typeof window.XMLHttpRequest&&"undefined"!==typeof window.XSLTProcessor){l=new XSLTProcessor;e=a.isFunction(l.transformDocument)?"undefined"!==typeof window.XMLSerializer:!0;if(!e)return!1;b=(new DOMParser).parseFromString(b,"text/xml");d=(new DOMParser).parseFromString(d,"text/xml");a.isFunction(l.transformDocument)?(e=document.implementation.createDocument("","",null),l.transformDocument(b,
d,e,null),f.call(null,(new XMLSerializer).serializeToString(e))):(l.importStylesheet(d),e=l.transformToFragment(b,document),f.call(null,a("<div />").append(e).html()));return!0}return!1};var b={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">\t<xsl:call-template name="nodes">\t\t<xsl:with-param name="node" select="/root" />\t</xsl:call-template></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<ul>\t<xsl:for-each select="$node/item">\t\t<xsl:variable name="children" select="count(./item) &gt; 0" />\t\t<li>\t\t\t<xsl:attribute name="class">\t\t\t\t<xsl:if test="position() = last()">jstree-last </xsl:if>\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t\t\t</xsl:choose>\t\t\t\t<xsl:value-of select="@class" />\t\t\t</xsl:attribute>\t\t\t<xsl:for-each select="@*">\t\t\t\t<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t</xsl:if>\t\t\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t\t\t<xsl:for-each select="content/name">\t\t\t\t<a>\t\t\t\t<xsl:attribute name="href">\t\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t\t\t</xsl:choose>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t\t\t<xsl:for-each select="@*">\t\t\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t\t</xsl:if>\t\t\t\t</xsl:for-each>\t\t\t\t\t<ins>\t\t\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t\t\t</xsl:attribute>\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t\t\t</ins>\t\t\t\t\t<xsl:copy-of select="./child::node()" />\t\t\t\t</a>\t\t\t</xsl:for-each>\t\t\t<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>\t\t</li>\t</xsl:for-each>\t</ul></xsl:template></xsl:stylesheet>',
flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">\t<ul>\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">\t\t<xsl:call-template name="nodes">\t\t\t<xsl:with-param name="node" select="." />\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t</xsl:call-template>\t</xsl:for-each>\t</ul></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<xsl:param name="is_last" />\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />\t<li>\t<xsl:attribute name="class">\t\t<xsl:if test="$is_last = true()">jstree-last </xsl:if>\t\t<xsl:choose>\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t</xsl:choose>\t\t<xsl:value-of select="@class" />\t</xsl:attribute>\t<xsl:for-each select="@*">\t\t<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t</xsl:if>\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t<xsl:for-each select="content/name">\t\t<a>\t\t<xsl:attribute name="href">\t\t\t<xsl:choose>\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t</xsl:choose>\t\t</xsl:attribute>\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t<xsl:for-each select="@*">\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t</xsl:if>\t\t</xsl:for-each>\t\t\t<ins>\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t</ins>\t\t\t<xsl:copy-of select="./child::node()" />\t\t</a>\t</xsl:for-each>\t<xsl:if test="$children">\t\t<ul>\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">\t\t\t<xsl:call-template name="nodes">\t\t\t\t<xsl:with-param name="node" select="." />\t\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t\t</xsl:call-template>\t\t</xsl:for-each>\t\t</ul>\t</xsl:if>\t</li></xsl:template></xsl:stylesheet>'},
d=function(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};a.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(a,b,c){var e=this;this.load_node_xml(a,function(){e.__callback({obj:e._get_node(a)});b.call(this)},c)},_is_loaded:function(b){var d=this._get_settings().xml_data,b=this._get_node(b);return-1==b||
!b||!d.ajax&&!a.isFunction(d.data)||b.is(".jstree-open, .jstree-leaf")||0<b.children("ul").children("li").size()},load_node_xml:function(b,d,f){var e=this.get_settings().xml_data,l=function(){},j=function(){};if((b=this._get_node(b))&&-1!==b){if(b.data("jstree-is-loading"))return;b.data("jstree-is-loading",!0)}switch(!0){case !e.data&&!e.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(e.data):e.data.call(this,b,a.proxy(function(f){this.parse_xml(f,a.proxy(function(f){if(f){f=
f.replace(/ ?xmlns="[^"]*"/ig,"");if(f.length>10){f=a(f);if(b===-1||!b)this.get_container().children("ul").empty().append(f.children());else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(f);b.removeData("jstree-is-loading")}e.clean_node&&this.clean_node(b);d&&d.call(this)}else if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(e.correct_state){this.correct_state(b);d&&d.call(this)}}else if(e.correct_state){this.get_container().children("ul").empty();
d&&d.call(this)}}},this))},this));break;case !!e.data&&!e.ajax||!!e.data&&!!e.ajax&&(!b||-1===b):(!b||-1==b)&&this.parse_xml(e.data,a.proxy(function(f){if(f){f=f.replace(/ ?xmlns="[^"]*"/ig,"");if(f.length>10){f=a(f);this.get_container().children("ul").empty().append(f.children());e.clean_node&&this.clean_node(b);d&&d.call(this)}}else if(e.correct_state){this.get_container().children("ul").empty();d&&d.call(this)}},this));break;case !e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b&&-1!==b:l=function(a,c,
d){var g=this.get_settings().xml_data.ajax.error;g&&g.call(this,a,c,d);if(b!==-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");c==="success"&&e.correct_state&&this.correct_state(b)}else c==="success"&&e.correct_state&&this.get_container().children("ul").empty();f&&f.call(this)},j=function(f,k,j){var f=j.responseText,o=this.get_settings().xml_data.ajax.success;o&&(f=o.call(this,f,k,j)||f);if(f===""||f&&f.toString&&f.toString().replace(/^[\s\n]+$/,
"")==="")return l.call(this,j,k,"");this.parse_xml(f,a.proxy(function(f){if(f){f=f.replace(/ ?xmlns="[^"]*"/ig,"");if(f.length>10){f=a(f);if(b===-1||!b)this.get_container().children("ul").empty().append(f.children());else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(f);b.removeData("jstree-is-loading")}e.clean_node&&this.clean_node(b);d&&d.call(this)}else if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(e.correct_state){this.correct_state(b);
d&&d.call(this)}}else if(e.correct_state){this.get_container().children("ul").empty();d&&d.call(this)}}},this))},e.ajax.context=this,e.ajax.error=l,e.ajax.success=j,e.ajax.dataType||(e.ajax.dataType="xml"),a.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,b)),a.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,b)),a.ajax(e.ajax)}},parse_xml:function(d,g){var f=this._get_settings().xml_data;a.vakata.xslt(d,b[f.xsl],g)},get_xml:function(b,g,f,e,j){var o="",r=this._get_settings(),
q=this,u,t,v,z,x;b||(b="flat");j||(j=0);g=this._get_node(g);if(!g||-1===g)g=this.get_container().find("> ul > li");f=a.isArray(f)?f:["id","class"];!j&&(this.data.types&&-1===a.inArray(r.types.type_attr,f))&&f.push(r.types.type_attr);e=a.isArray(e)?e:[];j||(r.xml_data.get_include_preamble&&(o+='<?xml version="1.0" encoding="UTF-8"?>'),o+="<root>");g.each(function(){o=o+"<item";v=a(this);a.each(f,function(a,b){var c=v.attr(b);if(!r.xml_data.get_skip_empty||typeof c!=="undefined")o=o+(" "+b+'="'+d((" "+
(c||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"')});v.hasClass("jstree-open")&&(o=o+' state="open"');v.hasClass("jstree-closed")&&(o=o+' state="closed"');b==="flat"&&(o=o+(' parent_id="'+d(j)+'"'));o=o+">";o=o+"<content>";z=v.children("a");z.each(function(){u=a(this);x=false;o=o+"<name";a.inArray("languages",r.plugins)!==-1&&a.each(r.languages,function(a,b){if(u.hasClass(b)){o=o+(' lang="'+d(b)+'"');x=b;return false}});e.length&&a.each(e,function(a,
b){var c=u.attr(b);if(!r.xml_data.get_skip_empty||typeof c!=="undefined")o=o+(" "+b+'="'+d((" "+c||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"')});u.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(o=o+(' icon="'+d(u.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'));u.children("ins").get(0).style.backgroundImage.length&&(o=o+(' icon="'+
d(u.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"'));o=o+">";o=o+("<![CDATA["+q.get_text(u,x)+"]]\>");o=o+"</name>"});o=o+"</content>";t=v[0].id||true;v=v.find("> ul > li");t=v.length?q.get_xml(b,v,f,e,t):"";b=="nest"&&(o=o+t);o=o+"</item>";b=="flat"&&(o=o+t)});j||(o+="</root>");return o}}})})(j);(function(a){a.expr[":"].jstree_contains=function(a,c,d){return 0<=(a.textContent||a.innerText||"").toLowerCase().indexOf(d[3].toLowerCase())};
a.expr[":"].jstree_title_contains=function(a,c,d){return 0<=(a.getAttribute("title")||"").toLowerCase().indexOf(d[3].toLowerCase())};a.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=a();this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(b,d){a(this).children("ul").find("li").hide().removeClass("jstree-last");d.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){a(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",
function(){a(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(b,d){if(""===a.trim(b))this.clear_search();else{var f=this.get_settings().search,g=this,k=function(){};this.data.search.str=b;if(!d&&!1!==f.ajax&&0<this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length){this.search.supress_callback=!0;k=function(a,b,c){var d=this.get_settings().search.ajax.success;
d&&(a=d.call(this,a,b,c)||a);this.data.search.to_open=a;this._search_open()};f.ajax.context=this;f.ajax.error=function(){};f.ajax.success=k;a.isFunction(f.ajax.url)&&(f.ajax.url=f.ajax.url.call(this,b));a.isFunction(f.ajax.data)&&(f.ajax.data=f.ajax.data.call(this,b));f.ajax.data||(f.ajax.data={search_string:b});if(!f.ajax.dataType||/^json/.exec(f.ajax.dataType))f.ajax.dataType="json";a.ajax(f.ajax)}else this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+
(this.data.languages?"."+this.get_lang():"")+":"+f.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){g.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:b})}},clear_search:function(){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=a()},_search_open:function(){var b=this,d=!0,f=[],g=[];this.data.search.to_open.length&&
(a.each(this.data.search.to_open,function(b,e){if("#"==e)return!0;a(e).length&&a(e).is(".jstree-closed")?f.push(e):g.push(e)}),f.length&&(this.data.search.to_open=g,a.each(f,function(a,c){b.open_node(c,function(){b._search_open(!0)})}),d=!1));d&&this.search(this.data.search.str,!0)}}})})(j);(function(a){a.vakata.context={hide_on_mouseleave:!1,cnt:a("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(b,d,f,g,k,e,j){a.vakata.context.rtl=!!j;if(b=a.vakata.context.parse(b)){a.vakata.context.vis=
!0;a.vakata.context.tgt=d;a.vakata.context.par=e||d||null;a.vakata.context.data=k||null;a.vakata.context.cnt.html(b).css({visibility:"hidden",display:"block",left:0,top:0});if(a.vakata.context.hide_on_mouseleave)a.vakata.context.cnt.one("mouseleave",function(){a.vakata.context.hide()});k=a.vakata.context.cnt.height();e=a.vakata.context.cnt.width();f+e>a(document).width()&&(f=a(document).width()-(e+5),a.vakata.context.cnt.find("li > ul").addClass("right"));g+k>a(document).height()&&(g-=k+d[0].offsetHeight,
a.vakata.context.cnt.find("li > ul").addClass("bottom"));a.vakata.context.cnt.css({left:f,top:g}).find("li:has(ul)").bind("mouseenter",function(){var b=a(document).width(),e=a(document).height(),d=a(this).children("ul").show();b!==a(document).width()&&d.toggleClass("right");e!==a(document).height()&&d.toggleClass("bottom")}).bind("mouseleave",function(){a(this).children("ul").hide()}).end().css({visibility:"visible"}).show();a(document).triggerHandler("context_show.vakata")}},hide:function(){a.vakata.context.vis=
!1;a.vakata.context.cnt.attr("class","").css({visibility:"hidden"});a(document).triggerHandler("context_hide.vakata")},parse:function(b,d){if(!b)return!1;var f="",g=!1,k=!0;d||(a.vakata.context.func={});f+="<ul>";a.each(b,function(b,d){if(!d)return true;a.vakata.context.func[b]=d.action;!k&&d.separator_before&&(f=f+"<li class='vakata-separator vakata-separator-before'></li>");k=false;f=f+("<li class='"+(d._class||"")+(d._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ");d.icon&&d.icon.indexOf("/")===
-1&&(f=f+(" class='"+d.icon+"' "));d.icon&&d.icon.indexOf("/")!==-1&&(f=f+(" style='background:url("+d.icon+") center center no-repeat;' "));f=f+(">&#160;</ins><a href='#' rel='"+b+"'>");d.submenu&&(f=f+("<span style='float:"+(a.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"));f=f+(d.label+"</a>");if(d.submenu)(g=a.vakata.context.parse(d.submenu,true))&&(f=f+g);f=f+"</li>";if(d.separator_after){f=f+"<li class='vakata-separator vakata-separator-after'></li>";k=true}});f=f.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,
"");f+="</ul>";a(document).triggerHandler("context_parse.vakata");return 10<f.length?f:!1},exec:function(b){return a.isFunction(a.vakata.context.func[b])?(a.vakata.context.func[b].call(a.vakata.context.data,a.vakata.context.par),!0):!1}};a(function(){a.vakata.css.add_sheet({str:"#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ",
title:"vakata"});a.vakata.context.cnt.delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(){!a(this).parent().hasClass("jstree-contextmenu-disabled")&&a.vakata.context.exec(a(this).attr("rel"))?a.vakata.context.hide():a(this).blur()}).delegate("a","mouseover",function(){a.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");a(document).bind("mousedown",function(b){a.vakata.context.vis&&!a.contains(a.vakata.context.cnt[0],b.target)&&
a.vakata.context.hide()});"undefined"!==typeof a.hotkeys&&a(document).bind("keydown","up",function(b){if(a.vakata.context.vis){var d=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();d.length||(d=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last());d.addClass("vakata-hover");b.stopImmediatePropagation();b.preventDefault()}}).bind("keydown","down",function(b){if(a.vakata.context.vis){var d=
a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();d.length||(d=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first());d.addClass("vakata-hover");b.stopImmediatePropagation();b.preventDefault()}}).bind("keydown","right",function(b){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),
b.stopImmediatePropagation(),b.preventDefault())}).bind("keydown","left",function(b){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault())}).bind("keydown","esc",function(b){a.vakata.context.hide();b.preventDefault()}).bind("keydown","space",function(b){a.vakata.context.cnt.find(".vakata-hover").last().children("a").click();b.preventDefault()})});a.jstree.plugin("contextmenu",
{__init:function(){this.get_container().delegate("a","contextmenu.jstree",a.proxy(function(b){b.preventDefault();a(b.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(b.currentTarget,b.pageX,b.pageY)},this)).delegate("a","click.jstree",a.proxy(function(){this.data.contextmenu&&a.vakata.context.hide()},this)).bind("destroy.jstree",a.proxy(function(){this.data.contextmenu&&a.vakata.context.hide()},this));a(document).bind("context_hide.vakata",a.proxy(function(){this.data.contextmenu=
!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(a){this.create(a)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(a){this.is_selected(a)?this.remove():this.remove(a)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,
separator_after:!1,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(a){this.copy(a)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(b,d,f){var b=this._get_node(b),g=this.get_settings().contextmenu,k=b.children("a:visible:eq(0)"),e=!1,e=!1;g.select_node&&(this.data.ui&&!this.is_selected(b))&&(this.deselect_all(),this.select_node(b,
!0));if(g.show_at_node||"undefined"===typeof d||"undefined"===typeof f)e=k.offset(),d=e.left,f=e.top+this.data.core.li_height;e=b.data("jstree")&&b.data("jstree").contextmenu?b.data("jstree").contextmenu:g.items;a.isFunction(e)&&(e=e.call(this,b));this.data.contextmenu=!0;a.vakata.context.show(e,k,d,f,this,b,this._get_settings().core.rtl);this.data.themes&&a.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})})(j);(function(a){a.jstree.plugin("types",{__init:function(){var b=
this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",a.proxy(function(){var d=b.type_attr,f="",g=this;a.each(b.types,function(b,e){a.each(e,function(a){/^(max_depth|max_children|icon|valid_children)$/.test(a)||g.data.types.attach_to.push(a)});if(!e.icon)return!0;if(e.icon.image||e.icon.position)f="default"==b?f+(".jstree-"+g.get_index()+" a > .jstree-icon { "):f+(".jstree-"+g.get_index()+" li["+d+'="'+b+'"] > a > .jstree-icon { '),e.icon.image&&(f+=" background-image:url("+
e.icon.image+"); "),f=e.icon.position?f+(" background-position:"+e.icon.position+"; "):f+" background-position:0 0; ",f+="} "});""!==f&&a.vakata.css.add_sheet({str:f,title:"jstree-types"})},this)).bind("before.jstree",a.proxy(function(b,d){var g,f;if((g=(g=this._get_settings().types.use_data?this._get_node(d.args[0]):!1)&&-1!==g&&g.length?g.data("jstree"):!1)&&g.types&&!1===g.types[d.func])return b.stopImmediatePropagation(),!1;if(-1!==a.inArray(d.func,this.data.types.attach_to)&&d.args[0]&&(d.args[0].tagName||
d.args[0].jquery))if(g=this._get_settings().types.types,f=this._get_type(d.args[0]),(g[f]&&"undefined"!==typeof g[f][d.func]||g["default"]&&"undefined"!==typeof g["default"][d.func])&&!1===this._check(d.func,d.args[0]))return b.stopImmediatePropagation(),!1},this));f&&this.get_container().bind("load_node.jstree set_type.jstree",a.proxy(function(b,d){var g=d&&d.rslt&&d.rslt.obj&&-1!==d.rslt.obj?this._get_node(d.rslt.obj).parent():this.get_container_ul(),f=!1,e=this._get_settings().types;a.each(e.types,
function(a,b){if(b.icon&&(b.icon.image||b.icon.position))f="default"===a?g.find("li > a > .jstree-icon"):g.find("li["+e.type_attr+"='"+a+"'] > a > .jstree-icon"),b.icon.image&&f.css("backgroundImage","url("+b.icon.image+")"),f.css("backgroundPosition",b.icon.position||"0 0")})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(a,c){c.type&&this._get_settings().types.use_data&&
this.set_type(c.type,a)},_get_type:function(a){a=this._get_node(a);return!a||!a.length?!1:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(a,c){var c=this._get_node(c),d=!c.length||!a?!1:c.attr(this._get_settings().types.type_attr,a);d&&this.__callback({obj:c,type:a});return d},_check:function(b,d,f){var d=this._get_node(d),g=!1,k=this._get_type(d),e=0,j=this,o=this._get_settings().types,r=!1;if(-1===d)if(o[b])g=o[b];else return;else{if(!1===k)return;(r=o.use_data?d.data("jstree"):
!1)&&r.types&&"undefined"!==typeof r.types[b]?g=r.types[b]:o.types[k]&&"undefined"!==typeof o.types[k][b]?g=o.types[k][b]:o.types["default"]&&"undefined"!==typeof o.types["default"][b]&&(g=o.types["default"][b])}a.isFunction(g)&&(g=g.call(this,d));"max_depth"===b&&(-1!==d&&!1!==f&&-2!==o.max_depth&&0!==g)&&d.children("a:eq(0)").parentsUntil(".jstree","li").each(function(a){if(-1!==o.max_depth&&0>=o.max_depth-(a+1))return g=0,!1;e=0===a?g:j._check(b,this,!1);if(-1!==e&&0>=e-(a+1))return g=0,!1;if(0<=
e&&(e-(a+1)<g||0>g))g=e-(a+1);if(0<=o.max_depth&&(o.max_depth-(a+1)<g||0>g))g=o.max_depth-(a+1)});return g},check_move:function(){if(!this.__call_old())return!1;var b=this._get_move(),d=b.rt._get_settings().types,f=b.rt._check("max_children",b.cr),g=b.rt._check("max_depth",b.cr),k=b.rt._check("valid_children",b.cr),e=0,j=1;if("none"===k||a.isArray(k)&&(b.ot&&b.ot._get_type)&&(b.o.each(function(){if(-1===a.inArray(b.ot._get_type(this),k))return j=!1}),!1===j)||-2!==d.max_children&&-1!==f&&(e=-1===
b.cr?this.get_container().find("> ul > li").not(b.o).length:b.cr.find("> ul > li").not(b.o).length,e+b.o.length>f))return!1;if(-2!==d.max_depth&&-1!==g){j=0;if(0===g)return!1;if("undefined"===typeof b.o.d){for(d=b.o;0<d.length;)d=d.find("> ul > li"),j++;b.o.d=j}if(0>g-b.o.d)return!1}return!0},create_node:function(b,d,f,g,k,e){if(!e&&(k||this._is_loaded(b))){var j="string"==typeof d&&d.match(/^before|after$/i)&&-1!==b?this._get_parent(b):this._get_node(b),o=this._get_settings().types,r=this._check("max_children",
j),q=this._check("max_depth",j),u=this._check("valid_children",j);"string"===typeof f&&(f={data:f});f||(f={});if("none"===u)return!1;if(a.isArray(u))if(!f.attr||!f.attr[o.type_attr])f.attr||(f.attr={}),f.attr[o.type_attr]=u[0];else if(-1===a.inArray(f.attr[o.type_attr],u))return!1;if(-2!==o.max_children&&-1!==r&&(j=-1===j?this.get_container().find("> ul > li").length:j.find("> ul > li").length,j+1>r)||-2!==o.max_depth&&-1!==q&&0>q-1)return!1}return this.__call_old(!0,b,d,f,g,k,e)}}})})(j);(function(a){a.jstree.plugin("html_data",
{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return 3==this.nodeType}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(a,c,d){var f=this;this.load_node_html(a,function(){f.__callback({obj:f._get_node(a)});c.call(this)},d)},_is_loaded:function(b){b=this._get_node(b);return-1==b||!b||!this._get_settings().html_data.ajax&&
!a.isFunction(this._get_settings().html_data.data)||b.is(".jstree-open, .jstree-leaf")||0<b.children("ul").children("li").size()},load_node_html:function(b,d,f){var g,k=this.get_settings().html_data,e=function(){};g=function(){};if((b=this._get_node(b))&&-1!==b){if(b.data("jstree-is-loading"))return;b.data("jstree-is-loading",!0)}switch(!0){case a.isFunction(k.data):k.data.call(this,b,a.proxy(function(e){if(e&&e!==""&&e.toString&&e.toString().replace(/^[\s\n]+$/,"")!==""){e=a(e);e.is("ul")||(e=a("<ul />").append(e));
if(b==-1||!b)this.get_container().children("ul").empty().append(e.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(e).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||
this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");b.removeData("jstree-is-loading")}this.clean_node(b);d&&d.call(this)}else if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(k.correct_state){this.correct_state(b);d&&d.call(this)}}else if(k.correct_state){this.get_container().children("ul").empty();d&&d.call(this)}},
this));break;case !k.data&&!k.ajax:if(!b||-1==b)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();d&&d.call(this);break;case !!k.data&&!k.ajax||!!k.data&&!!k.ajax&&(!b||-1===b):if(!b||
-1==b)g=a(k.data),g.is("ul")||(g=a("<ul />").append(g)),this.get_container().children("ul").empty().append(g.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();d&&d.call(this);break;case !k.data&&!!k.ajax||!!k.data&&!!k.ajax&&b&&-1!==b:b=this._get_node(b),e=function(a,
c,e){var d=this.get_settings().html_data.ajax.error;d&&d.call(this,a,c,e);if(b!=-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");c==="success"&&k.correct_state&&this.correct_state(b)}else c==="success"&&k.correct_state&&this.get_container().children("ul").empty();f&&f.call(this)},g=function(f,g,m){var j=this.get_settings().html_data.ajax.success;j&&(f=j.call(this,f,g,m)||f);if(f===""||f&&f.toString&&f.toString().replace(/^[\s\n]+$/,"")===
"")return e.call(this,m,g,"");if(f){f=a(f);f.is("ul")||(f=a("<ul />").append(f));if(b==-1||!b)this.get_container().children("ul").empty().append(f.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(f).children("ul").find("li, a").filter(function(){return!this.firstChild||
!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");b.removeData("jstree-is-loading")}this.clean_node(b);d&&d.call(this)}else if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(k.correct_state){this.correct_state(b);d&&d.call(this)}}else if(k.correct_state){this.get_container().children("ul").empty();
d&&d.call(this)}},k.ajax.context=this,k.ajax.error=e,k.ajax.success=g,k.ajax.dataType||(k.ajax.dataType="html"),a.isFunction(k.ajax.url)&&(k.ajax.url=k.ajax.url.call(this,b)),a.isFunction(k.ajax.data)&&(k.ajax.data=k.ajax.data.call(this,b)),a.ajax(k.ajax)}}}});a.jstree.defaults.plugins.push("html_data")})(j);(function(a){a.jstree.plugin("themeroller",{__init:function(){var b=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a",
"mouseenter.jstree",function(d){a(d.currentTarget).hasClass("jstree-loading")||a(this).addClass(b.item_h)}).delegate("a","mouseleave.jstree",function(){a(this).removeClass(b.item_h)}).bind("init.jstree",a.proxy(function(a,b){b.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(b.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",
a.proxy(function(){this._themeroller()},this)).bind("close_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.obj)},this)).bind("delete_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.parent)},this)).bind("correct_state.jstree",a.proxy(function(a,c){c.rslt.obj.children("ins.jstree-icon").removeClass(b.opened+" "+b.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return-1===this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,
"").indexOf("ui-icon-")}).removeClass(b.item_open+" "+b.item_clsd).addClass(b.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("a").addClass(b.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",a.proxy(function(){this.get_container().find("a."+b.item_a).removeClass(b.item_a).end().find("a.jstree-clicked").addClass(b.item_a)},this)).bind("dehover_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("a").removeClass(b.item_h)},this)).bind("hover_node.jstree",
a.proxy(function(a,c){this.get_container().find("a."+b.item_h).not(c.rslt.obj).removeClass(b.item_h);c.rslt.obj.children("a").addClass(b.item_h)},this)).bind("move_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.o);this._themeroller(b.rslt.op)},this))},__destroy:function(){var b=this._get_settings().themeroller,d=["ui-icon"];a.each(b,function(a,b){b=b.split(" ");b.length&&(d=d.concat(b))});this.get_container().removeClass("ui-widget-content").find("."+d.join(", .")).removeClass(d.join(" "))},
_fn:{_themeroller:function(a){var c=this._get_settings().themeroller,a=!a||-1==a?this.get_container_ul():this._get_node(a).parent();a.find("li.jstree-closed").children("ins.jstree-icon").removeClass(c.opened).addClass("ui-icon "+c.closed).end().children("a").addClass(c.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(c.item_clsd,"").replace(c.item_open,"").replace(c.item_leaf,"").indexOf("ui-icon-")}).removeClass(c.item_leaf+" "+
c.item_open).addClass(c.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(c.closed).addClass("ui-icon "+c.opened).end().children("a").addClass(c.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(c.item_clsd,"").replace(c.item_open,"").replace(c.item_leaf,"").indexOf("ui-icon-")}).removeClass(c.item_leaf+" "+c.item_clsd).addClass(c.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(c.closed+
" ui-icon "+c.opened).end().children("a").addClass(c.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(c.item_clsd,"").replace(c.item_open,"").replace(c.item_leaf,"").indexOf("ui-icon-")}).removeClass(c.item_clsd+" "+c.item_open).addClass(c.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",
item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}});a(function(){a.vakata.css.add_sheet({str:".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }",title:"jstree"})})})(j);(function(a){a.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",a.proxy(function(b,d){var f=[],g=!0,k;"move_node"==d.func&&(!0===d.args[4]&&d.args[0].o&&d.args[0].o.length)&&(d.args[0].o.children("a").each(function(){f.push(a(this).text().replace(/^\s+/g,
""))}),g=this._check_unique(f,d.args[0].np.find("> ul > li").not(d.args[0].o),"move_node"));if("create_node"==d.func&&(d.args[4]||this._is_loaded(d.args[0]))){g=this._get_node(d.args[0]);if(d.args[1]&&("before"===d.args[1]||"after"===d.args[1]))if(g=this._get_parent(d.args[0]),!g||-1===g)g=this.get_container();"string"===typeof d.args[2]?f.push(d.args[2]):!d.args[2]||!d.args[2].data?f.push(this._get_string("new_node")):f.push(d.args[2].data);g=this._check_unique(f,g.find("> ul > li"),"create_node")}if("rename_node"==
d.func){f.push(d.args[1]);k=this._get_node(d.args[0]);g=this._get_parent(k);if(!g||-1===g)g=this.get_container();g=this._check_unique(f,g.find("> ul > li").not(k),"rename_node")}if(!g)return b.stopPropagation(),!1},this))},defaults:{error_callback:a.noop},_fn:{_check_unique:function(b,d,f){var g=[];d.children("a").each(function(){g.push(a(this).text().replace(/^\s+/g,""))});if(!g.length||!b.length)return!0;g=g.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,
"").split(",");return g.length+b.length!=g.concat(b).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?(this._get_settings().unique.error_callback.call(null,b,d,f),!1):!0},check_move:function(){if(!this.__call_old())return!1;var b=this._get_move(),d=[];return b.o&&b.o.length?(b.o.children("a").each(function(){d.push(a(this).text().replace(/^\s+/g,""))}),this._check_unique(d,b.np.find("> ul > li").not(b.o),"check_move")):!0}}})})(j);
(function(c){c.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1;this.data.wholerow.to=!1;this.get_container().bind("init.jstree",c.proxy(function(){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",c.proxy(function(a,c){this._prepare_wholerow_span(c&&c.rslt&&c.rslt.obj?c.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",
c.proxy(function(a,c){this.data.to&&clearTimeout(this.data.to);this.data.to=setTimeout(function(a,b){return function(){a._prepare_wholerow_ul(b)}}(this,c&&c.rslt&&c.rslt.obj?c.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",c.proxy(function(){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",c.proxy(function(a,d){d.rslt.obj.each(function(){d.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+
parseInt((c(this).offset().top-d.inst.get_container().offset().top+d.inst.get_container()[0].scrollTop)/d.inst.data.core.li_height,10)+")").children("a").attr("class",d.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",c.proxy(function(a,c){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));"hover_node"===a.type&&this.get_container().find(" > .jstree-wholerow li:visible:eq("+
parseInt((c.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")").children("a").attr("class",c.rslt.obj.children(".jstree-hovered").attr("class"))},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(a){var d=c(a.currentTarget);"A"===a.target.tagName||"INS"===a.target.tagName&&d.closest("li").is(".jstree-open, .jstree-closed")||(d.closest("li").children("a:visible:eq(0)").click(),a.stopImmediatePropagation())}).delegate("li",
"mouseover.jstree",c.proxy(function(a){a.stopImmediatePropagation();if(c(a.currentTarget).children(".jstree-hovered, .jstree-clicked").length)return!1;this.hover_node(a.currentTarget);return!1},this)).delegate("li","mouseleave.jstree",c.proxy(function(a){c(a.currentTarget).children("a").hasClass("jstree-hovered").length||this.dehover_node(a.currentTarget)},this));(a||f)&&c.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();
this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(a){a=!a||-1==a?this.get_container().find("> ul > li"):this._get_node(a);!1!==a&&a.each(function(){c(this).find("li").andSelf().each(function(){var a=c(this);if(a.children(".jstree-wholerow-span").length)return!0;a.prepend("<span class='jstree-wholerow-span' style='width:"+18*a.parentsUntil(".jstree","li").length+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var b=this.get_container().children("ul").eq(0),
c=b.html();b.addClass("jstree-wholerow-real");this.data.wholerow.last_html!==c&&(this.data.wholerow.last_html=c,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(b.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(b.parent()[0].scrollWidth).css("top",-1*(b.height()+(a?5:0))).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}});c(function(){var b=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";
d&&(b+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(a||f)b+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";c.vakata.css.add_sheet({str:b,title:"jstree"})})})(j);(function(a){var b=
["getChildren","getChildrenCount","getAttr","getName","getProps"],d=function(b,d){var f=!0,b=b||{},d=[].concat(d);a.each(d,function(e,d){if(!a.isFunction(b[d]))return f=!1});return f};a.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(f,g){var k=-1==f?this._get_settings().model.object:f.data("jstree_model");if(!d(k,b))return g.call(null,!1);this._get_settings().model.async?k.getChildren(a.proxy(function(a){this.model_done(a,
g)},this)):this.model_done(k.getChildren(),g)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(b,d){var f=[],e=this._get_settings(),l=this;a.isArray(b)||(b=[b]);a.each(b,function(b,d){var g=d.getProps()||{};g.attr=d.getAttr()||{};d.getChildrenCount()&&(g.state="closed");g.data=d.getName();a.isArray(g.data)||(g.data=[g.data]);l.data.types&&a.isFunction(d.getType)&&(g.attr[e.types.type_attr]=d.getType());g.attr.id&&e.model.id_prefix&&(g.attr.id=e.model.id_prefix+g.attr.id);g.metadata||
(g.metadata={});g.metadata.jstree_model=d;f.push(g)});d.call(null,f)}}})})(j)}})()});define("jqgrid",["jquery","jqgrid-locale-"+(window&&window.__DEPS__&&window.__DEPS__.lang||"en"),"jqueryui"],function(j){(function(a){a.jgrid=a.jgrid||{};a.extend(a.jgrid,{htmlDecode:function(a){return a&&("&nbsp;"==a||"&#160;"==a||1==a.length&&160==a.charCodeAt(0))?"":!a?a:(""+a).replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"')},htmlEncode:function(a){return!a?a:(""+a).replace(/&/g,
"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\"/g,"&quot;")},format:function(d){var c=a.makeArray(arguments).slice(1);void 0===d&&(d="");return d.replace(/\{(\d+)\}/g,function(a,d){return c[d]})},getCellIndex:function(d){d=a(d);if(d.is("tr"))return-1;d=(!d.is("td")&&!d.is("th")?d.closest("td,th"):d)[0];return a.browser.msie?a.inArray(d,d.parentNode.cells):d.cellIndex},stripHtml:function(a){var a=a+"",c=/<("[^"]*"|'[^']*'|[^'">])*>/gi;return a?(a=a.replace(c,""))&&"&nbsp;"!==a&&"&#160;"!==
a?a.replace(/\"/g,"'"):"":a},stringToDoc:function(a){var c;if("string"!==typeof a)return a;try{c=(new DOMParser).parseFromString(a,"text/xml")}catch(b){c=new ActiveXObject("Microsoft.XMLDOM"),c.async=!1,c.loadXML(a)}return c&&c.documentElement&&"parsererror"!=c.documentElement.tagName?c:null},parse:function(d){"while(1);"==d.substr(0,9)&&(d=d.substr(9));"/*"==d.substr(0,2)&&(d=d.substr(2,d.length-4));d||(d="{}");return!0===a.jgrid.useJSON&&"object"===typeof ka&&"function"===typeof ka.parse?ka.parse(d):
eval("("+d+")")},parseDate:function(d,c){var b={m:1,d:1,y:1970,h:0,i:0,s:0},f,m,g;f=/[\\\/:_;.,\t\T\s-]/;if(c&&null!==c&&void 0!==c){var c=a.trim(c),c=c.split(f),d=d.split(f),k=a.jgrid.formatter.date.monthNames,e=a.jgrid.formatter.date.AmPm,j=function(a,b){0===a?12==b&&(b=0):12!=b&&(b+=12);return b};f=0;for(m=d.length;f<m;f++)"M"==d[f]&&(g=a.inArray(c[f],k),-1!==g&&12>g&&(c[f]=g+1)),"F"==d[f]&&(g=a.inArray(c[f],k),-1!==g&&11<g&&(c[f]=g+1-12)),"a"==d[f]&&(g=a.inArray(c[f],e),-1!==g&&(2>g&&c[f]==e[g])&&
(c[f]=g,b.h=j(c[f],b.h))),"A"==d[f]&&(g=a.inArray(c[f],e),-1!==g&&(1<g&&c[f]==e[g])&&(c[f]=g-2,b.h=j(c[f],b.h))),void 0!==c[f]&&(b[d[f].toLowerCase()]=parseInt(c[f],10));b.m=parseInt(b.m,10)-1;f=b.y;70<=f&&99>=f?b.y=1900+b.y:0<=f&&69>=f&&(b.y=2E3+b.y)}return new Date(b.y,b.m,b.d,b.h,b.i,b.s,0)},jqID:function(a){return(a+"").replace(/([\.\:\[\]])/g,"\\$1")},guid:1,uidPref:"jqg",randId:function(d){return(d?d:a.jgrid.uidPref)+a.jgrid.guid++},getAccessor:function(a,c){var b,f,m=[],g;if("function"===typeof c)return c(a);
b=a[c];if(void 0===b)try{if("string"===typeof c&&(m=c.split(".")),g=m.length)for(b=a;b&&g--;)f=m.shift(),b=b[f]}catch(k){}return b},ajaxOptions:{},from:function(d){return new function(c,b){"string"==typeof c&&(c=a.data(c));var d=this,f=c,g=!0,k=!1,e=b,j=/[\$,%]/g,o=null,r=null,q=!1,u="",t=[],v=!0;if("object"==typeof c&&c.push)0<c.length&&(v="object"!=typeof c[0]?!1:!0);else throw"data provides is not an array";this._hasData=function(){return null===f?!1:0===f.length?!1:!0};this._getStr=function(a){var b=
[];k&&b.push("jQuery.trim(");b.push("String("+a+")");k&&b.push(")");g||b.push(".toLowerCase()");return b.join("")};this._strComp=function(a){return"string"==typeof a?".toString()":""};this._group=function(a,b){return{field:a.toString(),unique:b,items:[]}};this._toStr=function(b){k&&(b=a.trim(b));g||(b=b.toLowerCase());return b.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"')};this._funcLoop=function(b){var c=[];a.each(f,function(a,e){c.push(b(e))});return c};this._append=function(a){e=null===
e?"":e+(""===u?" && ":u);q&&(e+="!");e+="("+a+")";q=!1;u=""};this._setCommand=function(a,b){o=a;r=b};this._resetNegate=function(){q=!1};this._repeatCommand=function(a,b){return null===o?d:null!==a&&null!==b?o(a,b):null===r||!v?o(a):o(r,a)};this._equals=function(a,b){return 0===d._compare(a,b,1)};this._compare=function(a,b,c){void 0===c&&(c=1);void 0===a&&(a=null);void 0===b&&(b=null);if(null===a&&null===b)return 0;if(null===a&&null!==b)return 1;if(null!==a&&null===b)return-1;!g&&("number"!==typeof a&&
"number"!==typeof b)&&(a=(""+a).toLowerCase(),b=(""+b).toLowerCase());return a<b?-c:a>b?c:0};this._performSort=function(){0!==t.length&&(f=d._doSort(f,0))};this._doSort=function(a,b){var c=t[b].by,e=t[b].dir,f=t[b].type,g=t[b].datefmt;if(b==t.length-1)return d._getOrder(a,c,e,f,g);b++;c=d._getGroup(a,c,e,f,g);e=[];for(f=0;f<c.length;f++)for(var g=d._doSort(c[f].items,b),k=0;k<g.length;k++)e.push(g[k]);return e};this._getOrder=function(b,c,e,f,g){var k=[],m=[],o="a"==e?1:-1,q,r;void 0===f&&(f="text");
r="float"==f||"number"==f||"currency"==f||"numeric"==f?function(a){a=parseFloat((""+a).replace(j,""));return isNaN(a)?0:a}:"int"==f||"integer"==f?function(a){return a?parseFloat((""+a).replace(j,"")):0}:"date"==f||"datetime"==f?function(b){return a.jgrid.parseDate(g,b).getTime()}:a.isFunction(f)?f:function(b){b||(b="");return a.trim((""+b).toUpperCase())};a.each(b,function(b,e){q=""!==c?a.jgrid.getAccessor(e,c):e;void 0===q&&(q="");q=r(q,e);m.push({vSort:q,index:b})});m.sort(function(a,b){a=a.vSort;
b=b.vSort;return d._compare(a,b,o)});for(var f=0,t=b.length;f<t;)e=m[f].index,k.push(b[e]),f++;return k};this._getGroup=function(b,c,e,f,g){var k=[],m=null,j=null,o;a.each(d._getOrder(b,c,e,f,g),function(b,e){o=a.jgrid.getAccessor(e,c);void 0===o&&(o="");d._equals(j,o)||(j=o,null!==m&&k.push(m),m=d._group(c,o));m.items.push(e)});null!==m&&k.push(m);return k};this.ignoreCase=function(){g=!1;return d};this.useCase=function(){g=!0;return d};this.trim=function(){k=!0;return d};this.noTrim=function(){k=
!1;return d};this.execute=function(){var b=e,c=[];if(null===b)return d;a.each(f,function(){eval(b)&&c.push(this)});f=c;return d};this.data=function(){return f};this.select=function(b){d._performSort();if(!d._hasData())return[];d.execute();if(a.isFunction(b)){var c=[];a.each(f,function(a,e){c.push(b(e))});return c}return f};this.hasMatch=function(){if(!d._hasData())return!1;d.execute();return 0<f.length};this.andNot=function(a,b,c){q=!q;return d.and(a,b,c)};this.orNot=function(a,b,c){q=!q;return d.or(a,
b,c)};this.not=function(a,b,c){return d.andNot(a,b,c)};this.and=function(a,b,c){u=" && ";return void 0===a?d:d._repeatCommand(a,b,c)};this.or=function(a,b,c){u=" || ";return void 0===a?d:d._repeatCommand(a,b,c)};this.isNot=function(a){q=!q;return d.is(a)};this.is=function(a){d._append("this."+a);d._resetNegate();return d};this._compareValues=function(b,c,e,f,g){var k;k=v?"jQuery.jgrid.getAccessor(this,'"+c+"')":"this";void 0===e&&(e=null);var m=e,o=void 0===g.stype?"text":g.stype;if(null!==e)switch(o){case "int":case "integer":m=
isNaN(Number(m))||""===m?"0":m;k="parseInt("+k+",10)";m="parseInt("+m+",10)";break;case "float":case "number":case "numeric":m=(""+m).replace(j,"");m=isNaN(Number(m))||""===m?"0":m;k="parseFloat("+k+")";m="parseFloat("+m+")";break;case "date":case "datetime":m=""+a.jgrid.parseDate(g.newfmt||"Y-m-d",m).getTime();k='jQuery.jgrid.parseDate("'+g.srcfmt+'",'+k+").getTime()";break;default:k=d._getStr(k),m=d._getStr('"'+d._toStr(m)+'"')}d._append(k+" "+f+" "+m);d._setCommand(b,c);d._resetNegate();return d};
this.equals=function(a,b,c){return d._compareValues(d.equals,a,b,"==",c)};this.notEquals=function(a,b,c){return d._compareValues(d.equals,a,b,"!==",c)};this.isNull=function(a,b,c){return d._compareValues(d.equals,a,null,"===",c)};this.greater=function(a,b,c){return d._compareValues(d.greater,a,b,">",c)};this.less=function(a,b,c){return d._compareValues(d.less,a,b,"<",c)};this.greaterOrEquals=function(a,b,c){return d._compareValues(d.greaterOrEquals,a,b,">=",c)};this.lessOrEquals=function(a,b,c){return d._compareValues(d.lessOrEquals,
a,b,"<=",c)};this.startsWith=function(b,c){var e=void 0===c||null===c?b:c,e=k?a.trim(e.toString()).length:e.toString().length;v?d._append(d._getStr("jQuery.jgrid.getAccessor(this,'"+b+"')")+".substr(0,"+e+") == "+d._getStr('"'+d._toStr(c)+'"')):(e=k?a.trim(c.toString()).length:c.toString().length,d._append(d._getStr("this")+".substr(0,"+e+") == "+d._getStr('"'+d._toStr(b)+'"')));d._setCommand(d.startsWith,b);d._resetNegate();return d};this.endsWith=function(b,c){var e=void 0===c||null===c?b:c,e=k?
a.trim(e.toString()).length:e.toString().length;v?d._append(d._getStr("jQuery.jgrid.getAccessor(this,'"+b+"')")+".substr("+d._getStr("jQuery.jgrid.getAccessor(this,'"+b+"')")+".length-"+e+","+e+') == "'+d._toStr(c)+'"'):d._append(d._getStr("this")+".substr("+d._getStr("this")+'.length-"'+d._toStr(b)+'".length,"'+d._toStr(b)+'".length) == "'+d._toStr(b)+'"');d._setCommand(d.endsWith,b);d._resetNegate();return d};this.contains=function(a,b){v?d._append(d._getStr("jQuery.jgrid.getAccessor(this,'"+a+
"')")+'.indexOf("'+d._toStr(b)+'",0) > -1'):d._append(d._getStr("this")+'.indexOf("'+d._toStr(a)+'",0) > -1');d._setCommand(d.contains,a);d._resetNegate();return d};this.groupBy=function(a,b,c,e){return!d._hasData()?null:d._getGroup(f,a,b,c,e)};this.orderBy=function(b,c,e,f){c=void 0===c||null===c?"a":a.trim(c.toString().toLowerCase());if(null===e||void 0===e)e="text";if(null===f||void 0===f)f="Y-m-d";if("desc"==c||"descending"==c)c="d";if("asc"==c||"ascending"==c)c="a";t.push({by:b,dir:c,type:e,
datefmt:f});return d};return d}(d,null)},extend:function(d){a.extend(a.fn.jqGrid,d);this.no_legacy_api||a.fn.extend(d)}});a.fn.jqGrid=function(d){if("string"==typeof d){var c=a.jgrid.getAccessor(a.fn.jqGrid,d);if(!c)throw"jqGrid - No such method: "+d;var b=a.makeArray(arguments).slice(1);return c.apply(this,b)}return this.each(function(){if(!this.grid){var b=a.extend(!0,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:!0,pginput:!0,colModel:[],rowList:[],colNames:[],
sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:!1,selarrrow:[],savedRow:[],shrinkToFit:!0,xmlReader:{},jsonReader:{},subGrid:!1,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,onHeaderClick:null,viewrecords:!1,loadonce:!1,multiselect:!1,multikey:!1,
editurl:null,search:!1,caption:"",hidegrid:!0,hiddengrid:!1,postData:{},userData:{},treeGrid:!1,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:!1,gridstate:"visible",cellEdit:!1,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[!1,""],scroll:!1,multiboxonly:!1,
deselectAfterSort:!0,scrollrows:!1,autowidth:!1,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:!1,rownumWidth:25,rownumbers:!1,pagerpos:"center",recordpos:"right",footerrow:!1,userDataOnFooter:!1,hoverrows:!0,altclass:"ui-priority-secondary",viewsortcols:[!1,"vertical",!0],resizeclass:"",autoencode:!1,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:!1,headertitles:!1,scrollTimeout:40,data:[],_index:{},grouping:!1,groupingView:{groupField:[],groupOrder:[],groupText:[],
groupColumnShow:[],groupSummary:[],showSummaryOnHide:!1,sortitems:[],sortnames:[],groupDataSorted:!1,summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus"},ignoreCase:!1,cmTemplate:{}},a.jgrid.defaults,d||{}),c={headers:[],cols:[],footers:[],dragStart:function(c,e,d){this.resizing={idx:c,startX:e.clientX,sOL:d[0]};this.hDiv.style.cursor="col-resize";this.curGbox=a("#rs_m"+a.jgrid.jqID(b.id),"#gbox_"+a.jgrid.jqID(b.id));this.curGbox.css({display:"block",
left:d[0],top:d[1],height:d[2]});a.isFunction(b.resizeStart)&&b.resizeStart.call(this,e,c);document.onselectstart=function(){return!1}},dragMove:function(a){if(this.resizing){var c=a.clientX-this.resizing.startX,a=this.headers[this.resizing.idx],e="ltr"===b.direction?a.width+c:a.width-c,d;33<e&&(this.curGbox.css({left:this.resizing.sOL+c}),!0===b.forceFit?(d=this.headers[this.resizing.idx+b.nv],c="ltr"===b.direction?d.width-c:d.width+c,33<c&&(a.newWidth=e,d.newWidth=c)):(this.newWidth="ltr"===b.direction?
b.tblwidth+c:b.tblwidth-c,a.newWidth=e))}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var c=this.resizing.idx,e=this.headers[c].newWidth||this.headers[c].width,e=parseInt(e,10);this.resizing=!1;a("#rs_m"+a.jgrid.jqID(b.id)).css("display","none");b.colModel[c].width=e;this.headers[c].width=e;this.headers[c].el.style.width=e+"px";this.cols[c].style.width=e+"px";0<this.footers.length&&(this.footers[c].style.width=e+"px");!0===b.forceFit?(e=this.headers[c+b.nv].newWidth||this.headers[c+
b.nv].width,this.headers[c+b.nv].width=e,this.headers[c+b.nv].el.style.width=e+"px",this.cols[c+b.nv].style.width=e+"px",0<this.footers.length&&(this.footers[c+b.nv].style.width=e+"px"),b.colModel[c+b.nv].width=e):(b.tblwidth=this.newWidth||b.tblwidth,a("table:first",this.bDiv).css("width",b.tblwidth+"px"),a("table:first",this.hDiv).css("width",b.tblwidth+"px"),this.hDiv.scrollLeft=this.bDiv.scrollLeft,b.footerrow&&(a("table:first",this.sDiv).css("width",b.tblwidth+"px"),this.sDiv.scrollLeft=this.bDiv.scrollLeft));
a.isFunction(b.resizeStop)&&b.resizeStop.call(this,e,c)}this.curGbox=null;document.onselectstart=function(){return!0}},populateVisible:function(){c.timer&&clearTimeout(c.timer);c.timer=null;var e=a(c.bDiv).height();if(e){var d=a("table:first",c.bDiv),f,g;if(d[0].rows.length)try{g=(f=d[0].rows[1])?a(f).outerHeight()||c.prevRowHeight:c.prevRowHeight}catch(k){g=c.prevRowHeight}if(g){c.prevRowHeight=g;var j=b.rowNum;f=c.scrollTop=c.bDiv.scrollTop;var o=Math.round(d.position().top)-f,p=o+d.height();g*=
j;var q,r,t;if(p<e&&0>=o&&(void 0===b.lastpage||parseInt((p+f+g-1)/g,10)<=b.lastpage))r=parseInt((e-p+g-1)/g,10),0<=p||2>r||!0===b.scroll?(q=Math.round((p+f)/g)+1,o=-1):o=1;0<o&&(q=parseInt(f/g,10)+1,r=parseInt((f+e)/g,10)+2-q,t=!0);if(r&&!(b.lastpage&&q>b.lastpage||1==b.lastpage||q===b.page&&q===b.lastpage))c.hDiv.loading?c.timer=setTimeout(c.populateVisible,b.scrollTimeout):(b.page=q,t&&(c.selectionPreserver(d[0]),c.emptyRows(c.bDiv,!1,!1)),c.populate(r))}}},scrollGrid:function(a){if(b.scroll){var e=
c.bDiv.scrollTop;void 0===c.scrollTop&&(c.scrollTop=0);e!=c.scrollTop&&(c.scrollTop=e,c.timer&&clearTimeout(c.timer),c.timer=setTimeout(c.populateVisible,b.scrollTimeout))}c.hDiv.scrollLeft=c.bDiv.scrollLeft;b.footerrow&&(c.sDiv.scrollLeft=c.bDiv.scrollLeft);a.stopPropagation()},selectionPreserver:function(b){var c=b.p,e=c.selrow,d=c.selarrrow?a.makeArray(c.selarrrow):null,f=b.grid.bDiv.scrollLeft,g=c.gridComplete;c.gridComplete=function(){c.selrow=null;c.selarrrow=[];if(c.multiselect&&d&&0<d.length)for(var k=
0;k<d.length;k++)d[k]!=e&&a(b).jqGrid("setSelection",d[k],!1);e&&a(b).jqGrid("setSelection",e,!1);b.grid.bDiv.scrollLeft=f;c.gridComplete=g;c.gridComplete&&g()}}};if("TABLE"!=this.tagName)alert("Element is not a table");else{a(this).empty().attr("tabindex","1");this.p=b;var f,k,e;if(0===this.p.colNames.length)for(f=0;f<this.p.colModel.length;f++)this.p.colNames[f]=this.p.colModel[f].label||this.p.colModel[f].name;if(this.p.colNames.length!==this.p.colModel.length)alert(a.jgrid.errors.model);else{var j=
a("<div class='ui-jqgrid-view'></div>"),o,r=a.browser.msie?!0:!1,q=a.browser.webkit||a.browser.safari?!0:!1;e=this;e.p.direction=a.trim(e.p.direction.toLowerCase());-1==a.inArray(e.p.direction,["ltr","rtl"])&&(e.p.direction="ltr");k=e.p.direction;a(j).insertBefore(this);a(this).appendTo(j).removeClass("scroll");var u=a("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");a(u).insertBefore(j).attr({id:"gbox_"+this.id,dir:k});a(j).appendTo(u).attr("id","gview_"+this.id);o=r&&6>=
a.browser.version?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"";a("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(o).insertBefore(j);a("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(j);a(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+
this.id});var t=function(a,b){a=parseInt(a,10);return isNaN(a)?b?b:0:a},v=function(b,d,f,g,k,l){var j=e.p.colModel[b],o=j.align,p='style="',q=j.classes,r=j.name,t=[];o&&(p=p+("text-align:"+o+";"));j.hidden===true&&(p=p+"display:none;");if(d===0)p=p+("width: "+c.headers[b].width+"px;");else if(j.cellattr&&a.isFunction(j.cellattr)&&(b=j.cellattr.call(e,k,f,g,j,l))&&typeof b==="string"){b=b.replace(/style/i,"style").replace(/title/i,"title");if(b.indexOf("title")>-1)j.title=false;b.indexOf("class")>
-1&&(q=void 0);t=b.split("style");if(t.length===2){t[1]=a.trim(t[1].replace("=",""));if(t[1].indexOf("'")===0||t[1].indexOf('"')===0)t[1]=t[1].substring(1);p=p+t[1].replace(/'/gi,'"')}else p=p+'"'}if(!t.length){t[0]="";p=p+'"'}p=p+((q!==void 0?' class="'+q+'"':"")+(j.title&&f?' title="'+a.jgrid.stripHtml(f)+'"':""));p=p+(' aria-describedby="'+e.p.id+"_"+r+'"');return p+t[0]},z=function(b){return b===void 0||b===null||b===""?"&#160;":e.p.autoencode?a.jgrid.htmlEncode(b):b+""},x=function(b,c,d,f,g){var k=
e.p.colModel[d];if(typeof k.formatter!=="undefined"){b={rowId:b,colModel:k,gid:e.p.id,pos:d};c=a.isFunction(k.formatter)?k.formatter.call(e,c,b,f,g):a.fmatter?a.fn.fmatter(k.formatter,c,b,f,g):z(c)}else c=z(c);return c},y=function(a,b,c,e,d){b=x(a,b,c,d,"add");return'<td role="gridcell" '+v(c,e,b,d,a,true)+">"+b+"</td>"},B=function(a,b,c){var d='<input role="checkbox" type="checkbox" id="jqg_'+e.p.id+"_"+a+'" class="cbox" name="jqg_'+e.p.id+"_"+a+'"/>';return'<td role="gridcell" '+v(b,c,"",null,a,
true)+">"+d+"</td>"},A=function(a,b,c,e){c=(parseInt(c,10)-1)*parseInt(e,10)+1+b;return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+v(a,b,c,null,b,true)+">"+c+"</td>"},F=function(a){var b,c=[],d=0,f;for(f=0;f<e.p.colModel.length;f++){b=e.p.colModel[f];if(b.name!=="cb"&&b.name!=="subgrid"&&b.name!=="rn"){c[d]=a=="local"?b.name:a=="xml"?b.xmlmap||b.name:b.jsonmap||b.name;d++}}return c},N=function(b){var c=e.p.remapColumns;if(!c||!c.length)c=a.map(e.p.colModel,function(a,b){return b});
b&&(c=a.map(c,function(a){return a<b?null:a-b}));return c},K=function(b,c,d){if(e.p.deepempty)a("#"+a.jgrid.jqID(e.p.id)+" tbody:first tr:gt(0)").remove();else{var f=a("#"+a.jgrid.jqID(e.p.id)+" tbody:first tr:first")[0];a("#"+a.jgrid.jqID(e.p.id)+" tbody:first").empty().append(f)}if(c&&e.p.scroll){a(">div:first",b).css({height:"auto"}).children("div:first").css({height:0,display:"none"});b.scrollTop=0}if(d===true&&e.p.treeGrid===true){e.p.data=[];e.p._index={}}},G=function(){var b=e.p.data.length,
c,d,f;c=e.p.rownumbers===true?1:0;d=e.p.multiselect===true?1:0;f=e.p.subGrid===true?1:0;c=e.p.keyIndex===false||e.p.loadonce===true?e.p.localReader.id:e.p.colModel[e.p.keyIndex+d+f+c].name;for(d=0;d<b;d++){f=a.jgrid.getAccessor(e.p.data[d],c);e.p._index[f]=d}},R=function(b,c,d,f,g){var k=new Date,l=e.p.datatype!="local"&&e.p.loadonce||e.p.datatype=="xmlstring",m=e.p.datatype=="local"?"local":"xml";if(l){e.p.data=[];e.p._index={};e.p.localReader.id="_id_"}e.p.reccount=0;if(a.isXMLDoc(b)){if(e.p.treeANode===
-1&&!e.p.scroll){K(c,false,true);d=1}else d=d>1?d:1;var j,o,p=0,q,r=0,t=0,u=0,v,x=[],z,G={},C,D,O=[],I=e.p.altRows===true?" "+e.p.altclass:"";e.p.xmlReader.repeatitems||(x=F(m));v=e.p.keyIndex===false?e.p.xmlReader.id:e.p.keyIndex;if(x.length>0&&!isNaN(v)){e.p.remapColumns&&e.p.remapColumns.length&&(v=a.inArray(v,e.p.remapColumns));v=x[v]}m=(v+"").indexOf("[")===-1?x.length?function(b,c){return a(v,b).text()||c}:function(b,c){return a(e.p.xmlReader.cell,b).eq(v).text()||c}:function(a,b){return a.getAttribute(v.replace(/[\[\]]/g,
""))||b};e.p.userData={};a(e.p.xmlReader.page,b).each(function(){e.p.page=this.textContent||this.text||0});a(e.p.xmlReader.total,b).each(function(){e.p.lastpage=this.textContent||this.text;if(e.p.lastpage===void 0)e.p.lastpage=1});a(e.p.xmlReader.records,b).each(function(){e.p.records=this.textContent||this.text||0});a(e.p.xmlReader.userdata,b).each(function(){e.p.userData[this.getAttribute("name")]=this.textContent||this.text});(b=a(e.p.xmlReader.root+" "+e.p.xmlReader.row,b))||(b=[]);var E=b.length,
H=0,R={},J;if(b&&E){J=parseInt(e.p.rowNum,10);var X=e.p.scroll?a.jgrid.randId():1;g&&(J=J*(g+1));var g=a.isFunction(e.p.afterInsertRow),ha="";for(e.p.grouping&&e.p.groupingView.groupCollapse===true&&(ha=' style="display:none;"');H<E;){C=b[H];D=m(C,X+H);j=d===0?0:d+1;j=(j+H)%2==1?I:"";O.push("<tr"+ha+' id="'+D+'" tabindex="-1" role="row" class ="ui-widget-content jqgrow ui-row-'+e.p.direction+""+j+'">');if(e.p.rownumbers===true){O.push(A(0,H,e.p.page,e.p.rowNum));u=1}if(e.p.multiselect===true){O.push(B(D,
u,H));r=1}if(e.p.subGrid===true){O.push(a(e).jqGrid("addSubGridCell",r+u,H+d));t=1}if(e.p.xmlReader.repeatitems){z||(z=N(r+t+u));var W=a(e.p.xmlReader.cell,C);a.each(z,function(a){var b=W[this];if(!b)return false;q=b.textContent||b.text;G[e.p.colModel[a+r+t+u].name]=q;O.push(y(D,q,a+r+t+u,H+d,C))})}else for(j=0;j<x.length;j++){q=a(x[j],C).text();G[e.p.colModel[j+r+t+u].name]=q;O.push(y(D,q,j+r+t+u,H+d,C))}O.push("</tr>");if(e.p.grouping){j=e.p.groupingView.groupField.length;for(var M=[],S=0;S<j;S++)M.push(G[e.p.groupingView.groupField[S]]);
R=a(e).jqGrid("groupingPrepare",O,M,R,G);O=[]}if(l||e.p.treeGrid===true){G._id_=D;e.p.data.push(G);e.p._index[D]=e.p.data.length-1}if(e.p.gridview===false){a("tbody:first",c).append(O.join(""));g&&e.p.afterInsertRow.call(e,D,G,C);O=[]}G={};p++;H++;if(p==J)break}}if(e.p.gridview===true){o=e.p.treeANode>-1?e.p.treeANode:0;if(e.p.grouping){a(e).jqGrid("groupingRender",R,e.p.colModel.length);R=null}else e.p.treeGrid===true&&o>0?a(e.rows[o]).after(O.join("")):a("tbody:first",c).append(O.join(""))}if(e.p.subGrid===
true)try{a(e).jqGrid("addSubGrid",r+u)}catch(L){}e.p.totaltime=new Date-k;if(p>0&&e.p.records===0)e.p.records=E;O=null;if(e.p.treeGrid===true)try{a(e).jqGrid("setTreeNode",o+1,p+o+1)}catch(aa){}if(!e.p.treeGrid&&!e.p.scroll)e.grid.bDiv.scrollTop=0;e.p.reccount=p;e.p.treeANode=-1;e.p.userDataOnFooter&&a(e).jqGrid("footerData","set",e.p.userData,true);if(l){e.p.records=E;e.p.lastpage=Math.ceil(E/J)}f||e.updatepager(false,true);if(l)for(;p<E;){C=b[p];D=m(C,p);if(e.p.xmlReader.repeatitems){z||(z=N(r+
t+u));var T=a(e.p.xmlReader.cell,C);a.each(z,function(a){var b=T[this];if(!b)return false;q=b.textContent||b.text;G[e.p.colModel[a+r+t+u].name]=q})}else for(j=0;j<x.length;j++){q=a(x[j],C).text();G[e.p.colModel[j+r+t+u].name]=q}G._id_=D;e.p.data.push(G);e.p._index[D]=e.p.data.length-1;G={};p++}}},I=function(b,c,d,f,g){var k=new Date;if(b){if(e.p.treeANode===-1&&!e.p.scroll){K(c,false,true);d=1}else d=d>1?d:1;var l,m=e.p.datatype!="local"&&e.p.loadonce||e.p.datatype=="jsonstring";if(m){e.p.data=[];
e.p._index={};e.p.localReader.id="_id_"}e.p.reccount=0;if(e.p.datatype=="local"){c=e.p.localReader;l="local"}else{c=e.p.jsonReader;l="json"}var j=0,o,p,q=[],r,t=0,u=0,v=0,x,z,G={},C,D,O=[],E=e.p.altRows===true?" "+e.p.altclass:"";e.p.page=a.jgrid.getAccessor(b,c.page)||0;x=a.jgrid.getAccessor(b,c.total);e.p.lastpage=x===void 0?1:x;e.p.records=a.jgrid.getAccessor(b,c.records)||0;e.p.userData=a.jgrid.getAccessor(b,c.userdata)||{};c.repeatitems||(r=q=F(l));l=e.p.keyIndex===false?c.id:e.p.keyIndex;if(q.length>
0&&!isNaN(l)){e.p.remapColumns&&e.p.remapColumns.length&&(l=a.inArray(l,e.p.remapColumns));l=q[l]}(z=a.jgrid.getAccessor(b,c.root))||(z=[]);x=z.length;var b=0,I=parseInt(e.p.rowNum,10),H=e.p.scroll?a.jgrid.randId():1;g&&(I=I*(g+1));var R=a.isFunction(e.p.afterInsertRow),J={},X="";for(e.p.grouping&&e.p.groupingView.groupCollapse===true&&(X=' style="display:none;"');b<x;){g=z[b];D=a.jgrid.getAccessor(g,l);if(D===void 0){D=H+b;q.length===0&&c.cell&&(D=a.jgrid.getAccessor(g,c.cell)[l]||D)}o=d===1?0:d;
o=(o+b)%2==1?E:"";O.push("<tr"+X+' id="'+D+'" tabindex="-1" role="row" class= "ui-widget-content jqgrow ui-row-'+e.p.direction+""+o+'">');if(e.p.rownumbers===true){O.push(A(0,b,e.p.page,e.p.rowNum));v=1}if(e.p.multiselect){O.push(B(D,v,b));t=1}if(e.p.subGrid){O.push(a(e).jqGrid("addSubGridCell",t+v,b+d));u=1}if(c.repeatitems){c.cell&&(g=a.jgrid.getAccessor(g,c.cell));r||(r=N(t+u+v))}for(p=0;p<r.length;p++){o=a.jgrid.getAccessor(g,r[p]);O.push(y(D,o,p+t+u+v,b+d,g));G[e.p.colModel[p+t+u+v].name]=o}O.push("</tr>");
if(e.p.grouping){o=e.p.groupingView.groupField.length;p=[];for(var ha=0;ha<o;ha++)p.push(G[e.p.groupingView.groupField[ha]]);J=a(e).jqGrid("groupingPrepare",O,p,J,G);O=[]}if(m||e.p.treeGrid===true){G._id_=D;e.p.data.push(G);e.p._index[D]=e.p.data.length-1}if(e.p.gridview===false){a("#"+a.jgrid.jqID(e.p.id)+" tbody:first").append(O.join(""));R&&e.p.afterInsertRow.call(e,D,G,g);O=[]}G={};j++;b++;if(j==I)break}if(e.p.gridview===true){C=e.p.treeANode>-1?e.p.treeANode:0;e.p.grouping?a(e).jqGrid("groupingRender",
J,e.p.colModel.length):e.p.treeGrid===true&&C>0?a(e.rows[C]).after(O.join("")):a("#"+a.jgrid.jqID(e.p.id)+" tbody:first").append(O.join(""))}if(e.p.subGrid===true)try{a(e).jqGrid("addSubGrid",t+v)}catch(S){}e.p.totaltime=new Date-k;if(j>0&&e.p.records===0)e.p.records=x;if(e.p.treeGrid===true)try{a(e).jqGrid("setTreeNode",C+1,j+C+1)}catch(W){}if(!e.p.treeGrid&&!e.p.scroll)e.grid.bDiv.scrollTop=0;e.p.reccount=j;e.p.treeANode=-1;e.p.userDataOnFooter&&a(e).jqGrid("footerData","set",e.p.userData,true);
if(m){e.p.records=x;e.p.lastpage=Math.ceil(x/I)}f||e.updatepager(false,true);if(m)for(;j<x&&z[j];){g=z[j];D=a.jgrid.getAccessor(g,l);if(D===void 0){D=H+j;q.length===0&&c.cell&&(D=a.jgrid.getAccessor(g,c.cell)[l]||D)}if(g){if(c.repeatitems){c.cell&&(g=a.jgrid.getAccessor(g,c.cell));r||(r=N(t+u+v))}for(p=0;p<r.length;p++){o=a.jgrid.getAccessor(g,r[p]);G[e.p.colModel[p+t+u+v].name]=o}G._id_=D;e.p.data.push(G);e.p._index[D]=e.p.data.length-1;G={}}j++}}},ba=function(){function b(c){var e=0,d,g,k;if(c.groups!==
void 0)for(d=0;d<c.groups.length;d++){try{b(c.groups[d])}catch(l){alert(l)}e++}if(c.rules!==void 0){if(e>0){var m=q.select();q=a.jgrid.from(m)}try{for(d=0;d<c.rules.length;d++){k=c.rules[d];g=c.groupOp.toString().toUpperCase();if(p[k.op]&&k.field){e>0&&(g&&g==="OR")&&(q=q.or());q=p[k.op](q,g)(k.field,k.data,f[k.field])}e++}}catch(j){alert(j)}}}var c,d=false,f={},g=[],k=[],l,m,j;if(a.isArray(e.p.data)){var o=e.p.grouping?e.p.groupingView:false;a.each(e.p.colModel,function(){m=this.sorttype||"text";
if(m=="date"||m=="datetime"){if(this.formatter&&typeof this.formatter==="string"&&this.formatter=="date"){l=this.formatoptions&&this.formatoptions.srcformat?this.formatoptions.srcformat:a.jgrid.formatter.date.srcformat;j=this.formatoptions&&this.formatoptions.newformat?this.formatoptions.newformat:a.jgrid.formatter.date.newformat}else l=j=this.datefmt||"Y-m-d";f[this.name]={stype:m,srcfmt:l,newfmt:j}}else f[this.name]={stype:m,srcfmt:"",newfmt:""};if(e.p.grouping&&this.name==o.groupField[0]){var b=
this.name;if(typeof this.index!="undefined")b=this.index;g[0]=f[b];k.push(b)}if(!d&&(this.index==e.p.sortname||this.name==e.p.sortname)){c=this.name;d=true}});if(e.p.treeGrid)a(e).jqGrid("SortTree",c,e.p.sortorder,f[c].stype,f[c].srcfmt);else{var p={eq:function(a){return a.equals},ne:function(a){return a.notEquals},lt:function(a){return a.less},le:function(a){return a.lessOrEquals},gt:function(a){return a.greater},ge:function(a){return a.greaterOrEquals},cn:function(a){return a.contains},nc:function(a,
b){return b==="OR"?a.orNot().contains:a.andNot().contains},bw:function(a){return a.startsWith},bn:function(a,b){return b==="OR"?a.orNot().startsWith:a.andNot().startsWith},en:function(a,b){return b==="OR"?a.orNot().endsWith:a.andNot().endsWith},ew:function(a){return a.endsWith},ni:function(a,b){return b==="OR"?a.orNot().equals:a.andNot().equals},"in":function(a){return a.equals},nu:function(a){return a.isNull},nn:function(a,b){return b==="OR"?a.orNot().isNull:a.andNot().isNull}},q=a.jgrid.from(e.p.data);
e.p.ignoreCase&&(q=q.ignoreCase());if(e.p.search===true){var r=e.p.postData.filters;if(r){typeof r=="string"&&(r=a.jgrid.parse(r));b(r)}else try{q=p[e.p.postData.searchOper](q)(e.p.postData.searchField,e.p.postData.searchString,f[e.p.postData.searchField])}catch(t){}}if(e.p.grouping){q.orderBy(k,o.groupOrder[0],g[0].stype,g[0].srcfmt);o.groupDataSorted=true}c&&(e.p.sortorder&&d)&&(e.p.sortorder.toUpperCase()=="DESC"?q.orderBy(e.p.sortname,"d",f[c].stype,f[c].srcfmt):q.orderBy(e.p.sortname,"a",f[c].stype,
f[c].srcfmt));var r=q.select(),u=parseInt(e.p.rowNum,10),v=r.length,x=parseInt(e.p.page,10),y=Math.ceil(v/u),z={},r=r.slice((x-1)*u,x*u),f=q=null;z[e.p.localReader.total]=y;z[e.p.localReader.page]=x;z[e.p.localReader.records]=v;z[e.p.localReader.root]=r;r=null;return z}}},T=function(){e.grid.hDiv.loading=true;if(!e.p.hiddengrid)switch(e.p.loadui){case "enable":a("#load_"+a.jgrid.jqID(e.p.id)).show();break;case "block":a("#lui_"+a.jgrid.jqID(e.p.id)).show();a("#load_"+a.jgrid.jqID(e.p.id)).show()}},
Y=function(){e.grid.hDiv.loading=false;switch(e.p.loadui){case "enable":a("#load_"+a.jgrid.jqID(e.p.id)).hide();break;case "block":a("#lui_"+a.jgrid.jqID(e.p.id)).hide();a("#load_"+a.jgrid.jqID(e.p.id)).hide()}},D=function(b){if(!e.grid.hDiv.loading){var c=e.p.scroll&&b===false,d={},f,g=e.p.prmNames;if(e.p.page<=0)e.p.page=1;if(g.search!==null)d[g.search]=e.p.search;g.nd!==null&&(d[g.nd]=(new Date).getTime());if(g.rows!==null)d[g.rows]=e.p.rowNum;if(g.page!==null)d[g.page]=e.p.page;if(g.sort!==null)d[g.sort]=
e.p.sortname;if(g.order!==null)d[g.order]=e.p.sortorder;if(e.p.rowTotal!==null&&g.totalrows!==null)d[g.totalrows]=e.p.rowTotal;var k=e.p.loadComplete,l=a.isFunction(k);l||(k=null);var m=0,b=b||1;if(b>1)if(g.npage!==null){d[g.npage]=b;m=b-1;b=1}else k=function(a){e.p.page++;e.grid.hDiv.loading=false;l&&e.p.loadComplete.call(e,a);D(b-1)};else g.npage!==null&&delete e.p.postData[g.npage];if(e.p.grouping){a(e).jqGrid("groupingSetup");e.p.groupingView.groupDataSorted===true&&(d[g.sort]=e.p.groupingView.groupField[0]+
" "+e.p.groupingView.groupOrder[0]+", "+d[g.sort])}a.extend(e.p.postData,d);var j=!e.p.scroll?1:e.rows.length-1;if(a.isFunction(e.p.datatype))e.p.datatype.call(e,e.p.postData,"load_"+e.p.id);else{a.isFunction(e.p.beforeRequest)&&e.p.beforeRequest.call(e);f=e.p.datatype.toLowerCase();switch(f){case "json":case "jsonp":case "xml":case "script":a.ajax(a.extend({url:e.p.url,type:e.p.mtype,dataType:f,data:a.isFunction(e.p.serializeGridData)?e.p.serializeGridData.call(e,e.p.postData):e.p.postData,success:function(a){f===
"xml"?R(a,e.grid.bDiv,j,b>1,m):I(a,e.grid.bDiv,j,b>1,m);k&&k.call(e,a);c&&e.grid.populateVisible();if(e.p.loadonce||e.p.treeGrid)e.p.datatype="local";Y()},error:function(b,c,d){a.isFunction(e.p.loadError)&&e.p.loadError.call(e,b,c,d);Y()},beforeSend:function(b){T();a.isFunction(e.p.loadBeforeSend)&&e.p.loadBeforeSend.call(e,b)}},a.jgrid.ajaxOptions,e.p.ajaxGridOptions));break;case "xmlstring":T();d=a.jgrid.stringToDoc(e.p.datastr);R(d,e.grid.bDiv);l&&e.p.loadComplete.call(e,d);e.p.datatype="local";
e.p.datastr=null;Y();break;case "jsonstring":T();d=typeof e.p.datastr=="string"?a.jgrid.parse(e.p.datastr):e.p.datastr;I(d,e.grid.bDiv);l&&e.p.loadComplete.call(e,d);e.p.datatype="local";e.p.datastr=null;Y();break;case "local":case "clientside":T();e.p.datatype="local";d=ba();I(d,e.grid.bDiv,j,b>1,m);k&&k.call(e,d);c&&e.grid.populateVisible();Y()}}}};o=function(b,c){var d="",f="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",g="",l,m,j,
o,p=function(b){var c;a.isFunction(e.p.onPaging)&&(c=e.p.onPaging.call(e,b));e.p.selrow=null;if(e.p.multiselect){e.p.selarrrow=[];a("#cb_"+a.jgrid.jqID(e.p.id),e.grid.hDiv).attr("checked",false)}e.p.savedRow=[];return c=="stop"?false:true},b=b.substr(1);l="pg_"+b;m=b+"_left";j=b+"_center";o=b+"_right";a("#"+a.jgrid.jqID(b)).append("<div id='"+l+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+
m+"' align='left'></td><td id='"+j+"' align='center' style='white-space:pre;'></td><td id='"+o+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr");if(e.p.rowList.length>0){g="<td dir='"+k+"'>";g=g+"<select class='ui-pg-selbox' role='listbox'>";for(m=0;m<e.p.rowList.length;m++)g=g+('<option role="option" value="'+e.p.rowList[m]+'"'+(e.p.rowNum==e.p.rowList[m]?' selected="selected"':"")+">"+e.p.rowList[m]+"</option>");g=g+"</select></td>"}k=="rtl"&&(f=f+g);e.p.pginput===true&&(d="<td dir='"+
k+"'>"+a.jgrid.format(e.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1'></span>")+"</td>");if(e.p.pgbuttons===true){m=["first"+c,"prev"+c,"next"+c,"last"+c];k=="rtl"&&m.reverse();f=f+("<td id='"+m[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>");f=f+("<td id='"+m[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>");f=f+(d!==""?"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>"+
d+"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>":"")+("<td id='"+m[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>");f=f+("<td id='"+m[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>")}else d!==""&&(f=f+d);k=="ltr"&&(f=f+g);f=f+"</tr></tbody></table>";e.p.viewrecords===true&&a("td#"+b+"_"+e.p.recordpos,"#"+l).append("<div dir='"+k+"' style='text-align:"+
e.p.recordpos+"' class='ui-paging-info'></div>");a("td#"+b+"_"+e.p.pagerpos,"#"+l).append(f);g=a(".ui-jqgrid").css("font-size")||"11px";a(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+g+";visibility:hidden;' ></div>");f=a(f).clone().appendTo("#testpg").width();a("#testpg").remove();if(f>0){d!==""&&(f=f+50);a("td#"+b+"_"+e.p.pagerpos,"#"+l).width(f)}e.p._nvtd=[];e.p._nvtd[0]=f?Math.floor((e.p.width-f)/2):Math.floor(e.p.width/3);e.p._nvtd[1]=
0;f=null;a(".ui-pg-selbox","#"+l).bind("change",function(){e.p.page=Math.round(e.p.rowNum*(e.p.page-1)/this.value-0.5)+1;e.p.rowNum=this.value;c?a(".ui-pg-selbox",e.p.pager).val(this.value):e.p.toppager&&a(".ui-pg-selbox",e.p.toppager).val(this.value);if(!p("records"))return false;D();return false});if(e.p.pgbuttons===true){a(".ui-pg-button","#"+l).hover(function(){if(a(this).hasClass("ui-state-disabled"))this.style.cursor="default";else{a(this).addClass("ui-state-hover");this.style.cursor="pointer"}},
function(){if(!a(this).hasClass("ui-state-disabled")){a(this).removeClass("ui-state-hover");this.style.cursor="default"}});a("#first"+c+", #prev"+c+", #next"+c+", #last"+c,"#"+b).click(function(){var a=t(e.p.page,1),b=t(e.p.lastpage,1),d=false,f=true,g=true,k=true,l=true;if(b===0||b===1)l=k=g=f=false;else if(b>1&&a>=1)a===1?g=f=false:a>1&&a<b||a===b&&(l=k=false);else if(b>1&&a===0){l=k=false;a=b-1}if(this.id==="first"+c&&f){e.p.page=1;d=true}if(this.id==="prev"+c&&g){e.p.page=a-1;d=true}if(this.id===
"next"+c&&k){e.p.page=a+1;d=true}if(this.id==="last"+c&&l){e.p.page=b;d=true}if(d){if(!p(this.id))return false;D()}return false})}e.p.pginput===true&&a("input.ui-pg-input","#"+l).keypress(function(b){if((b.charCode?b.charCode:b.keyCode?b.keyCode:0)==13){e.p.page=a(this).val()>0?a(this).val():e.p.page;if(!p("user"))return false;D();return false}return this})};var M=function(b,c,d,f){if(e.p.colModel[c].sortable&&!(e.p.savedRow.length>0)){if(!d){if(e.p.lastsort==c)if(e.p.sortorder=="asc")e.p.sortorder=
"desc";else{if(e.p.sortorder=="desc")e.p.sortorder="asc"}else e.p.sortorder=e.p.colModel[c].firstsortorder||"asc";e.p.page=1}if(f){if(e.p.lastsort==c&&e.p.sortorder==f&&!d)return;e.p.sortorder=f}d=a("thead:first",e.grid.hDiv).get(0);a("tr th:eq("+e.p.lastsort+") span.ui-grid-ico-sort",d).addClass("ui-state-disabled");a("tr th:eq("+e.p.lastsort+")",d).attr("aria-selected","false");a("tr th:eq("+c+") span.ui-icon-"+e.p.sortorder,d).removeClass("ui-state-disabled");a("tr th:eq("+c+")",d).attr("aria-selected",
"true");if(!e.p.viewsortcols[0]&&e.p.lastsort!=c){a("tr th:eq("+e.p.lastsort+") span.s-ico",d).hide();a("tr th:eq("+c+") span.s-ico",d).show()}b=b.substring(5);e.p.sortname=e.p.colModel[c].index||b;d=e.p.sortorder;if(a.isFunction(e.p.onSortCol)&&e.p.onSortCol.call(e,b,c,d)=="stop")e.p.lastsort=c;else{if(e.p.datatype=="local")e.p.deselectAfterSort&&a(e).jqGrid("resetSelection");else{e.p.selrow=null;e.p.multiselect&&a("#cb_"+a.jgrid.jqID(e.p.id),e.grid.hDiv).attr("checked",false);e.p.selarrrow=[];e.p.savedRow=
[]}if(e.p.scroll){d=e.grid.bDiv.scrollLeft;K(e.grid.bDiv,true,false);e.grid.hDiv.scrollLeft=d}e.p.subGrid&&e.p.datatype=="local"&&a("td.sgexpanded","#"+a.jgrid.jqID(e.p.id)).each(function(){a(this).trigger("click")});D();e.p.lastsort=c;if(e.p.sortname!=b&&c)e.p.lastsort=c}}},Z=function(b){var c,d={},f=q?0:e.p.cellLayout;for(c=d[0]=d[1]=d[2]=0;c<=b;c++)e.p.colModel[c].hidden===false&&(d[0]=d[0]+(e.p.colModel[c].width+f));e.p.direction=="rtl"&&(d[0]=e.p.width-d[0]);d[0]=d[0]-e.grid.bDiv.scrollLeft;
a(e.grid.cDiv).is(":visible")&&(d[1]=d[1]+(a(e.grid.cDiv).height()+parseInt(a(e.grid.cDiv).css("padding-top"),10)+parseInt(a(e.grid.cDiv).css("padding-bottom"),10)));if(e.p.toolbar[0]===true&&(e.p.toolbar[1]=="top"||e.p.toolbar[1]=="both"))d[1]=d[1]+(a(e.grid.uDiv).height()+parseInt(a(e.grid.uDiv).css("border-top-width"),10)+parseInt(a(e.grid.uDiv).css("border-bottom-width"),10));e.p.toppager&&(d[1]=d[1]+(a(e.grid.topDiv).height()+parseInt(a(e.grid.topDiv).css("border-bottom-width"),10)));d[2]=d[2]+
(a(e.grid.bDiv).height()+a(e.grid.hDiv).height());return d};this.p.id=this.id;-1==a.inArray(e.p.multikey,["shiftKey","altKey","ctrlKey"])&&(e.p.multikey=!1);e.p.keyIndex=!1;for(f=0;f<e.p.colModel.length;f++)e.p.colModel[f]=a.extend(!0,{},e.p.cmTemplate,e.p.colModel[f].template||{},e.p.colModel[f]),!1===e.p.keyIndex&&!0===e.p.colModel[f].key&&(e.p.keyIndex=f);e.p.sortorder=e.p.sortorder.toLowerCase();!0===e.p.grouping&&(e.p.scroll=!1,e.p.rownumbers=!1,e.p.subGrid=!1,e.p.treeGrid=!1,e.p.gridview=!0);
if(!0===this.p.treeGrid){try{a(this).jqGrid("setTreeGrid")}catch(E){}"local"!=e.p.datatype&&(e.p.localReader={id:"_id_"})}if(this.p.subGrid)try{a(e).jqGrid("setSubGrid")}catch(H){}this.p.multiselect&&(this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>"),this.p.colModel.unshift({name:"cb",width:q?e.p.multiselectWidth+e.p.cellLayout:e.p.multiselectWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));this.p.rownumbers&&(this.p.colNames.unshift(""),
this.p.colModel.unshift({name:"rn",width:e.p.rownumWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));e.p.xmlReader=a.extend(!0,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:!0,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:!0,cell:"cell"}},e.p.xmlReader);e.p.jsonReader=a.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!0,cell:"cell",id:"id",userdata:"userdata",
subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},e.p.jsonReader);e.p.localReader=a.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},e.p.localReader);e.p.scroll&&(e.p.pgbuttons=!1,e.p.pginput=!1,e.p.rowList=[]);e.p.data.length&&G();var L="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",C,O,ha,aa,X,S,W,Da;O=Da="";if(!0===e.p.shrinkToFit&&!0===e.p.forceFit)for(f=e.p.colModel.length-
1;0<=f;f--)if(!e.p.colModel[f].hidden){e.p.colModel[f].resizable=!1;break}"horizontal"==e.p.viewsortcols[1]&&(Da=" ui-i-asc",O=" ui-i-desc");C=r?"class='ui-th-div-ie'":"";Da="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+Da+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+k+"'></span>"+("<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+O+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+k+"'></span></span>");for(f=0;f<this.p.colNames.length;f++)O=
e.p.headertitles?' title="'+a.jgrid.stripHtml(e.p.colNames[f])+'"':"",L+="<th id='"+e.p.id+"_"+e.p.colModel[f].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+k+"'"+O+">",O=e.p.colModel[f].index||e.p.colModel[f].name,L+="<div id='jqgh_"+e.p.colModel[f].name+"' "+C+">"+e.p.colNames[f],e.p.colModel[f].width=e.p.colModel[f].width?parseInt(e.p.colModel[f].width,10):150,"boolean"!==typeof e.p.colModel[f].title&&(e.p.colModel[f].title=!0),O==e.p.sortname&&(e.p.lastsort=f),L+=Da+
"</div></th>";Da=null;a(this).append(L+"</tr></thead>");a("thead tr:first th",this).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});if(this.p.multiselect){var ia=[],na;a("#cb_"+a.jgrid.jqID(e.p.id),this).bind("click",function(){e.p.selarrrow=[];if(this.checked){a(e.rows).each(function(b){if(b>0&&!a(this).hasClass("subgrid")&&!a(this).hasClass("jqgroup")&&!a(this).hasClass("ui-state-disabled")){a("#jqg_"+a.jgrid.jqID(e.p.id)+"_"+a.jgrid.jqID(this.id)).attr("checked",
"checked");a(this).addClass("ui-state-highlight").attr("aria-selected","true");e.p.selarrrow.push(this.id);e.p.selrow=this.id}});na=true;ia=[]}else{a(e.rows).each(function(b){if(b>0&&!a(this).hasClass("subgrid")&&!a(this).hasClass("ui-state-disabled")){a("#jqg_"+a.jgrid.jqID(e.p.id)+"_"+a.jgrid.jqID(this.id)).removeAttr("checked");a(this).removeClass("ui-state-highlight").attr("aria-selected","false");ia.push(this.id)}});e.p.selrow=null;na=false}a.isFunction(e.p.onSelectAll)&&e.p.onSelectAll.call(e,
na?e.p.selarrrow:ia,na)})}!0===e.p.autowidth&&(L=a(u).innerWidth(),e.p.width=0<L?L:"nw");(function(){var b=0,d=q?0:e.p.cellLayout,f=0,g,k=e.p.scrollOffset,l,j=false,o,p=0,r=0,u;a.each(e.p.colModel,function(){if(typeof this.hidden==="undefined")this.hidden=false;this.widthOrg=l=t(this.width,0);if(this.hidden===false){b=b+(l+d);this.fixed?p=p+(l+d):f++;r++}});isNaN(e.p.width)?e.p.width=c.width=b:c.width=e.p.width;e.p.tblwidth=b;if(e.p.shrinkToFit===false&&e.p.forceFit===true)e.p.forceFit=false;if(e.p.shrinkToFit===
true&&f>0){o=c.width-d*f-p;if(!isNaN(e.p.height)){o=o-k;j=true}b=0;a.each(e.p.colModel,function(a){if(this.hidden===false&&!this.fixed){this.width=l=Math.round(o*this.width/(e.p.tblwidth-d*f-p));b=b+l;g=a}});u=0;j?c.width-p-(b+d*f)!==k&&(u=c.width-p-(b+d*f)-k):!j&&Math.abs(c.width-p-(b+d*f))!==1&&(u=c.width-p-(b+d*f));e.p.colModel[g].width=e.p.colModel[g].width+u;e.p.tblwidth=b+u+d*f+p;if(e.p.tblwidth>e.p.width){e.p.colModel[g].width=e.p.colModel[g].width-(e.p.tblwidth-parseInt(e.p.width,10));e.p.tblwidth=
e.p.width}}})();a(u).css("width",c.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+e.p.id+"'>&#160;</div>");a(j).css("width",c.width+"px");var L=a("thead:first",e).get(0),ta="";e.p.footerrow&&(ta+="<table role='grid' style='width:"+e.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+k+"'>");var j=a("tr:first",L),va="<tr class='jqgfirstrow' role='row' style='height:auto'>";e.p.disableClick=
!1;a("th",j).each(function(b){ha=e.p.colModel[b].width;if(typeof e.p.colModel[b].resizable==="undefined")e.p.colModel[b].resizable=true;if(e.p.colModel[b].resizable){aa=document.createElement("span");a(aa).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+k);a.browser.opera||a(aa).css("cursor","col-resize");a(this).addClass(e.p.resizeclass)}else aa="";a(this).css("width",ha+"px").prepend(aa);var d="";if(e.p.colModel[b].hidden){a(this).css("display","none");d="display:none;"}va=va+("<td role='gridcell' style='height:0px;width:"+
ha+"px;"+d+"'></td>");c.headers[b]={width:ha,el:this};X=e.p.colModel[b].sortable;if(typeof X!=="boolean")X=e.p.colModel[b].sortable=true;d=e.p.colModel[b].name;d=="cb"||d=="subgrid"||d=="rn"||e.p.viewsortcols[2]&&a("div",this).addClass("ui-jqgrid-sortable");if(X)if(e.p.viewsortcols[0]){a("div span.s-ico",this).show();b==e.p.lastsort&&a("div span.ui-icon-"+e.p.sortorder,this).removeClass("ui-state-disabled")}else if(b==e.p.lastsort){a("div span.s-ico",this).show();a("div span.ui-icon-"+e.p.sortorder,
this).removeClass("ui-state-disabled")}e.p.footerrow&&(ta=ta+("<td role='gridcell' "+v(b,0,"",null,"",false)+">&#160;</td>"))}).mousedown(function(b){if(a(b.target).closest("th>span.ui-jqgrid-resize").length==1){var d=a.jgrid.getCellIndex(this);if(e.p.forceFit===true){var f=e.p,g=d,k;for(k=d+1;k<e.p.colModel.length;k++)if(e.p.colModel[k].hidden!==true){g=k;break}f.nv=g-d}c.dragStart(d,b,Z(d));return false}}).click(function(b){if(e.p.disableClick)return e.p.disableClick=false;var c="th>div.ui-jqgrid-sortable",
d,f;e.p.viewsortcols[2]||(c="th>div>span>span.ui-grid-ico-sort");b=a(b.target).closest(c);if(b.length==1){c=a.jgrid.getCellIndex(this);if(!e.p.viewsortcols[2]){d=true;f=b.attr("sort")}M(a("div",this)[0].id,c,d,f);return false}});if(e.p.sortable&&a.fn.sortable)try{a(e).jqGrid("sortableColumns",j)}catch(J){}e.p.footerrow&&(ta+="</tr></tbody></table>");va+="</tr>";this.appendChild(document.createElement("tbody"));a(this).addClass("ui-jqgrid-btable").append(va);var va=null,j=a("<table class='ui-jqgrid-htable' style='width:"+
e.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(L),ea=e.p.caption&&!0===e.p.hiddengrid?!0:!1;f=a("<div class='ui-jqgrid-hbox"+("rtl"==k?"-rtl":"")+"'></div>");L=null;c.hDiv=document.createElement("div");a(c.hDiv).css({width:c.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(f);a(f).append(j);j=null;ea&&a(c.hDiv).hide();e.p.pager&&("string"==typeof e.p.pager?"#"!=e.p.pager.substr(0,1)&&(e.p.pager="#"+e.p.pager):
e.p.pager="#"+a(e.p.pager).attr("id"),a(e.p.pager).css({width:c.width+"px"}).appendTo(u).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom"),ea&&a(e.p.pager).hide(),o(e.p.pager,""));!1===e.p.cellEdit&&!0===e.p.hoverrows&&a(e).bind("mouseover",function(b){W=a(b.target).closest("tr.jqgrow");a(W).attr("class")!=="subgrid"&&a(W).addClass("ui-state-hover");return false}).bind("mouseout",function(b){W=a(b.target).closest("tr.jqgrow");a(W).removeClass("ui-state-hover");return false});var ua,la;
a(e).before(c.hDiv).click(function(b){S=b.target;W=a(S,e.rows).closest("tr.jqgrow");if(a(W).length===0||W[0].className.indexOf("ui-state-disabled")>-1)return this;var c=a(S).hasClass("cbox"),d=true;a.isFunction(e.p.beforeSelectRow)&&(d=e.p.beforeSelectRow.call(e,W[0].id,b));if(!(S.tagName=="A"||(S.tagName=="INPUT"||S.tagName=="TEXTAREA"||S.tagName=="OPTION"||S.tagName=="SELECT")&&!c)&&d===true){if(e.p.cellEdit===true)if(e.p.multiselect&&c)a(e).jqGrid("setSelection",W[0].id,true);else{ua=W[0].rowIndex;
la=a.jgrid.getCellIndex(S);try{a(e).jqGrid("editCell",ua,la,true)}catch(f){}}else if(e.p.multikey)if(b[e.p.multikey])a(e).jqGrid("setSelection",W[0].id,true);else{if(e.p.multiselect&&c){c=a("[id^=jqg_"+a.jgrid.jqID(e.p.id)+"_]").attr("checked");a("[id^=jqg_"+a.jgrid.jqID(e.p.id)+"_]").attr("checked",!c)}}else{if(e.p.multiselect&&e.p.multiboxonly&&!c){a(e.p.selarrrow).each(function(b,c){var d=e.rows.namedItem(c);a(d).removeClass("ui-state-highlight");a("#jqg_"+a.jgrid.jqID(e.p.id)+"_"+a.jgrid.jqID(c)).attr("checked",
false)});e.p.selarrrow=[];a("#cb_"+a.jgrid.jqID(e.p.id),e.grid.hDiv).attr("checked",false)}a(e).jqGrid("setSelection",W[0].id,true)}if(a.isFunction(e.p.onCellSelect)){ua=W[0].id;la=a.jgrid.getCellIndex(S);e.p.onCellSelect.call(e,ua,la,a(S).html(),b)}b.stopPropagation()}else return this}).bind("reloadGrid",function(b,c){if(e.p.treeGrid===true)e.p.datatype=e.p.treedatatype;c&&c.current&&e.grid.selectionPreserver(e);if(e.p.datatype=="local"){a(e).jqGrid("resetSelection");e.p.data.length&&G()}else if(!e.p.treeGrid){e.p.selrow=
null;if(e.p.multiselect){e.p.selarrrow=[];a("#cb_"+a.jgrid.jqID(e.p.id),e.grid.hDiv).attr("checked",false)}e.p.savedRow=[]}e.p.scroll&&K(e.grid.bDiv,true,false);if(c&&c.page){var d=c.page;if(d>e.p.lastpage)d=e.p.lastpage;d<1&&(d=1);e.p.page=d;e.grid.bDiv.scrollTop=e.grid.prevRowHeight?(d-1)*e.grid.prevRowHeight*e.p.rowNum:0}if(e.grid.prevRowHeight&&e.p.scroll){delete e.p.lastpage;e.grid.populateVisible()}else e.grid.populate();return false});a.isFunction(this.p.ondblClickRow)&&a(this).dblclick(function(b){S=
b.target;W=a(S,e.rows).closest("tr.jqgrow");if(a(W).length===0)return false;ua=W[0].rowIndex;la=a.jgrid.getCellIndex(S);e.p.ondblClickRow.call(e,a(W).attr("id"),ua,la,b);return false});a.isFunction(this.p.onRightClickRow)&&a(this).bind("contextmenu",function(b){S=b.target;W=a(S,e.rows).closest("tr.jqgrow");if(a(W).length===0)return false;e.p.multiselect||a(e).jqGrid("setSelection",W[0].id,true);ua=W[0].rowIndex;la=a.jgrid.getCellIndex(S);e.p.onRightClickRow.call(e,a(W).attr("id"),ua,la,b);return false});
c.bDiv=document.createElement("div");r&&"auto"===(""+e.p.height).toLowerCase()&&(e.p.height="100%");a(c.bDiv).append(a('<div style="position:relative;'+(r&&8>a.browser.version?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:e.p.height+(isNaN(e.p.height)?"":"px"),width:c.width+"px"}).scroll(c.scrollGrid);a("table:first",c.bDiv).css({width:e.p.tblwidth+"px"});r?(2==a("tbody",this).size()&&a("tbody:gt(0)",this).remove(),e.p.multikey&&a(c.bDiv).bind("selectstart",
function(){return false})):e.p.multikey&&a(c.bDiv).bind("mousedown",function(){return false});ea&&a(c.bDiv).hide();c.cDiv=document.createElement("div");var ka=!0===e.p.hidegrid?a("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close HeaderButton").hover(function(){ka.addClass("ui-state-hover")},function(){ka.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css("rtl"==k?"left":"right","0px"):"";a(c.cDiv).append(ka).append("<span class='ui-jqgrid-title"+
("rtl"==k?"-rtl":"")+"'>"+e.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix");a(c.cDiv).insertBefore(c.hDiv);e.p.toolbar[0]&&(c.uDiv=document.createElement("div"),"top"==e.p.toolbar[1]?a(c.uDiv).insertBefore(c.hDiv):"bottom"==e.p.toolbar[1]&&a(c.uDiv).insertAfter(c.hDiv),"both"==e.p.toolbar[1]?(c.ubDiv=document.createElement("div"),a(c.uDiv).insertBefore(c.hDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),a(c.ubDiv).insertAfter(c.hDiv).addClass("ui-userdata ui-state-default").attr("id",
"tb_"+this.id),ea&&a(c.ubDiv).hide()):a(c.uDiv).width(c.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),ea&&a(c.uDiv).hide());e.p.toppager&&(e.p.toppager=a.jgrid.jqID(e.p.id)+"_toppager",c.topDiv=a("<div id='"+e.p.toppager+"'></div>")[0],e.p.toppager="#"+e.p.toppager,a(c.topDiv).insertBefore(c.hDiv).addClass("ui-state-default ui-jqgrid-toppager").width(c.width),o(e.p.toppager,"_t"));e.p.footerrow&&(c.sDiv=a("<div class='ui-jqgrid-sdiv'></div>")[0],f=a("<div class='ui-jqgrid-hbox"+
("rtl"==k?"-rtl":"")+"'></div>"),a(c.sDiv).append(f).insertAfter(c.hDiv).width(c.width),a(f).append(ta),c.footers=a(".ui-jqgrid-ftable",c.sDiv)[0].rows[0].cells,e.p.rownumbers&&(c.footers[0].className="ui-state-default jqgrid-rownum"),ea&&a(c.sDiv).hide());f=null;if(e.p.caption){var La=e.p.datatype;!0===e.p.hidegrid&&(a(".ui-jqgrid-titlebar-close",c.cDiv).click(function(b){var d=a.isFunction(e.p.onHeaderClick),f=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",g,k=this;if(e.p.toolbar[0]===
true){e.p.toolbar[1]=="both"&&(f=f+(", #"+a(c.ubDiv).attr("id")));f=f+(", #"+a(c.uDiv).attr("id"))}g=a(f,"#gview_"+a.jgrid.jqID(e.p.id)).length;e.p.gridstate=="visible"?a(f,"#gbox_"+a.jgrid.jqID(e.p.id)).slideUp("fast",function(){g--;if(g===0){a("span",k).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");e.p.gridstate="hidden";a("#gbox_"+a.jgrid.jqID(e.p.id)).hasClass("ui-resizable")&&a(".ui-resizable-handle","#gbox_"+a.jgrid.jqID(e.p.id)).hide();d&&(ea||e.p.onHeaderClick.call(e,
e.p.gridstate,b))}}):e.p.gridstate=="hidden"&&a(f,"#gbox_"+a.jgrid.jqID(e.p.id)).slideDown("fast",function(){g--;if(g===0){a("span",k).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if(ea){e.p.datatype=La;D();ea=false}e.p.gridstate="visible";a("#gbox_"+a.jgrid.jqID(e.p.id)).hasClass("ui-resizable")&&a(".ui-resizable-handle","#gbox_"+a.jgrid.jqID(e.p.id)).show();d&&(ea||e.p.onHeaderClick.call(e,e.p.gridstate,b))}});return false}),ea&&(e.p.datatype="local",a(".ui-jqgrid-titlebar-close",
c.cDiv).trigger("click")))}else a(c.cDiv).hide();a(c.hDiv).after(c.bDiv).mousemove(function(a){if(c.resizing){c.dragMove(a);return false}});a(".ui-jqgrid-labels",c.hDiv).bind("selectstart",function(){return false});a(document).mouseup(function(){if(c.resizing){c.dragEnd();return false}return true});e.formatCol=v;e.sortData=M;e.updatepager=function(b,c){var d,f,g,k,l,m,j,o="";g=parseInt(e.p.page,10)-1;g<0&&(g=0);g=g*parseInt(e.p.rowNum,10);l=g+e.p.reccount;if(e.p.scroll){d=a("tbody:first > tr:gt(0)",
e.grid.bDiv);g=l-d.length;e.p.reccount=d.length;if(f=d.outerHeight()||e.grid.prevRowHeight){d=g*f;f=f*parseInt(e.p.records,10);a(">div:first",e.grid.bDiv).css({height:f}).children("div:first").css({height:d,display:d?"":"none"})}e.grid.bDiv.scrollLeft=e.grid.hDiv.scrollLeft}o=e.p.pager?e.p.pager:"";if(o=o+(e.p.toppager?o?","+e.p.toppager:e.p.toppager:"")){j=a.jgrid.formatter.integer||{};d=t(e.p.page);f=t(e.p.lastpage);a(".selbox",o).attr("disabled",false);if(e.p.pginput===true){a(".ui-pg-input",o).val(e.p.page);
a("#sp_1",o).html(a.fmatter?a.fmatter.util.NumberFormat(e.p.lastpage,j):e.p.lastpage)}if(e.p.viewrecords)if(e.p.reccount===0)a(".ui-paging-info",o).html(e.p.emptyrecords);else{k=g+1;m=e.p.records;if(a.fmatter){k=a.fmatter.util.NumberFormat(k,j);l=a.fmatter.util.NumberFormat(l,j);m=a.fmatter.util.NumberFormat(m,j)}a(".ui-paging-info",o).html(a.jgrid.format(e.p.recordtext,k,l,m))}if(e.p.pgbuttons===true){d<=0&&(d=f=0);if(d==1||d===0){a("#first, #prev",e.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");
e.p.toppager&&a("#first_t, #prev_t",e.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}else{a("#first, #prev",e.p.pager).removeClass("ui-state-disabled");e.p.toppager&&a("#first_t, #prev_t",e.p.toppager).removeClass("ui-state-disabled")}if(d==f||d===0){a("#next, #last",e.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");e.p.toppager&&a("#next_t, #last_t",e.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}else{a("#next, #last",e.p.pager).removeClass("ui-state-disabled");
e.p.toppager&&a("#next_t, #last_t",e.p.toppager).removeClass("ui-state-disabled")}}}b===true&&e.p.rownumbers===true&&a("td.jqgrid-rownum",e.rows).each(function(b){a(this).html(g+1+b)});c&&e.p.jqgdnd&&a(e).jqGrid("gridDnD","updateDnD");a.isFunction(e.p.gridComplete)&&e.p.gridComplete.call(e)};e.refreshIndex=G;e.formatter=function(a,b,c,e,d){return x(a,b,c,e,d)};a.extend(c,{populate:D,emptyRows:K});this.grid=c;e.addXmlData=function(a){R(a,e.grid.bDiv)};e.addJSONData=function(a){I(a,e.grid.bDiv)};this.grid.cols=
this.rows[0].cells;D();e.p.hiddengrid=!1;a(window).unload(function(){e=null})}}}})};a.jgrid.extend({getGridParam:function(a){var c=this[0];if(c&&c.grid)return a?"undefined"!=typeof c.p[a]?c.p[a]:null:c.p},setGridParam:function(d){return this.each(function(){this.grid&&"object"===typeof d&&a.extend(!0,this.p,d)})},getDataIDs:function(){var d=[],c=0,b,f=0;this.each(function(){if((b=this.rows.length)&&0<b)for(;c<b;)a(this.rows[c]).hasClass("jqgrow")&&(d[f]=this.rows[c].id,f++),c++});return d},setSelection:function(d,
c){return this.each(function(){var b,f,m;if(void 0!==d&&(c=!1===c?!1:!0,(f=this.rows.namedItem(d+""))&&!(-1<f.className.indexOf("ui-state-disabled")))){if(!0===this.p.scrollrows&&(b=this.rows.namedItem(d).rowIndex,0<=b)){m=a(this.grid.bDiv)[0].clientHeight;var g=a(this.grid.bDiv)[0].scrollTop,k=this.rows[b].offsetTop;b=this.rows[b].clientHeight;k+b>=m+g?a(this.grid.bDiv)[0].scrollTop=k-(m+g)+b+g:k<m+g&&k<g&&(a(this.grid.bDiv)[0].scrollTop=k)}this.p.multiselect?(this.p.selrow=f.id,m=a.inArray(this.p.selrow,
this.p.selarrrow),-1===m?("ui-subgrid"!==f.className&&a(f).addClass("ui-state-highlight").attr("aria-selected","true"),b=!0,a("#jqg_"+a.jgrid.jqID(this.p.id)+"_"+a.jgrid.jqID(this.p.selrow)).attr("checked",b),this.p.selarrrow.push(this.p.selrow)):("ui-subgrid"!==f.className&&a(f).removeClass("ui-state-highlight").attr("aria-selected","false"),b=!1,a("#jqg_"+a.jgrid.jqID(this.p.id)+"_"+a.jgrid.jqID(this.p.selrow)).attr("checked",b),this.p.selarrrow.splice(m,1),m=this.p.selarrrow[0],this.p.selrow=void 0===
m?null:m),this.p.onSelectRow&&c&&this.p.onSelectRow.call(this,f.id,b)):"ui-subgrid"!==f.className&&(this.p.selrow!=f.id?(a(this.rows.namedItem(this.p.selrow)).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"}),a(f).addClass("ui-state-highlight").attr({"aria-selected":!0,tabindex:"0"}),b=!0):b=!1,this.p.selrow=f.id,this.p.onSelectRow&&c&&this.p.onSelectRow.call(this,f.id,b))}})},resetSelection:function(d){return this.each(function(){var c=this,b,f;"undefined"!==typeof d?
(f=d===c.p.selrow?c.p.selrow:d,a("#"+a.jgrid.jqID(c.p.id)+" tbody:first tr#"+a.jgrid.jqID(f)).removeClass("ui-state-highlight").attr("aria-selected","false"),c.p.multiselect&&(a("#jqg_"+a.jgrid.jqID(c.p.id)+"_"+a.jgrid.jqID(f)).attr("checked",!1),a("#cb_"+a.jgrid.jqID(c.p.id)).attr("checked",!1)),f=null):c.p.multiselect?(a(c.p.selarrrow).each(function(d,f){b=c.rows.namedItem(f);a(b).removeClass("ui-state-highlight").attr("aria-selected","false");a("#jqg_"+a.jgrid.jqID(c.p.id)+"_"+a.jgrid.jqID(f)).attr("checked",
!1)}),a("#cb_"+a.jgrid.jqID(c.p.id)).attr("checked",!1),c.p.selarrrow=[]):c.p.selrow&&(a("#"+a.jgrid.jqID(c.p.id)+" tbody:first tr#"+a.jgrid.jqID(c.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false"),c.p.selrow=null);c.p.savedRow=[]})},getRowData:function(d){var c={},b,f=!1,m,g=0;this.each(function(){var k=this,e,j;if("undefined"==typeof d)f=!0,b=[],m=k.rows.length;else{j=k.rows.namedItem(d);if(!j)return c;m=2}for(;g<m;)f&&(j=k.rows[g]),a(j).hasClass("jqgrow")&&(a("td",j).each(function(b){e=
k.p.colModel[b].name;if("cb"!==e&&"subgrid"!==e&&"rn"!==e)if(!0===k.p.treeGrid&&e==k.p.ExpandColumn)c[e]=a.jgrid.htmlDecode(a("span:first",this).html());else try{c[e]=a.unformat(this,{rowId:j.id,colModel:k.p.colModel[b]},b)}catch(d){c[e]=a.jgrid.htmlDecode(a(this).html())}}),f&&(b.push(c),c={})),g++});return b?b:c},delRowData:function(d){var c=!1,b,f;this.each(function(){if(b=this.rows.namedItem(d)){if(a(b).remove(),this.p.records--,this.p.reccount--,this.updatepager(!0,!1),c=!0,this.p.multiselect&&
(f=a.inArray(d,this.p.selarrrow),-1!=f&&this.p.selarrrow.splice(f,1)),d==this.p.selrow)this.p.selrow=null}else return!1;if("local"==this.p.datatype){var m=this.p._index[d];"undefined"!=typeof m&&(this.p.data.splice(m,1),this.refreshIndex())}if(!0===this.p.altRows&&c){var g=this.p.altclass;a(this.rows).each(function(b){1==b%2?a(this).addClass(g):a(this).removeClass(g)})}});return c},setRowData:function(d,c,b){var f,m=!0,g;this.each(function(){if(!this.grid)return!1;var k=this,e,j,o=typeof b,r={};j=
k.rows.namedItem(d);if(!j)return!1;if(c)try{if(a(this.p.colModel).each(function(b){f=this.name;void 0!==c[f]&&(r[f]=this.formatter&&"string"===typeof this.formatter&&"date"==this.formatter?a.unformat.date(c[f],this):c[f],e=k.formatter(d,c[f],b,c,"edit"),g=this.title?{title:a.jgrid.stripHtml(e)}:{},!0===k.p.treeGrid&&f==k.p.ExpandColumn?a("td:eq("+b+") > span:first",j).html(e).attr(g):a("td:eq("+b+")",j).html(e).attr(g))}),"local"==k.p.datatype){var q=k.p._index[d];if(k.p.treeGrid)for(var u in k.p.treeReader)r.hasOwnProperty(k.p.treeReader[u])&&
delete r[k.p.treeReader[u]];"undefined"!=typeof q&&(k.p.data[q]=a.extend(!0,k.p.data[q],r));r=null}}catch(t){m=!1}m&&("string"===o?a(j).addClass(b):"object"===o&&a(j).css(b))});return m},addRowData:function(d,c,b,f){b||(b="last");var j=!1,g,k,e,p,o,r,q,u,t="",v,z,x,y,B;c&&(a.isArray(c)?(v=!0,b="last",z=d):(c=[c],v=!1),this.each(function(){var A=c.length;o=this.p.rownumbers===true?1:0;e=this.p.multiselect===true?1:0;p=this.p.subGrid===true?1:0;if(!v)if(typeof d!="undefined")d=d+"";else{d=a.jgrid.randId();
if(this.p.keyIndex!==false){z=this.p.colModel[this.p.keyIndex+e+p+o].name;typeof c[0][z]!="undefined"&&(d=c[0][z])}}x=this.p.altclass;for(var F=0,N="",K={},G=a.isFunction(this.p.afterInsertRow)?true:false;F<A;){y=c[F];k="";if(v){try{d=y[z]}catch(R){d=a.jgrid.randId()}N=this.p.altRows===true?(this.rows.length-1)%2===0?x:"":""}if(o){t=this.formatCol(0,1,"",null,d,true);k=k+('<td role="gridcell" aria-describedby="'+this.p.id+'_rn" class="ui-state-default jqgrid-rownum" '+t+">0</td>")}if(e){u='<input role="checkbox" type="checkbox" id="jqg_'+
this.p.id+"_"+d+'" class="cbox"/>';t=this.formatCol(o,1,"",null,d,true);k=k+('<td role="gridcell" aria-describedby="'+this.p.id+'_cb" '+t+">"+u+"</td>")}p&&(k=k+a(this).jqGrid("addSubGridCell",e+o,1));for(q=e+p+o;q<this.p.colModel.length;q++){B=this.p.colModel[q];g=B.name;K[g]=B.formatter&&typeof B.formatter==="string"&&B.formatter=="date"?a.unformat.date(y[g],B):y[g];u=this.formatter(d,a.jgrid.getAccessor(y,g),q,y,"edit");t=this.formatCol(q,1,u,d,y,true);k=k+('<td role="gridcell" aria-describedby="'+
this.p.id+"_"+g+'" '+t+">"+u+"</td>")}k='<tr id="'+d+'" role="row" tabindex="-1" class="ui-widget-content jqgrow ui-row-'+this.p.direction+" "+N+'">'+k+"</tr>";if(this.p.subGrid===true){k=a(k)[0];a(this).jqGrid("addSubGrid",k,e+o)}if(this.rows.length===0)a("table:first",this.grid.bDiv).append(k);else switch(b){case "last":a(this.rows[this.rows.length-1]).after(k);break;case "first":a(this.rows[0]).after(k);break;case "after":if(r=this.rows.namedItem(f))a(this.rows[r.rowIndex+1]).hasClass("ui-subgrid")?
a(this.rows[r.rowIndex+1]).after(k):a(r).after(k);break;case "before":if(r=this.rows.namedItem(f)){a(r).before(k);r=r.rowIndex}}this.p.records++;this.p.reccount++;G&&this.p.afterInsertRow.call(this,d,y,y);F++;if(this.p.datatype=="local"){K[this.p.localReader.id]=d;this.p._index[d]=this.p.data.length;this.p.data.push(K);K={}}}this.p.altRows===true&&!v&&(b=="last"?(this.rows.length-1)%2==1&&a(this.rows[this.rows.length-1]).addClass(x):a(this.rows).each(function(b){b%2==1?a(this).addClass(x):a(this).removeClass(x)}));
this.updatepager(true,true);j=true}));return j},footerData:function(d,c,b){function f(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}var j,g=!1,k={},e;"undefined"==typeof d&&(d="get");"boolean"!=typeof b&&(b=!0);d=d.toLowerCase();this.each(function(){var p=this,o;if(!p.grid||!p.p.footerrow||"set"==d&&f(c))return!1;g=!0;a(this.p.colModel).each(function(f){j=this.name;"set"==d?void 0!==c[j]&&(o=b?p.formatter("",c[j],f,c,"edit"):c[j],e=this.title?{title:a.jgrid.stripHtml(o)}:{},a("tr.footrow td:eq("+
f+")",p.grid.sDiv).html(o).attr(e),g=!0):"get"==d&&(k[j]=a("tr.footrow td:eq("+f+")",p.grid.sDiv).html())})});return"get"==d?k:g},showHideCol:function(d,c){return this.each(function(){var b=this,f=!1,j=a.browser.webkit||a.browser.safari?0:b.p.cellLayout,g;if(b.grid){"string"===typeof d&&(d=[d]);c="none"!=c?"":"none";var k=""===c?!0:!1;a(this.p.colModel).each(function(e){-1!==a.inArray(this.name,d)&&this.hidden===k&&(a("tr",b.grid.hDiv).each(function(){a(this).children("th:eq("+e+")").css("display",
c)}),a(b.rows).each(function(){a(this).children("td:eq("+e+")").css("display",c)}),b.p.footerrow&&a(b.grid.sDiv).children("td:eq("+e+")").css("display",c),g=this.widthOrg?this.widthOrg:parseInt(this.width,10),b.p.tblwidth="none"===c?b.p.tblwidth-(g+j):b.p.tblwidth+(g+j),this.hidden=!k,f=!0)});!0===f&&b.grid.width!==b.p.tblwidth&&a(b).jqGrid("setGridWidth",!0===b.p.shrinkToFit?b.grid.width:b.p.tblwidth,!0)}})},hideCol:function(d){return this.each(function(){a(this).jqGrid("showHideCol",d,"none")})},
showCol:function(d){return this.each(function(){a(this).jqGrid("showHideCol",d,"")})},remapColumns:function(d,c,b){function f(b){var c;c=b.length?a.makeArray(b):a.extend({},b);a.each(d,function(a){b[a]=c[this]})}function j(b,c){a(">tr"+(c||""),b).each(function(){var b=this,c=a.makeArray(b.cells);a.each(d,function(){var a=c[this];a&&b.appendChild(a)})})}var g=this.get(0);f(g.p.colModel);f(g.p.colNames);f(g.grid.headers);j(a("thead:first",g.grid.hDiv),b&&":not(.ui-jqgrid-labels)");c&&j(a("#"+a.jgrid.jqID(g.p.id)+
" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot");g.p.footerrow&&j(a("tbody:first",g.grid.sDiv));g.p.remapColumns&&(g.p.remapColumns.length?f(g.p.remapColumns):g.p.remapColumns=a.makeArray(d));g.p.lastsort=a.inArray(g.p.lastsort,d);g.p.treeGrid&&(g.p.expColInd=a.inArray(g.p.expColInd,d))},setGridWidth:function(d,c){return this.each(function(){if(this.grid){var b=this,f,j=0,g=a.browser.webkit||a.browser.safari?0:b.p.cellLayout,k,e=0,p=!1,o=b.p.scrollOffset,r,q=0,u=0,t;"boolean"!=typeof c&&(c=b.p.shrinkToFit);
if(!isNaN(d)&&(d=parseInt(d,10),b.grid.width=b.p.width=d,a("#gbox_"+a.jgrid.jqID(b.p.id)).css("width",d+"px"),a("#gview_"+a.jgrid.jqID(b.p.id)).css("width",d+"px"),a(b.grid.bDiv).css("width",d+"px"),a(b.grid.hDiv).css("width",d+"px"),b.p.pager&&a(b.p.pager).css("width",d+"px"),b.p.toppager&&a(b.p.toppager).css("width",d+"px"),!0===b.p.toolbar[0]&&(a(b.grid.uDiv).css("width",d+"px"),"both"==b.p.toolbar[1]&&a(b.grid.ubDiv).css("width",d+"px")),b.p.footerrow&&a(b.grid.sDiv).css("width",d+"px"),!1===
c&&!0===b.p.forceFit&&(b.p.forceFit=!1),!0===c))if(a.each(b.p.colModel,function(){if(this.hidden===false){f=this.widthOrg?this.widthOrg:parseInt(this.width,10);j=j+(f+g);this.fixed?q=q+(f+g):e++;u++}}),0!==e){b.p.tblwidth=j;r=d-g*e-q;if(!isNaN(b.p.height)&&(a(b.grid.bDiv)[0].clientHeight<a(b.grid.bDiv)[0].scrollHeight||1===b.rows.length))p=!0,r-=o;var j=0,v=0<b.grid.cols.length;a.each(b.p.colModel,function(a){if(this.hidden===false&&!this.fixed){f=this.widthOrg?this.widthOrg:parseInt(this.width,10);
f=Math.round(r*f/(b.p.tblwidth-g*e-q));if(!(f<0)){this.width=f;j=j+f;b.grid.headers[a].width=f;b.grid.headers[a].el.style.width=f+"px";if(b.p.footerrow)b.grid.footers[a].style.width=f+"px";if(v)b.grid.cols[a].style.width=f+"px";k=a}}});t=0;p?d-q-(j+g*e)!==o&&(t=d-q-(j+g*e)-o):1!==Math.abs(d-q-(j+g*e))&&(t=d-q-(j+g*e));b.p.colModel[k].width+=t;b.p.tblwidth=j+t+g*e+q;b.p.tblwidth>d?(p=b.p.tblwidth-parseInt(d,10),b.p.tblwidth=d,f=b.p.colModel[k].width-=p):f=b.p.colModel[k].width;b.grid.headers[k].width=
f;b.grid.headers[k].el.style.width=f+"px";v&&(b.grid.cols[k].style.width=f+"px");a("table:first",b.grid.bDiv).css("width",b.p.tblwidth+"px");a("table:first",b.grid.hDiv).css("width",b.p.tblwidth+"px");b.grid.hDiv.scrollLeft=b.grid.bDiv.scrollLeft;b.p.footerrow&&(b.grid.footers[k].style.width=f+"px",a("table:first",b.grid.sDiv).css("width",b.p.tblwidth+"px"))}}})},setGridHeight:function(d){return this.each(function(){this.grid&&(a(this.grid.bDiv).css({height:d+(isNaN(d)?"":"px")}),this.p.height=d,
this.p.scroll&&this.grid.populateVisible())})},setCaption:function(d){return this.each(function(){this.p.caption=d;a("span.ui-jqgrid-title",this.grid.cDiv).html(d);a(this.grid.cDiv).show()})},setLabel:function(d,c,b,f){return this.each(function(){var j=-1;if(this.grid&&(isNaN(d)?a(this.p.colModel).each(function(a){if(this.name==d)return j=a,!1}):j=parseInt(d,10),0<=j)){var g=a("tr.ui-jqgrid-labels th:eq("+j+")",this.grid.hDiv);if(c){var k=a(".s-ico",g);a("[id^=jqgh_]",g).empty().html(c).append(k);
this.p.colNames[j]=c}b&&("string"===typeof b?a(g).addClass(b):a(g).css(b));"object"===typeof f&&a(g).attr(f)}})},setCell:function(d,c,b,f,j,g){return this.each(function(){var k=-1,e,p;if(this.grid&&(isNaN(c)?a(this.p.colModel).each(function(a){if(this.name==c)return k=a,!1}):k=parseInt(c,10),0<=k&&(e=this.rows.namedItem(d)))){var o=a("td:eq("+k+")",e);if(""!==b||!0===g)e=this.formatter(d,b,k,e,"edit"),p=this.p.colModel[k].title?{title:a.jgrid.stripHtml(e)}:{},this.p.treeGrid&&0<a(".tree-wrap",a(o)).length?
a("span",a(o)).html(e).attr(p):a(o).html(e).attr(p),"local"==this.p.datatype&&(e=this.p.colModel[k],b=e.formatter&&"string"===typeof e.formatter&&"date"==e.formatter?a.unformat.date(b,e):b,p=this.p._index[d],"undefined"!=typeof p&&(this.p.data[p][e.name]=b));"string"===typeof f?a(o).addClass(f):f&&a(o).css(f);"object"===typeof j&&a(o).attr(j)}})},getCell:function(d,c){var b=!1;this.each(function(){var f=-1;if(this.grid&&(isNaN(c)?a(this.p.colModel).each(function(a){if(this.name===c)return f=a,!1}):
f=parseInt(c,10),0<=f)){var j=this.rows.namedItem(d);if(j)try{b=a.unformat(a("td:eq("+f+")",j),{rowId:j.id,colModel:this.p.colModel[f]},f)}catch(g){b=a.jgrid.htmlDecode(a("td:eq("+f+")",j).html())}}});return b},getCol:function(d,c,b){var f=[],j,g=0,k=0,e=0,p,c="boolean"!=typeof c?!1:c;"undefined"==typeof b&&(b=!1);this.each(function(){var o=-1;if(this.grid&&(isNaN(d)?a(this.p.colModel).each(function(a){if(this.name===d)return o=a,!1}):o=parseInt(d,10),0<=o)){var r=this.rows.length,q=0;if(r&&0<r){for(;q<
r;){if(a(this.rows[q]).hasClass("jqgrow")){try{j=a.unformat(a(this.rows[q].cells[o]),{rowId:this.rows[q].id,colModel:this.p.colModel[o]},o)}catch(u){j=a.jgrid.htmlDecode(this.rows[q].cells[o].innerHTML)}b?(p=parseFloat(j),g+=p,k=Math.min(k,p),e=Math.max(k,p)):c?f.push({id:this.rows[q].id,value:j}):f.push(j)}q++}if(b)switch(b.toLowerCase()){case "sum":f=g;break;case "avg":f=g/r;break;case "count":f=r;break;case "min":f=k;break;case "max":f=e}}}});return f},clearGridData:function(d){return this.each(function(){if(this.grid){"boolean"!=
typeof d&&(d=!1);if(this.p.deepempty)a("#"+a.jgrid.jqID(this.p.id)+" tbody:first tr:gt(0)").remove();else{var c=a("#"+a.jgrid.jqID(this.p.id)+" tbody:first tr:first")[0];a("#"+a.jgrid.jqID(this.p.id)+" tbody:first").empty().append(c)}this.p.footerrow&&d&&a(".ui-jqgrid-ftable td",this.grid.sDiv).html("&#160;");this.p.selrow=null;this.p.selarrrow=[];this.p.savedRow=[];this.p.records=0;this.p.page=1;this.p.lastpage=0;this.p.reccount=0;this.p.data=[];this.p_index={};this.updatepager(!0,!1)}})},getInd:function(a,
c){var b=!1,f;this.each(function(){if(f=this.rows.namedItem(a))b=!0===c?f:f.rowIndex});return b},bindKeys:function(d){var c=a.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:!0},d||{});return this.each(function(){var b=this;a("body").is("[role]")||a("body").attr("role","application");b.p.scrollrows=c.scrollingRows;a(b).keydown(function(d){var f=a(b).find("tr[tabindex=0]")[0],g,k,e,j=b.p.treeReader.expanded_field;if(f){e=b.p._index[f.id];if(37===d.keyCode||38===d.keyCode||
39===d.keyCode||40===d.keyCode){if(38===d.keyCode){k=f.previousSibling;g="";if(k)if(a(k).is(":hidden"))for(;k;){if(k=k.previousSibling,!a(k).is(":hidden")&&a(k).hasClass("jqgrow")){g=k.id;break}}else g=k.id;a(b).jqGrid("setSelection",g)}if(40===d.keyCode){k=f.nextSibling;g="";if(k)if(a(k).is(":hidden"))for(;k;){if(k=k.nextSibling,!a(k).is(":hidden")&&a(k).hasClass("jqgrow")){g=k.id;break}}else g=k.id;a(b).jqGrid("setSelection",g)}37===d.keyCode&&(b.p.treeGrid&&b.p.data[e][j]&&a(f).find("div.treeclick").trigger("click"),
a.isFunction(c.onLeftKey)&&c.onLeftKey.call(b,b.p.selrow));39===d.keyCode&&(b.p.treeGrid&&!b.p.data[e][j]&&a(f).find("div.treeclick").trigger("click"),a.isFunction(c.onRightKey)&&c.onRightKey.call(b,b.p.selrow));return!1}if(13===d.keyCode)return a.isFunction(c.onEnter)&&c.onEnter.call(b,b.p.selrow),!1;if(32===d.keyCode)return a.isFunction(c.onSpace)&&c.onSpace.call(b,b.p.selrow),!1}})})},unbindKeys:function(){return this.each(function(){a(this).unbind("keydown")})},getLocalRow:function(a){var c=!1,
b;this.each(function(){"undefined"!==typeof a&&(b=this.p._index[a],0<=b&&(c=this.p.data[b]))});return c}})})(j);(function(a){a.fmatter={};a.extend(a.fmatter,{isBoolean:function(a){return"boolean"===typeof a},isObject:function(d){return d&&("object"===typeof d||a.isFunction(d))||!1},isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a&&isFinite(a)},isNull:function(a){return null===a},isUndefined:function(a){return"undefined"===typeof a},isValue:function(a){return this.isObject(a)||
this.isString(a)||this.isNumber(a)||this.isBoolean(a)},isEmpty:function(d){if(!this.isString(d)&&this.isValue(d))return!1;if(!this.isValue(d))return!0;d=a.trim(d).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return""===d}});a.fn.fmatter=function(d,c,b,f,j){var g=c,b=a.extend({},a.jgrid.formatter,b);a.fn.fmatter[d]&&(g=a.fn.fmatter[d](c,b,f,j));return g};a.fmatter.util={NumberFormat:function(d,c){a.fmatter.isNumber(d)||(d*=1);if(a.fmatter.isNumber(d)){var b=0>d,f=d+"",j=c.decimalSeparator?c.decimalSeparator:
".",g;if(a.fmatter.isNumber(c.decimalPlaces)){var k=c.decimalPlaces,f=Math.pow(10,k),f=Math.round(d*f)/f+"";g=f.lastIndexOf(".");if(0<k){0>g?(f+=j,g=f.length-1):"."!==j&&(f=f.replace(".",j));for(;f.length-1-g<k;)f+="0"}}if(c.thousandsSeparator){k=c.thousandsSeparator;g=f.lastIndexOf(j);g=-1<g?g:f.length;for(var j=f.substring(g),e=-1,p=g;0<p;p--){e++;if(0===e%3&&p!==g&&(!b||1<p))j=k+j;j=f.charAt(p-1)+j}f=j}f=c.prefix?c.prefix+f:f;return c.suffix?f+c.suffix:f}return d},DateFormat:function(d,c,b,f){var j=
/^\/Date\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\)\/$/,g="string"===typeof c?c.match(j):null,j=function(a,b){a=""+a;for(b=parseInt(b,10)||2;a.length<b;)a="0"+a;return a},k={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},e=0,p,o=["i18n"];o.i18n={dayNames:f.dayNames,monthNames:f.monthNames};d in f.masks&&(d=f.masks[d]);if(c.constructor===Number)"u"==(""+d).toLowerCase()&&(c*=1E3),e=new Date(c);else if(c.constructor===Date)e=c;else if(null!==g)e=new Date(parseInt(g[1],10)),g[3]&&(d=60*Number(g[5])+Number(g[6]),
d*="-"==g[4]?1:-1,d-=e.getTimezoneOffset(),e.setTime(Number(Number(e)+6E4*d)));else{c=(""+c).split(/[\\\/:_;.,\t\T\s-]/);d=d.split(/[\\\/:_;.,\t\T\s-]/);g=0;for(p=d.length;g<p;g++)"M"==d[g]&&(e=a.inArray(c[g],o.i18n.monthNames),-1!==e&&12>e&&(c[g]=e+1)),"F"==d[g]&&(e=a.inArray(c[g],o.i18n.monthNames),-1!==e&&11<e&&(c[g]=e+1-12)),c[g]&&(k[d[g].toLowerCase()]=parseInt(c[g],10));k.f&&(k.m=k.f);if(0===k.m&&0===k.y&&0===k.d)return"&#160;";k.m=parseInt(k.m,10)-1;e=k.y;70<=e&&99>=e?k.y=1900+k.y:0<=e&&69>=
e&&(k.y=2E3+k.y);e=new Date(k.y,k.m,k.d,k.h,k.i,k.s,k.u)}b in f.masks?b=f.masks[b]:b||(b="Y-m-d");d=e.getHours();c=e.getMinutes();k=e.getDate();g=e.getMonth()+1;p=e.getTimezoneOffset();var r=e.getSeconds(),q=e.getMilliseconds(),u=e.getDay(),t=e.getFullYear(),v=(u+6)%7+1,z=(new Date(t,g-1,k)-new Date(t,0,1))/864E5,x={d:j(k),D:o.i18n.dayNames[u],j:k,l:o.i18n.dayNames[u+7],N:v,S:f.S(k),w:u,z:z,W:5>v?Math.floor((z+v-1)/7)+1:Math.floor((z+v-1)/7)||(4>((new Date(t-1,0,1)).getDay()+6)%7?53:52),F:o.i18n.monthNames[g-
1+12],m:j(g),M:o.i18n.monthNames[g-1],n:g,t:"?",L:"?",o:"?",Y:t,y:(""+t).substring(2),a:12>d?f.AmPm[0]:f.AmPm[1],A:12>d?f.AmPm[2]:f.AmPm[3],B:"?",g:d%12||12,G:d,h:j(d%12||12),H:j(d),i:j(c),s:j(r),u:q,e:"?",I:"?",O:(0<p?"-":"+")+j(100*Math.floor(Math.abs(p)/60)+Math.abs(p)%60,4),P:"?",T:((""+e).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||[""]).pop().replace(/[^-+\dA-Z]/g,""),Z:"?",c:"?",r:"?",U:Math.floor(e/
1E3)};return b.replace(/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,function(a){return a in x?x[a]:a.substring(1)})}};a.fn.fmatter.defaultFormat=function(d,c){return a.fmatter.isValue(d)&&""!==d?d:c.defaultValue?c.defaultValue:"&#160;"};a.fn.fmatter.email=function(d,c){return a.fmatter.isEmpty(d)?a.fn.fmatter.defaultFormat(d,c):'<a href="mailto:'+d+'">'+d+"</a>"};a.fn.fmatter.checkbox=function(d,c){var b=a.extend({},c.checkbox),f;a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,
c.colModel.formatoptions));f=!0===b.disabled?'disabled="disabled"':"";if(a.fmatter.isEmpty(d)||a.fmatter.isUndefined(d))d=a.fn.fmatter.defaultFormat(d,b);d=(d+"").toLowerCase();return'<input type="checkbox" '+(0>d.search(/(false|0|no|off)/i)?" checked='checked' ":"")+' value="'+d+'" offval="no" '+f+"/>"};a.fn.fmatter.link=function(d,c){var b={target:c.target},f="";a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));b.target&&(f="target="+b.target);return a.fmatter.isEmpty(d)?
a.fn.fmatter.defaultFormat(d,c):"<a "+f+' href="'+d+'">'+d+"</a>"};a.fn.fmatter.showlink=function(d,c){var b={baseLinkUrl:c.baseLinkUrl,showAction:c.showAction,addParam:c.addParam||"",target:c.target,idName:c.idName},f="";a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));b.target&&(f="target="+b.target);b=b.baseLinkUrl+b.showAction+"?"+b.idName+"="+c.rowId+b.addParam;return a.fmatter.isString(d)||a.fmatter.isNumber(d)?"<a "+f+' href="'+b+'">'+d+"</a>":a.fn.fmatter.defaultFormat(d,
c)};a.fn.fmatter.integer=function(d,c){var b=a.extend({},c.integer);a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));return a.fmatter.isEmpty(d)?b.defaultValue:a.fmatter.util.NumberFormat(d,b)};a.fn.fmatter.number=function(d,c){var b=a.extend({},c.number);a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));return a.fmatter.isEmpty(d)?b.defaultValue:a.fmatter.util.NumberFormat(d,b)};a.fn.fmatter.currency=function(d,
c){var b=a.extend({},c.currency);a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));return a.fmatter.isEmpty(d)?b.defaultValue:a.fmatter.util.NumberFormat(d,b)};a.fn.fmatter.date=function(d,c,b,f){b=a.extend({},c.date);a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));return!b.reformatAfterEdit&&"edit"==f?a.fn.fmatter.defaultFormat(d,c):a.fmatter.isEmpty(d)?a.fn.fmatter.defaultFormat(d,c):a.fmatter.util.DateFormat(b.srcformat,
d,b.newformat,b)};a.fn.fmatter.select=function(d,c){var d=d+"",b=!1,f=[];a.fmatter.isUndefined(c.colModel.formatoptions)?a.fmatter.isUndefined(c.colModel.editoptions)||(b=c.colModel.editoptions.value):b=c.colModel.formatoptions.value;if(b){var m=!0===c.colModel.editoptions.multiple?!0:!1,g=[],k;m&&(g=d.split(","),g=a.map(g,function(b){return a.trim(b)}));if(a.fmatter.isString(b))for(var e=b.split(";"),p=0,o=0;o<e.length;o++)if(k=e[o].split(":"),2<k.length&&(k[1]=j.map(k,function(a,b){if(b>0)return a}).join(":")),
m)-1<j.inArray(k[0],g)&&(f[p]=k[1],p++);else{if(a.trim(k[0])==a.trim(d)){f[0]=k[1];break}}else a.fmatter.isObject(b)&&(m?f=j.map(g,function(a){return b[a]}):f[0]=b[d]||"")}d=f.join(", ");return""===d?a.fn.fmatter.defaultFormat(d,c):d};a.fn.fmatter.rowactions=function(d,c,b,f){var j={keys:!1,editbutton:!0,delbutton:!0,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{}},f=a("#"+c)[0].p.colModel[f];a.fmatter.isUndefined(f.formatoptions)||
(j=a.extend(j,f.formatoptions));var f=function(b){j.afterSave&&j.afterSave(b);a("tr#"+d+" div.ui-inline-edit, tr#"+d+" div.ui-inline-del","#"+c).show();a("tr#"+d+" div.ui-inline-save, tr#"+d+" div.ui-inline-cancel","#"+c).hide()},g=function(b){j.afterRestore&&j.afterRestore(b);a("tr#"+d+" div.ui-inline-edit, tr#"+d+" div.ui-inline-del","#"+c).show();a("tr#"+d+" div.ui-inline-save, tr#"+d+" div.ui-inline-cancel","#"+c).hide()};switch(b){case "edit":a("#"+c).jqGrid("editRow",d,j.keys,j.onEdit,j.onSuccess,
j.url,j.extraparam,f,j.onError,g);a("tr#"+d+" div.ui-inline-edit, tr#"+d+" div.ui-inline-del","#"+c).hide();a("tr#"+d+" div.ui-inline-save, tr#"+d+" div.ui-inline-cancel","#"+c).show();break;case "save":a("#"+c).jqGrid("saveRow",d,j.onSuccess,j.url,j.extraparam,f,j.onError,g)&&(a("tr#"+d+" div.ui-inline-edit, tr#"+d+" div.ui-inline-del","#"+c).show(),a("tr#"+d+" div.ui-inline-save, tr#"+d+" div.ui-inline-cancel","#"+c).hide());break;case "cancel":a("#"+c).jqGrid("restoreRow",d,g);a("tr#"+d+" div.ui-inline-edit, tr#"+
d+" div.ui-inline-del","#"+c).show();a("tr#"+d+" div.ui-inline-save, tr#"+d+" div.ui-inline-cancel","#"+c).hide();break;case "del":a("#"+c).jqGrid("delGridRow",d,j.delOptions)}};a.fn.fmatter.actions=function(d,c){var b={keys:!1,editbutton:!0,delbutton:!0};a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend(b,c.colModel.formatoptions));var f=c.rowId,j="",g;if("undefined"==typeof f||a.fmatter.isEmpty(f))return"";b.editbutton&&(g="onclick=$.fn.fmatter.rowactions('"+f+"','"+c.gid+"','edit',"+
c.pos+");",j=j+"<div style='margin-left:8px;'><div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+g+"><span class='ui-icon ui-icon-pencil'></span></div>");b.delbutton&&(g="onclick=$.fn.fmatter.rowactions('"+f+"','"+c.gid+"','del',"+c.pos+");",j=j+"<div title='"+a.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+g+"><span class='ui-icon ui-icon-trash'></span></div>");g="onclick=$.fn.fmatter.rowactions('"+
f+"','"+c.gid+"','save',"+c.pos+");";j=j+"<div title='"+a.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save'><span class='ui-icon ui-icon-disk' "+g+"></span></div>";g="onclick=$.fn.fmatter.rowactions('"+f+"','"+c.gid+"','cancel',"+c.pos+");";return j+"<div title='"+a.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel'><span class='ui-icon ui-icon-cancel' "+g+"></span></div></div>"};a.unformat=function(d,c,b,
f){var j,g=c.colModel.formatter,k=c.colModel.formatoptions||{},e=/([\.\*\_\'\(\)\{\}\+\?\\])/g,p=c.colModel.unformat||a.fn.fmatter[g]&&a.fn.fmatter[g].unformat;if("undefined"!==typeof p&&a.isFunction(p))j=p(a(d).text(),c,d);else if(!a.fmatter.isUndefined(g)&&a.fmatter.isString(g))switch(j=a.jgrid.formatter||{},g){case "integer":k=a.extend({},j.integer,k);c=k.thousandsSeparator.replace(e,"\\$1");j=a(d).text().replace(RegExp(c,"g"),"");break;case "number":k=a.extend({},j.number,k);c=k.thousandsSeparator.replace(e,
"\\$1");j=a(d).text().replace(RegExp(c,"g"),"").replace(k.decimalSeparator,".");break;case "currency":k=a.extend({},j.currency,k);c=k.thousandsSeparator.replace(e,"\\$1");j=a(d).text().replace(RegExp(c,"g"),"").replace(k.decimalSeparator,".").replace(k.prefix,"").replace(k.suffix,"");break;case "checkbox":k=c.colModel.editoptions?c.colModel.editoptions.value.split(":"):["Yes","No"];j=a("input",d).attr("checked")?k[0]:k[1];break;case "select":j=a.unformat.select(d,c,b,f);break;case "actions":return"";
default:j=a(d).text()}return j?j:!0===f?a(d).text():a.jgrid.htmlDecode(a(d).html())};a.unformat.select=function(d,c,b,f){b=[];d=a(d).text();if(!0===f)return d;c=a.extend({},c.colModel.editoptions);if(c.value){var m=c.value,c=!0===c.multiple?!0:!1,f=[],g;c&&(f=d.split(","),f=a.map(f,function(b){return a.trim(b)}));if(a.fmatter.isString(m))for(var k=m.split(";"),e=0,p=0;p<k.length;p++)if(g=k[p].split(":"),2<g.length&&(g[1]=j.map(g,function(a,b){if(b>0)return a}).join(":")),c)-1<j.inArray(g[1],f)&&(b[e]=
g[0],e++);else{if(a.trim(g[1])==a.trim(d)){b[0]=g[0];break}}else if(a.fmatter.isObject(m)||a.isArray(m))c||(f[0]=d),b=j.map(f,function(b){var c;a.each(m,function(a,e){if(e==b){c=a;return false}});if(typeof c!="undefined")return c});return b.join(", ")}return d||""};a.unformat.date=function(d,c){var b=a.jgrid.formatter.date||{};a.fmatter.isUndefined(c.formatoptions)||(b=a.extend({},b,c.formatoptions));return a.fmatter.isEmpty(d)?a.fn.fmatter.defaultFormat(d,c):a.fmatter.util.DateFormat(b.newformat,
d,b.srcformat,b)}})(j);(function(a){a.jgrid.extend({getColProp:function(a){var c={},b=this[0];if(!b.grid)return!1;for(var b=b.p.colModel,f=0;f<b.length;f++)if(b[f].name==a){c=b[f];break}return c},setColProp:function(d,c){return this.each(function(){if(this.grid&&c)for(var b=this.p.colModel,f=0;f<b.length;f++)if(b[f].name==d){a.extend(this.p.colModel[f],c);break}})},sortGrid:function(a,c,b){return this.each(function(){var f=-1;if(this.grid){a||(a=this.p.sortname);for(var j=0;j<this.p.colModel.length;j++)if(this.p.colModel[j].index==
a||this.p.colModel[j].name==a){f=j;break}-1!=f&&(j=this.p.colModel[f].sortable,"boolean"!==typeof j&&(j=!0),"boolean"!==typeof c&&(c=!1),j&&this.sortData("jqgh_"+a,f,c,b))}})},GridDestroy:function(){return this.each(function(){if(this.grid){this.p.pager&&a(this.p.pager).remove();var d=this.id;try{a("#gbox_"+d).remove()}catch(c){}}})},GridUnload:function(){return this.each(function(){if(this.grid){var d={id:a(this).attr("id"),cl:a(this).attr("class")};this.p.pager&&a(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom");
var c=document.createElement("table");a(c).attr({id:d.id});c.className=d.cl;d=this.id;a(c).removeClass("ui-jqgrid-btable");1===a(this.p.pager).parents("#gbox_"+d).length?(a(c).insertBefore("#gbox_"+d).show(),a(this.p.pager).insertBefore("#gbox_"+d)):a(c).insertBefore("#gbox_"+d).show();a("#gbox_"+d).remove()}})},setGridState:function(d){return this.each(function(){this.grid&&("hidden"==d?(a(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+this.p.id).slideUp("fast"),this.p.pager&&a(this.p.pager).slideUp("fast"),
this.p.toppager&&a(this.p.toppager).slideUp("fast"),!0===this.p.toolbar[0]&&("both"==this.p.toolbar[1]&&a(this.grid.ubDiv).slideUp("fast"),a(this.grid.uDiv).slideUp("fast")),this.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+this.p.id).slideUp("fast"),a(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),this.p.gridstate="hidden"):"visible"==d&&(a(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+this.p.id).slideDown("fast"),this.p.pager&&
a(this.p.pager).slideDown("fast"),this.p.toppager&&a(this.p.toppager).slideDown("fast"),!0===this.p.toolbar[0]&&("both"==this.p.toolbar[1]&&a(this.grid.ubDiv).slideDown("fast"),a(this.grid.uDiv).slideDown("fast")),this.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+this.p.id).slideDown("fast"),a(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),this.p.gridstate="visible"))})},filterToolbar:function(d){d=a.extend({autosearch:!0,
searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw"},d||{});return this.each(function(){function c(b,c){var d=a(b);d[0]&&j.each(c,function(){void 0!==this.data?d.bind(this.type,this.data,this.fn):d.bind(this.type,this.fn)})}var b=this;if(!this.ftoolbar){var f=function(){var c={},e=0,f,g,j={},l;a.each(b.p.colModel,function(){g=this.index||this.name;switch(this.stype){case "select":l=this.searchoptions&&this.searchoptions.sopt?
this.searchoptions.sopt[0]:"eq";if(f=a("#gs_"+a.jgrid.jqID(g),b.grid.hDiv).val())c[g]=f,j[g]=l,e++;else try{delete b.p.postData[g]}catch(m){}break;case "text":if(l=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:d.defaultSearch,f=a("#gs_"+a.jgrid.jqID(g),b.grid.hDiv).val())c[g]=f,j[g]=l,e++;else try{delete b.p.postData[g]}catch(t){}}});var m=0<e?!0:!1;if(!0===d.stringResult||"local"==b.p.datatype){var t='{"groupOp":"'+d.groupOp+'","rules":[',v=0;a.each(c,function(a,b){0<v&&
(t+=",");t+='{"field":"'+a+'",';t+='"op":"'+j[a]+'",';t+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';v++});t+="]}";a.extend(b.p.postData,{filters:t});a.each(["searchField","searchString","searchOper"],function(a,c){b.p.postData.hasOwnProperty(c)&&delete b.p.postData[c]})}else a.extend(b.p.postData,c);var z;b.p.searchurl&&(z=b.p.url,a(b).jqGrid("setGridParam",{url:b.p.searchurl}));var x=!1;a.isFunction(d.beforeSearch)&&(x=d.beforeSearch.call(b));x||a(b).jqGrid("setGridParam",
{search:m}).trigger("reloadGrid",[{page:1}]);z&&a(b).jqGrid("setGridParam",{url:z});a.isFunction(d.afterSearch)&&d.afterSearch()},m=a("<tr class='ui-search-toolbar' role='rowheader'></tr>"),g;a.each(b.p.colModel,function(){var k=this,e,j,o,r;j=a("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+b.p.direction+"'></th>");e=a("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>");!0===this.hidden&&a(j).css("display","none");this.search=!1===this.search?
!1:!0;"undefined"==typeof this.stype&&(this.stype="text");o=a.extend({},this.searchoptions||{});if(this.search)switch(this.stype){case "select":if(r=this.surl||o.dataUrl)a.ajax(a.extend({url:r,dataType:"html",complete:function(b){o.buildSelect!==void 0?(b=o.buildSelect(b))&&a(e).append(b):a(e).append(b.responseText);o.defaultValue&&a("select",e).val(o.defaultValue);a("select",e).attr({name:k.index||k.name,id:"gs_"+k.name});o.attr&&a("select",e).attr(o.attr);a("select",e).css({width:"100%"});o.dataInit!==
void 0&&o.dataInit(a("select",e)[0]);o.dataEvents!==void 0&&c(a("select",e)[0],o.dataEvents);d.autosearch===true&&a("select",e).change(function(){f();return false});b=null}},a.jgrid.ajaxOptions,b.p.ajaxSelectOptions||{}));else{var q;k.searchoptions&&k.searchoptions.value?q=k.searchoptions.value:k.editoptions&&k.editoptions.value&&(q=k.editoptions.value);if(q){r=document.createElement("select");r.style.width="100%";a(r).attr({name:k.index||k.name,id:"gs_"+k.name});var u,t;if("string"===typeof q){q=
q.split(";");for(var v=0;v<q.length;v++)u=q[v].split(":"),t=document.createElement("option"),t.value=u[0],t.innerHTML=u[1],r.appendChild(t)}else if("object"===typeof q)for(u in q)q.hasOwnProperty(u)&&(t=document.createElement("option"),t.value=u,t.innerHTML=q[u],r.appendChild(t));o.defaultValue&&a(r).val(o.defaultValue);o.attr&&a(r).attr(o.attr);void 0!==o.dataInit&&o.dataInit(r);void 0!==o.dataEvents&&c(r,o.dataEvents);a(e).append(r);!0===d.autosearch&&a(r).change(function(){f();return false})}}break;
case "text":r=o.defaultValue?o.defaultValue:"",a(e).append("<input type='text' style='width:95%;padding:0px;' name='"+(k.index||k.name)+"' id='gs_"+k.name+"' value='"+r+"'/>"),o.attr&&a("input",e).attr(o.attr),void 0!==o.dataInit&&o.dataInit(a("input",e)[0]),void 0!==o.dataEvents&&c(a("input",e)[0],o.dataEvents),!0===d.autosearch&&(d.searchOnEnter?a("input",e).keypress(function(a){if((a.charCode?a.charCode:a.keyCode?a.keyCode:0)==13){f();return false}return this}):a("input",e).keydown(function(a){switch(a.which){case 13:return false;
case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:g&&clearTimeout(g);g=setTimeout(function(){f()},500)}}))}a(j).append(e);a(m).append(j)});a("table thead",b.grid.hDiv).append(m);this.ftoolbar=!0;this.triggerToolbar=f;this.clearToolbar=function(c){var e={},f,g=0,j,c="boolean"!=typeof c?!0:c;a.each(b.p.colModel,function(){f=this.searchoptions&&this.searchoptions.defaultValue?this.searchoptions.defaultValue:"";j=this.index||this.name;switch(this.stype){case "select":var c;a("#gs_"+
a.jgrid.jqID(j)+" option",b.grid.hDiv).each(function(b){0===b&&(this.selected=!0);if(a(this).text()==f)return this.selected=!0,c=a(this).val(),!1});if(c)e[j]=c,g++;else try{delete b.p.postData[j]}catch(d){}break;case "text":if(a("#gs_"+a.jgrid.jqID(j),b.grid.hDiv).val(f),f)e[j]=f,g++;else try{delete b.p.postData[j]}catch(k){}}});var l=0<g?!0:!1;if(!0===d.stringResult||"local"==b.p.datatype){var m='{"groupOp":"'+d.groupOp+'","rules":[',t=0;a.each(e,function(a,b){0<t&&(m+=",");m+='{"field":"'+a+'",';
m+='"op":"eq",';m+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';t++});m+="]}";a.extend(b.p.postData,{filters:m});a.each(["searchField","searchString","searchOper"],function(a,c){b.p.postData.hasOwnProperty(c)&&delete b.p.postData[c]})}else a.extend(b.p.postData,e);var v;b.p.searchurl&&(v=b.p.url,a(b).jqGrid("setGridParam",{url:b.p.searchurl}));var z=!1;a.isFunction(d.beforeClear)&&(z=d.beforeClear.call(b));z||c&&a(b).jqGrid("setGridParam",{search:l}).trigger("reloadGrid",[{page:1}]);
v&&a(b).jqGrid("setGridParam",{url:v});a.isFunction(d.afterClear)&&d.afterClear()};this.toggleToolbar=function(){var c=a("tr.ui-search-toolbar",b.grid.hDiv);"none"==c.css("display")?c.show():c.hide()}}})}})})(j);(function(a){a.extend(a.jgrid,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true");a.o&&a.o.remove()},hideModal:function(d,c){c=a.extend({jqm:!0,gb:""},c||{});if(c.onClose){var b=c.onClose(d);if("boolean"==typeof b&&!b)return}if(a.fn.jqm&&!0===c.jqm)a(d).attr("aria-hidden",
"true").jqmHide();else{if(""!==c.gb)try{a(".jqgrid-overlay:first",c.gb).hide()}catch(f){}a(d).hide().attr("aria-hidden","true")}},findPos:function(a){var c=0,b=0;if(a.offsetParent){do c+=a.offsetLeft,b+=a.offsetTop;while(a=a.offsetParent)}return[c,b]},createModal:function(d,c,b,f,j,g,k){var e=document.createElement("div"),p,o=this,k=a.extend({},k||{});p="rtl"==a(b.gbox).attr("dir")?!0:!1;e.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";e.id=d.themodal;var r=document.createElement("div");
r.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";r.id=d.modalhead;a(r).append("<span class='ui-jqdialog-title'>"+b.caption+"</span>");var q=a("<a href='javascript:void(0)' class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){q.addClass("ui-state-hover")},function(){q.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");a(r).append(q);p?(e.dir="rtl",a(".ui-jqdialog-title",r).css("float","right"),a(".ui-jqdialog-titlebar-close",
r).css("left","0.3em")):(e.dir="ltr",a(".ui-jqdialog-title",r).css("float","left"),a(".ui-jqdialog-titlebar-close",r).css("right","0.3em"));var u=document.createElement("div");a(u).addClass("ui-jqdialog-content ui-widget-content").attr("id",d.modalcontent);a(u).append(c);e.appendChild(u);a(e).prepend(r);!0===g?a("body").append(e):"string"==typeof g?a(g).append(e):a(e).insertBefore(f);a(e).css(k);"undefined"===typeof b.jqModal&&(b.jqModal=!0);c={};if(a.fn.jqm&&!0===b.jqModal)0===b.left&&(0===b.top&&
b.overlay)&&(k=[],k=this.findPos(j),b.left=k[0]+4,b.top=k[1]+4),c.top=b.top+"px",c.left=b.left;else if(0!==b.left||0!==b.top)c.left=b.left,c.top=b.top+"px";a("a.ui-jqdialog-titlebar-close",r).click(function(){var c=a("#"+d.themodal).data("onClose")||b.onClose,e=a("#"+d.themodal).data("gbox")||b.gbox;o.hideModal("#"+d.themodal,{gb:e,jqm:b.jqModal,onClose:c});return false});if(0===b.width||!b.width)b.width=300;if(0===b.height||!b.height)b.height=200;b.zIndex||(f=a(f).parents("*[role=dialog]").filter(":first").css("z-index"),
b.zIndex=f?parseInt(f,10)+1:950);f=0;p&&(c.left&&!g)&&(f=a(b.gbox).width()-(!isNaN(b.width)?parseInt(b.width,10):0)-8,c.left=parseInt(c.left,10)+parseInt(f,10));c.left&&(c.left+="px");a(e).css(a.extend({width:isNaN(b.width)?"auto":b.width+"px",height:isNaN(b.height)?"auto":b.height+"px",zIndex:b.zIndex,overflow:"hidden"},c)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":d.modalhead,"aria-hidden":"true"});"undefined"==typeof b.drag&&(b.drag=!0);"undefined"==typeof b.resize&&(b.resize=!0);if(b.drag)if(a(r).css("cursor",
"move"),a.fn.jqDrag)a(e).jqDrag(r);else try{a(e).draggable({handle:a("#"+r.id)})}catch(t){}if(b.resize)if(a.fn.jqResize)a(e).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>"),a("#"+d.themodal).jqResize(".jqResize",d.scrollelm?"#"+d.scrollelm:!1);else try{a(e).resizable({handles:"se, sw",alsoResize:d.scrollelm?"#"+d.scrollelm:!1})}catch(v){}!0===b.closeOnEscape&&a(e).keydown(function(c){if(c.which==27){c=a("#"+
d.themodal).data("onClose")||b.onClose;o.hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:c})}})},viewModal:function(d,c){c=a.extend({toTop:!0,overlay:10,modal:!1,onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:!0,jqM:!0},c||{});if(a.fn.jqm&&!0===c.jqm)c.jqM?a(d).attr("aria-hidden","false").jqm(c).jqmShow():a(d).attr("aria-hidden","false").jqmShow();else{""!==c.gbox&&(a(".jqgrid-overlay:first",c.gbox).show(),a(d).data("gbox",c.gbox));a(d).show().attr("aria-hidden","false");try{a(":input:visible",
d)[0].focus()}catch(b){}}},info_dialog:function(d,c,b,f){var j={width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,caption:"<b>"+d+"</b>",left:250,top:170,zIndex:1E3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]};a.extend(j,f||{});var g=j.jqModal,k=this;a.fn.jqm&&!g&&(g=!1);d="";if(0<j.buttons.length)for(f=0;f<j.buttons.length;f++)"undefined"==typeof j.buttons[f].id&&(j.buttons[f].id="info_button_"+f),d+="<a href='javascript:void(0)' id='"+j.buttons[f].id+
"' class='fm-button ui-state-default ui-corner-all'>"+j.buttons[f].text+"</a>";f=isNaN(j.dataheight)?j.dataheight:j.dataheight+"px";c="<div id='info_id'>"+("<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+f+";"+("text-align:"+j.align+";")+"'>"+c+"</div>");c+=b?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+j.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+
b+"</a>"+d+"</div>":""!==d?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+j.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+d+"</div>":"";c+="</div>";try{"false"==a("#info_dialog").attr("aria-hidden")&&this.hideModal("#info_dialog",{jqm:g}),a("#info_dialog").remove()}catch(e){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},c,j,"","",!0);d&&a.each(j.buttons,
function(b){a("#"+this.id,"#info_id").bind("click",function(){j.buttons[b].onClick.call(a("#info_dialog"));return!1})});a("#closedialog","#info_id").click(function(){k.hideModal("#info_dialog",{jqm:g});return!1});a(".fm-button","#info_dialog").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a.isFunction(j.beforeOpen)&&j.beforeOpen();this.viewModal("#info_dialog",{onHide:function(a){a.w.hide().remove();a.o&&a.o.remove()},modal:j.modal,jqm:g});
a.isFunction(j.afterOpen)&&j.afterOpen();try{a("#info_dialog").focus()}catch(p){}},createEl:function(d,c,b,f,j){function g(b,c){a.isFunction(c.dataInit)&&c.dataInit(b);c.dataEvents&&a.each(c.dataEvents,function(){void 0!==this.data?a(b).bind(this.type,this.data,this.fn):a(b).bind(this.type,this.fn)});return c}function k(b,c){var e="dataInit dataEvents dataUrl buildSelect sopt searchhidden defaultValue attr".split(" ");a.each(c,function(c,d){-1===a.inArray(c,e)&&a(b).attr(c,d)});c.hasOwnProperty("id")||
a(b).attr("id",a.jgrid.randId())}var e="";switch(d){case "textarea":e=document.createElement("textarea");f?c.cols||a(e).css({width:"98%"}):c.cols||(c.cols=20);c.rows||(c.rows=2);if("&nbsp;"==b||"&#160;"==b||1==b.length&&160==b.charCodeAt(0))b="";e.value=b;k(e,c);c=g(e,c);a(e).attr({role:"textbox",multiline:"true"});break;case "checkbox":e=document.createElement("input");e.type="checkbox";c.value?(d=c.value.split(":"),b===d[0]&&(e.checked=!0,e.defaultChecked=!0),e.value=d[0],a(e).attr("offval",d[1])):
(d=b.toLowerCase(),0>d.search(/(false|0|no|off|undefined)/i)&&""!==d?(e.checked=!0,e.defaultChecked=!0,e.value=b):e.value="on",a(e).attr("offval","off"));k(e,c);c=g(e,c);a(e).attr("role","checkbox");break;case "select":e=document.createElement("select");e.setAttribute("role","select");f=[];!0===c.multiple?(d=!0,e.multiple="multiple",a(e).attr("aria-multiselectable","true")):d=!1;if("undefined"!=typeof c.dataUrl)a.ajax(a.extend({url:c.dataUrl,type:"GET",dataType:"html",context:{elem:e,options:c,vl:b},
success:function(b){var c=[],e=this.elem,d=this.vl,f=a.extend({},this.options),j=f.multiple===true;typeof f.buildSelect!="undefined"&&(b=f.buildSelect(b));if(b=a(b).html()){a(e).append(b);k(e,f);f=g(e,f);if(typeof f.size==="undefined")f.size=j?3:1;if(j){c=d.split(",");c=a.map(c,function(b){return a.trim(b)})}else c[0]=a.trim(d);setTimeout(function(){a("option",e).each(function(){a(this).attr("role","option");if(a.inArray(a.trim(a(this).text()),c)>-1||a.inArray(a.trim(a(this).val()),c)>-1)this.selected=
"selected"})},0)}}},j||{}));else if(c.value){var p;d?(f=b.split(","),f=a.map(f,function(b){return a.trim(b)}),"undefined"===typeof c.size&&(c.size=3)):c.size=1;"function"===typeof c.value&&(c.value=c.value());var o,r;if("string"===typeof c.value){o=c.value.split(";");for(p=0;p<o.length;p++){r=o[p].split(":");2<r.length&&(r[1]=a.map(r,function(a,b){if(b>0)return a}).join(":"));j=document.createElement("option");j.setAttribute("role","option");j.value=r[0];j.innerHTML=r[1];if(!d&&(a.trim(r[0])==a.trim(b)||
a.trim(r[1])==a.trim(b)))j.selected="selected";if(d&&(-1<a.inArray(a.trim(r[1]),f)||-1<a.inArray(a.trim(r[0]),f)))j.selected="selected";e.appendChild(j)}}else if("object"===typeof c.value)for(p in o=c.value,o)if(o.hasOwnProperty(p)){j=document.createElement("option");j.setAttribute("role","option");j.value=p;j.innerHTML=o[p];if(!d&&(a.trim(p)==a.trim(b)||a.trim(o[p])==a.trim(b)))j.selected="selected";if(d&&(-1<a.inArray(a.trim(o[p]),f)||-1<a.inArray(a.trim(p),f)))j.selected="selected";e.appendChild(j)}k(e,
c);c=g(e,c)}break;case "text":case "password":case "button":p="button"==d?"button":"textbox";e=document.createElement("input");e.type=d;e.value=b;k(e,c);c=g(e,c);"button"!=d&&(f?c.size||a(e).css({width:"98%"}):c.size||(c.size=20));a(e).attr("role",p);break;case "image":case "file":e=document.createElement("input");e.type=d;k(e,c);c=g(e,c);break;case "custom":e=document.createElement("span");try{if(a.isFunction(c.custom_element))if(o=c.custom_element.call(this,b,c))o=a(o).addClass("customelement").attr({id:c.id,
name:c.name}),a(e).empty().append(o);else throw"e2";else throw"e1";}catch(q){"e1"==q&&this.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose),"e2"==q?this.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose):this.info_dialog(a.jgrid.errors.errcap,"string"===typeof q?q:q.message,a.jgrid.edit.bClose)}}return e},checkDate:function(a,c){var b={},f,a=a.toLowerCase();f=-1!=a.indexOf("/")?
"/":-1!=a.indexOf("-")?"-":-1!=a.indexOf(".")?".":"/";a=a.split(f);c=c.split(f);if(3!=c.length)return!1;f=-1;for(var j,g=-1,k=-1,e=0;e<a.length;e++)j=isNaN(c[e])?0:parseInt(c[e],10),b[a[e]]=j,j=a[e],-1!=j.indexOf("y")&&(f=e),-1!=j.indexOf("m")&&(k=e),-1!=j.indexOf("d")&&(g=e);j="y"==a[f]||"yyyy"==a[f]?4:"yy"==a[f]?2:-1;var e=function(a){for(var b=1;b<=a;b++){this[b]=31;if(4==b||6==b||9==b||11==b)this[b]=30;2==b&&(this[b]=29)}return this}(12),p;if(-1===f)return!1;p=b[a[f]].toString();2==j&&1==p.length&&
(j=1);if(p.length!=j||0===b[a[f]]&&"00"!=c[f]||-1===k)return!1;p=b[a[k]].toString();if(1>p.length||(1>b[a[k]]||12<b[a[k]])||-1===g)return!1;p=b[a[g]].toString();return 1>p.length||1>b[a[g]]||31<b[a[g]]||2==b[a[k]]&&b[a[g]]>(0===b[a[f]]%4&&(0!==b[a[f]]%100||0===b[a[f]]%400)?29:28)||b[a[g]]>e[b[a[k]]]?!1:!0},isEmpty:function(a){return a.match(/^\s+$/)||""===a?!0:!1},checkTime:function(a){var c=/^(\d{1,2}):(\d{2})([ap]m)?$/;if(!this.isEmpty(a))if(a=a.match(c)){if(a[3]){if(1>a[1]||12<a[1])return!1}else if(23<
a[1])return!1;if(59<a[2])return!1}else return!1;return!0},checkValues:function(d,c,b,f,j){var g,k;if("undefined"===typeof f)if("string"==typeof c){f=0;for(j=b.p.colModel.length;f<j;f++)if(b.p.colModel[f].name==c){g=b.p.colModel[f].editrules;c=f;try{k=b.p.colModel[f].formoptions.label}catch(e){}break}}else 0<=c&&(g=b.p.colModel[c].editrules);else g=f,k=void 0===j?"_":j;if(g){k||(k=b.p.colNames[c]);if(!0===g.required&&this.isEmpty(d))return[!1,k+": "+a.jgrid.edit.msg.required,""];f=!1===g.required?
!1:!0;if(!0===g.number&&!(!1===f&&this.isEmpty(d))&&isNaN(d))return[!1,k+": "+a.jgrid.edit.msg.number,""];if("undefined"!=typeof g.minValue&&!isNaN(g.minValue)&&parseFloat(d)<parseFloat(g.minValue))return[!1,k+": "+a.jgrid.edit.msg.minValue+" "+g.minValue,""];if("undefined"!=typeof g.maxValue&&!isNaN(g.maxValue)&&parseFloat(d)>parseFloat(g.maxValue))return[!1,k+": "+a.jgrid.edit.msg.maxValue+" "+g.maxValue,""];if(!0===g.email&&!(!1===f&&this.isEmpty(d))&&(j=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,
!j.test(d)))return[!1,k+": "+a.jgrid.edit.msg.email,""];if(!0===g.integer&&!(!1===f&&this.isEmpty(d))&&(isNaN(d)||0!==d%1||-1!=d.indexOf(".")))return[!1,k+": "+a.jgrid.edit.msg.integer,""];if(!0===g.date&&!(!1===f&&this.isEmpty(d))&&(c=b.p.colModel[c].formatoptions&&b.p.colModel[c].formatoptions.newformat?b.p.colModel[c].formatoptions.newformat:b.p.colModel[c].datefmt||"Y-m-d",!this.checkDate(c,d)))return[!1,k+": "+a.jgrid.edit.msg.date+" - "+c,""];if(!0===g.time&&!(!1===f&&this.isEmpty(d))&&!this.checkTime(d))return[!1,
k+": "+a.jgrid.edit.msg.date+" - hh:mm (am/pm)",""];if(!0===g.url&&!(!1===f&&this.isEmpty(d))&&(j=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,!j.test(d)))return[!1,k+": "+a.jgrid.edit.msg.url,""];if(!0===g.custom&&!(!1===f&&this.isEmpty(d)))return a.isFunction(g.custom_func)?(d=g.custom_func.call(b,d,k),a.isArray(d)?d:[!1,a.jgrid.edit.msg.customarray,""]):[!1,a.jgrid.edit.msg.customfcheck,""]}return[!0,"",""]}})})(j);(function(a){var d=
null;a.jgrid.extend({searchGrid:function(c){c=a.extend({recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!1,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,
onReset:null,toTop:!0,overlay:10,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null},a.jgrid.search,c||{});return this.each(function(){function b(){a.isFunction(c.beforeShowSearch)&&(g=c.beforeShowSearch(a("#"+j)),"undefined"===typeof g&&(g=!0));g&&(a.jgrid.viewModal("#"+k.themodal,{gbox:"#gbox_"+j,jqm:c.jqModal,modal:c.modal,overlay:c.overlay,toTop:c.toTop}),a.isFunction(c.afterShowSearch)&&c.afterShowSearch(a("#"+j)))}var d=this;if(d.grid){var j="fbox_"+
d.p.id,g=!0,k={themodal:"searchmod"+j,modalhead:"searchhd"+j,modalcontent:"searchcnt"+j,scrollelm:j},e=d.p.postData[c.sFilter];"string"===typeof e&&(e=a.jgrid.parse(e));!0===c.recreateFilter&&a("#"+k.themodal).remove();if(null!==a("#"+k.themodal).html())b();else{var p=a("<span><div id='"+j+"' class='searchFilter' style='overflow:auto'></div></span>").insertBefore("#gview_"+d.p.id);if(a.isFunction(c.onInitializeSearch))c.onInitializeSearch(a("#"+j));var o=a.extend([],d.p.colModel),r="<a href='javascript:void(0)' id='"+
j+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+c.Find+"</a>",q="<a href='javascript:void(0)' id='"+j+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+c.Reset+"</a>",u="",t="",v,z=!1;c.showQuery&&(u="<a href='javascript:void(0)' id='"+j+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>");
c.columns.length?o=c.columns:a.each(o,function(a,b){b.label||(b.label=d.p.colNames[a]);if(!z){var c="undefined"===typeof b.search?!0:b.search,e=!0===b.hidden;if(b.searchoptions&&!0===b.searchoptions.searchhidden&&c||c&&!e)z=!0,v=b.index||b.name}});if(!e&&v||!1===c.multipleSearch)e={groupOp:"AND",rules:[{field:v,op:"eq",data:""}]};z=!1;c.tmplNames&&c.tmplNames.length&&(z=!0,t=c.tmplLabel,t+="<select class='ui-template'>",t+="<option value='default'>Default</option>",a.each(c.tmplNames,function(a,b){t+=
"<option value='"+a+"'>"+b+"</option>"}),t+="</select>");r="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+j+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:left'>"+q+t+"</td><td class='EditButton'>"+u+r+"</td></tr></tbody></table>";a("#"+j).jqFilter({columns:o,filter:c.loadDefaults?e:null,showQuery:c.showQuery,errorcheck:c.errorcheck,sopt:c.sopt,groupButton:c.multipleGroup,_gridsopt:a.jgrid.search.odata,
onChange:function(){this.p.showQuery&&a(".query",this).html(this.toUserFriendlyString())}});p.append(r);z&&c.tmplFilters&&c.tmplFilters.length&&a(".ui-template",p).bind("change",function(){var b=a(this).val();b=="default"?a("#"+j).jqFilter("addFilter",e):a("#"+j).jqFilter("addFilter",c.tmplFilters[parseInt(b,10)]);return false});!1===c.multipleSearch&&(a(".add-rule","#"+j).hide(),a(".delete-rule","#"+j).hide());if(a.isFunction(c.onInitializeSearch))c.onInitializeSearch(a("#"+j));c.layer?a.jgrid.createModal(k,
p,c,"#gview_"+d.p.id,a("#gbox_"+d.p.id)[0],"#"+c.layer,{position:"relative"}):a.jgrid.createModal(k,p,c,"#gview_"+d.p.id,a("#gbox_"+d.p.id)[0]);u&&a("#"+j+"_query").bind("click",function(){a(".queryresult",p).toggle();return false});void 0===c.stringResult&&(c.stringResult=c.multipleSearch);a("#"+j+"_search").bind("click",function(){var b=a("#"+j),e={},g,o=b.jqFilter("filterData");if(c.errorcheck){b[0].hideError();c.showQuery||b.jqFilter("toSQLString");if(b[0].p.error){b[0].showError();return false}}if(c.stringResult){try{g=
f.toJson(o,"","",false)}catch(p){try{g=ka.stringify(o)}catch(q){}}if(typeof g==="string"){e[c.sFilter]=g;a.each([c.sField,c.sValue,c.sOper],function(){e[this]=""})}}else if(c.multipleSearch){e[c.sFilter]=o;a.each([c.sField,c.sValue,c.sOper],function(){e[this]=""})}else{e[c.sField]=o.rules[0].field;e[c.sValue]=o.rules[0].data;e[c.sOper]=o.rules[0].op;e[c.sFilter]=""}d.p.search=true;a.extend(d.p.postData,e);if(a.isFunction(c.onSearch))c.onSearch();a(d).trigger("reloadGrid",[{page:1}]);c.closeAfterSearch&&
a.jgrid.hideModal("#"+k.themodal,{gb:"#gbox_"+d.p.id,jqm:c.jqModal,onClose:c.onClose});return false});a("#"+j+"_reset").bind("click",function(){var b={},e=a("#"+j);d.p.search=false;c.multipleSearch===false?b[c.sField]=b[c.sValue]=b[c.sOper]="":b[c.sFilter]="";e[0].resetFilter();z&&a(".ui-template",p).val("default");a.extend(d.p.postData,b);if(a.isFunction(c.onReset))c.onReset();a(d).trigger("reloadGrid",[{page:1}]);return false});b();a(".fm-button:not(.ui-state-disabled)",p).hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")})}}})},editGridRow:function(c,b){d=b=a.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,
closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0},a.jgrid.edit,b||{});return this.each(function(){function f(){a(".FormElement","#"+x).each(function(){var b=a(".customelement",this);if(b.length){var c=a(b[0]).attr("name");a.each(t.p.colModel,function(){if(this.name===c&&this.editoptions&&a.isFunction(this.editoptions.custom_value)){try{if(I[c]=
this.editoptions.custom_value(a("#"+a.jgrid.jqID(c),"#"+x),"get"),void 0===I[c])throw"e1";}catch(b){"e1"===b?a.jgrid.info_dialog(j.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,j.jgrid.edit.bClose):a.jgrid.info_dialog(j.jgrid.errors.errcap,b.message,j.jgrid.edit.bClose)}return!0}})}else{switch(a(this).get(0).type){case "checkbox":a(this).attr("checked")?I[this.name]=a(this).val():(b=a(this).attr("offval"),I[this.name]=b);break;case "select-one":I[this.name]=a("option:selected",
this).val();ba[this.name]=a("option:selected",this).text();break;case "select-multiple":I[this.name]=a(this).val();I[this.name]=I[this.name]?I[this.name].join(","):"";var e=[];a("option:selected",this).each(function(b,c){e[b]=a(c).text()});ba[this.name]=e.join(",");break;case "password":case "text":case "textarea":case "button":I[this.name]=a(this).val()}t.p.autoencode&&(I[this.name]=a.jgrid.htmlEncode(I[this.name]))}});return!0}function m(b,c,e,f){var g,k,j=0,l,m,o,p=[],q=!1,r="",u;for(u=1;u<=f;u++)r+=
"<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";"_empty"!=b&&(q=a(c).jqGrid("getInd",b));a(c.p.colModel).each(function(u){g=this.name;m=(this.editrules&&!0===this.editrules.edithidden?0:!0===this.hidden)?"style='display:none'":"";if("cb"!==g&&"subgrid"!==g&&!0===this.editable&&"rn"!==g){if(!1===q)l="";else if(g==c.p.ExpandColumn&&!0===c.p.treeGrid)l=a("td:eq("+u+")",c.rows[q]).text();else try{l=a.unformat(a("td:eq("+u+")",c.rows[q]),{rowId:b,colModel:this},u)}catch(v){l=a("td:eq("+
u+")",c.rows[q]).text()}var x=a.extend({},this.editoptions||{},{id:g,name:g}),z=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),y=parseInt(z.rowpos,10)||j+1,A=parseInt(2*(parseInt(z.colpos,10)||1),10);"_empty"==b&&x.defaultValue&&(l=a.isFunction(x.defaultValue)?x.defaultValue():x.defaultValue);this.edittype||(this.edittype="text");t.p.autoencode&&(l=a.jgrid.htmlDecode(l));o=a.jgrid.createEl(this.edittype,x,l,!1,a.extend({},a.jgrid.ajaxOptions,c.p.ajaxSelectOptions||
{}));""===l&&"checkbox"==this.edittype&&(l=a(o).attr("offval"));""===l&&"select"==this.edittype&&(l=a("option:eq(0)",o).text());if(d.checkOnSubmit||d.checkOnUpdate)d._savedData[g]=l;a(o).addClass("FormElement");("text"==this.edittype||"textarea"==this.edittype)&&a(o).addClass("ui-widget-content ui-corner-all");k=a(e).find("tr[rowpos="+y+"]");z.rowabove&&(x=a("<tr><td class='contentinfo' colspan='"+2*f+"'>"+z.rowcontent+"</td></tr>"),a(e).append(x),x[0].rp=y);0===k.length&&(k=a("<tr "+m+" rowpos='"+
y+"'></tr>").addClass("FormData").attr("id","tr_"+g),a(k).append(r),a(e).append(k),k[0].rp=y);a("td:eq("+(A-2)+")",k[0]).html("undefined"===typeof z.label?c.p.colNames[u]:z.label);a("td:eq("+(A-1)+")",k[0]).append(z.elmprefix).append(o).append(z.elmsuffix);p[j]=u;j++}});if(0<j&&(u=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*f-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+c.p.id+"_id' value='"+b+"'/></td></tr>"),u[0].rp=
j+999,a(e).append(u),d.checkOnSubmit||d.checkOnUpdate))d._savedData[c.p.id+"_id"]=b;return p}function g(b,c,e){var f,g=0,k,l,m,o,p;if(d.checkOnSubmit||d.checkOnUpdate)d._savedData={},d._savedData[c.p.id+"_id"]=b;var q=c.p.colModel;if("_empty"==b)a(q).each(function(){f=this.name;m=a.extend({},this.editoptions||{});if((l=a("#"+a.jgrid.jqID(f),"#"+e))&&null!==l[0])if(o="",m.defaultValue?(o=a.isFunction(m.defaultValue)?m.defaultValue():m.defaultValue,"checkbox"==l[0].type?(p=o.toLowerCase(),0>p.search(/(false|0|no|off|undefined)/i)&&
""!==p?(l[0].checked=!0,l[0].defaultChecked=!0,l[0].value=o):l.attr({checked:"",defaultChecked:""})):l.val(o)):"checkbox"==l[0].type?(l[0].checked=!1,l[0].defaultChecked=!1,o=a(l).attr("offval")):l[0].type&&"select"==l[0].type.substr(0,6)?l[0].selectedIndex=0:l.val(o),!0===d.checkOnSubmit||d.checkOnUpdate)d._savedData[f]=o}),a("#id_g","#"+e).val(b);else{var r=a(c).jqGrid("getInd",b,!0);r&&(a("td",r).each(function(l){f=q[l].name;if("cb"!==f&&"subgrid"!==f&&"rn"!==f&&!0===q[l].editable){if(f==c.p.ExpandColumn&&
!0===c.p.treeGrid)k=a(this).text();else try{k=a.unformat(a(this),{rowId:b,colModel:q[l]},l)}catch(m){k=a(this).text()}t.p.autoencode&&(k=a.jgrid.htmlDecode(k));if(!0===d.checkOnSubmit||d.checkOnUpdate)d._savedData[f]=k;f=a.jgrid.jqID(f);switch(q[l].edittype){case "password":case "text":case "button":case "image":a("#"+f,"#"+e).val(k);break;case "textarea":if("&nbsp;"==k||"&#160;"==k||1==k.length&&160==k.charCodeAt(0))k="";a("#"+f,"#"+e).val(k);break;case "select":var o=k.split(","),o=a.map(o,function(b){return a.trim(b)});
a("#"+f+" option","#"+e).each(function(){this.selected=!q[l].editoptions.multiple&&(o[0]==a.trim(a(this).text())||o[0]==a.trim(a(this).val()))?!0:q[l].editoptions.multiple?-1<a.inArray(a.trim(a(this).text()),o)||-1<a.inArray(a.trim(a(this).val()),o)?!0:!1:!1});break;case "checkbox":k+="";q[l].editoptions&&q[l].editoptions.value?q[l].editoptions.value.split(":")[0]==k?(a("#"+f,"#"+e).attr("checked",!0),a("#"+f,"#"+e).attr("defaultChecked",!0)):(a("#"+f,"#"+e).attr("checked",!1),a("#"+f,"#"+e).attr("defaultChecked",
"")):(k=k.toLowerCase(),0>k.search(/(false|0|no|off|undefined)/i)&&""!==k?(a("#"+f,"#"+e).attr("checked",!0),a("#"+f,"#"+e).attr("defaultChecked",!0)):(a("#"+f,"#"+e).attr("checked",!1),a("#"+f,"#"+e).attr("defaultChecked","")));break;case "custom":try{if(q[l].editoptions&&a.isFunction(q[l].editoptions.custom_value))q[l].editoptions.custom_value(a("#"+f,"#"+e),"set",k);else throw"e1";}catch(p){"e1"==p?a.jgrid.info_dialog(j.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,
j.jgrid.edit.bClose):a.jgrid.info_dialog(j.jgrid.errors.errcap,p.message,j.jgrid.edit.bClose)}}g++}}),0<g&&a("#id_g","#"+x).val(b))}}function k(){var c,e=[!0,"",""],f={},k=t.p.prmNames,j,l,m,o;if(a.isFunction(d.beforeCheckValues)){var p=d.beforeCheckValues(I,a("#"+z),"_empty"==I[t.p.id+"_id"]?k.addoper:k.editoper);p&&"object"===typeof p&&(I=p)}for(m in I)if(I.hasOwnProperty(m)&&(e=a.jgrid.checkValues(I[m],m,t),!1===e[0]))break;e[0]&&(a.isFunction(d.onclickSubmit)&&(f=d.onclickSubmit(d,I)||{}),a.isFunction(d.beforeSubmit)&&
(e=d.beforeSubmit(I,a("#"+z))));if(e[0]&&!d.processing){d.processing=!0;a("#sData","#"+x+"_2").addClass("ui-state-active");l=k.oper;j=k.id;I[l]="_empty"==a.trim(I[t.p.id+"_id"])?k.addoper:k.editoper;I[l]!=k.addoper?I[j]=I[t.p.id+"_id"]:void 0===I[j]&&(I[j]=I[t.p.id+"_id"]);delete I[t.p.id+"_id"];I=a.extend(I,d.editData,f);if(!0===t.p.treeGrid)for(i in I[l]==k.addoper&&(o=a(t).jqGrid("getGridParam","selrow"),I["adjacency"==t.p.treeGridModel?t.p.treeReader.parent_id_field:"parent_id"]=o),t.p.treeReader)f=
t.p.treeReader[i],I.hasOwnProperty(f)&&(I[l]==k.addoper&&"parent_id_field"===i||delete I[f]);f=a.extend({url:d.url?d.url:a(t).jqGrid("getGridParam","editurl"),type:d.mtype,data:a.isFunction(d.serializeEditData)?d.serializeEditData(I):I,complete:function(f,m){if(m!="success"){e[0]=false;e[1]=a.isFunction(d.errorTextFormat)?d.errorTextFormat(f):m+" Status: '"+f.statusText+"'. Error code: "+f.status}else a.isFunction(d.afterSubmit)&&(e=d.afterSubmit(f,I));if(e[0]===false){a("#FormError>td","#"+x).html(e[1]);
a("#FormError","#"+x).show()}else{a.each(t.p.colModel,function(){if(ba[this.name]&&this.formatter&&this.formatter=="select")try{delete ba[this.name]}catch(a){}});I=a.extend(I,ba);t.p.autoencode&&a.each(I,function(b,c){I[b]=a.jgrid.htmlDecode(c)});d.reloadAfterSubmit=d.reloadAfterSubmit&&t.p.datatype!="local";if(I[l]==k.addoper){e[2]||(e[2]=a.jgrid.randId());I[j]=e[2];if(d.closeAfterAdd){if(d.reloadAfterSubmit)a(t).trigger("reloadGrid");else if(t.p.treeGrid===true)a(t).jqGrid("addChildNode",e[2],o,
I);else{a(t).jqGrid("addRowData",e[2],I,b.addedrow);a(t).jqGrid("setSelection",e[2])}a.jgrid.hideModal("#"+y.themodal,{gb:"#gbox_"+v,jqm:b.jqModal,onClose:d.onClose})}else if(d.clearAfterAdd){d.reloadAfterSubmit?a(t).trigger("reloadGrid"):t.p.treeGrid===true?a(t).jqGrid("addChildNode",e[2],o,I):a(t).jqGrid("addRowData",e[2],I,b.addedrow);g("_empty",t,z)}else d.reloadAfterSubmit?a(t).trigger("reloadGrid"):t.p.treeGrid===true?a(t).jqGrid("addChildNode",e[2],o,I):a(t).jqGrid("addRowData",e[2],I,b.addedrow)}else{if(d.reloadAfterSubmit){a(t).trigger("reloadGrid");
d.closeAfterEdit||setTimeout(function(){a(t).jqGrid("setSelection",I[j])},1E3)}else t.p.treeGrid===true?a(t).jqGrid("setTreeRow",I[j],I):a(t).jqGrid("setRowData",I[j],I);d.closeAfterEdit&&a.jgrid.hideModal("#"+y.themodal,{gb:"#gbox_"+v,jqm:b.jqModal,onClose:d.onClose})}if(a.isFunction(d.afterComplete)){c=f;setTimeout(function(){d.afterComplete(c,I,a("#"+z));c=null},500)}if(d.checkOnSubmit||d.checkOnUpdate){a("#"+z).data("disabled",false);if(d._savedData[t.p.id+"_id"]!="_empty")for(var p in d._savedData)I[p]&&
(d._savedData[p]=I[p])}}d.processing=false;a("#sData","#"+x+"_2").removeClass("ui-state-active");try{a(":input:visible","#"+z)[0].focus()}catch(q){}}},a.jgrid.ajaxOptions,d.ajaxEditOptions);!f.url&&!d.useDataProxy&&(a.isFunction(t.p.dataProxy)?d.useDataProxy=!0:(e[0]=!1,e[1]+=" "+a.jgrid.errors.nourl));e[0]&&(d.useDataProxy?t.p.dataProxy.call(t,f,"set_"+t.p.id):a.ajax(f))}!1===e[0]&&(a("#FormError>td","#"+x).html(e[1]),a("#FormError","#"+x).show())}function e(a,b){var c=!1,e;for(e in a)if(a[e]!=b[e]){c=
!0;break}return c}function p(){a.each(t.p.colModel,function(a,b){b.editoptions&&!0===b.editoptions.NullIfEmpty&&I.hasOwnProperty(b.name)&&""==I[b.name]&&(I[b.name]="null")})}function o(){var b=!0;a("#FormError","#"+x).hide();d.checkOnUpdate&&(I={},ba={},f(),T=a.extend({},I,ba),e(T,d._savedData)?(a("#"+z).data("disabled",!0),a(".confirm","#"+y.themodal).show(),b=!1):p());return b}function r(){if("_empty"!==c&&"undefined"!==typeof t.p.savedRow&&0<t.p.savedRow.length&&a.isFunction(a.fn.jqGrid.restoreRow))for(var b=
0;b<t.p.savedRow.length;b++)if(t.p.savedRow[b].id==c){a(t).jqGrid("restoreRow",c);break}}function q(b,c){0===b?a("#pData","#"+x+"_2").addClass("ui-state-disabled"):a("#pData","#"+x+"_2").removeClass("ui-state-disabled");b==c?a("#nData","#"+x+"_2").addClass("ui-state-disabled"):a("#nData","#"+x+"_2").removeClass("ui-state-disabled")}function u(){var b=a(t).jqGrid("getDataIDs"),c=a("#id_g","#"+x).val();return[a.inArray(c,b),b]}var t=this;if(t.grid&&c){var v=t.p.id,z="FrmGrid_"+v,x="TblGrid_"+v,y={themodal:"editmod"+
v,modalhead:"edithd"+v,modalcontent:"editcnt"+v,scrollelm:z},B=a.isFunction(d.beforeShowForm)?d.beforeShowForm:!1,A=a.isFunction(d.afterShowForm)?d.afterShowForm:!1,F=a.isFunction(d.beforeInitData)?d.beforeInitData:!1,N=a.isFunction(d.onInitializeForm)?d.onInitializeForm:!1,K=!0,G=1,R=0,I,ba,T;"new"===c?(c="_empty",b.caption=d.addCaption):b.caption=d.editCaption;!0===b.recreateForm&&null!==a("#"+y.themodal).html()&&a("#"+y.themodal).remove();var Y=!0;b.checkOnUpdate&&(b.jqModal&&!b.modal)&&(Y=!1);
if(null!==a("#"+y.themodal).html()){F&&(K=F(a("#"+z)),"undefined"==typeof K&&(K=!0));if(!1===K)return;r();a(".ui-jqdialog-title","#"+y.modalhead).html(b.caption);a("#FormError","#"+x).hide();d.topinfo?(a(".topinfo","#"+x+"_2").html(d.topinfo),a(".tinfo","#"+x+"_2").show()):a(".tinfo","#"+x+"_2").hide();d.bottominfo?(a(".bottominfo","#"+x+"_2").html(d.bottominfo),a(".binfo","#"+x+"_2").show()):a(".binfo","#"+x+"_2").hide();g(c,t,z);"_empty"==c||!d.viewPagerButtons?a("#pData, #nData","#"+x+"_2").hide():
a("#pData, #nData","#"+x+"_2").show();!0===d.processing&&(d.processing=!1,a("#sData","#"+x+"_2").removeClass("ui-state-active"));!0===a("#"+z).data("disabled")&&(a(".confirm","#"+y.themodal).hide(),a("#"+z).data("disabled",!1));B&&B(a("#"+z));a("#"+y.themodal).data("onClose",d.onClose);a.jgrid.viewModal("#"+y.themodal,{gbox:"#gbox_"+v,jqm:b.jqModal,jqM:!1,overlay:b.overlay,modal:b.modal});Y||a(".jqmOverlay").click(function(){if(!o())return false;a.jgrid.hideModal("#"+y.themodal,{gb:"#gbox_"+v,jqm:b.jqModal,
onClose:d.onClose});return false});A&&A(a("#"+z))}else{var D=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",D=a("<form name='FormPost' id='"+z+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+D+";'></form>").data("disabled",!1),M=a("<table id='"+x+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");F&&(K=F(a("#"+z)),"undefined"==typeof K&&(K=!0));if(!1===K)return;r();a(t.p.colModel).each(function(){var a=
this.formoptions;G=Math.max(G,a?a.colpos||0:0);R=Math.max(R,a?a.rowpos||0:0)});a(D).append(M);F=a("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+2*G+"'></td></tr>");F[0].rp=0;a(M).append(F);F=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*G+"'>"+d.topinfo+"</td></tr>");F[0].rp=0;a(M).append(F);var K=(F="rtl"==t.p.direction?!0:!1)?"nData":"pData",Z=F?"pData":"nData";m(c,t,M,G);var K="<a href='javascript:void(0)' id='"+K+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>",
Z="<a href='javascript:void(0)' id='"+Z+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>",E="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>",H="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+"</a>",K="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+x+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+
(F?Z+K:K+Z)+"</td><td class='EditButton'>"+E+H+"</td></tr>"+("<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+d.bottominfo+"</td></tr>"),K=K+"</tbody></table>";if(0<R){var L=[];a.each(a(M)[0].rows,function(a,b){L[a]=b});L.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(L,function(b,c){a("tbody",M).append(c)})}b.gbox="#gbox_"+v;var C=!1;!0===b.closeOnEscape&&(b.closeOnEscape=!1,C=!0);D=a("<span></span>").append(D).append(K);a.jgrid.createModal(y,D,b,"#gview_"+
t.p.id,a("#gbox_"+t.p.id)[0]);F&&(a("#pData, #nData","#"+x+"_2").css("float","right"),a(".EditButton","#"+x+"_2").css("text-align","left"));d.topinfo&&a(".tinfo","#"+x+"_2").show();d.bottominfo&&a(".binfo","#"+x+"_2").show();K=D=null;a("#"+y.themodal).keydown(function(c){var e=c.target;if(a("#"+z).data("disabled")===true)return false;if(d.savekey[0]===true&&c.which==d.savekey[1]&&e.tagName!="TEXTAREA"){a("#sData","#"+x+"_2").trigger("click");return false}if(c.which===27){if(!o())return false;C&&a.jgrid.hideModal(this,
{gb:b.gbox,jqm:b.jqModal,onClose:d.onClose});return false}if(d.navkeys[0]===true){if(a("#id_g","#"+x).val()=="_empty")return true;if(c.which==d.navkeys[1]){a("#pData","#"+x+"_2").trigger("click");return false}if(c.which==d.navkeys[2]){a("#nData","#"+x+"_2").trigger("click");return false}}});b.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span","#"+y.themodal).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close","#"+y.themodal).unbind("click").click(function(){if(!o())return false;a.jgrid.hideModal("#"+
y.themodal,{gb:"#gbox_"+v,jqm:b.jqModal,onClose:d.onClose});return false}));b.saveicon=a.extend([!0,"left","ui-icon-disk"],b.saveicon);b.closeicon=a.extend([!0,"left","ui-icon-close"],b.closeicon);!0===b.saveicon[0]&&a("#sData","#"+x+"_2").addClass("right"==b.saveicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.saveicon[2]+"'></span>");!0===b.closeicon[0]&&a("#cData","#"+x+"_2").addClass("right"==b.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+
b.closeicon[2]+"'></span>");if(d.checkOnSubmit||d.checkOnUpdate)E="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bYes+"</a>",Z="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bNo+"</a>",H="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bExit+"</a>",D=b.zIndex||999,D++,a("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+
D+";display:none;'>&#160;"+(a.browser.msie&&6==a.browser.version?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"")+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(D+1)+"'>"+b.saveData+"<br/><br/>"+E+Z+H+"</div>").insertAfter("#"+z),a("#sNew","#"+y.themodal).click(function(){k();a("#"+z).data("disabled",false);a(".confirm","#"+y.themodal).hide();return false}),a("#nNew","#"+y.themodal).click(function(){a(".confirm",
"#"+y.themodal).hide();a("#"+z).data("disabled",false);setTimeout(function(){a(":input","#"+z)[0].focus()},0);return false}),a("#cNew","#"+y.themodal).click(function(){a(".confirm","#"+y.themodal).hide();a("#"+z).data("disabled",false);a.jgrid.hideModal("#"+y.themodal,{gb:"#gbox_"+v,jqm:b.jqModal,onClose:d.onClose});return false});N&&N(a("#"+z));"_empty"==c||!d.viewPagerButtons?a("#pData,#nData","#"+x+"_2").hide():a("#pData,#nData","#"+x+"_2").show();B&&B(a("#"+z));a("#"+y.themodal).data("onClose",
d.onClose);a.jgrid.viewModal("#"+y.themodal,{gbox:"#gbox_"+v,jqm:b.jqModal,overlay:b.overlay,modal:b.modal});Y||a(".jqmOverlay").click(function(){if(!o())return false;a.jgrid.hideModal("#"+y.themodal,{gb:"#gbox_"+v,jqm:b.jqModal,onClose:d.onClose});return false});A&&A(a("#"+z));a(".fm-button","#"+y.themodal).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a("#sData","#"+x+"_2").click(function(){I={};ba={};a("#FormError","#"+x).hide();f();p();
if(I[t.p.id+"_id"]=="_empty")k();else if(b.checkOnSubmit===true){T=a.extend({},I,ba);if(e(T,d._savedData)){a("#"+z).data("disabled",true);a(".confirm","#"+y.themodal).show()}else k()}else k();return false});a("#cData","#"+x+"_2").click(function(){if(!o())return false;a.jgrid.hideModal("#"+y.themodal,{gb:"#gbox_"+v,jqm:b.jqModal,onClose:d.onClose});return false});a("#nData","#"+x+"_2").click(function(){if(!o())return false;a("#FormError","#"+x).hide();var c=u();c[0]=parseInt(c[0],10);if(c[0]!=-1&&
c[1][c[0]+1]){if(a.isFunction(b.onclickPgButtons))b.onclickPgButtons("next",a("#"+z),c[1][c[0]]);g(c[1][c[0]+1],t,z);a(t).jqGrid("setSelection",c[1][c[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",a("#"+z),c[1][c[0]+1]);q(c[0]+1,c[1].length-1)}return false});a("#pData","#"+x+"_2").click(function(){if(!o())return false;a("#FormError","#"+x).hide();var c=u();if(c[0]!=-1&&c[1][c[0]-1]){if(a.isFunction(b.onclickPgButtons))b.onclickPgButtons("prev",a("#"+z),c[1][c[0]]);g(c[1][c[0]-
1],t,z);a(t).jqGrid("setSelection",c[1][c[0]-1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("prev",a("#"+z),c[1][c[0]-1]);q(c[0]-1,c[1].length-1)}return false})}B=u();q(B[0],B[1].length-1)}})},viewGridRow:function(c,b){b=a.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"30%",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0},a.jgrid.view,
b||{});return this.each(function(){function d(){(!0===b.closeOnEscape||!0===b.navkeys[0])&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+u.modalhead).focus()},0)}function f(c,e,d,g){for(var k,j,l,m=0,o,p,q=[],r=!1,t="<td class='CaptionTD form-view-label ui-widget-content' width='"+b.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",u="",v=["integer","number","currency"],x=0,z=0,y,A,B,F=1;F<=g;F++)u+=1==F?t:"<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>";
a(e.p.colModel).each(function(){j=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1;!j&&"right"===this.align&&(this.formatter&&-1!==a.inArray(this.formatter,v)?x=Math.max(x,parseInt(this.width,10)):z=Math.max(z,parseInt(this.width,10)))});y=0!==x?x:0!==z?z:0;r=a(e).jqGrid("getInd",c);a(e.p.colModel).each(function(b){k=this.name;A=!1;p=(j=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":"";B="boolean"!=typeof this.viewable?!0:this.viewable;
if("cb"!==k&&"subgrid"!==k&&"rn"!==k&&B){o=!1===r?"":k==e.p.ExpandColumn&&!0===e.p.treeGrid?a("td:eq("+b+")",e.rows[r]).text():a("td:eq("+b+")",e.rows[r]).html();A="right"===this.align&&0!==y?!0:!1;a.extend({},this.editoptions||{},{id:k,name:k});var c=a.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),f=parseInt(c.rowpos,10)||m+1,t=parseInt(2*(parseInt(c.colpos,10)||1),10);if(c.rowabove){var v=a("<tr><td class='contentinfo' colspan='"+2*g+"'>"+c.rowcontent+"</td></tr>");a(d).append(v);
v[0].rp=f}l=a(d).find("tr[rowpos="+f+"]");0===l.length&&(l=a("<tr "+p+" rowpos='"+f+"'></tr>").addClass("FormData").attr("id","trv_"+k),a(l).append(u),a(d).append(l),l[0].rp=f);a("td:eq("+(t-2)+")",l[0]).html("<b>"+("undefined"===typeof c.label?e.p.colNames[b]:c.label)+"</b>");a("td:eq("+(t-1)+")",l[0]).append("<span>"+o+"</span>").attr("id","v_"+k);A&&a("td:eq("+(t-1)+") span",l[0]).css({"text-align":"right",width:y+"px"});q[m]=b;m++}});0<m&&(c=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+
(2*g-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+c+"'/></td></tr>"),c[0].rp=m+99,a(d).append(c));return q}function g(b,c){var e,d,f=0,g,k;if(k=a(c).jqGrid("getInd",b,!0))a("td",k).each(function(b){e=c.p.colModel[b].name;d=c.p.colModel[b].editrules&&!0===c.p.colModel[b].editrules.edithidden?!1:!0===c.p.colModel[b].hidden?!0:!1;"cb"!==e&&("subgrid"!==e&&"rn"!==e)&&(g=e==c.p.ExpandColumn&&!0===c.p.treeGrid?a(this).text():a(this).html(),a.extend({},c.p.colModel[b].editoptions||
{}),e=a.jgrid.jqID("v_"+e),a("#"+e+" span","#"+q).html(g),d&&a("#"+e,"#"+q).parents("tr:first").hide(),f++)}),0<f&&a("#id_g","#"+q).val(b)}function k(b,c){0===b?a("#pData","#"+q+"_2").addClass("ui-state-disabled"):a("#pData","#"+q+"_2").removeClass("ui-state-disabled");b==c?a("#nData","#"+q+"_2").addClass("ui-state-disabled"):a("#nData","#"+q+"_2").removeClass("ui-state-disabled")}function e(){var b=a(j).jqGrid("getDataIDs"),c=a("#id_g","#"+q).val();return[a.inArray(c,b),b]}var j=this;if(j.grid&&
c){b.imgpath||(b.imgpath=j.p.imgpath);var o=j.p.id,r="ViewGrid_"+o,q="ViewTbl_"+o,u={themodal:"viewmod"+o,modalhead:"viewhd"+o,modalcontent:"viewcnt"+o,scrollelm:r},t=a.isFunction(b.beforeInitData)?b.beforeInitData:!1,v=!0,z=1,x=0;if(null!==a("#"+u.themodal).html()){t&&(v=t(a("#"+r)),"undefined"==typeof v&&(v=!0));if(!1===v)return;a(".ui-jqdialog-title","#"+u.modalhead).html(b.caption);a("#FormError","#"+q).hide();g(c,j);a.isFunction(b.beforeShowForm)&&b.beforeShowForm(a("#"+r));a.jgrid.viewModal("#"+
u.themodal,{gbox:"#gbox_"+o,jqm:b.jqModal,jqM:!1,overlay:b.overlay,modal:b.modal});d()}else{var y=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",y=a("<form name='FormPost' id='"+r+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+y+";'></form>"),B=a("<table id='"+q+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");t&&(v=t(a("#"+r)),"undefined"==typeof v&&(v=!0));if(!1===v)return;a(j.p.colModel).each(function(){var a=
this.formoptions;z=Math.max(z,a?a.colpos||0:0);x=Math.max(x,a?a.rowpos||0:0)});a(y).append(B);f(c,j,B,z);var t="rtl"==j.p.direction?!0:!1,v="<a href='javascript:void(0)' id='"+(t?"nData":"pData")+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",A="<a href='javascript:void(0)' id='"+(t?"pData":"nData")+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",F="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+
b.bClose+"</a>";if(0<x){var N=[];a.each(a(B)[0].rows,function(a,b){N[a]=b});N.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(N,function(b,c){a("tbody",B).append(c)})}b.gbox="#gbox_"+o;var K=!1;!0===b.closeOnEscape&&(b.closeOnEscape=!1,K=!0);y=a("<span></span>").append(y).append("<table border='0' class='EditTable' id='"+q+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+b.labelswidth+"'>"+(t?A+v:v+A)+"</td><td class='EditButton'>"+F+"</td></tr></tbody></table>");a.jgrid.createModal(u,
y,b,"#gview_"+j.p.id,a("#gview_"+j.p.id)[0]);t&&(a("#pData, #nData","#"+q+"_2").css("float","right"),a(".EditButton","#"+q+"_2").css("text-align","left"));b.viewPagerButtons||a("#pData, #nData","#"+q+"_2").hide();y=null;a("#"+u.themodal).keydown(function(c){if(c.which===27){K&&a.jgrid.hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:b.onClose});return false}if(b.navkeys[0]===true){if(c.which===b.navkeys[1]){a("#pData","#"+q+"_2").trigger("click");return false}if(c.which===b.navkeys[2]){a("#nData",
"#"+q+"_2").trigger("click");return false}}});b.closeicon=a.extend([!0,"left","ui-icon-close"],b.closeicon);!0===b.closeicon[0]&&a("#cData","#"+q+"_2").addClass("right"==b.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.closeicon[2]+"'></span>");a.isFunction(b.beforeShowForm)&&b.beforeShowForm(a("#"+r));a.jgrid.viewModal("#"+u.themodal,{gbox:"#gbox_"+o,jqm:b.jqModal,modal:b.modal});a(".fm-button:not(.ui-state-disabled)","#"+q+"_2").hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")});d();a("#cData","#"+q+"_2").click(function(){a.jgrid.hideModal("#"+u.themodal,{gb:"#gbox_"+o,jqm:b.jqModal,onClose:b.onClose});return false});a("#nData","#"+q+"_2").click(function(){a("#FormError","#"+q).hide();var c=e();c[0]=parseInt(c[0],10);if(c[0]!=-1&&c[1][c[0]+1]){if(a.isFunction(b.onclickPgButtons))b.onclickPgButtons("next",a("#"+r),c[1][c[0]]);g(c[1][c[0]+1],j);a(j).jqGrid("setSelection",c[1][c[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",
a("#"+r),c[1][c[0]+1]);k(c[0]+1,c[1].length-1)}d();return false});a("#pData","#"+q+"_2").click(function(){a("#FormError","#"+q).hide();var c=e();if(c[0]!=-1&&c[1][c[0]-1]){if(a.isFunction(b.onclickPgButtons))b.onclickPgButtons("prev",a("#"+r),c[1][c[0]]);g(c[1][c[0]-1],j);a(j).jqGrid("setSelection",c[1][c[0]-1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("prev",a("#"+r),c[1][c[0]-1]);k(c[0]-1,c[1].length-1)}d();return false})}y=e();k(y[0],y[1].length-1)}})},delGridRow:function(c,b){d=
b=a.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},a.jgrid.del,b||{});return this.each(function(){var f=this;if(f.grid&&c){var m="function"===typeof b.beforeShowForm?
!0:!1,g="function"===typeof b.afterShowForm?!0:!1,k=a.isFunction(b.beforeInitData)?b.beforeInitData:!1,e=f.p.id,p={},o=!0,r="DelTbl_"+e,q,u,t,v,z={themodal:"delmod"+e,modalhead:"delhd"+e,modalcontent:"delcnt"+e,scrollelm:r};j.isArray(c)&&(c=c.join());if(null!==a("#"+z.themodal).html()){k&&(o=k(a("#"+r)),"undefined"==typeof o&&(o=!0));if(!1===o)return;a("#DelData>td","#"+r).text(c);a("#DelError","#"+r).hide();!0===d.processing&&(d.processing=!1,a("#dData","#"+r).removeClass("ui-state-active"));m&&
b.beforeShowForm(a("#"+r));a.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+e,jqm:b.jqModal,jqM:!1,overlay:b.overlay,modal:b.modal})}else{var x=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",x="<div id='"+r+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+x+";'><table class='DelTable'><tbody><tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>"+("<tr id='DelData' style='display:none'><td >"+c+"</td></tr>"),x=x+('<tr><td class="delmsg" style="white-space:pre;">'+
b.msg+"</td></tr><tr><td >&#160;</td></tr>"),x=x+"</tbody></table></div>"+("<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+r+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr></tr><tr><td class='DelButton EditButton'>"+("<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>")+"&#160;"+("<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+"</a>")+
"</td></tr></tbody></table>");b.gbox="#gbox_"+e;a.jgrid.createModal(z,x,b,"#gview_"+f.p.id,a("#gview_"+f.p.id)[0]);k&&(o=k(a("#"+r)),"undefined"==typeof o&&(o=!0));if(!1===o)return;a(".fm-button","#"+r+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});b.delicon=a.extend([!0,"left","ui-icon-scissors"],b.delicon);b.cancelicon=a.extend([!0,"left","ui-icon-cancel"],b.cancelicon);!0===b.delicon[0]&&a("#dData","#"+r+"_2").addClass("right"==b.delicon[1]?
"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.delicon[2]+"'></span>");!0===b.cancelicon[0]&&a("#eData","#"+r+"_2").addClass("right"==b.cancelicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.cancelicon[2]+"'></span>");a("#dData","#"+r+"_2").click(function(){var c=[true,""];p={};var g=a("#DelData>td","#"+r).text();typeof b.onclickSubmit==="function"&&(p=b.onclickSubmit(d,g)||{});typeof b.beforeSubmit==="function"&&(c=b.beforeSubmit(g));
if(c[0]&&!d.processing){d.processing=true;a(this).addClass("ui-state-active");t=f.p.prmNames;q=a.extend({},d.delData,p);v=t.oper;q[v]=t.deloper;u=t.id;q[u]=g;var k=a.extend({url:d.url?d.url:a(f).jqGrid("getGridParam","editurl"),type:b.mtype,data:a.isFunction(b.serializeDelData)?b.serializeDelData(q):q,complete:function(k,j){if(j!="success"){c[0]=false;c[1]=a.isFunction(d.errorTextFormat)?d.errorTextFormat(k):j+" Status: '"+k.statusText+"'. Error code: "+k.status}else typeof d.afterSubmit==="function"&&
(c=d.afterSubmit(k,q));if(c[0]===false){a("#DelError>td","#"+r).html(c[1]);a("#DelError","#"+r).show()}else{if(d.reloadAfterSubmit&&f.p.datatype!="local")a(f).trigger("reloadGrid");else{var m=[],m=g.split(",");if(f.p.treeGrid===true)try{a(f).jqGrid("delTreeNode",m[0])}catch(o){}else for(var p=0;p<m.length;p++)a(f).jqGrid("delRowData",m[p]);f.p.selrow=null;f.p.selarrrow=[]}a.isFunction(d.afterComplete)&&setTimeout(function(){d.afterComplete(k,g)},500)}d.processing=false;a("#dData","#"+r+"_2").removeClass("ui-state-active");
c[0]&&a.jgrid.hideModal("#"+z.themodal,{gb:"#gbox_"+e,jqm:b.jqModal,onClose:d.onClose})}},a.jgrid.ajaxOptions,b.ajaxDelOptions);if(!k.url&&!d.useDataProxy)if(a.isFunction(f.p.dataProxy))d.useDataProxy=true;else{c[0]=false;c[1]=c[1]+(" "+a.jgrid.errors.nourl)}c[0]&&(d.useDataProxy?f.p.dataProxy.call(f,k,"del_"+f.p.id):a.ajax(k))}if(c[0]===false){a("#DelError>td","#"+r).html(c[1]);a("#DelError","#"+r).show()}return false});a("#eData","#"+r+"_2").click(function(){a.jgrid.hideModal("#"+z.themodal,{gb:"#gbox_"+
e,jqm:b.jqModal,onClose:d.onClose});return false});m&&b.beforeShowForm(a("#"+r));a.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+e,jqm:b.jqModal,overlay:b.overlay,modal:b.modal})}g&&b.afterShowForm(a("#"+r));!0===b.closeOnEscape&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+z.modalhead).focus()},0)}})},navGrid:function(c,b,d,f,g,k,e){b=a.extend({edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",del:!0,delicon:"ui-icon-trash",search:!0,searchicon:"ui-icon-search",refresh:!0,
refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:!1,viewicon:"ui-icon-document",position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1},a.jgrid.nav,b||{});return this.each(function(){if(!this.nav){var j={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},o=this,r,q,u;if(o.grid&&"string"==typeof c){null===a("#"+j.themodal).html()&&("undefined"!=typeof window.innerWidth?(r=window.innerWidth,q=window.innerHeight):"undefined"!=typeof document.documentElement&&
"undefined"!=typeof document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(r=document.documentElement.clientWidth,q=document.documentElement.clientHeight):(r=1024,q=768),a.jgrid.createModal(j,"<div>"+b.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+o.p.id,jqModal:!0,drag:!0,resize:!0,caption:b.alertcap,top:q/2-25,left:r/2-100,width:200,height:"auto",closeOnEscape:b.closeOnEscape},"","",!0));r=1;b.cloneToTop&&o.p.toppager&&
(r=2);for(q=0;q<r;q++){var t=a("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),v,z;0===q?(v=c,z=o.p.id,v==o.p.toppager&&(z+="_top",r=1)):(v=o.p.toppager,z=o.p.id+"_top");"rtl"==o.p.direction&&a(t).attr("dir","rtl").css("float","right");b.add&&(f=f||{},u=a("<td class='ui-pg-button ui-corner-all'></td>"),a(u).append("<div class='ui-pg-div'><span class='ui-icon "+b.addicon+"'></span>"+b.addtext+"</div>"),
a("tr",t).append(u),a(u,t).attr({title:b.addtitle||"",id:f.id||"add_"+z}).click(function(){a(this).hasClass("ui-state-disabled")||(typeof b.addfunc=="function"?b.addfunc():a(o).jqGrid("editGridRow","new",f));return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),u=null);b.edit&&(u=a("<td class='ui-pg-button ui-corner-all'></td>"),d=d||{},a(u).append("<div class='ui-pg-div'><span class='ui-icon "+
b.editicon+"'></span>"+b.edittext+"</div>"),a("tr",t).append(u),a(u,t).attr({title:b.edittitle||"",id:d.id||"edit_"+z}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var c=o.p.selrow;if(c)typeof b.editfunc=="function"?b.editfunc(c):a(o).jqGrid("editGridRow",c,d);else{a.jgrid.viewModal("#"+j.themodal,{gbox:"#gbox_"+o.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),
u=null);b.view&&(u=a("<td class='ui-pg-button ui-corner-all'></td>"),e=e||{},a(u).append("<div class='ui-pg-div'><span class='ui-icon "+b.viewicon+"'></span>"+b.viewtext+"</div>"),a("tr",t).append(u),a(u,t).attr({title:b.viewtitle||"",id:e.id||"view_"+z}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b=o.p.selrow;if(b)a(o).jqGrid("viewGridRow",b,e);else{a.jgrid.viewModal("#"+j.themodal,{gbox:"#gbox_"+o.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||
a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),u=null);b.del&&(u=a("<td class='ui-pg-button ui-corner-all'></td>"),g=g||{},a(u).append("<div class='ui-pg-div'><span class='ui-icon "+b.delicon+"'></span>"+b.deltext+"</div>"),a("tr",t).append(u),a(u,t).attr({title:b.deltitle||"",id:g.id||"del_"+z}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var c;if(o.p.multiselect){c=o.p.selarrrow;c.length===0&&(c=null)}else c=o.p.selrow;if(c)"function"==typeof b.delfunc?
b.delfunc(c):a(o).jqGrid("delGridRow",c,g);else{a.jgrid.viewModal("#"+j.themodal,{gbox:"#gbox_"+o.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),u=null);(b.add||b.edit||b.del||b.view)&&a("tr",t).append("<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>");b.search&&(u=a("<td class='ui-pg-button ui-corner-all'></td>"),
k=k||{},a(u).append("<div class='ui-pg-div'><span class='ui-icon "+b.searchicon+"'></span>"+b.searchtext+"</div>"),a("tr",t).append(u),a(u,t).attr({title:b.searchtitle||"",id:k.id||"search_"+z}).click(function(){a(this).hasClass("ui-state-disabled")||a(o).jqGrid("searchGrid",k);return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),k.showOnLoad&&!0===k.showOnLoad&&a(u,t).click(),u=null);b.refresh&&
(u=a("<td class='ui-pg-button ui-corner-all'></td>"),a(u).append("<div class='ui-pg-div'><span class='ui-icon "+b.refreshicon+"'></span>"+b.refreshtext+"</div>"),a("tr",t).append(u),a(u,t).attr({title:b.refreshtitle||"",id:"refresh_"+z}).click(function(){if(!a(this).hasClass("ui-state-disabled")){a.isFunction(b.beforeRefresh)&&b.beforeRefresh();o.p.search=false;try{var c=o.p.id;o.p.postData.filters="";a("#fbox_"+c).jqFilter("resetFilter");a.isFunction(o.clearToolbar)&&o.clearToolbar(false)}catch(e){}switch(b.refreshstate){case "firstpage":a(o).trigger("reloadGrid",
[{page:1}]);break;case "current":a(o).trigger("reloadGrid",[{current:true}])}a.isFunction(b.afterRefresh)&&b.afterRefresh()}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),u=null);u=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+u+";visibility:hidden;' ></div>");u=a(t).clone().appendTo("#testpg2").width();
a("#testpg2").remove();a(v+"_"+b.position,v).append(t);o.p._nvtd&&(u>o.p._nvtd[0]&&(a(v+"_"+b.position,v).width(u),o.p._nvtd[0]=u),o.p._nvtd[1]=u);t=u=u=null;this.nav=!0}}}})},navButtonAdd:function(c,b){b=a.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},b||{});return this.each(function(){if(this.grid){0!==c.indexOf("#")&&(c="#"+c);var d=a(".navtable",c)[0],f=this;if(d&&!(b.id&&null!==a("#"+b.id,d).html())){var g=a("<td></td>");
"NONE"==b.buttonicon.toString().toUpperCase()?a(g).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+b.caption+"</div>"):a(g).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+b.buttonicon+"'></span>"+b.caption+"</div>");b.id&&a(g).attr("id",b.id);"first"==b.position?0===d.rows[0].cells.length?a("tr",d).append(g):a("tr td:eq(0)",d).before(g):a("tr",d).append(g);a(g,d).attr("title",b.title||"").click(function(c){a(this).hasClass("ui-state-disabled")||
a.isFunction(b.onClickButton)&&b.onClickButton.call(f,c);return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})},navSeparatorAdd:function(c,b){b=a.extend({sepclass:"ui-separator",sepcontent:""},b||{});return this.each(function(){if(this.grid){0!==c.indexOf("#")&&(c="#"+c);var d=a(".navtable",c)[0];if(d){var f="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+b.sepclass+
"'></span>"+b.sepcontent+"</td>";a("tr",d).append(f)}}})},GridToForm:function(c,b){return this.each(function(){if(this.grid){var d=a(this).jqGrid("getRowData",c);if(d)for(var f in d)a("[name="+a.jgrid.jqID(f)+"]",b).is("input:radio")||a("[name="+a.jgrid.jqID(f)+"]",b).is("input:checkbox")?a("[name="+a.jgrid.jqID(f)+"]",b).each(function(){a(this).val()==d[f]?a(this).attr("checked","checked"):a(this).attr("checked","")}):a("[name="+a.jgrid.jqID(f)+"]",b).val(d[f])}})},FormToGrid:function(c,b,d,f){return this.each(function(){if(this.grid){d||
(d="set");f||(f="first");var g=a(b).serializeArray(),k={};a.each(g,function(a,b){k[b.name]=b.value});"add"==d?a(this).jqGrid("addRowData",c,k,f):"set"==d&&a(this).jqGrid("setRowData",c,k)}})}})})(j);(function(a){a.fn.jqFilter=function(d){if("string"===typeof d){var c=a.fn.jqFilter[d];if(!c)throw"jqFilter - No such method: "+d;var b=a.makeArray(arguments).slice(1);return c.apply(this,b)}var f=a.extend(!0,{filter:null,columns:[],onChange:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,
sopt:null,ops:[{name:"eq",description:"equal",operator:"="},{name:"ne",description:"not equal",operator:"<>"},{name:"lt",description:"less",operator:"<"},{name:"le",description:"less or equal",operator:"<="},{name:"gt",description:"greater",operator:">"},{name:"ge",description:"greater or equal",operator:">="},{name:"bw",description:"begins with",operator:"LIKE"},{name:"bn",description:"does not begin with",operator:"NOT LIKE"},{name:"in",description:"in",operator:"IN"},{name:"ni",description:"not in",
operator:"NOT IN"},{name:"ew",description:"ends with",operator:"LIKE"},{name:"en",description:"does not end with",operator:"NOT LIKE"},{name:"cn",description:"contains",operator:"LIKE"},{name:"nc",description:"does not contain",operator:"NOT LIKE"},{name:"nu",description:"is null",operator:"IS NULL"},{name:"nn",description:"is not null",operator:"IS NOT NULL"}],numopts:"eq ne lt le gt ge nu nn in ni".split(" "),stropts:"eq ne bw bn ew en cn nc nu nn in ni".split(" "),_gridsopt:[],groupOps:["AND",
"OR"],groupButton:!0},d||{});return this.each(function(){if(!this.filter){this.p=f;if(null===this.p.filter||void 0===this.p.filter)this.p.filter={groupOp:this.p.groupOps[0],rules:[],groups:[]};var b,c=this.p.columns.length,d,e=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p._gridsopt.length)for(b=0;b<this.p._gridsopt.length;b++)this.p.ops[b].description=this.p._gridsopt[b];this.p.initFilter=a.extend(!0,{},this.p.filter);if(c){for(b=0;b<c;b++)if(d=this.p.columns[b],d.stype?d.inputtype=d.stype:
d.inputtype||(d.inputtype="text"),d.sorttype?d.searchtype=d.sorttype:d.searchtype||(d.searchtype="string"),void 0===d.hidden&&(d.hidden=!1),d.label||(d.label=d.name),d.index&&(d.name=d.index),d.hasOwnProperty("searchoptions")||(d.searchoptions={}),!d.hasOwnProperty("searchrules"))d.searchrules={};this.p.showQuery&&a(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;'><tbody><tr><td class='query'></td></tr></tbody></table>");var j=
function(b,c){var e=[!0,""];if(a.isFunction(c.searchrules))e=c.searchrules(b,c);else if(a.jgrid&&a.jgrid.checkValues)try{e=a.jgrid.checkValues(b,-1,null,c.searchrules,c.label)}catch(d){}e&&(e.length&&!1===e[0])&&(f.error=!e[0],f.errmsg=e[1])};this.onchange=function(){this.p.error=!1;this.p.errmsg="";return a.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):!1};this.reDraw=function(){a("table.group:first",this).remove();var b=this.createTableForGroup(f.filter,null);a(this).append(b)};
this.createTableForGroup=function(b,c){var e=this,d,g=a("<table class='group ui-widget ui-widget-content' style='border:0px none;'><tbody></tbody></table>");null===c&&a(g).append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='left'></th></tr>");var k=a("<tr></tr>");a(g).append(k);var j=a("<th colspan='5' align='left'></th>");k.append(j);var m=a("<select class='opsel'></select>");j.append(m);var k="",p;for(d=0;d<f.groupOps.length;d++)p=b.groupOp===e.p.groupOps[d]?
" selected='selected'":"",k+="<option value='"+e.p.groupOps[d]+"'"+p+">"+e.p.groupOps[d]+"</option>";m.append(k).bind("change",function(){b.groupOp=a(m).val();e.onchange()});k="<span></span>";this.p.groupButton&&(k=a("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>"),k.bind("click",function(){void 0===b.groups&&(b.groups=[]);b.groups.push({groupOp:f.groupOps[0],rules:[],groups:[]});e.reDraw();e.onchange();return!1}));j.append(k);var k=a("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>"),
B;k.bind("click",function(){if(b.rules===void 0)b.rules=[];for(d=0;d<e.p.columns.length;d++){var a=typeof e.p.columns[d].search==="undefined"?true:e.p.columns[d].search,c=e.p.columns[d].hidden===true;if(e.p.columns[d].searchoptions.searchhidden===true&&a||a&&!c){B=e.p.columns[d];break}}b.rules.push({field:B.name,op:(B.searchoptions.sopt?B.searchoptions.sopt:e.p.sopt?e.p.sopt:B.searchtype==="string"?e.p.stropts:e.p.numopts)[0],data:""});e.reDraw();return false});j.append(k);null!==c&&(k=a("<input type='button' value='-' title='Delete group' class='delete-group'/>"),
j.append(k),k.bind("click",function(){for(d=0;d<c.groups.length;d++)if(c.groups[d]===b){c.groups.splice(d,1);break}e.reDraw();e.onchange();return false}));if(void 0!==b.groups)for(d=0;d<b.groups.length;d++)j=a("<tr></tr>"),g.append(j),k=a("<td class='first'></td>"),j.append(k),k=a("<td colspan='4'></td>"),k.append(this.createTableForGroup(b.groups[d],b)),j.append(k);void 0===b.groupOp&&(b.groupOp=e.p.groupOps[0]);if(void 0!==b.rules)for(d=0;d<b.rules.length;d++)g.append(this.createTableRowForRule(b.rules[d],
b));return g};this.createTableRowForRule=function(b,c){var d=this,g=a("<tr></tr>"),k,j,m,p,y="",B;g.append("<td class='first'></td>");var A=a("<td class='columns'></td>");g.append(A);var F=a("<select></select>");A.append(F);F.bind("change",function(){b.field=a(F).val();m=a(this).parents("tr:first");for(k=0;k<d.p.columns.length;k++)if(d.p.columns[k].name===b.field){p=d.p.columns[k];break}if(p){p.searchoptions.id=a.jgrid.randId();e&&"text"===p.inputtype&&!p.searchoptions.size&&(p.searchoptions.size=
10);var c=a.jgrid.createEl(p.inputtype,p.searchoptions,"",!0,d.p.ajaxSelectOptions,!0);a(c).addClass("input-elm");j=p.searchoptions.sopt?p.searchoptions.sopt:d.p.sopt?d.p.sopt:"string"===p.searchtype?d.p.stropts:d.p.numopts;var f="",g="";for(k=0;k<d.p.ops.length;k++)-1!==a.inArray(d.p.ops[k].name,j)&&(g=b.op===d.p.ops[k].name?" selected=selected":"",f+="<option value='"+d.p.ops[k].name+"'"+g+">"+d.p.ops[k].description+"</option>");a(".selectopts",m).empty().append(f);a(".data",m).empty().append(c);
a(".input-elm",m).bind("change",function(){b.data=a(this).val();if(a.isArray(b.data))b.data=b.data.join(",");d.onchange()});setTimeout(function(){b.data=a(c).val();d.onchange()},0)}});for(k=A=0;k<d.p.columns.length;k++){B="undefined"===typeof d.p.columns[k].search?!0:d.p.columns[k].search;var N=!0===d.p.columns[k].hidden;if(!0===d.p.columns[k].searchoptions.searchhidden&&B||B&&!N)B="",b.field===d.p.columns[k].name&&(B=" selected='selected'",A=k),y+="<option value='"+d.p.columns[k].name+"'"+B+">"+
d.p.columns[k].label+"</option>"}F.append(y);y=a("<td class='operators'></td>");g.append(y);p=f.columns[A];p.searchoptions.id=a.jgrid.randId();e&&"text"===p.inputtype&&!p.searchoptions.size&&(p.searchoptions.size=10);var A=a.jgrid.createEl(p.inputtype,p.searchoptions,b.data,!0,d.p.ajaxSelectOptions,!0),K=a("<select class='selectopts'></select>");y.append(K);K.bind("change",function(){b.op=a(K).val();m=a(this).parents("tr:first");var c=a(".input-elm",m)[0];if(b.op==="nu"||b.op==="nn"){b.data="";c.value=
"";c.setAttribute("readonly","true");c.setAttribute("disabled","true")}else{c.removeAttribute("readonly");c.removeAttribute("disabled")}d.onchange()});j=p.searchoptions.sopt?p.searchoptions.sopt:d.p.sopt?d.p.sopt:"string"===p.searchtype?f.stropts:d.p.numopts;y="";for(k=0;k<d.p.ops.length;k++)-1!==a.inArray(d.p.ops[k].name,j)&&(B=b.op===d.p.ops[k].name?" selected='selected'":"",y+="<option value='"+d.p.ops[k].name+"'"+B+">"+d.p.ops[k].description+"</option>");K.append(y);y=a("<td class='data'></td>");
g.append(y);y.append(A);a(A).addClass("input-elm").bind("change",function(){b.data=a(this).val();if(a.isArray(b.data))b.data=b.data.join(",");d.onchange()});y=a("<td></td>");g.append(y);A=a("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>");y.append(A);A.bind("click",function(){for(k=0;k<c.rules.length;k++)if(c.rules[k]===b){c.rules.splice(k,1);break}d.reDraw();d.onchange();return false});return g};this.getStringForGroup=function(a){var b="(",c;if(void 0!==a.groups)for(c=
0;c<a.groups.length;c++){1<b.length&&(b+=" "+a.groupOp+" ");try{b+=this.getStringForGroup(a.groups[c])}catch(e){alert(e)}}if(void 0!==a.rules)try{for(c=0;c<a.rules.length;c++)1<b.length&&(b+=" "+a.groupOp+" "),b+=this.getStringForRule(a.rules[c])}catch(d){alert(d)}b+=")";return"()"===b?"":b};this.getStringForRule=function(b){var c="",e="",d,g;for(d=0;d<this.p.ops.length;d++)if(this.p.ops[d].name===b.op){c=this.p.ops[d].operator;e=this.p.ops[d].name;break}for(d=0;d<this.p.columns.length;d++)if(this.p.columns[d].name===
b.field){g=this.p.columns[d];break}d=b.data;if("bw"===e||"bn"===e)d+="%";if("ew"===e||"en"===e)d="%"+d;if("cn"===e||"nc"===e)d="%"+d+"%";if("in"===e||"ni"===e)d=" ("+d+")";f.errorcheck&&j(b.data,g);return-1!==a.inArray(g.searchtype,["int","integer","float","number","currency"])||"nn"===e||"nu"===e?b.field+" "+c+" "+d:b.field+" "+c+' "'+d+'"'};this.resetFilter=function(){this.p.filter=a.extend(!0,{},this.p.initFilter);this.reDraw();this.onchange()};this.hideError=function(){a("th.ui-state-error",this).html("");
a("tr.error",this).hide()};this.showError=function(){a("th.ui-state-error",this).html(this.p.errmsg);a("tr.error",this).show()};this.toUserFriendlyString=function(){return this.getStringForGroup(f.filter)};this.toString=function(){function a(c){var e="(",d;if(void 0!==c.groups)for(d=0;d<c.groups.length;d++)1<e.length&&(e+="OR"===c.groupOp?" || ":" && "),e+=a(c.groups[d]);if(void 0!==c.rules)for(d=0;d<c.rules.length;d++){1<e.length&&(e+="OR"===c.groupOp?" || ":" && ");var f=c.rules[d];if(b.p.errorcheck){for(var g=
void 0,k=void 0,g=0;g<b.p.columns.length;g++)if(b.p.columns[g].name===f.field){k=b.p.columns[g];break}k&&j(f.data,k)}e+=f.op+"(item."+f.field+",'"+f.data+"')"}e+=")";return"()"===e?"":e}var b=this;return a(this.p.filter)};this.reDraw();if(this.p.showQuery)this.onchange();this.filter=!0}}})};a.extend(a.fn.jqFilter,{toSQLString:function(){var a="";this.each(function(){a=this.toUserFriendlyString()});return a},filterData:function(){var a;this.each(function(){a=this.p.filter});return a},getParameter:function(a){return void 0!==
a&&this.p.hasOwnProperty(a)?this.p[a]:this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(a){"string"===typeof a&&(a=j.jgrid.parse(a));this.each(function(){this.p.filter=a;this.reDraw();this.onchange()})}})})(j);(function(a){a.jgrid.extend({editRow:function(d,c,b,f,j,g,k,e,p){var o={keys:c||!1,oneditfunc:b||null,successfunc:f||null,url:j||null,extraparam:g||{},aftersavefunc:k||null,errorfunc:e||null,afterrestorefunc:p||null,restoreAfterErorr:!0},r=a.makeArray(arguments).slice(1),
q;q=r[0]&&"object"==typeof r[0]&&!a.isFunction(r[0])?a.extend(o,r[0]):o;return this.each(function(){var b=this,c,e,f=0,g=null,k={},j,l;if(b.grid&&(j=a(b).jqGrid("getInd",d,!0),!1!==j&&"0"==(a(j).attr("editable")||"0")&&!a(j).hasClass("not-editable-row")))l=b.p.colModel,a("td",j).each(function(j){c=l[j].name;var m=!0===b.p.treeGrid&&c==b.p.ExpandColumn;if(m)e=a("span:first",this).html();else try{e=a.unformat(this,{rowId:d,colModel:l[j]},j)}catch(o){e=a(this).html()}if("cb"!=c&&("subgrid"!=c&&"rn"!=
c)&&(b.p.autoencode&&(e=a.jgrid.htmlDecode(e)),k[c]=e,!0===l[j].editable)){null===g&&(g=j);m?a("span:first",this).html(""):a(this).html("");var p=a.extend({},l[j].editoptions||{},{id:d+"_"+c,name:c});l[j].edittype||(l[j].edittype="text");p=a.jgrid.createEl(l[j].edittype,p,e,!0,a.extend({},a.jgrid.ajaxOptions,b.p.ajaxSelectOptions||{}));a(p).addClass("editable");m?a("span:first",this).append(p):a(this).append(p);"select"==l[j].edittype&&!0===l[j].editoptions.multiple&&a.browser.msie&&a(p).width(a(p).width());
f++}}),0<f&&(k.id=d,b.p.savedRow.push(k),a(j).attr("editable","1"),a("td:eq("+g+") input",j).focus(),!0===q.keys&&a(j).bind("keydown",function(c){27===c.keyCode&&a(b).jqGrid("restoreRow",d,p);if(13===c.keyCode){if("TEXTAREA"==c.target.tagName)return!0;a(b).jqGrid("saveRow",d,q);return!1}c.stopPropagation()}),a.isFunction(q.oneditfunc)&&q.oneditfunc.call(b,d))})},saveRow:function(d,c,b,f,m,g,k){var e={successfunc:c||null,url:b||null,extraparam:f||{},aftersavefunc:m||null,errorfunc:g||null,afterrestorefunc:k||
null,restoreAfterErorr:!0},p=a.makeArray(arguments).slice(1),o;o=p[0]&&"object"==typeof p[0]&&!a.isFunction(p[0])?a.extend(e,p[0]):e;var r=!1,q=this[0],u,t={},v={},z={},x,y,B;if(!q.grid)return r;B=a(q).jqGrid("getInd",d,!0);if(!1===B)return r;e=a(B).attr("editable");o.url=o.url?o.url:q.p.editurl;if("1"===e){var A;a("td",B).each(function(b){A=q.p.colModel[b];u=A.name;if("cb"!=u&&"subgrid"!=u&&!0===A.editable&&"rn"!=u&&!a(this).hasClass("not-editable-cell")){switch(A.edittype){case "checkbox":var c=
["Yes","No"];A.editoptions&&(c=A.editoptions.value.split(":"));t[u]=a("input",this).attr("checked")?c[0]:c[1];break;case "text":case "password":case "textarea":case "button":t[u]=a("input, textarea",this).val();break;case "select":if(A.editoptions.multiple){var c=a("select",this),e=[];t[u]=a(c).val();t[u]=t[u]?t[u].join(","):"";a("select > option:selected",this).each(function(b,c){e[b]=a(c).text()});v[u]=e.join(",")}else t[u]=a("select>option:selected",this).val(),v[u]=a("select>option:selected",
this).text();A.formatter&&"select"==A.formatter&&(v={});break;case "custom":try{if(A.editoptions&&a.isFunction(A.editoptions.custom_value)){if(t[u]=A.editoptions.custom_value.call(q,a(".customelement",this),"get"),void 0===t[u])throw"e2";}else throw"e1";}catch(d){"e1"==d&&a.jgrid.info_dialog(j.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,j.jgrid.edit.bClose),"e2"==d?a.jgrid.info_dialog(j.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,j.jgrid.edit.bClose):
a.jgrid.info_dialog(j.jgrid.errors.errcap,d.message,j.jgrid.edit.bClose)}}y=a.jgrid.checkValues(t[u],b,q);if(!1===y[0])return y[1]=t[u]+" "+y[1],!1;q.p.autoencode&&(t[u]=a.jgrid.htmlEncode(t[u]));"clientArray"!==o.url&&A.editoptions&&!0===A.editoptions.NullIfEmpty&&""==t[u]&&(z[u]="null")}});if(!1===y[0]){try{var F=a.jgrid.findPos(a("#"+a.jgrid.jqID(d),q.grid.bDiv)[0]);a.jgrid.info_dialog(a.jgrid.errors.errcap,y[1],a.jgrid.edit.bClose,{left:F[0],top:F[1]})}catch(N){alert(y[1])}return r}t&&(e=q.p.prmNames,
p=e.oper,F=e.id,t[p]=e.editoper,t[F]=d,"undefined"==typeof q.p.inlineData&&(q.p.inlineData={}),t=a.extend({},t,q.p.inlineData,o.extraparam));if("clientArray"==o.url){t=a.extend({},t,v);q.p.autoencode&&a.each(t,function(b,c){t[b]=a.jgrid.htmlDecode(c)});F=a(q).jqGrid("setRowData",d,t);a(B).attr("editable","0");for(e=0;e<q.p.savedRow.length;e++)if(q.p.savedRow[e].id==d){x=e;break}0<=x&&q.p.savedRow.splice(x,1);a.isFunction(o.aftersavefunc)&&o.aftersavefunc.call(q,d,F);r=!0}else a("#lui_"+q.p.id).show(),
z=a.extend({},t,z),a.ajax(a.extend({url:o.url,data:a.isFunction(q.p.serializeRowData)?q.p.serializeRowData.call(q,z):z,type:"POST",async:!1,complete:function(b,c){a("#lui_"+q.p.id).hide();if(c==="success")if((a.isFunction(o.succesfunc)?o.succesfunc.call(q,b):true)===true){q.p.autoencode&&a.each(t,function(b,c){t[b]=a.jgrid.htmlDecode(c)});t=a.extend({},t,v);a(q).jqGrid("setRowData",d,t);a(B).attr("editable","0");for(var e=0;e<q.p.savedRow.length;e++)if(q.p.savedRow[e].id==d){x=e;break}x>=0&&q.p.savedRow.splice(x,
1);a.isFunction(o.aftersavefunc)&&o.aftersavefunc.call(q,d,b);r=true}else{a.isFunction(o.errorfunc)&&o.errorfunc.call(q,d,b,c);o.restoreAfterError===true&&a(q).jqGrid("restoreRow",d,o.afterrestorefunc)}},error:function(b,c){a("#lui_"+q.p.id).hide();if(a.isFunction(o.errorfunc))o.errorfunc.call(q,d,b,c);else try{j.jgrid.info_dialog(j.jgrid.errors.errcap,'<div class="ui-state-error">'+b.responseText+"</div>",j.jgrid.edit.bClose,{buttonalign:"right"})}catch(e){alert(b.responseText)}o.restoreAfterError===
true&&a(q).jqGrid("restoreRow",d,o.afterrestorefunc)}},a.jgrid.ajaxOptions,q.p.ajaxRowOptions||{}));a(B).unbind("keydown")}return r},restoreRow:function(d,c){return this.each(function(){var b=this,f,j,g={};if(b.grid&&(j=a(b).jqGrid("getInd",d,!0),!1!==j)){for(var k=0;k<b.p.savedRow.length;k++)if(b.p.savedRow[k].id==d){f=k;break}if(0<=f){if(a.isFunction(a.fn.datepicker))try{a("input.hasDatepicker","#"+a.jgrid.jqID(j.id)).datepicker("hide")}catch(e){}a.each(b.p.colModel,function(){!0===this.editable&&
(this.name in b.p.savedRow[f]&&!a(this).hasClass("not-editable-cell"))&&(g[this.name]=b.p.savedRow[f][this.name])});a(b).jqGrid("setRowData",d,g);a(j).attr("editable","0").unbind("keydown");b.p.savedRow.splice(f,1)}a.isFunction(c)&&c.call(b,d)}})}})})(j);(function(a){a.jgrid.extend({editCell:function(d,c,b){return this.each(function(){var f=this,j,g,k;if(f.grid&&!0===f.p.cellEdit){c=parseInt(c,10);f.p.selrow=f.rows[d].id;f.p.knv||a(f).jqGrid("GridNav");if(0<f.p.savedRow.length){if(!0===b&&d==f.p.iRow&&
c==f.p.iCol)return;a(f).jqGrid("saveCell",f.p.savedRow[0].id,f.p.savedRow[0].ic)}else window.setTimeout(function(){a("#"+f.p.knv).attr("tabindex","-1").focus()},0);j=f.p.colModel[c].name;if(!("subgrid"==j||"cb"==j||"rn"==j)){k=a("td:eq("+c+")",f.rows[d]);if(!0===f.p.colModel[c].editable&&!0===b&&!k.hasClass("not-editable-cell")){0<=parseInt(f.p.iCol,10)&&0<=parseInt(f.p.iRow,10)&&(a("td:eq("+f.p.iCol+")",f.rows[f.p.iRow]).removeClass("edit-cell ui-state-highlight"),a(f.rows[f.p.iRow]).removeClass("selected-row ui-state-hover"));
a(k).addClass("edit-cell ui-state-highlight");a(f.rows[d]).addClass("selected-row ui-state-hover");try{g=a.unformat(k,{rowId:f.rows[d].id,colModel:f.p.colModel[c]},c)}catch(e){g=a(k).html()}f.p.autoencode&&(g=a.jgrid.htmlDecode(g));f.p.colModel[c].edittype||(f.p.colModel[c].edittype="text");f.p.savedRow.push({id:d,ic:c,name:j,v:g});if(a.isFunction(f.p.formatCell)){var p=f.p.formatCell.call(f,f.rows[d].id,j,g,d,c);void 0!==p&&(g=p)}var p=a.extend({},f.p.colModel[c].editoptions||{},{id:d+"_"+j,name:j}),
o=a.jgrid.createEl(f.p.colModel[c].edittype,p,g,!0,a.extend({},a.jgrid.ajaxOptions,f.p.ajaxSelectOptions||{}));a.isFunction(f.p.beforeEditCell)&&f.p.beforeEditCell.call(f,f.rows[d].id,j,g,d,c);a(k).html("").append(o).attr("tabindex","0");window.setTimeout(function(){a(o).focus()},0);a("input, select, textarea",k).bind("keydown",function(b){b.keyCode===27&&(a("input.hasDatepicker",k).length>0?a(".ui-datepicker").is(":hidden")?a(f).jqGrid("restoreCell",d,c):a("input.hasDatepicker",k).datepicker("hide"):
a(f).jqGrid("restoreCell",d,c));b.keyCode===13&&a(f).jqGrid("saveCell",d,c);if(b.keyCode==9){if(f.grid.hDiv.loading)return false;b.shiftKey?a(f).jqGrid("prevCell",d,c):a(f).jqGrid("nextCell",d,c)}b.stopPropagation()});a.isFunction(f.p.afterEditCell)&&f.p.afterEditCell.call(f,f.rows[d].id,j,g,d,c)}else if(0<=parseInt(f.p.iCol,10)&&0<=parseInt(f.p.iRow,10)&&(a("td:eq("+f.p.iCol+")",f.rows[f.p.iRow]).removeClass("edit-cell ui-state-highlight"),a(f.rows[f.p.iRow]).removeClass("selected-row ui-state-hover")),
k.addClass("edit-cell ui-state-highlight"),a(f.rows[d]).addClass("selected-row ui-state-hover"),a.isFunction(f.p.onSelectCell))g=k.html().replace(/\&#160\;/ig,""),f.p.onSelectCell.call(f,f.rows[d].id,j,g,d,c);f.p.iCol=c;f.p.iRow=d}}})},saveCell:function(d,c){return this.each(function(){var b=this,f;if(b.grid&&!0===b.p.cellEdit){f=1<=b.p.savedRow.length?0:null;if(null!==f){var m=a("td:eq("+c+")",b.rows[d]),g,k,e=b.p.colModel[c],p=e.name,o=a.jgrid.jqID(p);switch(e.edittype){case "select":if(e.editoptions.multiple){var o=
a("#"+d+"_"+o,b.rows[d]),r=[];(g=a(o).val())?g.join(","):g="";a("option:selected",o).each(function(b,c){r[b]=a(c).text()});k=r.join(",")}else g=a("#"+d+"_"+o+">option:selected",b.rows[d]).val(),k=a("#"+d+"_"+o+">option:selected",b.rows[d]).text();e.formatter&&(k=g);break;case "checkbox":var q=["Yes","No"];e.editoptions&&(q=e.editoptions.value.split(":"));k=g=a("#"+d+"_"+o,b.rows[d]).attr("checked")?q[0]:q[1];break;case "password":case "text":case "textarea":case "button":k=g=a("#"+d+"_"+o,b.rows[d]).val();
break;case "custom":try{if(e.editoptions&&a.isFunction(e.editoptions.custom_value)){g=e.editoptions.custom_value.call(b,a(".customelement",m),"get");if(void 0===g)throw"e2";k=g}else throw"e1";}catch(u){"e1"==u&&a.jgrid.info_dialog(j.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,j.jgrid.edit.bClose),"e2"==u?a.jgrid.info_dialog(j.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,j.jgrid.edit.bClose):a.jgrid.info_dialog(j.jgrid.errors.errcap,u.message,
j.jgrid.edit.bClose)}}if(k!=b.p.savedRow[f].v){if(a.isFunction(b.p.beforeSaveCell)&&(f=b.p.beforeSaveCell.call(b,b.rows[d].id,p,g,d,c)))k=g=f;var t=a.jgrid.checkValues(g,c,b);if(!0===t[0]){f={};a.isFunction(b.p.beforeSubmitCell)&&((f=b.p.beforeSubmitCell.call(b,b.rows[d].id,p,g,d,c))||(f={}));0<a("input.hasDatepicker",m).length&&a("input.hasDatepicker",m).datepicker("hide");if("remote"==b.p.cellsubmit)if(b.p.cellurl){var v={};b.p.autoencode&&(g=a.jgrid.htmlEncode(g));v[p]=g;q=b.p.prmNames;e=q.id;
o=q.oper;v[e]=b.rows[d].id;v[o]=q.editoper;v=a.extend(f,v);a("#lui_"+b.p.id).show();b.grid.hDiv.loading=!0;a.ajax(a.extend({url:b.p.cellurl,data:a.isFunction(b.p.serializeCellData)?b.p.serializeCellData.call(b,v):v,type:"POST",complete:function(e,f){a("#lui_"+b.p.id).hide();b.grid.hDiv.loading=!1;if("success"==f)if(a.isFunction(b.p.afterSubmitCell)){var j=b.p.afterSubmitCell.call(b,e,v.id,p,g,d,c);!0===j[0]?(a(m).empty(),a(b).jqGrid("setCell",b.rows[d].id,c,k,!1,!1,!0),a(m).addClass("dirty-cell"),
a(b.rows[d]).addClass("edited"),a.isFunction(b.p.afterSaveCell)&&b.p.afterSaveCell.call(b,b.rows[d].id,p,g,d,c),b.p.savedRow.splice(0,1)):(a.jgrid.info_dialog(a.jgrid.errors.errcap,j[1],a.jgrid.edit.bClose),a(b).jqGrid("restoreCell",d,c))}else a(m).empty(),a(b).jqGrid("setCell",b.rows[d].id,c,k,!1,!1,!0),a(m).addClass("dirty-cell"),a(b.rows[d]).addClass("edited"),a.isFunction(b.p.afterSaveCell)&&b.p.afterSaveCell.call(b,b.rows[d].id,p,g,d,c),b.p.savedRow.splice(0,1)},error:function(e,f){a("#lui_"+
b.p.id).hide();b.grid.hDiv.loading=!1;a.isFunction(b.p.errorCell)?b.p.errorCell.call(b,e,f):a.jgrid.info_dialog(a.jgrid.errors.errcap,e.status+" : "+e.statusText+"<br/>"+f,a.jgrid.edit.bClose);a(b).jqGrid("restoreCell",d,c)}},a.jgrid.ajaxOptions,b.p.ajaxCellOptions||{}))}else try{a.jgrid.info_dialog(a.jgrid.errors.errcap,a.jgrid.errors.nourl,a.jgrid.edit.bClose),a(b).jqGrid("restoreCell",d,c)}catch(z){}"clientArray"==b.p.cellsubmit&&(a(m).empty(),a(b).jqGrid("setCell",b.rows[d].id,c,k,!1,!1,!0),a(m).addClass("dirty-cell"),
a(b.rows[d]).addClass("edited"),a.isFunction(b.p.afterSaveCell)&&b.p.afterSaveCell.call(b,b.rows[d].id,p,g,d,c),b.p.savedRow.splice(0,1))}else try{window.setTimeout(function(){a.jgrid.info_dialog(a.jgrid.errors.errcap,g+" "+t[1],a.jgrid.edit.bClose)},100),a(b).jqGrid("restoreCell",d,c)}catch(x){}}else a(b).jqGrid("restoreCell",d,c)}a.browser.opera?a("#"+b.p.knv).attr("tabindex","-1").focus():window.setTimeout(function(){a("#"+b.p.knv).attr("tabindex","-1").focus()},0)}})},restoreCell:function(d,c){return this.each(function(){var b=
this,f;if(b.grid&&!0===b.p.cellEdit){f=1<=b.p.savedRow.length?0:null;if(null!==f){var j=a("td:eq("+c+")",b.rows[d]);if(a.isFunction(a.fn.datepicker))try{a("input.hasDatepicker",j).datepicker("hide")}catch(g){}a(j).empty().attr("tabindex","-1");a(b).jqGrid("setCell",b.rows[d].id,c,b.p.savedRow[f].v,!1,!1,!0);a.isFunction(b.p.afterRestoreCell)&&b.p.afterRestoreCell.call(b,b.rows[d].id,b.p.savedRow[f].v,d,c);b.p.savedRow.splice(0,1)}window.setTimeout(function(){a("#"+b.p.knv).attr("tabindex","-1").focus()},
0)}})},nextCell:function(d,c){return this.each(function(){var b=!1;if(this.grid&&!0===this.p.cellEdit){for(var f=c+1;f<this.p.colModel.length;f++)if(!0===this.p.colModel[f].editable){b=f;break}!1!==b?a(this).jqGrid("editCell",d,b,!0):0<this.p.savedRow.length&&a(this).jqGrid("saveCell",d,c)}})},prevCell:function(d,c){return this.each(function(){var b=!1;if(this.grid&&!0===this.p.cellEdit){for(var f=c-1;0<=f;f--)if(!0===this.p.colModel[f].editable){b=f;break}!1!==b?a(this).jqGrid("editCell",d,b,!0):
0<this.p.savedRow.length&&a(this).jqGrid("saveCell",d,c)}})},GridNav:function(){return this.each(function(){function d(c,e,d){if("v"==d.substr(0,1)){var f=a(b.grid.bDiv)[0].clientHeight,g=a(b.grid.bDiv)[0].scrollTop,j=b.rows[c].offsetTop+b.rows[c].clientHeight,l=b.rows[c].offsetTop;"vd"==d&&j>=f&&(a(b.grid.bDiv)[0].scrollTop=a(b.grid.bDiv)[0].scrollTop+b.rows[c].clientHeight);"vu"==d&&l<g&&(a(b.grid.bDiv)[0].scrollTop=a(b.grid.bDiv)[0].scrollTop-b.rows[c].clientHeight)}"h"==d&&(d=a(b.grid.bDiv)[0].clientWidth,
f=a(b.grid.bDiv)[0].scrollLeft,g=b.rows[c].cells[e].offsetLeft,b.rows[c].cells[e].offsetLeft+b.rows[c].cells[e].clientWidth>=d+parseInt(f,10)?a(b.grid.bDiv)[0].scrollLeft=a(b.grid.bDiv)[0].scrollLeft+b.rows[c].cells[e].clientWidth:g<f&&(a(b.grid.bDiv)[0].scrollLeft=a(b.grid.bDiv)[0].scrollLeft-b.rows[c].cells[e].clientWidth))}function c(a,c){var d,f;if("lft"==c){d=a+1;for(f=a;0<=f;f--)if(!0!==b.p.colModel[f].hidden){d=f;break}}if("rgt"==c){d=a-1;for(f=a;f<b.p.colModel.length;f++)if(!0!==b.p.colModel[f].hidden){d=
f;break}}return d}var b=this;if(b.grid&&!0===b.p.cellEdit){b.p.knv=b.p.id+"_kn";var f=a("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+b.p.knv+"'></span></span>"),j,g;a(f).insertBefore(b.grid.cDiv);a("#"+b.p.knv).focus().keydown(function(f){g=f.keyCode;"rtl"==b.p.direction&&(37==g?g=39:39==g&&(g=37));switch(g){case 38:0<b.p.iRow-1&&(d(b.p.iRow-1,b.p.iCol,"vu"),a(b).jqGrid("editCell",b.p.iRow-1,b.p.iCol,
!1));break;case 40:b.p.iRow+1<=b.rows.length-1&&(d(b.p.iRow+1,b.p.iCol,"vd"),a(b).jqGrid("editCell",b.p.iRow+1,b.p.iCol,!1));break;case 37:0<=b.p.iCol-1&&(j=c(b.p.iCol-1,"lft"),d(b.p.iRow,j,"h"),a(b).jqGrid("editCell",b.p.iRow,j,!1));break;case 39:b.p.iCol+1<=b.p.colModel.length-1&&(j=c(b.p.iCol+1,"rgt"),d(b.p.iRow,j,"h"),a(b).jqGrid("editCell",b.p.iRow,j,!1));break;case 13:0<=parseInt(b.p.iCol,10)&&0<=parseInt(b.p.iRow,10)&&a(b).jqGrid("editCell",b.p.iRow,b.p.iCol,!0)}return!1})}})},getChangedCells:function(d){var c=
[];d||(d="all");this.each(function(){var b=this,f;!b.grid||!0!==b.p.cellEdit||a(b.rows).each(function(j){var g={};a(this).hasClass("edited")&&(a("td",this).each(function(c){f=b.p.colModel[c].name;if("cb"!==f&&"subgrid"!==f)if("dirty"==d){if(a(this).hasClass("dirty-cell"))try{g[f]=a.unformat(this,{rowId:b.rows[j].id,colModel:b.p.colModel[c]},c)}catch(e){g[f]=a.jgrid.htmlDecode(a(this).html())}}else try{g[f]=a.unformat(this,{rowId:b.rows[j].id,colModel:b.p.colModel[c]},c)}catch(p){g[f]=a.jgrid.htmlDecode(a(this).html())}}),
g.id=this.id,c.push(g))})});return c}})})(j);(function(a){a.fn.jqm=function(b){var e={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:j,ajaxText:"",target:j,modal:j,toTop:j,onShow:j,onHide:j,onLoad:j};return this.each(function(){if(this._jqm)return c[this._jqm].c=a.extend({},c[this._jqm].c,b);d++;this._jqm=d;c[d]={c:a.extend(e,a.jqm.params,b),a:j,w:a(this).addClass("jqmID"+d),s:d};e.trigger&&a(this).jqmAddTrigger(e.trigger)})};a.fn.jqmAddClose=function(a){return o(this,
a,"jqmHide")};a.fn.jqmAddTrigger=function(a){return o(this,a,"jqmShow")};a.fn.jqmShow=function(b){return this.each(function(){a.jqm.open(this._jqm,b)})};a.fn.jqmHide=function(b){return this.each(function(){a.jqm.close(this._jqm,b)})};a.jqm={hash:{},open:function(d,k){var o=c[d],p=o.c,v="."+p.closeClass,z=parseInt(o.w.css("z-index")),z=0<z?z:3E3,x=a("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":z-1,opacity:p.overlay/100});if(o.a)return j;o.t=k;o.a=!0;o.w.css("z-index",
z);p.modal?(b[0]||setTimeout(function(){e("bind")},1),b.push(d)):0<p.overlay?p.closeoverlay&&o.w.jqmAddClose(x):x=j;o.o=x?x.addClass(p.overlayClass).prependTo("body"):j;if(f&&(a("html,body").css({height:"100%",width:"100%"}),x)){var x=x.css({position:"absolute"})[0],y;for(y in{Top:1,Left:1})x.style.setExpression(y.toLowerCase(),"(_=(document.documentElement.scroll"+y+" || document.body.scroll"+y+"))+'px'")}p.ajax?(z=p.target||o.w,x=p.ajax,z="string"==typeof z?a(z,o.w):a(z),x="@"==x.substr(0,1)?a(k).attr(x.substring(1)):
x,z.html(p.ajaxText).load(x,function(){p.onLoad&&p.onLoad.call(this,o);v&&o.w.jqmAddClose(a(v,o.w));g(o)})):v&&o.w.jqmAddClose(a(v,o.w));p.toTop&&o.o&&o.w.before('<span id="jqmP'+o.w[0]._jqm+'"></span>').insertAfter(o.o);p.onShow?p.onShow(o):o.w.show();g(o);return j},close:function(d){d=c[d];if(!d.a)return j;d.a=j;b[0]&&(b.pop(),b[0]||e("unbind"));d.c.toTop&&d.o&&a("#jqmP"+d.w[0]._jqm).after(d.w).remove();if(d.c.onHide)d.c.onHide(d);else d.w.hide(),d.o&&d.o.remove();return j},params:{}};var d=0,c=
a.jqm.hash,b=[],f=a.browser.msie&&"6.0"==a.browser.version,j=!1,g=function(b){var c=a('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0});f&&(b.o?b.o.html('<p style="width:100%;height:100%"/>').prepend(c):a("iframe.jqm",b.w)[0]||b.w.prepend(c));k(b)},k=function(b){try{a(":input:visible",b.w)[0].focus()}catch(c){}},e=function(b){a(document)[b]("keypress",p)[b]("keydown",p)[b]("mousedown",p)},p=function(e){var d=c[b[b.length-1]];(e=!a(e.target).parents(".jqmID"+
d.s)[0])&&k(d);return!e},o=function(b,e,d){return b.each(function(){var b=this._jqm;a(e).each(function(){this[d]||(this[d]=[],a(this).click(function(){for(var a in{jqmShow:1,jqmHide:1})for(var b in this[a])if(c[this[a][b]])c[this[a][b]].w[a](this);return j}));this[d].push(b)})})}})(j);(function(a){a.fn.jqDrag=function(a){return j(this,a,"d")};a.fn.jqResize=function(a,b){return j(this,a,"r",b)};a.jqDnR={dnr:{},e:0,drag:function(a){"d"==c.k?b.css({left:c.X+a.pageX-c.pX,top:c.Y+a.pageY-c.pY}):(b.css({width:Math.max(a.pageX-
c.pX+c.W,0),height:Math.max(a.pageY-c.pY+c.H,0)}),M1&&f.css({width:Math.max(a.pageX-M1.pX+M1.W,0),height:Math.max(a.pageY-M1.pY+M1.H,0)}));return!1},stop:function(){a(document).unbind("mousemove",d.drag).unbind("mouseup",d.stop)}};var d=a.jqDnR,c=d.dnr,b=d.e,f,j=function(d,e,j,m){return d.each(function(){e=e?a(e,d):d;e.bind("mousedown",{e:d,k:j},function(e){var d=e.data,k={};b=d.e;f=m?a(m):!1;if("relative"!=b.css("position"))try{b.position(k)}catch(j){}c={X:k.left||g("left")||0,Y:k.top||g("top")||
0,W:g("width")||b[0].scrollWidth||0,H:g("height")||b[0].scrollHeight||0,pX:e.pageX,pY:e.pageY,k:d.k};M1=f&&"d"!=d.k?{X:k.left||f1("left")||0,Y:k.top||f1("top")||0,W:f[0].offsetWidth||f1("width")||0,H:f[0].offsetHeight||f1("height")||0,pX:e.pageX,pY:e.pageY,k:d.k}:!1;if(a("input.hasDatepicker",b[0])[0])try{a("input.hasDatepicker",b[0]).datepicker("hide")}catch(p){}a(document).mousemove(a.jqDnR.drag).mouseup(a.jqDnR.stop);return!1})})},g=function(a){return parseInt(b.css(a))||!1};f1=function(a){return parseInt(f.css(a))||
!1}})(j);(function(a){a.jgrid.extend({setSubGrid:function(){return this.each(function(){var d;this.p.subGridOptions=a.extend({plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:"ui-icon-carat-1-sw",expandOnLoad:!1,delayOnLoad:50,selectOnExpand:!1,reloadOnExpand:!0},this.p.subGridOptions||{});this.p.colNames.unshift("");this.p.colModel.unshift({name:"subgrid",width:a.browser.safari?this.p.subGridWidth+this.p.cellLayout:this.p.subGridWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,fixed:!0});
d=this.p.subGridModel;if(d[0]){d[0].align=a.extend([],d[0].align||[]);for(var c=0;c<d[0].name.length;c++)d[0].align[c]=d[0].align[c]||"left"}})},addSubGridCell:function(a,c){var b="",f,j;this.each(function(){b=this.formatCol(a,c);j=this.p.id;f=this.p.subGridOptions.plusicon});return'<td role="grid" aria-describedby="'+j+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+b+"><a href='javascript:void(0);'><span class='ui-icon "+f+"'></span></a></td>"},addSubGrid:function(d){return this.each(function(){var c=
this;if(c.grid){var b=function(b,e,d){e=a("<td align='"+c.p.subGridModel[0].align[d]+"'></td>").html(e);a(b).append(e)},f=function(e,d){var f,g,k,j=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),l=a("<tr></tr>");for(g=0;g<c.p.subGridModel[0].name.length;g++)f=a("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+c.p.direction+"'></th>"),a(f).html(c.p.subGridModel[0].name[g]),a(f).width(c.p.subGridModel[0].width[g]),a(l).append(f);a(j).append(l);e&&(k=c.p.xmlReader.subgrid,
a(k.root+" "+k.row,e).each(function(){l=a("<tr class='ui-widget-content ui-subtblcell'></tr>");if(!0===k.repeatitems)a(k.cell,this).each(function(c){b(l,a(this).text()||"&#160;",c)});else{var e=c.p.subGridModel[0].mapping||c.p.subGridModel[0].name;if(e)for(g=0;g<e.length;g++)b(l,a(e[g],this).text()||"&#160;",g)}a(j).append(l)}));f=a("table:first",c.grid.bDiv).attr("id")+"_";a("#"+f+d).append(j);c.grid.hDiv.loading=!1;a("#load_"+c.p.id).hide();return!1},j=function(e,d){var f,g,k,j,l,m=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),
o=a("<tr></tr>");for(g=0;g<c.p.subGridModel[0].name.length;g++)f=a("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+c.p.direction+"'></th>"),a(f).html(c.p.subGridModel[0].name[g]),a(f).width(c.p.subGridModel[0].width[g]),a(o).append(f);a(m).append(o);if(e&&(j=c.p.jsonReader.subgrid,f=e[j.root],"undefined"!==typeof f))for(g=0;g<f.length;g++){k=f[g];o=a("<tr class='ui-widget-content ui-subtblcell'></tr>");if(!0===j.repeatitems){j.cell&&(k=k[j.cell]);for(l=0;l<k.length;l++)b(o,k[l]||"&#160;",
l)}else{var p=c.p.subGridModel[0].mapping||c.p.subGridModel[0].name;if(p.length)for(l=0;l<p.length;l++)b(o,k[p[l]]||"&#160;",l)}a(m).append(o)}g=a("table:first",c.grid.bDiv).attr("id")+"_";a("#"+g+d).append(m);c.grid.hDiv.loading=!1;a("#load_"+c.p.id).hide();return!1},g=function(b){var e,d,g,k;e=a(b).attr("id");d={nd_:(new Date).getTime()};d[c.p.prmNames.subgridid]=e;if(!c.p.subGridModel[0])return!1;if(c.p.subGridModel[0].params)for(k=0;k<c.p.subGridModel[0].params.length;k++)for(g=0;g<c.p.colModel.length;g++)c.p.colModel[g].name==
c.p.subGridModel[0].params[k]&&(d[c.p.colModel[g].name]=a("td:eq("+g+")",b).text().replace(/\&#160\;/ig,""));if(!c.grid.hDiv.loading)switch(c.grid.hDiv.loading=!0,a("#load_"+c.p.id).show(),c.p.subgridtype||(c.p.subgridtype=c.p.datatype),a.isFunction(c.p.subgridtype)?c.p.subgridtype.call(c,d):c.p.subgridtype=c.p.subgridtype.toLowerCase(),c.p.subgridtype){case "xml":case "json":a.ajax(a.extend({type:c.p.mtype,url:c.p.subGridUrl,dataType:c.p.subgridtype,data:a.isFunction(c.p.serializeSubGridData)?c.p.serializeSubGridData.call(c,
d):d,complete:function(b){c.p.subgridtype=="xml"?f(b.responseXML,e):j(a.jgrid.parse(b.responseText),e)}},a.jgrid.ajaxOptions,c.p.ajaxSubgridOptions||{}))}return!1},k,e,p,o=0,r,q;a.each(c.p.colModel,function(){(!0===this.hidden||"rn"==this.name||"cb"==this.name)&&o++});a(c.rows).each(function(b){var f=this;a(f).hasClass("jqgrow")&&(a(this.cells[d]).bind("click",function(){q=f.nextSibling;if(a(this).hasClass("sgcollapsed")){e=c.p.id;k=f.id;if(!0===c.p.subGridOptions.reloadOnExpand||!1===c.p.subGridOptions.reloadOnExpand&&
!a(q).hasClass("ui-subgrid")){p=1<=d?"<td colspan='"+d+"'>&#160;</td>":"";r=!0;a.isFunction(c.p.subGridBeforeExpand)&&(r=c.p.subGridBeforeExpand.call(c,e+"_"+k,k));if(!1===r)return!1;a(f).after("<tr role='row' class='ui-subgrid'>"+p+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon "+c.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(c.p.colNames.length-1-o,10)+"' class='ui-widget-content subgrid-data'><div id="+e+"_"+k+" class='tablediv'></div></td></tr>");a.isFunction(c.p.subGridRowExpanded)?
c.p.subGridRowExpanded.call(c,e+"_"+k,k):g(f)}else a(q).show();a(this).html("<a href='javascript:void(0);'><span class='ui-icon "+c.p.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded");c.p.subGridOptions.selectOnExpand&&a(c).jqGrid("setSelection",k)}else if(a(this).hasClass("sgexpanded")){r=!0;a.isFunction(c.p.subGridRowColapsed)&&(k=f.id,r=c.p.subGridRowColapsed.call(c,e+"_"+k,k));if(!1===r)return!1;!0===c.p.subGridOptions.reloadOnExpand?a(q).remove(".ui-subgrid"):
a(q).hasClass("ui-subgrid")&&a(q).hide();a(this).html("<a href='javascript:void(0);'><span class='ui-icon "+c.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed")}return!1}),!0===c.p.subGridOptions.expandOnLoad&&setTimeout(function(){a(f.cells[d]).trigger("click")},b*c.p.subGridOptions.delayOnLoad))});c.subGridXml=function(a,b){f(a,b)};c.subGridJson=function(a,b){j(a,b)}}})},expandSubGridRow:function(d){return this.each(function(){if((this.grid||d)&&!0===this.p.subGrid){var c=
a(this).jqGrid("getInd",d,!0);c&&(c=a("td.sgcollapsed",c)[0])&&a(c).trigger("click")}})},collapseSubGridRow:function(d){return this.each(function(){if((this.grid||d)&&!0===this.p.subGrid){var c=a(this).jqGrid("getInd",d,!0);c&&(c=a("td.sgexpanded",c)[0])&&a(c).trigger("click")}})},toggleSubGridRow:function(d){return this.each(function(){if((this.grid||d)&&!0===this.p.subGrid){var c=a(this).jqGrid("getInd",d,!0);if(c){var b=a("td.sgcollapsed",c)[0];b?a(b).trigger("click"):(b=a("td.sgexpanded",c)[0])&&
a(b).trigger("click")}}})}})})(j);(function(a){a.jgrid.extend({groupingSetup:function(){return this.each(function(){var d=this.p.groupingView;if(null!==d&&("object"===typeof d||a.isFunction(d)))if(d.groupField.length){"undefined"==typeof d.visibiltyOnNextGrouping&&(d.visibiltyOnNextGrouping=[]);for(var c=0;c<d.groupField.length;c++)if(d.groupOrder[c]||(d.groupOrder[c]="asc"),d.groupText[c]||(d.groupText[c]="{0}"),"boolean"!=typeof d.groupColumnShow[c]&&(d.groupColumnShow[c]=!0),"boolean"!=typeof d.groupSummary[c]&&
(d.groupSummary[c]=!1),!0===d.groupColumnShow[c]?(d.visibiltyOnNextGrouping[c]=!0,a(this).jqGrid("showCol",d.groupField[c])):(d.visibiltyOnNextGrouping[c]=a("#"+this.p.id+"_"+d.groupField[c]).is(":visible"),a(this).jqGrid("hideCol",d.groupField[c])),d.sortitems[c]=[],d.sortnames[c]=[],d.summaryval[c]=[],d.groupSummary[c]){d.summary[c]=[];for(var b=this.p.colModel,f=0,j=b.length;f<j;f++)b[f].summaryType&&d.summary[c].push({nm:b[f].name,st:b[f].summaryType,v:""})}this.p.scroll=!1;this.p.rownumbers=
!1;this.p.subGrid=!1;this.p.treeGrid=!1;this.p.gridview=!0}else this.p.grouping=!1;else this.p.grouping=!1})},groupingPrepare:function(d,c,b,f){this.each(function(){c[0]+="";var j=c[0].toString().split(" ").join(""),g=this.p.groupingView,k=this;b.hasOwnProperty(j)?b[j].push(d):(b[j]=[],b[j].push(d),g.sortitems[0].push(j),g.sortnames[0].push(a.trim(c[0].toString())),g.summaryval[0][j]=a.extend(!0,[],g.summary[0]));g.groupSummary[0]&&a.each(g.summaryval[0][j],function(){this.v=a.isFunction(this.st)?
this.st.call(k,this.v,this.nm,f):a(k).jqGrid("groupingCalculations."+this.st,this.v,this.nm,f)})});return b},groupingToggle:function(d){this.each(function(){var c=this.p.groupingView,b=d.lastIndexOf("_"),f=d.substring(0,b+1),b=parseInt(d.substring(b+1),10)+1,j=c.minusicon,g=c.plusicon,k=a("#"+d)[0].nextSibling,e=a("#"+d+" span.tree-wrap-"+this.p.direction),p=!1;if(e.hasClass(j)){if(c.showSummaryOnHide&&c.groupSummary[0]){if(k)for(;k&&!a(k).hasClass("jqfoot");)a(k).hide(),k=k.nextSibling}else if(k)for(;k&&
a(k).attr("id")!=f+(""+b);)a(k).hide(),k=k.nextSibling;e.removeClass(j).addClass(g);p=!0}else{if(k)for(;k&&a(k).attr("id")!=f+(""+b);)a(k).show(),k=k.nextSibling;e.removeClass(g).addClass(j);p=!1}a.isFunction(this.p.onClickGroup)&&this.p.onClickGroup.call(this,d,p)});return!1},groupingRender:function(d,c){return this.each(function(){var b=this,f=b.p.groupingView,j="",g="",k,e="",p,o,r;f.groupDataSorted||(f.sortitems[0].sort(),f.sortnames[0].sort(),"desc"==f.groupOrder[0].toLowerCase()&&(f.sortitems[0].reverse(),
f.sortnames[0].reverse()));e=f.groupCollapse?f.plusicon:f.minusicon;e+=" tree-wrap-"+b.p.direction;for(r=0;r<c;){if(b.p.colModel[r].name==f.groupField[0]){o=r;break}r++}a.each(f.sortitems[0],function(q,r){k=b.p.id+"ghead_"+q;g="<span style='cursor:pointer;' class='ui-icon "+e+"' onclick=\"jQuery('#"+b.p.id+"').jqGrid('groupingToggle','"+k+"');return false;\"></span>";try{p=b.formatter(k,f.sortnames[0][q],o,f.sortitems[0])}catch(t){p=f.sortnames[0][q]}j=j+('<tr id="'+k+'" role="row" class= "ui-widget-content jqgroup ui-row-'+
b.p.direction+'"><td colspan="'+c+'">'+g+a.jgrid.format(f.groupText[0],p,d[r].length)+"</td></tr>");for(var v=0;v<d[r].length;v++)j=j+d[r][v].join("");if(f.groupSummary[0]){v="";f.groupCollapse&&!f.showSummaryOnHide&&(v=' style="display:none;"');j=j+("<tr"+v+' role="row" class="ui-widget-content jqfoot ui-row-'+b.p.direction+'">');for(var v=f.summaryval[0][r],z=b.p.colModel,x,y=d[r].length,B=0;B<c;B++){var A="<td "+b.formatCol(B,1,"")+">&#160;</td>",F="{0}";a.each(v,function(){if(this.nm==z[B].name){if(z[B].summaryTpl)F=
z[B].summaryTpl;if(this.st=="avg"&&this.v&&y>0)this.v=this.v/y;try{x=b.formatter("",this.v,B,this)}catch(c){x=this.v}A="<td "+b.formatCol(B,1,"")+">"+a.jgrid.format(F,x)+"</td>";return false}});j=j+A}j=j+"</tr>"}});a("#"+b.p.id+" tbody:first").append(j);j=null})},groupingGroupBy:function(d,c){return this.each(function(){"string"==typeof d&&(d=[d]);var b=this.p.groupingView;this.p.grouping=!0;for(var f=0;f<b.groupField.length;f++)!b.groupColumnShow[f]&&b.visibiltyOnNextGrouping[f]&&a(this).jqGrid("showCol",
b.groupField[f]);for(f=0;f<d.length;f++)b.visibiltyOnNextGrouping[f]=a("#"+this.p.id+"_"+d[f]).is(":visible");this.p.groupingView=a.extend(this.p.groupingView,c||{});b.groupField=d;a(this).trigger("reloadGrid")})},groupingRemove:function(d){return this.each(function(){"undefined"==typeof d&&(d=!0);this.p.grouping=!1;if(!0===d){for(var c=this.p.groupingView,b=0;b<c.groupField.length;b++)!c.groupColumnShow[b]&&c.visibiltyOnNextGrouping[b]&&a(this).jqGrid("showCol",c.groupField);a("tr.jqgroup, tr.jqfoot",
"#"+this.p.id+" tbody:first").remove();a("tr.jqgrow:hidden","#"+this.p.id+" tbody:first").show()}else a(this).trigger("reloadGrid")})},groupingCalculations:{sum:function(a,c,b){return parseFloat(a||0)+parseFloat(b[c]||0)},min:function(a,c,b){return""===a?parseFloat(b[c]||0):Math.min(parseFloat(a),parseFloat(b[c]||0))},max:function(a,c,b){return""===a?parseFloat(b[c]||0):Math.max(parseFloat(a),parseFloat(b[c]||0))},count:function(a,c,b){""===a&&(a=0);return b.hasOwnProperty(c)?a+1:0},avg:function(a,
c,b){return parseFloat(a||0)+parseFloat(b[c]||0)}}})})(j);(function(a){a.jgrid.extend({setTreeNode:function(d,c){return this.each(function(){var b=this;if(b.grid&&b.p.treeGrid)for(var f=b.p.expColInd,j=b.p.treeReader.expanded_field,g=b.p.treeReader.leaf_field,k=b.p.treeReader.level_field,e=b.p.treeReader.icon_field,p=b.p.treeReader.loaded,o,r,q,u;d<c;)u=b.p.data[b.p._index[b.rows[d].id]],"nested"==b.p.treeGridModel&&!u[g]&&(o=parseInt(u[b.p.treeReader.left_field],10),r=parseInt(u[b.p.treeReader.right_field],
10),u[g]=r===o+1?"true":"false",b.rows[d].cells[b.p._treeleafpos].innerHTML=u[g]),o=parseInt(u[k],10),0===b.p.tree_root_level?(q=o+1,r=o):(q=o,r=o-1),q="<div class='tree-wrap tree-wrap-"+b.p.direction+"' style='width:"+18*q+"px;'>",q+="<div style='"+("rtl"==b.p.direction?"right:":"left:")+18*r+"px;' class='ui-icon ",void 0!==u[p]&&(u[p]="true"==u[p]||!0===u[p]?!0:!1),"true"==u[g]||!0===u[g]?(q+=(void 0!==u[e]&&""!==u[e]?u[e]:b.p.treeIcons.leaf)+" tree-leaf treeclick'",u[g]=!0,r="leaf"):(u[g]=!1,r=
""),u[j]=("true"==u[j]||!0===u[j]?!0:!1)&&u[p],q+=!0===u[j]?b.p.treeIcons.minus+" tree-minus treeclick'":b.p.treeIcons.plus+" tree-plus treeclick'",q+="</div></div>",a(b.rows[d].cells[f]).wrapInner("<span class='cell-wrapper"+r+"'></span>").prepend(q),o!==parseInt(b.p.tree_root_level,10)&&((u=(u=a(b).jqGrid("getNodeParent",u))&&u.hasOwnProperty(j)?u[j]:!0)||a(b.rows[d]).css("display","none")),a(b.rows[d].cells[f]).find("div.treeclick").bind("click",function(c){c=a(c.target||c.srcElement,b.rows).closest("tr.jqgrow")[0].id;
c=b.p._index[c];if(!b.p.data[c][g])if(b.p.data[c][j]){a(b).jqGrid("collapseRow",b.p.data[c]);a(b).jqGrid("collapseNode",b.p.data[c])}else{a(b).jqGrid("expandRow",b.p.data[c]);a(b).jqGrid("expandNode",b.p.data[c])}return false}),!0===b.p.ExpandColClick&&a(b.rows[d].cells[f]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(c){var c=a(c.target||c.srcElement,b.rows).closest("tr.jqgrow")[0].id,e=b.p._index[c];if(!b.p.data[e][g])if(b.p.data[e][j]){a(b).jqGrid("collapseRow",b.p.data[e]);
a(b).jqGrid("collapseNode",b.p.data[e])}else{a(b).jqGrid("expandRow",b.p.data[e]);a(b).jqGrid("expandNode",b.p.data[e])}a(b).jqGrid("setSelection",c);return false}),d++})},setTreeGrid:function(){return this.each(function(){var d=this,c=0,b=!1,f,j,g=[];if(d.p.treeGrid){d.p.treedatatype||a.extend(d.p,{treedatatype:d.p.datatype});d.p.subGrid=!1;d.p.altRows=!1;d.p.pgbuttons=!1;d.p.pginput=!1;d.p.gridview=!0;d.p.multiselect=!1;d.p.rowList=[];d.p.expColInd=0;d.p.treeIcons=a.extend({plus:"ui-icon-triangle-1-"+
("rtl"==d.p.direction?"w":"e"),minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},d.p.treeIcons||{});"nested"==d.p.treeGridModel?d.p.treeReader=a.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},d.p.treeReader):"adjacency"==d.p.treeGridModel&&(d.p.treeReader=a.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},d.p.treeReader));
for(j in d.p.colModel)if(d.p.colModel.hasOwnProperty(j)){f=d.p.colModel[j].name;f==d.p.ExpandColumn&&!b&&(b=!0,d.p.expColInd=c);c++;for(var k in d.p.treeReader)d.p.treeReader[k]==f&&g.push(f)}a.each(d.p.treeReader,function(b,f){if(f&&a.inArray(f,g)===-1){if(b==="leaf_field")d.p._treeleafpos=c;c++;d.p.colNames.push(f);d.p.colModel.push({name:f,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})}})},expandRow:function(d){this.each(function(){var c=this;if(c.grid&&
c.p.treeGrid){var b=a(c).jqGrid("getNodeChildren",d),f=c.p.treeReader.expanded_field;a(b).each(function(){var b=a.jgrid.getAccessor(this,c.p.localReader.id);a("#"+b,c.grid.bDiv).css("display","");this[f]&&a(c).jqGrid("expandRow",this)})}})},collapseRow:function(d){this.each(function(){var c=this;if(c.grid&&c.p.treeGrid){var b=a(c).jqGrid("getNodeChildren",d),f=c.p.treeReader.expanded_field;a(b).each(function(){var b=a.jgrid.getAccessor(this,c.p.localReader.id);a("#"+b,c.grid.bDiv).css("display","none");
this[f]&&a(c).jqGrid("collapseRow",this)})}})},getRootNodes:function(){var d=[];this.each(function(){var c=this;if(c.grid&&c.p.treeGrid)switch(c.p.treeGridModel){case "nested":var b=c.p.treeReader.level_field;a(c.p.data).each(function(){parseInt(this[b],10)===parseInt(c.p.tree_root_level,10)&&d.push(this)});break;case "adjacency":var f=c.p.treeReader.parent_id_field;a(c.p.data).each(function(){(null===this[f]||"null"==(""+this[f]).toLowerCase())&&d.push(this)})}});return d},getNodeDepth:function(d){var c=
null;this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":c=parseInt(d[this.p.treeReader.level_field],10)-parseInt(this.p.tree_root_level,10);break;case "adjacency":c=a(this).jqGrid("getNodeAncestors",d).length}});return c},getNodeParent:function(d){var c=null;this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":var b=this.p.treeReader.left_field,f=this.p.treeReader.right_field,j=this.p.treeReader.level_field,g=parseInt(d[b],
10),k=parseInt(d[f],10),e=parseInt(d[j],10);a(this.p.data).each(function(){if(parseInt(this[j],10)===e-1&&parseInt(this[b],10)<g&&parseInt(this[f],10)>k)return c=this,!1});break;case "adjacency":var p=this.p.treeReader.parent_id_field,o=this.p.localReader.id;a(this.p.data).each(function(){if(this[o]==d[p])return c=this,!1})}});return c},getNodeChildren:function(d){var c=[];this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":var b=this.p.treeReader.left_field,
f=this.p.treeReader.right_field,j=this.p.treeReader.level_field,g=parseInt(d[b],10),k=parseInt(d[f],10),e=parseInt(d[j],10);a(this.p.data).each(function(){parseInt(this[j],10)===e+1&&parseInt(this[b],10)>g&&parseInt(this[f],10)<k&&c.push(this)});break;case "adjacency":var p=this.p.treeReader.parent_id_field,o=this.p.localReader.id;a(this.p.data).each(function(){this[p]==d[o]&&c.push(this)})}});return c},getFullTreeNode:function(d){var c=[];this.each(function(){var b;if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":var f=
this.p.treeReader.left_field,j=this.p.treeReader.right_field,g=this.p.treeReader.level_field,k=parseInt(d[f],10),e=parseInt(d[j],10),p=parseInt(d[g],10);a(this.p.data).each(function(){parseInt(this[g],10)>=p&&parseInt(this[f],10)>=k&&parseInt(this[f],10)<=e&&c.push(this)});break;case "adjacency":if(d){c.push(d);var o=this.p.treeReader.parent_id_field,r=this.p.localReader.id;a(this.p.data).each(function(a){b=c.length;for(a=0;a<b;a++)if(c[a][r]==this[o]){c.push(this);break}})}}});return c},getNodeAncestors:function(d){var c=
[];this.each(function(){if(this.grid&&this.p.treeGrid)for(var b=a(this).jqGrid("getNodeParent",d);b;)c.push(b),b=a(this).jqGrid("getNodeParent",b)});return c},isVisibleNode:function(d){var c=!0;this.each(function(){if(this.grid&&this.p.treeGrid){var b=a(this).jqGrid("getNodeAncestors",d),f=this.p.treeReader.expanded_field;a(b).each(function(){c=c&&this[f];if(!c)return!1})}});return c},isNodeLoaded:function(d){var c;this.each(function(){if(this.grid&&this.p.treeGrid){var b=this.p.treeReader.leaf_field;
c=void 0!==d?void 0!==d.loaded?d.loaded:d[b]||0<a(this).jqGrid("getNodeChildren",d).length?!0:!1:!1}});return c},expandNode:function(d){return this.each(function(){if(this.grid&&this.p.treeGrid){var c=this.p.treeReader.expanded_field,b=this.p.treeReader.parent_id_field,f=this.p.treeReader.loaded,j=this.p.treeReader.level_field,g=this.p.treeReader.left_field,k=this.p.treeReader.right_field;if(!d[c]){var e=a.jgrid.getAccessor(d,this.p.localReader.id),p=a("#"+e,this.grid.bDiv)[0],o=this.p._index[e];
a(this).jqGrid("isNodeLoaded",this.p.data[o])?(d[c]=!0,a("div.treeclick",p).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")):(d[c]=!0,a("div.treeclick",p).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus"),this.p.treeANode=p.rowIndex,this.p.datatype=this.p.treedatatype,"nested"==this.p.treeGridModel?a(this).jqGrid("setGridParam",{postData:{nodeid:e,n_left:d[g],n_right:d[k],n_level:d[j]}}):a(this).jqGrid("setGridParam",
{postData:{nodeid:e,parentid:d[b],n_level:d[j]}}),a(this).trigger("reloadGrid"),d[f]=!0,"nested"==this.p.treeGridModel?a(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):a(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}}))}}})},collapseNode:function(d){return this.each(function(){if(this.grid&&this.p.treeGrid&&d.expanded){d.expanded=!1;var c=a.jgrid.getAccessor(d,this.p.localReader.id),c=a("#"+c,this.grid.bDiv)[0];a("div.treeclick",c).removeClass(this.p.treeIcons.minus+
" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}})},SortTree:function(d,c,b,f){return this.each(function(){if(this.grid&&this.p.treeGrid){var j,g,k,e=[],p=this,o;j=a(this).jqGrid("getRootNodes");j=a.jgrid.from(j);j.orderBy(d,c,b,f);o=j.select();j=0;for(g=o.length;j<g;j++)k=o[j],e.push(k),a(this).jqGrid("collectChildrenSortTree",e,k,d,c,b,f);a.each(e,function(b){var c=a.jgrid.getAccessor(this,p.p.localReader.id);a("#"+p.p.id+" tbody tr:eq("+b+")").after(a("tr#"+c,p.grid.bDiv))});e=o=j=
null}})},collectChildrenSortTree:function(d,c,b,f,j,g){return this.each(function(){if(this.grid&&this.p.treeGrid){var k,e,p,o;k=a(this).jqGrid("getNodeChildren",c);k=a.jgrid.from(k);k.orderBy(b,f,j,g);o=k.select();k=0;for(e=o.length;k<e;k++)p=o[k],d.push(p),a(this).jqGrid("collectChildrenSortTree",d,p,b,f,j,g)}})},setTreeRow:function(d,c){var b=!1;this.each(function(){this.grid&&this.p.treeGrid&&(b=a(this).jqGrid("setRowData",d,c))});return b},delTreeNode:function(d){return this.each(function(){var c=
this.p.localReader.id,b=this.p.treeReader.left_field,f=this.p.treeReader.right_field,j,g,k;if(this.grid&&this.p.treeGrid){var e=this.p._index[d];if(void 0!==e){j=parseInt(this.p.data[e][f],10);g=j-parseInt(this.p.data[e][b],10)+1;e=a(this).jqGrid("getFullTreeNode",this.p.data[e]);if(0<e.length)for(var p=0;p<e.length;p++)a(this).jqGrid("delRowData",e[p][c]);if("nested"===this.p.treeGridModel){c=a.jgrid.from(this.p.data).greater(b,j,{stype:"integer"}).select();if(c.length)for(k in c)c[k][b]=parseInt(c[k][b],
10)-g;c=a.jgrid.from(this.p.data).greater(f,j,{stype:"integer"}).select();if(c.length)for(k in c)c[k][f]=parseInt(c[k][f],10)-g}}}})},addChildNode:function(d,c,b){var f=this[0];if(b){var j=f.p.treeReader.expanded_field,g=f.p.treeReader.leaf_field,k=f.p.treeReader.level_field,e=f.p.treeReader.parent_id_field,p=f.p.treeReader.left_field,o=f.p.treeReader.right_field,r=f.p.treeReader.loaded,q,u,t,v,z;q=0;var x=c,y;if(!d){z=f.p.data.length-1;if(0<=z)for(;0<=z;)q=Math.max(q,parseInt(f.p.data[z][f.p.localReader.id],
10)),z--;d=q+1}var B=a(f).jqGrid("getInd",c);y=!1;if(void 0===c||null===c||""===c)x=c=null,q="last",v=f.p.tree_root_level,z=f.p.data.length+1;else if(q="after",u=f.p._index[c],t=f.p.data[u],c=t[f.p.localReader.id],v=parseInt(t[k],10)+1,z=a(f).jqGrid("getFullTreeNode",t),z.length?(x=z[z.length-1][f.p.localReader.id],z=a(f).jqGrid("getInd",x)+1):z=a(f).jqGrid("getInd",c)+1,t[g])y=!0,t[j]=!0,a(f.rows[B]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(f.p.treeIcons.leaf+
" tree-leaf").addClass(f.p.treeIcons.minus+" tree-minus"),f.p.data[u][g]=!1,t[r]=!0;u=z+1;b[j]=!1;b[r]=!0;b[k]=v;b[g]=!0;"adjacency"===f.p.treeGridModel&&(b[e]=c);if("nested"===f.p.treeGridModel){var A;if(null!==c){g=parseInt(t[o],10);k=a.jgrid.from(f.p.data);k=k.greaterOrEquals(o,g,{stype:"integer"});k=k.select();if(k.length)for(A in k)k[A][p]=k[A][p]>g?parseInt(k[A][p],10)+2:k[A][p],k[A][o]=k[A][o]>=g?parseInt(k[A][o],10)+2:k[A][o];b[p]=g;b[o]=g+1}else{g=parseInt(a(f).jqGrid("getCol",o,!1,"max"),
10);k=a.jgrid.from(f.p.data).greater(p,g,{stype:"integer"}).select();if(k.length)for(A in k)k[A][p]=parseInt(k[A][p],10)+2;k=a.jgrid.from(f.p.data).greater(o,g,{stype:"integer"}).select();if(k.length)for(A in k)k[A][o]=parseInt(k[A][o],10)+2;b[p]=g+1;b[o]=g+2}}if(null===c||a(f).jqGrid("isNodeLoaded",t)||y)a(f).jqGrid("addRowData",d,b,q,x),a(f).jqGrid("setTreeNode",z,u);t&&!t[j]&&a(f.rows[B]).find("div.treeclick").click()}}})})(j);(function(a){a.jgrid.extend({jqGridImport:function(d){d=a.extend({imptype:"xml",
impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},d||{});return this.each(function(){var c=this,b=function(b,d){var e=a(d.xmlGrid.config,b)[0],j=a(d.xmlGrid.data,b)[0],l;if(f.xml2json&&a.jgrid.parse){var e=f.xml2json(e," "),e=a.jgrid.parse(e),m;for(m in e)e.hasOwnProperty(m)&&(l=e[m]);j?(j=e.grid.datatype,e.grid.datatype="xmlstring",e.grid.datastr=b,a(c).jqGrid(l).jqGrid("setGridParam",{datatype:j})):
a(c).jqGrid(l)}else alert("xml2json or parse are not present")},j=function(b,d){if(b&&"string"==typeof b){var e=a.jgrid.parse(b),f=e[d.jsonGrid.config];if(e=e[d.jsonGrid.data]){var j=f.datatype;f.datatype="jsonstring";f.datastr=e;a(c).jqGrid(f).jqGrid("setGridParam",{datatype:j})}else a(c).jqGrid(f)}};switch(d.imptype){case "xml":a.ajax(a.extend({url:d.impurl,type:d.mtype,data:d.impData,dataType:"xml",complete:function(c,f){"success"==f&&(b(c.responseXML,d),a.isFunction(d.importComplete)&&d.importComplete(c))}},
d.ajaxOptions));break;case "xmlstring":if(d.impstring&&"string"==typeof d.impstring){var m=a.jgrid.stringToDoc(d.impstring);m&&(b(m,d),a.isFunction(d.importComplete)&&d.importComplete(m),d.impstring=null);m=null}break;case "json":a.ajax(a.extend({url:d.impurl,type:d.mtype,data:d.impData,dataType:"json",complete:function(b,c){"success"==c&&(j(b.responseText,d),a.isFunction(d.importComplete)&&d.importComplete(b))}},d.ajaxOptions));break;case "jsonstring":d.impstring&&"string"==typeof d.impstring&&(j(d.impstring,
d),a.isFunction(d.importComplete)&&d.importComplete(d.impstring),d.impstring=null)}})},jqGridExport:function(d){var d=a.extend({exptype:"xmlstring",root:"grid",ident:"\t"},d||{}),c=null;this.each(function(){if(this.grid){var b=a.extend({},a(this).jqGrid("getGridParam"));b.rownumbers&&(b.colNames.splice(0,1),b.colModel.splice(0,1));b.multiselect&&(b.colNames.splice(0,1),b.colModel.splice(0,1));b.subGrid&&(b.colNames.splice(0,1),b.colModel.splice(0,1));b.knv=null;if(b.treeGrid)for(var j in b.treeReader)b.treeReader.hasOwnProperty(j)&&
(b.colNames.splice(b.colNames.length-1),b.colModel.splice(b.colModel.length-1));switch(d.exptype){case "xmlstring":c="<"+d.root+">"+f.json2xml(b,d.ident)+"</"+d.root+">";break;case "jsonstring":c="{"+f.toJson(b,d.root,d.ident)+"}",void 0!==b.postData.filters&&(c=c.replace(/filters":"/,'filters":'),c=c.replace(/}]}"/,"}]}"))}}});return c},excelExport:function(d){d=a.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},d||{});return this.each(function(){if(this.grid){var c;"remote"==
d.exptype&&(c=a.extend({},this.p.postData),c[d.oper]=d.tag,c=j.param(c),c=-1!=d.url.indexOf("?")?d.url+"&"+c:d.url+"?"+c,window.location=c)}})}})})(j);var f={xml2json:function(a,d){9===a.nodeType&&(a=a.documentElement);var c=this.toJson(this.toObj(this.removeWhite(a)),a.nodeName,"\t");return"{\n"+d+(d?c.replace(/\t/g,d):c.replace(/\t|\n/g,""))+"\n}"},json2xml:function(a,d){var c=function(a,b,d){var e="",f,j;if(a instanceof Array)if(0===a.length)e+=d+"<"+b+">__EMPTY_ARRAY_</"+b+">\n";else{f=0;for(j=
a.length;f<j;f+=1)var l=d+c(a[f],b,d+"\t")+"\n",e=e+l}else if("object"===typeof a){f=!1;e+=d+"<"+b;for(j in a)a.hasOwnProperty(j)&&("@"===j.charAt(0)?e+=" "+j.substr(1)+'="'+a[j].toString()+'"':f=!0);e+=f?">":"/>";if(f){for(j in a)a.hasOwnProperty(j)&&("#text"===j?e+=a[j]:"#cdata"===j?e+="<![CDATA["+a[j]+"]]\>":"@"!==j.charAt(0)&&(e+=c(a[j],j,d+"\t")));e+=("\n"===e.charAt(e.length-1)?d:"")+"</"+b+">"}}else e+="function"===typeof a?d+"<"+b+"><![CDATA["+a+"]]\></"+b+">":'""'===a.toString()||0===a.toString().length?
d+"<"+b+">__EMPTY_STRING_</"+b+">":d+"<"+b+">"+a.toString()+"</"+b+">";return e},b="",f;for(f in a)a.hasOwnProperty(f)&&(b+=c(a[f],f,""));return d?b.replace(/\t/g,d):b.replace(/\t|\n/g,"")},toObj:function(a){var d={},c=/function/i;if(1===a.nodeType){if(a.attributes.length){var b;for(b=0;b<a.attributes.length;b+=1)d["@"+a.attributes[b].nodeName]=(a.attributes[b].nodeValue||"").toString()}if(a.firstChild){var f=b=0,j=!1,g;for(g=a.firstChild;g;g=g.nextSibling)1===g.nodeType?j=!0:3===g.nodeType&&g.nodeValue.match(/[^ \f\n\r\t\v]/)?
b+=1:4===g.nodeType&&(f+=1);if(j)if(2>b&&2>f){this.removeWhite(a);for(g=a.firstChild;g;g=g.nextSibling)3===g.nodeType?d["#text"]=this.escape(g.nodeValue):4===g.nodeType?c.test(g.nodeValue)?d[g.nodeName]=[d[g.nodeName],g.nodeValue]:d["#cdata"]=this.escape(g.nodeValue):d[g.nodeName]?d[g.nodeName]instanceof Array?d[g.nodeName][d[g.nodeName].length]=this.toObj(g):d[g.nodeName]=[d[g.nodeName],this.toObj(g)]:d[g.nodeName]=this.toObj(g)}else a.attributes.length?d["#text"]=this.escape(this.innerXml(a)):d=
this.escape(this.innerXml(a));else if(b)a.attributes.length?d["#text"]=this.escape(this.innerXml(a)):(d=this.escape(this.innerXml(a)),"__EMPTY_ARRAY_"===d?d="[]":"__EMPTY_STRING_"===d&&(d=""));else if(f)if(1<f)d=this.escape(this.innerXml(a));else for(g=a.firstChild;g;g=g.nextSibling)if(c.test(a.firstChild.nodeValue)){d=a.firstChild.nodeValue;break}else d["#cdata"]=this.escape(g.nodeValue)}!a.attributes.length&&!a.firstChild&&(d=null)}else 9===a.nodeType?d=this.toObj(a.documentElement):alert("unhandled node type: "+
a.nodeType);return d},toJson:function(a,d,c,b){void 0===b&&(b=!0);var f=d?'"'+d+'"':"",j="\t",g="\n";b||(g=j="");if("[]"===a)f+=d?":[]":"[]";else if(a instanceof Array){var k,e,p=[];e=0;for(k=a.length;e<k;e+=1)p[e]=this.toJson(a[e],"",c+j,b);f+=(d?":[":"[")+(1<p.length?g+c+j+p.join(","+g+c+j)+g+c:p.join(""))+"]"}else if(null===a)f+=(d&&":")+"null";else if("object"===typeof a){k=[];for(e in a)a.hasOwnProperty(e)&&(k[k.length]=this.toJson(a[e],e,c+j,b));f+=(d?":{":"{")+(1<k.length?g+c+j+k.join(","+
g+c+j)+g+c:k.join(""))+"}"}else f+="string"===typeof a?(d&&":")+'"'+a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"':(d&&":")+'"'+a.toString()+'"';return f},innerXml:function(a){var d="";if("innerHTML"in a)d=a.innerHTML;else for(var c=function(a){var d="",f;if(1===a.nodeType){d+="<"+a.nodeName;for(f=0;f<a.attributes.length;f+=1)d+=" "+a.attributes[f].nodeName+'="'+(a.attributes[f].nodeValue||"").toString()+'"';if(a.firstChild){d+=">";for(f=a.firstChild;f;f=f.nextSibling)d+=c(f);d+="</"+a.nodeName+
">"}else d+="/>"}else 3===a.nodeType?d+=a.nodeValue:4===a.nodeType&&(d+="<![CDATA["+a.nodeValue+"]]\>");return d},a=a.firstChild;a;a=a.nextSibling)d+=c(a);return d},escape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(a){a.normalize();var d;for(d=a.firstChild;d;)if(3===d.nodeType)if(d.nodeValue.match(/[^ \f\n\r\t\v]/))d=d.nextSibling;else{var c=d.nextSibling;a.removeChild(d);d=c}else 1===d.nodeType&&this.removeWhite(d),
d=d.nextSibling;return a}};(function(a){a.browser.msie&&8==a.browser.version&&(a.expr[":"].hidden=function(a){return 0===a.offsetWidth||0===a.offsetHeight||"none"==a.style.display});a.jgrid._multiselect=!1;if(a.ui&&a.ui.multiselect){if(a.ui.multiselect.prototype._setSelected){var d=a.ui.multiselect.prototype._setSelected;a.ui.multiselect.prototype._setSelected=function(c,b){var f=d.call(this,c,b);if(b&&this.selectedList){var j=this.element;this.selectedList.find("li").each(function(){a(this).data("optionLink")&&
a(this).data("optionLink").remove().appendTo(j)})}return f}}a.ui.multiselect.prototype.destroy&&(a.ui.multiselect.prototype.destroy=function(){this.element.show();this.container.remove();a.Widget===void 0?a.widget.prototype.destroy.apply(this,arguments):a.Widget.prototype.destroy.apply(this,arguments)});a.jgrid._multiselect=!0}a.jgrid.extend({sortableColumns:function(c){return this.each(function(){function b(){d.p.disableClick=true}var d=this,f={tolerance:"pointer",axis:"x",scrollSensitivity:"1",
items:">th:not(:has(#jqgh_cb,#jqgh_rn,#jqgh_subgrid),:hidden)",placeholder:{element:function(b){return a(document.createElement(b[0].nodeName)).addClass(b[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(a,b){b.height(a.currentItem.innerHeight()-parseInt(a.currentItem.css("paddingTop")||0,10)-parseInt(a.currentItem.css("paddingBottom")||0,10));b.width(a.currentItem.innerWidth()-parseInt(a.currentItem.css("paddingLeft")||0,10)-parseInt(a.currentItem.css("paddingRight")||
0,10))}},update:function(b,c){var f=a(c.item).parent(),f=a(">th",f),g={};a.each(d.p.colModel,function(a){g[this.name]=a});var j=[];f.each(function(){var b=a(">div",this).get(0).id.replace(/^jqgh_/,"");b in g&&j.push(g[b])});a(d).jqGrid("remapColumns",j,true,true);a.isFunction(d.p.sortable.update)&&d.p.sortable.update(j);setTimeout(function(){d.p.disableClick=false},50)}};if(d.p.sortable.options)a.extend(f,d.p.sortable.options);else if(a.isFunction(d.p.sortable))d.p.sortable={update:d.p.sortable};
if(f.start){var g=f.start;f.start=function(a,c){b();g.call(this,a,c)}}else f.start=b;if(d.p.sortable.exclude)f.items=f.items+(":not("+d.p.sortable.exclude+")");c.sortable(f).data("sortable").floating=true})},columnChooser:function(c){function b(b,c){b&&(typeof b=="string"?a.fn[b]&&a.fn[b].apply(c,a.makeArray(arguments).slice(2)):a.isFunction(b)&&b.apply(c,a.makeArray(arguments).slice(2)))}var d=this;if(!a("#colchooser_"+d[0].p.id).length){var f=a('<div id="colchooser_'+d[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>'),
g=a("select",f),c=a.extend({width:420,height:240,classname:null,done:function(a){a&&d.jqGrid("remapColumns",a,true)},msel:"multiselect",dlog:"dialog",dlog_opts:function(a){var b={};b[a.bSubmit]=function(){a.apply_perm();a.cleanup(false)};b[a.bCancel]=function(){a.cleanup(true)};return{buttons:b,close:function(){a.cleanup(true)},modal:a.modal?a.modal:false,resizable:a.resizable?a.resizable:true,width:a.width+20}},apply_perm:function(){a("option",g).each(function(){this.selected?d.jqGrid("showCol",
k[this.value].name):d.jqGrid("hideCol",k[this.value].name)});var b=[];a("option[selected]",g).each(function(){b.push(parseInt(this.value,10))});a.each(b,function(){delete j[k[parseInt(this,10)].name]});a.each(j,function(){var a=parseInt(this,10),c=b,e=a;if(e>=0){var d=c.slice(),f=d.splice(e,Math.max(c.length-e,e));if(e>c.length)e=c.length;d[e]=a;b=d.concat(f)}else b=void 0});c.done&&c.done.call(d,b)},cleanup:function(a){b(c.dlog,f,"destroy");b(c.msel,g,"destroy");f.remove();a&&c.done&&c.done.call(d)},
msel_opts:{}},a.jgrid.col,c||{});if(a.ui&&a.ui.multiselect&&c.msel=="multiselect"){if(!a.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}c.msel_opts=a.extend(a.ui.multiselect.defaults,c.msel_opts)}c.caption&&f.attr("title",c.caption);if(c.classname){f.addClass(c.classname);g.addClass(c.classname)}if(c.width){a(">div",f).css({width:c.width,margin:"0 auto"});g.css("width",c.width)}if(c.height){a(">div",f).css("height",c.height);g.css("height",
c.height-10)}var k=d.jqGrid("getGridParam","colModel"),e=d.jqGrid("getGridParam","colNames"),j={},o=[];g.empty();a.each(k,function(a){j[this.name]=a;this.hidedlg?this.hidden||o.push(a):g.append("<option value='"+a+"' "+(this.hidden?"":"selected='selected'")+">"+e[a]+"</option>")});var r=a.isFunction(c.dlog_opts)?c.dlog_opts.call(d,c):c.dlog_opts;b(c.dlog,f,r);r=a.isFunction(c.msel_opts)?c.msel_opts.call(d,c):c.msel_opts;b(c.msel,g,r)}},sortableRows:function(c){return this.each(function(){var b=this;
if(b.grid&&!b.p.treeGrid&&a.fn.sortable){c=a.extend({cursor:"move",axis:"y",items:".jqgrow"},c||{});if(c.start&&a.isFunction(c.start)){c._start_=c.start;delete c.start}else c._start_=false;if(c.update&&a.isFunction(c.update)){c._update_=c.update;delete c.update}else c._update_=false;c.start=function(d,f){a(f.item).css("border-width","0px");a("td",f.item).each(function(a){this.style.width=b.grid.cols[a].style.width});if(b.p.subGrid){var g=a(f.item).attr("id");try{a(b).jqGrid("collapseSubGridRow",g)}catch(k){}}c._start_&&
c._start_.apply(this,[d,f])};c.update=function(d,f){a(f.item).css("border-width","");b.p.rownumbers===true&&a("td.jqgrid-rownum",b.rows).each(function(b){a(this).html(b+1)});c._update_&&c._update_.apply(this,[d,f])};a("tbody:first",b).sortable(c);a("tbody:first",b).disableSelection()}})},gridDnD:function(c){return this.each(function(){function b(){var b=a.data(d,"dnd");a("tr.jqgrow:not(.ui-draggable)",d).draggable(a.isFunction(b.drag)?b.drag.call(a(d),b):b.drag)}var d=this;if(d.grid&&!d.p.treeGrid&&
a.fn.draggable&&a.fn.droppable){a("#jqgrid_dnd").html()===null&&a("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>");if(typeof c=="string"&&c=="updateDnD"&&d.p.jqgdnd===true)b();else{c=a.extend({drag:function(b){return a.extend({start:function(c,e){if(d.p.subGrid){var f=a(e.helper).attr("id");try{a(d).jqGrid("collapseSubGridRow",f)}catch(j){}}for(f=0;f<a.data(d,"dnd").connectWith.length;f++)a(a.data(d,"dnd").connectWith[f]).jqGrid("getGridParam","reccount")=="0"&&a(a.data(d,"dnd").connectWith[f]).jqGrid("addRowData",
"jqg_empty_row",{});e.helper.addClass("ui-state-highlight");a("td",e.helper).each(function(a){this.style.width=d.grid.headers[a].width+"px"});b.onstart&&a.isFunction(b.onstart)&&b.onstart.call(a(d),c,e)},stop:function(c,e){if(e.helper.dropped){var f=a(e.helper).attr("id");a(d).jqGrid("delRowData",f)}for(f=0;f<a.data(d,"dnd").connectWith.length;f++)a(a.data(d,"dnd").connectWith[f]).jqGrid("delRowData","jqg_empty_row");b.onstop&&a.isFunction(b.onstop)&&b.onstop.call(a(d),c,e)}},b.drag_opts||{})},drop:function(b){return a.extend({accept:function(b){if(!a(b).hasClass("jqgrow"))return b;
var c=a(b).closest("table.ui-jqgrid-btable");if(c.length>0&&a.data(c[0],"dnd")!==void 0){b=a.data(c[0],"dnd").connectWith;return a.inArray("#"+this.id,b)!=-1?true:false}return b},drop:function(c,e){if(a(e.draggable).hasClass("jqgrow")){var f=a(e.draggable).attr("id"),f=e.draggable.parent().parent().jqGrid("getRowData",f);if(!b.dropbyname){var j=0,m={},q,u=a("#"+this.id).jqGrid("getGridParam","colModel");try{for(var t in f){if(f.hasOwnProperty(t)&&u[j]){q=u[j].name;m[q]=f[t]}j++}f=m}catch(v){}}e.helper.dropped=
true;if(b.beforedrop&&a.isFunction(b.beforedrop)){q=b.beforedrop.call(this,c,e,f,a("#"+d.id),a(this));typeof q!="undefined"&&(q!==null&&typeof q=="object")&&(f=q)}if(e.helper.dropped){var z;if(b.autoid)if(a.isFunction(b.autoid))z=b.autoid.call(this,f);else{z=Math.ceil(Math.random()*1E3);z=b.autoidprefix+z}a("#"+this.id).jqGrid("addRowData",z,f,b.droppos)}b.ondrop&&a.isFunction(b.ondrop)&&b.ondrop.call(this,c,e,f)}}},b.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",
hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5E3},dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},c||{});if(c.connectWith){c.connectWith=c.connectWith.split(",");c.connectWith=a.map(c.connectWith,function(b){return a.trim(b)});a.data(d,"dnd",c);d.p.reccount!="0"&&!d.p.jqgdnd&&b();d.p.jqgdnd=true;for(var f=0;f<c.connectWith.length;f++)a(c.connectWith[f]).droppable(a.isFunction(c.drop)?c.drop.call(a(d),c):c.drop)}}}})},
gridResize:function(c){return this.each(function(){var b=this;if(b.grid&&a.fn.resizable){c=a.extend({},c||{});if(c.alsoResize){c._alsoResize_=c.alsoResize;delete c.alsoResize}else c._alsoResize_=false;if(c.stop&&a.isFunction(c.stop)){c._stop_=c.stop;delete c.stop}else c._stop_=false;c.stop=function(d,f){a(b).jqGrid("setGridParam",{height:a("#gview_"+b.p.id+" .ui-jqgrid-bdiv").height()});a(b).jqGrid("setGridWidth",f.size.width,c.shrinkToFit);c._stop_&&c._stop_.call(b,d,f)};c.alsoResize=c._alsoResize_?
eval("("+("{'#gview_"+b.p.id+" .ui-jqgrid-bdiv':true,'"+c._alsoResize_+"':true}")+")"):a(".ui-jqgrid-bdiv","#gview_"+b.p.id);delete c._alsoResize_;a("#gbox_"+b.p.id).resizable(c)}})}})})(j)});define("jquery-layout",["jquery"],function(j){(function(f){function a(a){return"string"===f.type(a)}function d(b,c){if(f.isArray(c))for(var e=0,d=c.length;e<d;e++){var j=c[e];try{a(j)&&(j=eval(j)),f.isFunction(j)&&j(b)}catch(l){}}}var c=Math.min,b=Math.max,j=Math.floor;f.layout={version:"1.3.rc30.51",revision:0.033005,
language:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpenTip:"Not enough room to show this pane.",minSizeWarning:"Panel has reached its minimum size",maxSizeWarning:"Panel has reached its maximum size",pane:"pane",selector:"selector",errButton:"Error Adding Button \n\nInvalid ",errContainerMissing:"UI Layout Initialization Error\n\nThe specified layout-container does not exist.",errCenterPaneMissing:"UI Layout Initialization Error\n\nThe center-pane element does not exist.\n\nThe center-pane is a required element.",
errContainerHeight:"UI Layout Initialization Warning\n\nThe layout-container \"CONTAINER\" has no height.\n\nTherefore the layout is 0-height and hence 'invisible'!"},browser:{mozilla:!!f.browser.mozilla,webkit:!!f.browser.webkit||!!f.browser.safari,msie:!!f.browser.msie,isIE6:!!f.browser.msie&&6==f.browser.version,version:f.browser.version},effects:{slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},
north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}},blind:{},clip:{},explode:{},fade:{},fold:{},puff:{},size:{all:{easing:"swing"}}},config:{optionRootKeys:"effects panes north south west east center".split(" "),allPanes:["north","south","west","east","center"],borderPanes:["north","south","west","east"],oppositeEdge:{north:"south",south:"north",east:"west",west:"east"},offscreenCSS:{left:"-99999px",right:"auto"},offscreenReset:"offscreenReset",
hidden:{visibility:"hidden"},visible:{visibility:"visible"},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",
padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"Top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{side:"Bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{side:"Right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{side:"Left",sizeType:"Width",
dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},callbacks:{},getParentPaneElem:function(a){a=f(a);if(a=a.data("layout")||a.data("parentLayout")){a=a.container;if(a.data("layoutPane"))return a;a=a.closest("."+f.layout.defaults.panes.paneClass);if(a.data("layoutPane"))return a}return null},getParentPaneInstance:function(a){return(a=f.layout.getParentPaneElem(a))?
a.data("layoutPane"):null},getParentLayoutInstance:function(a){return(a=f.layout.getParentPaneElem(a))?a.data("parentLayout"):null},getEventObject:function(a){return"object"===typeof a&&a.stopPropagation?a:null},parsePaneName:function(a){var b=f.layout.getEventObject(a);return b?(b.stopPropagation(),f(this).data("layoutEdge")):a},plugins:{draggable:!!f.fn.draggable,effects:{core:!!f.effects,slide:f.effects&&f.effects.slide}},onCreate:[],onLoad:[],onReady:[],onDestroy:[],onUnload:[],afterOpen:[],afterClose:[],
scrollbarWidth:function(){return window.scrollbarWidth||f.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||f.layout.getScrollbarSize("height")},getScrollbarSize:function(a){var b=f('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),c={width:b.width()-b[0].clientWidth,height:b.height()-b[0].clientHeight};b.remove();window.scrollbarWidth=c.width;window.scrollbarHeight=c.height;
return a.match(/^(width|height)$/)?c[a]:c},showInvisibly:function(a,b){if(!a)return{};a.jquery||(a=f(a));var c={display:a.css("display"),visibility:a.css("visibility")};return b||"none"===c.display?(a.css({display:"block",visibility:"hidden"}),c):{}},getElementDimensions:function(a){var c={},e=c.css={},d={},j,l,m=f.layout.cssNum,u=a.offset();c.offsetLeft=u.left;c.offsetTop=u.top;f.each(["Left","Right","Top","Bottom"],function(b,m){j=e["border"+m]=f.layout.borderWidth(a,m);l=e["padding"+m]=f.layout.cssNum(a,
"padding"+m);d[m]=j+l;c["inset"+m]=l});c.offsetWidth=a.innerWidth();c.offsetHeight=a.innerHeight();c.outerWidth=a.outerWidth();c.outerHeight=a.outerHeight();c.innerWidth=b(0,c.outerWidth-d.Left-d.Right);c.innerHeight=b(0,c.outerHeight-d.Top-d.Bottom);e.width=a.width();e.height=a.height();e.top=m(a,"top",!0);e.bottom=m(a,"bottom",!0);e.left=m(a,"left",!0);e.right=m(a,"right",!0);return c},getElementCSS:function(a,b){var c={},d=a[0].style,f=b.split(","),j=["Top","Bottom","Left","Right"],l=["Color",
"Style","Width"],m,t,v,z,x,y;for(z=0;z<f.length;z++)if(m=f[z],m.match(/(border|padding|margin)$/))for(x=0;4>x;x++)if(t=j[x],"border"===m)for(y=0;3>y;y++)v=l[y],c[m+t+v]=d[m+t+v];else c[m+t]=d[m+t];else c[m]=d[m];return c},cssWidth:function(a,c){var e=f.layout.borderWidth,d=f.layout.cssNum;if(0>=c)return 0;if(!f.support.boxModel)return c;e=c-e(a,"Left")-e(a,"Right")-d(a,"paddingLeft")-d(a,"paddingRight");return b(0,e)},cssHeight:function(a,c){var e=f.layout.borderWidth,d=f.layout.cssNum;if(0>=c)return 0;
if(!f.support.boxModel)return c;e=c-e(a,"Top")-e(a,"Bottom")-d(a,"paddingTop")-d(a,"paddingBottom");return b(0,e)},cssNum:function(a,b,c){a.jquery||(a=f(a));var d=f.layout.showInvisibly(a),b=f.curCSS(a[0],b,!0),c=c&&"auto"==b?b:parseInt(b,10)||0;a.css(d);return c},borderWidth:function(a,b){a.jquery&&(a=a[0]);var c="border"+b.substr(0,1).toUpperCase()+b.substr(1);return"none"===f.curCSS(a,c+"Style",!0)?0:parseInt(f.curCSS(a,c+"Width",!0),10)||0},isMouseOverElem:function(a,b){var c=f(b||this),d=c.offset(),
j=d.top,d=d.left,l=d+c.outerWidth(),c=j+c.outerHeight(),m=a.pageX,u=a.pageY;return f.layout.browser.msie&&0>m&&0>u||m>=d&&m<=l&&u>=j&&u<=c},msg:function(a,b,c,d){f.isPlainObject(a)&&window.debugData?("string"===typeof b?(d=c,c=b):"object"===typeof c&&(d=c,c=null),c=c||"log( <object> )",d=f.extend({sort:!1,returnHTML:!1,display:!1},d),!0===b||d.display?debugData(a,c,d):window.console&&console.log(debugData(a,c,d))):b?alert(a):window.console?console.log(a):(b=f("#layoutLogger"),b.length||(b=f('<div id="layoutLogger" style="position: '+
(f.support.fixedPosition?"fixed":"absolute")+'; top: 5px; z-index: 999999; max-width: 25%; overflow: hidden; border: 1px solid #000; border-radius: 5px; background: #FBFBFB; box-shadow: 0 2px 10px rgba(0,0,0,0.3);"><div style="font-size: 13px; font-weight: bold; padding: 5px 10px; background: #F6F6F6; border-radius: 5px 5px 0 0; cursor: move;"><span style="float: right; padding-left: 7px; cursor: pointer;" title="Remove Console" onclick="$(this).closest(\'#layoutLogger\').remove()">X</span>Layout console.log</div><ul style="font-size: 13px; font-weight: none; list-style: none; margin: 0; padding: 0 0 2px;"></ul></div>').appendTo("body"),
b.css("left",f(window).width()-b.outerWidth()-5),f.ui.draggable&&b.draggable({handle:":first-child"})),b.children("ul").append('<li style="padding: 4px 10px; margin: 0; border-top: 1px solid #CCC;">'+a.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</li>"))}};var m=f.layout.language;f.layout.defaults={name:"",containerSelector:"",containerClass:"ui-layout-container",scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,onresizeall_start:null,onresizeall_end:null,
onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,autoBindCustomButtons:!1,initPanes:!0,showErrorMessages:!0,showDebugMessages:!1,zIndex:null,zIndexes:{pane_normal:0,content_mask:1,resizer_normal:2,pane_sliding:100,pane_animate:1E3,resizer_drag:1E4},panes:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",
togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:m.Close,togglerTip_closed:m.Open,togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskContents:!1,maskObjects:!1,maskZindex:null,resizingGrid:!1,livePaneResizing:!1,liveContentResizing:!1,liveResizingTolerance:1,
noRoomToOpenTip:m.noRoomToOpenTip,resizerTip:m.Resize,sliderTip:m.Slide,sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:f.layout.browser.webkit,preventPrematureSlideClose:!1,showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,animatePaneSizing:!1,childOptions:null,initChildLayout:!0,destroyChildLayout:!0,
resizeChildLayout:!0,triggerEventsOnLoad:!1,triggerEventsDuringLiveResize:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",
size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0}};f.layout.optionsMap={layout:"stateManagement effects zIndexes name zIndex scrollToBookmarkOnLoad showErrorMessages resizeWithWindow resizeWithWindowDelay resizeWithWindowMaxDelay onresizeall onresizeall_start onresizeall_end onload onunload autoBindCustomButtons".split(" "),
center:"paneClass contentSelector contentIgnoreSelector findNestedContent applyDemoStyles triggerEventsOnLoad showOverflowOnHover maskContents maskObjects liveContentResizing childOptions initChildLayout resizeChildLayout destroyChildLayout onresize onresize_start onresize_end onsizecontent onsizecontent_start onsizecontent_end".split(" "),noDefault:["paneSelector","resizerCursor","customHotkey"]};f.layout.transformData=function(a){var b={panes:{},center:{}},c,d,f,j,l,m,t;if("object"!==typeof a)return b;
for(d in a){c=b;l=a[d];f=d.split("__");t=f.length-1;for(m=0;m<=t;m++)j=f[m],m===t?c[j]=l:c[j]||(c[j]={}),c=c[j]}return b};f.layout.backwardCompatibility={map:{applyDefaultStyles:"applyDemoStyles",resizeNestedLayout:"resizeChildLayout",resizeWhileDragging:"livePaneResizing",resizeContentWhileDragging:"liveContentResizing",triggerEventsWhileDragging:"triggerEventsDuringLiveResize",maskIframesOnResize:"maskContents",useStateCookie:"stateManagement.enabled","cookie.autoLoad":"stateManagement.autoLoad",
"cookie.autoSave":"stateManagement.autoSave","cookie.keys":"stateManagement.stateKeys","cookie.name":"stateManagement.cookie.name","cookie.domain":"stateManagement.cookie.domain","cookie.path":"stateManagement.cookie.path","cookie.expires":"stateManagement.cookie.expires","cookie.secure":"stateManagement.cookie.secure"},renameOptions:function(a){function b(c,e){for(var d=c.split("."),f=d.length-1,k={branch:a,key:d[f]},j=0,l;j<f;j++)l=d[j],k.branch=void 0==k.branch[l]?e?k.branch[l]={}:{}:k.branch[l];
return k}var c=f.layout.backwardCompatibility.map,d,j,l,m;for(m in c)d=b(m),l=d.branch[d.key],void 0!==l&&(j=b(c[m],!0),j.branch[j.key]=l,delete d.branch[d.key])},renameAllOptions:function(a){var b=f.layout.backwardCompatibility.renameOptions;b(a);a.defaults&&("object"!==typeof a.panes&&(a.panes={}),f.extend(!0,a.panes,a.defaults),delete a.defaults);a.panes&&b(a.panes);f.each(f.layout.config.allPanes,function(c,d){a[d]&&b(a[d])});return a}};f.fn.layout=function(g){function k(a){if(!a)return!0;var b=
a.keyCode;if(33>b)return!0;var c={38:"north",40:"south",37:"west",39:"east"},d=a.shiftKey,e=a.ctrlKey,g,k,j,l;e&&(37<=b&&40>=b)&&B[c[b]].enableCursorHotkey?l=c[b]:(e||d)&&f.each(q.borderPanes,function(a,c){g=B[c];k=g.customHotkey;j=g.customHotkeyModifier;if(d&&"SHIFT"==j||e&&"CTRL"==j||e&&d)if(k&&b===(isNaN(k)||9>=k?k.toUpperCase().charCodeAt(0):k))return l=c,!1});if(!l||!P[l]||!B[l].closable||A[l].isHidden)return!0;Pa(l);a.stopPropagation();return a.returnValue=!1}function e(b){if(C()){this&&this.tagName&&
(b=this);var c;a(b)?c=P[b]:f(b).data("layoutRole")?c=f(b):f(b).parents().each(function(){if(f(this).data("layoutRole"))return c=f(this),!1});if(c&&c.length){var d=c.data("layoutEdge"),b=A[d];b.cssSaved&&m(d);if(b.isSliding||b.isResizing||b.isClosed)b.cssSaved=!1;else{var e={zIndex:B.zIndexes.resizer_normal+1},g={},k=c.css("overflow"),j=c.css("overflowX"),l=c.css("overflowY");"visible"!=k&&(g.overflow=k,e.overflow="visible");j&&!j.match(/visible|auto/)&&(g.overflowX=j,e.overflowX="visible");l&&!l.match(/visible|auto/)&&
(g.overflowY=j,e.overflowY="visible");b.cssSaved=g;c.css(e);f.each(q.allPanes,function(a,b){b!=d&&m(b)})}}}}function m(b){if(C()){this&&this.tagName&&(b=this);var c;a(b)?c=P[b]:f(b).data("layoutRole")?c=f(b):f(b).parents().each(function(){if(f(this).data("layoutRole"))return c=f(this),!1});if(c&&c.length){var b=c.data("layoutEdge"),b=A[b],d=b.cssSaved||{};!b.isSliding&&!b.isResizing&&c.css("zIndex",B.zIndexes.pane_normal);c.css(d);b.cssSaved=!1}}}var o=f.layout.browser,r=f.layout.language,q=f.layout.config,
u=f.layout.cssWidth,t=f.layout.cssHeight,v=f.layout.getElementDimensions,z=f.layout.getElementCSS,x=f.layout.getEventObject,y=f.layout.parsePaneName,B=f.extend(!0,{},f.layout.defaults);B.effects=f.extend(!0,{},f.layout.effects);var A={id:"layout"+f.now(),initialized:!1,container:{},north:{},south:{},east:{},west:{},center:{}},F={north:null,south:null,east:null,west:null,center:null},N={data:{},set:function(a,b,c){N.clear(a);N.data[a]=setTimeout(b,c)},clear:function(a){var b=N.data;b[a]&&(clearTimeout(b[a]),
delete b[a])}},K=function(a,b){f.layout.msg(B.name+" / "+a,b&&B.showErrorMessages)},G=function(b,c,d){var e=c?B[c]:B,g=b+(b.match(/_/)?"":"_end"),k=g.match(/_end$/)?g.substr(0,g.length-4):"",j=e[g],l="NC",m=[];!j&&k&&(j=e[k]);j&&(a(j)&&(j.match(/,/)?(m=j.split(","),j=eval(m[0])):j=eval(j)),f.isFunction(j)&&(l=m.length?j(m[1]):c&&P[c]?j(c,P[c],A[c],B[c],B.name):j(fa,A,B,B.name)));!d&&!1!==l&&(c?(P[c].triggerHandler("layoutpane"+g,[c,P[c],A[c],B[c],B.name]),k&&P[c].triggerHandler("layoutpane"+k,[c,
P[c],A[c],B[c],B.name])):U.triggerHandler("layout"+g,[c,P[c],A[c],B[c],B.name]));("onresize_end"===b||"onsizecontent_end"===b)&&Za(c);return l},R=function(a){if(!o.mozilla){var b=P[a];"IFRAME"===A[a].tagName?b.css(q.hidden).css(q.visible):b.find("IFRAME").css(q.hidden).css(q.visible)}},I=function(a){var b=P[a],a=q[a].dir,b={minWidth:1001-u(b,1E3),minHeight:1001-t(b,1E3)};"horz"===a&&(b.minSize=b.minHeight);"vert"===a&&(b.minSize=b.minWidth);return b},ba=function(b,c,d){var e=b;a(b)?e=P[b]:b.jquery||
(e=f(b));b=t(e,c);e.css({height:b,visibility:"visible"});0<b&&0<e.innerWidth()?d&&e.data("autoHidden")&&(e.show().data("autoHidden",!1),o.mozilla||e.css(q.hidden).css(q.visible)):d&&!e.data("autoHidden")&&e.hide().data("autoHidden",!0)},T=function(b,c,e){e||(e=q[b].dir);a(c)&&c.match(/%/)&&(c="100%"===c?-1:parseInt(c,10)/100);if(0===c)return 0;if(1<=c)return parseInt(c,10);var d=B,g=0;"horz"==e?g=V.innerHeight-(P.north?d.north.spacing_open:0)-(P.south?d.south.spacing_open:0):"vert"==e&&(g=V.innerWidth-
(P.west?d.west.spacing_open:0)-(P.east?d.east.spacing_open:0));if(-1===c)return g;if(0<c)return j(g*c);if("center"==b)return 0;var e="horz"===e?"height":"width",d=P[b],b="height"===e?Ba[b]:!1,g=f.layout.showInvisibly(d),k=d.css(e),m=b?b.css(e):0;d.css(e,"auto");b&&b.css(e,"auto");c="height"===e?d.outerHeight():d.outerWidth();d.css(e,k).css(g);b&&b.css(e,m);return c},Y=function(a,b){var c=P[a],e=B[a],d=A[a],f=b?e.spacing_open:0,e=b?e.spacing_closed:0;return!c||d.isHidden?0:d.isClosed||d.isSliding&&
b?e:"horz"===q[a].dir?c.outerHeight()+f:c.outerWidth()+f},D=function(a,e){if(C()){var d=B[a],f=A[a],g=q[a],k=g.dir;g.side.toLowerCase();g.sizeType.toLowerCase();var g=void 0!=e?e:f.isSliding,j=d.spacing_open,l=q.oppositeEdge[a],m=A[l],o=P[l],p=!o||!1===m.isVisible||m.isSliding?0:"horz"==k?o.outerHeight():o.outerWidth(),l=(!o||m.isHidden?0:B[l][!1!==m.isClosed?"spacing_closed":"spacing_open"])||0,m="horz"==k?V.innerHeight:V.innerWidth,o=I("center"),o="horz"==k?b(B.center.minHeight,o.minHeight):b(B.center.minWidth,
o.minWidth),g=m-j-(g?0:T("center",o,k)+p+l),k=f.minSize=b(T(a,d.minSize),I(a).minSize),g=f.maxSize=c(d.maxSize?T(a,d.maxSize):1E5,g),f=f.resizerPosition={},j=V.insetTop,p=V.insetLeft,l=V.innerWidth,m=V.innerHeight,d=d.spacing_open;switch(a){case "north":f.min=j+k;f.max=j+g;break;case "west":f.min=p+k;f.max=p+g;break;case "south":f.min=j+m-g-d;f.max=j+m-k-d;break;case "east":f.min=p+l-g-d,f.max=p+l-k-d}}},M=function(a,b){var c=f(a),e=c.data("layoutRole"),d=c.data("layoutEdge"),g=B[d][e+"Class"],d=
"-"+d,k=c.hasClass(g+"-closed")?"-closed":"-open",j="-closed"===k?"-open":"-closed",k=g+"-hover "+(g+d+"-hover ")+(g+k+"-hover ")+(g+d+k+"-hover ");b&&(k+=g+j+"-hover "+(g+d+j+"-hover "));"resizer"==e&&c.hasClass(g+"-sliding")&&(k+=g+"-sliding-hover "+(g+d+"-sliding-hover "));return f.trim(k)},Z=function(a,b){var c=f(b||this);a&&"toggler"===c.data("layoutRole")&&a.stopPropagation();c.addClass(M(c))},E=function(a,b){var c=f(b||this);c.removeClass(M(c,!0))},H=function(){f.fn.disableSelection&&f("body").disableSelection()},
L=function(a,b){var c=b||this,d=f(c).data("layoutEdge"),e=d+"ResizerLeave";N.clear(d+"_openSlider");N.clear(e);b?!A[d].isResizing&&f.fn.enableSelection&&f("body").enableSelection():N.set(e,function(){L(a,c)},200)},C=function(){return A.initialized||A.creatingLayout?!0:O()},O=function(a){var b=B;if(!U.is(":visible"))return!a&&(o.webkit&&"BODY"===U[0].tagName)&&setTimeout(function(){O(!0)},50),!1;if(!ia("center").length)return B.showErrorMessages&&K(r.errCenterPaneMissing,!0),!1;A.creatingLayout=!0;
f.extend(V,v(U));na();b.scrollToBookmarkOnLoad&&(a=self.location,a.hash&&a.replace(a.hash));fa.hasParentLayout?b.resizeWithWindow=!1:b.resizeWithWindow&&f(window).bind("resize."+$,aa);delete A.creatingLayout;A.initialized=!0;d(fa,f.layout.onReady);G("onload_end");return!0},ha=function(a,b){var c=y.call(this,a),d=P[c];if(d){var e=Ba[c],f=b||B[c].childOptions,d=f.containerSelector?d.find(f.containerSelector):e||d,g=(e=d.length)?F[c]=d.data("layout")||null:null;!g&&(e&&f)&&(g=F[c]=d.eq(0).layout(f)||
null);g&&(g.hasParentLayout=!0)}fa[c].child=F[c]},aa=function(){var a=Number(B.resizeWithWindowDelay);10>a&&(a=100);N.clear("winResize");N.set("winResize",function(){N.clear("winResize");N.clear("winResizeRepeater");var a=v(U);(a.innerWidth!==V.innerWidth||a.innerHeight!==V.innerHeight)&&Oa()},a);N.data.winResizeRepeater||X()},X=function(){var a=Number(B.resizeWithWindowMaxDelay);0<a&&N.set("winResizeRepeater",function(){X();Oa()},a)},S=function(){G("onunload_start");d(fa,f.layout.onUnload);G("onunload_end")},
W=function(a){a=a?a.split(","):q.borderPanes;f.each(a,function(a,b){var c=B[b];if(c.enableCursorHotkey||c.customHotkey)return f(document).bind("keydown."+$,k),!1})},ka=function(){function a(b){var c=B[b],e=B.panes;c.fxSettings||(c.fxSettings={});e.fxSettings||(e.fxSettings={});f.each(["_open","_close","_size"],function(a,d){var g="fxName"+d,k="fxSpeed"+d,j="fxSettings"+d,l=c[g]=c[g]||e[g]||c.fxName||e.fxName||"none";if(l==="none"||!f.effects||!f.effects[l]||!B.effects[l])l=c[g]="none";l=B.effects[l]||
{};g=l.all||null;l=l[b]||null;c[k]=c[k]||e[k]||c.fxSpeed||e.fxSpeed||null;c[j]=f.extend({},g,l,e.fxSettings,c.fxSettings,e[j],c[j])});delete c.fxName;delete c.fxSpeed;delete c.fxSettings}var c,d,e,k,j,l;g=f.layout.transformData(g);g=f.layout.backwardCompatibility.renameAllOptions(g);if(!f.isEmptyObject(g.panes)){c=f.layout.optionsMap.noDefault;k=0;for(j=c.length;k<j;k++)e=c[k],delete g.panes[e];c=f.layout.optionsMap.layout;k=0;for(j=c.length;k<j;k++)e=c[k],delete g.panes[e]}c=f.layout.optionsMap.layout;
var m=f.layout.config.optionRootKeys;for(e in g)k=g[e],0>f.inArray(e,m)&&0>f.inArray(e,c)&&(g.panes[e]||(g.panes[e]=f.isPlainObject(k)?f.extend(!0,{},k):k),delete g[e]);f.extend(!0,B,g);f.each(q.allPanes,function(b,k){q[k]=f.extend(!0,{},q.panes,q[k]);d=B.panes;l=B[k];if("center"===k){c=f.layout.optionsMap.center;b=0;for(j=c.length;b<j;b++)if(e=c[b],!g.center[e]&&(g.panes[e]||!l[e]))l[e]=d[e]}else if(l=B[k]=f.extend({},d,l),a(k),l.resizerClass||(l.resizerClass="ui-layout-resizer"),!l.togglerClass)l.togglerClass=
"ui-layout-toggler";l.paneClass||(l.paneClass="ui-layout-pane")});k=g.zIndex;m=B.zIndexes;0<k&&(m.pane_normal=k,m.content_mask=b(k+1,m.content_mask),m.resizer_normal=b(k+2,m.resizer_normal));delete B.panes},ia=function(a){a=B[a].paneSelector;if("#"===a.substr(0,1))return U.find(a).eq(0);var b=U.children(a).eq(0);return b.length?b:U.children("form:first").children(a).eq(0)},na=function(){f.each(q.allPanes,function(a,b){ta(b,!0)});va();f.each(q.borderPanes,function(a,b){P[b]&&A[b].isVisible&&(D(b),
Ea(b))});Na("center");f.each(q.allPanes,function(a,b){var c=B[b];P[b]&&(A[b].isVisible&&(Aa(b),c.triggerEventsOnLoad?G("onresize_end",b):Za(b)),c.initChildLayout&&c.childOptions&&ha(b))})},ta=function(a,d){if(d||C()){var f=B[a],g=A[a],k=q[a],j=k.dir,l="center"===a,o={},r=P[a],v,x;r?Qa(a,!1,!0,!1):Ba[a]=!1;r=P[a]=ia(a);if(r.length){r.data("layoutCSS")||r.data("layoutCSS",z(r,"position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border"));fa[a]={name:a,
pane:P[a],content:Ba[a],options:B[a],state:A[a],child:F[a]};r.data({parentLayout:fa,layoutPane:fa[a],layoutEdge:a,layoutRole:"pane"}).css(k.cssReq).css("zIndex",B.zIndexes.pane_normal).css(f.applyDemoStyles?k.cssDemo:{}).addClass(f.paneClass+" "+f.paneClass+"-"+a).bind("mouseenter."+$,Z).bind("mouseleave."+$,E);k={hide:"",show:"",toggle:"",close:"",open:"",slideOpen:"",slideClose:"",slideToggle:"",size:"manualSizePane",sizePane:"manualSizePane",sizeContent:"",sizeHandles:"",enableClosable:"",disableClosable:"",
enableSlideable:"",disableSlideable:"",enableResizable:"",disableResizable:"",swapPanes:"swapPanes",swap:"swapPanes",move:"swapPanes",removePane:"removePane",remove:"removePane",createChildLayout:"",resizeChildLayout:"",resizeAll:"resizeAll",resizeLayout:"resizeAll"};for(x in k)r.bind("layoutpane"+x.toLowerCase()+"."+$,fa[k[x]||x]);J(a,!1);l||(v=g.size=T(a,f.size),l=T(a,f.minSize)||1,x=T(a,f.maxSize)||1E5,0<v&&(v=b(c(v,x),l)),g.isClosed=!1,g.isSliding=!1,g.isResizing=!1,g.isHidden=!1,g.pins||(g.pins=
[]));g.tagName=r[0].tagName;g.edge=a;g.noRoom=!1;g.isVisible=!0;switch(a){case "north":o.top=V.insetTop;o.left=V.insetLeft;o.right=V.insetRight;break;case "south":o.bottom=V.insetBottom;o.left=V.insetLeft;o.right=V.insetRight;break;case "west":o.left=V.insetLeft;break;case "east":o.right=V.insetRight}"horz"===j?o.height=t(r,v):"vert"===j&&(o.width=u(r,v));r.css(o);"horz"!=j&&Na(a,!0);f.initClosed&&f.closable&&!f.initHidden?sa(a,!0,!0):f.initHidden||f.initClosed?Va(a):g.noRoom||r.css("display","block");
r.css("visibility","visible");f.showOverflowOnHover&&r.hover(e,m);A.initialized&&(va(a),W(a),Oa(),g.isVisible&&(f.triggerEventsOnLoad?G("onresize_end",a):Za(a)),f.initChildLayout&&f.childOptions&&ha(a))}else P[a]=!1}},va=function(a){a=a?a.split(","):q.borderPanes;f.each(a,function(a,b){var c=P[b];ja[b]=!1;ga[b]=!1;if(c){var c=B[b],e=A[b],d=c.resizerClass,g=c.togglerClass;q[b].side.toLowerCase();var k="-"+b,j=fa[b],l=j.resizer=ja[b]=f("<div></div>"),j=j.toggler=c.closable?ga[b]=f("<div></div>"):!1;
!e.isVisible&&c.slidable&&l.attr("title",c.sliderTip).css("cursor",c.sliderCursor);l.attr("id","#"==c.paneSelector.substr(0,1)?c.paneSelector.substr(1)+"-resizer":"").data({parentLayout:fa,layoutPane:fa[b],layoutEdge:b,layoutRole:"resizer"}).css(q.resizers.cssReq).css("zIndex",B.zIndexes.resizer_normal).css(c.applyDemoStyles?q.resizers.cssDemo:{}).addClass(d+" "+d+k).hover(Z,E).hover(H,L).appendTo(U);j&&(j.attr("id","#"==c.paneSelector.substr(0,1)?c.paneSelector.substr(1)+"-toggler":"").data({parentLayout:fa,
layoutPane:fa[b],layoutEdge:b,layoutRole:"toggler"}).css(q.togglers.cssReq).css(c.applyDemoStyles?q.togglers.cssDemo:{}).addClass(g+" "+g+k).hover(Z,E).bind("mouseenter",H).appendTo(l),c.togglerContent_open&&f("<span>"+c.togglerContent_open+"</span>").data({layoutEdge:b,layoutRole:"togglerContent"}).data("layoutRole","togglerContent").data("layoutEdge",b).addClass("content content-open").css("display","none").appendTo(j),c.togglerContent_closed&&f("<span>"+c.togglerContent_closed+"</span>").data({layoutEdge:b,
layoutRole:"togglerContent"}).addClass("content content-closed").css("display","none").appendTo(j),rb(b));ea(b);e.isVisible?ra(b):(Ca(b),Ja(b,!0))}});Ia()},J=function(a,b){if(C()){var c=B[a],e=c.contentSelector,d=fa[a],f=P[a],g;e&&(g=d.content=Ba[a]=c.findNestedContent?f.find(e).eq(0):f.children(e).eq(0));g&&g.length?(g.data("layoutRole","content"),g.data("layoutCSS")||g.data("layoutCSS",z(g,"height")),g.css(q.content.cssReq),c.applyDemoStyles&&(g.css(q.content.cssDemo),f.css(q.content.cssDemoPane)),
A[a].content={},!1!==b&&Aa(a)):d.content=Ba[a]=!1}},ea=function(a){var b=f.layout.plugins.draggable,a=a?a.split(","):q.borderPanes;f.each(a,function(a,e){var d=B[e];if(!b||!P[e]||!d.resizable)return d.resizable=!1,!0;var g=A[e],k=B.zIndexes,j=q[e],l="horz"==j.dir?"top":"left",m=e+",center,"+q.oppositeEdge[e]+("horz"==j.dir?",west,east":""),o=ja[e],p=d.resizerClass,t=0,u,v,x=p+"-drag",y=p+"-"+e+"-drag",z=p+"-dragging",Wa=p+"-"+e+"-dragging",C=p+"-dragging-limit",E=p+"-"+e+"-dragging-limit",F=!1;g.isClosed||
o.attr("title",d.resizerTip).css("cursor",d.resizerCursor);o.draggable({containment:U[0],axis:"horz"==j.dir?"y":"x",delay:0,distance:1,grid:d.resizingGrid,helper:"clone",opacity:d.resizerDragOpacity,addClasses:!1,zIndex:k.resizer_drag,start:function(a,b){d=B[e];g=A[e];v=d.livePaneResizing;if(!1===G("ondrag_start",e))return!1;g.isResizing=!0;N.clear(e+"_closeSlider");D(e);u=g.resizerPosition;t=b.position[l];o.addClass(x+" "+y);F=!1;f("body").disableSelection();la(m)},drag:function(a,b){F||(b.helper.addClass(z+
" "+Wa).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),F=!0,g.isSliding&&P[e].css("zIndex",k.pane_sliding));var f=0;b.position[l]<u.min?(b.position[l]=u.min,f=-1):b.position[l]>u.max&&(b.position[l]=u.max,f=1);f?(b.helper.addClass(C+" "+E),window.defaultStatus=0<f&&e.match(/north|west/)||0>f&&e.match(/south|east/)?r.maxSizeWarning:r.minSizeWarning):(b.helper.removeClass(C+" "+E),window.defaultStatus="");v&&Math.abs(b.position[l]-t)>=d.liveResizingTolerance&&(t=b.position[l],
c(a,b,e))},stop:function(a,b){f("body").enableSelection();window.defaultStatus="";o.removeClass(x+" "+y);g.isResizing=!1;c(a,b,e,!0,m)}})});var c=function(a,b,c,e,d){var f=b.position,g=q[c],a=B[c],b=A[c],k;switch(c){case "north":k=f.top;break;case "west":k=f.left;break;case "south":k=V.offsetHeight-f.top-a.spacing_open;break;case "east":k=V.offsetWidth-f.left-a.spacing_open}k-=V["inset"+g.side];e?(!1!==G("ondrag_end",c)&&ma(c,k,!1,!0),ya(),b.isSliding&&d&&la(d,!0)):Math.abs(k-b.size)<a.liveResizingTolerance||
(ma(c,k,!1,!0),Ga.each(ua))}},ua=function(){var a=f(this),b=a.data("layoutMask"),b=A[b];"IFRAME"==b.tagName&&b.isVisible&&a.css({top:b.offsetTop,left:b.offsetLeft,width:b.outerWidth,height:b.outerHeight})},la=function(a,b){var c=a?a.split(","):f.layout.config.allPanes,e=B.zIndexes,d,g;f.each(c,function(a,c){g=A[c];d=B[c];g.isVisible&&(!b&&d.maskContents||d.maskObjects)&&La(c).each(function(){ua.call(this);this.style.zIndex=g.isSliding?e.pane_sliding+1:e.pane_normal+1;this.style.display="block"})})},
ya=function(){var a;f.each(f.layout.config.borderPanes,function(b,c){if(A[c].isResizing)return a=!0,!1});a||Ga.hide()},La=function(a){for(var b=f([]),c,e=0,d=Ga.length;e<d;e++)c=Ga.eq(e),c.data("layoutMask")===a&&(b=b.add(c));if(b.length)return b;b=P[a];c=A[a];var e=B[a],d=B.zIndexes,g=f([]),k,j,l,m,o;if(e.maskContents||e.maskObjects)for(o=0;o<(e.maskObjects?2:1);o++)k=e.maskObjects&&0==o,j=document.createElement(k?"iframe":"div"),l=f(j).data("layoutMask",a),j.className="ui-layout-mask ui-layout-mask-"+
a,m=j.style,m.display="block",m.position="absolute",k&&(j.frameborder=0,j.src="about:blank",m.opacity=0,m.filter="Alpha(Opacity='0')",m.border=0),"IFRAME"==c.tagName?(m.zIndex=d.pane_normal+1,U.append(j)):(l.addClass("ui-layout-mask-inside-pane"),m.zIndex=e.maskZindex||d.content_mask,m.top=0,m.left=0,m.width="100%",m.height="100%",b.append(j)),g=g.add(j),Ga=Ga.add(j);return g},Qa=function(a,b,c,e){if(C()){var a=y.call(this,a),d=P[a],g=Ba[a],k=ja[a],j=ga[a];d&&f.isEmptyObject(d.data())&&(d=!1);g&&
f.isEmptyObject(g.data())&&(g=!1);k&&f.isEmptyObject(k.data())&&(k=!1);j&&f.isEmptyObject(j.data())&&(j=!1);d&&d.stop(!0,!0);var l=B[a],m=F[a]||(d?d.data("layout"):0)||(g?g.data("layout"):0)||null;if((void 0!==e?e:l.destroyChildLayout)&&m&&!m.destroyed)m.destroy(!0),m.destroyed&&(m=null);d&&b&&!m?d.remove():d&&d[0]&&(b=l.paneClass,e=b+"-"+a,b=[b,b+"-open",b+"-closed",b+"-sliding",e,e+"-open",e+"-closed",e+"-sliding"],f.merge(b,M(d,!0)),d.removeClass(b.join(" ")).removeData("parentLayout").removeData("layoutPane").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+
$),g&&g.data("layout")?(g.width(g.width()),m.resizeAll()):g&&g.css(g.data("layoutCSS")).removeData("layoutCSS").removeData("layoutRole"),d.data("layout")||d.css(d.data("layoutCSS")).removeData("layoutCSS"));j&&j.remove();k&&k.remove();fa[a]=P[a]=Ba[a]=ja[a]=ga[a]=F[a]=!1;c||Oa()}},qa=function(a){var b=P[a],c=b[0].style;B[a].useOffscreenClose?(b.data(q.offscreenReset)||b.data(q.offscreenReset,{left:c.left,right:c.right}),b.css(q.offscreenCSS)):b.hide().removeData(q.offscreenReset)},pa=function(a){var b=
P[a],a=B[a],c=q.offscreenCSS,e=b.data(q.offscreenReset),d=b[0].style;b.show().removeData(q.offscreenReset);if(a.useOffscreenClose&&e&&(d.left==c.left&&(d.left=e.left),d.right==c.right))d.right=e.right},Va=function(a,b){if(C()){var c=y.call(this,a),e=B[c],d=A[c],f=ja[c];P[c]&&!d.isHidden&&!(A.initialized&&!1===G("onhide_start",c))&&(d.isSliding=!1,f&&f.hide(),!A.initialized||d.isClosed?(d.isClosed=!0,d.isHidden=!0,d.isVisible=!1,A.initialized||qa(c),Na("horz"===q[c].dir?"":"center"),(A.initialized||
e.triggerEventsOnLoad)&&G("onhide_end",c)):(d.isHiding=!0,sa(c,!1,b)))}},oa=function(a,b,c,e){if(C()){var a=y.call(this,a),d=A[a];P[a]&&d.isHidden&&!1!==G("onshow_start",a)&&(d.isSliding=!1,d.isShowing=!0,!1===b?sa(a,!0):da(a,!1,c,e))}},Pa=function(a,b){if(C()){var c=x(a),e=y.call(this,a),d=A[e];c&&c.stopImmediatePropagation();d.isHidden?oa(e):d.isClosed?da(e,!!b):sa(e)}},Xa=function(a){var b=A[a];qa(a);b.isClosed=!0;b.isVisible=!1},sa=function(a,b,c,e){function d(){j.isMoving=!1;Ja(f,!0);var a=q.oppositeEdge[f];
A[a].noRoom&&(D(a),Ea(a));ya();if(!e&&(A.initialized||k.triggerEventsOnLoad))o||G("onclose_end",f),o&&G("onshow_end",f),p&&G("onhide_end",f)}var f=y.call(this,a);if(!A.initialized&&P[f])Xa(f);else if(C()){var g=P[f],k=B[f],j=A[f],l=q[f],m,o,p;U.queue(function(a){if(!g||!k.closable&&!j.isShowing&&!j.isHiding||!b&&j.isClosed&&!j.isShowing)return a();var e=!j.isShowing&&!1===G("onclose_start",f);o=j.isShowing;p=j.isHiding;delete j.isShowing;delete j.isHiding;if(e)return a();m=!c&&!j.isClosed&&"none"!=
k.fxName_close;j.isMoving=!0;j.isClosed=!0;j.isVisible=!1;p?j.isHidden=!0:o&&(j.isHidden=!1);j.isSliding?Ra(f,!1):Na("horz"===q[f].dir?"":"center",!1);Ca(f);m?(la("center"+("horz"==l.dir?",west,east":""),!0),za(f,!0),g.hide(k.fxName_close,k.fxSettings_close,k.fxSpeed_close,function(){za(f,false);j.isClosed&&d();a()})):(qa(f),d(),a())})}},Ca=function(a){var b=ja[a],c=ga[a],e=B[a],d=q[a].side.toLowerCase(),g=e.resizerClass,k=e.togglerClass,j="-"+a;b.css(d,V["inset"+q[a].side]).removeClass(g+"-open "+
g+j+"-open").removeClass(g+"-sliding "+g+j+"-sliding").addClass(g+"-closed "+g+j+"-closed").unbind("dblclick."+$);e.resizable&&f.layout.plugins.draggable&&b.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title","");c&&(c.removeClass(k+"-open "+k+j+"-open").addClass(k+"-closed "+k+j+"-closed").attr("title",e.togglerTip_closed),c.children(".content-open").hide(),c.children(".content-closed").css("display","block"));Sa(a,!1);A.initialized&&Ia()},da=function(a,b,c,
e){function d(){j.isMoving=!1;R(f);j.isSliding||(ya(),Na("vert"==q[f].dir?"center":"",!1));ra(f)}if(C()){var f=y.call(this,a),g=P[f],k=B[f],j=A[f],l=q[f],m,o;U.queue(function(a){if(!g||!k.resizable&&!k.closable&&!j.isShowing||j.isVisible&&!j.isSliding)return a();if(j.isHidden&&!j.isShowing)a(),oa(f,!0);else{k.autoResize&&j.size!=k.size?Ma(f,k.size,!0,!0,!0):D(f,b);var p=G("onopen_start",f);if("abort"===p)return a();"NC"!==p&&D(f,b);if(j.minSize>j.maxSize)return Sa(f,!1),!e&&k.noRoomToOpenTip&&alert(k.noRoomToOpenTip),
a();b?Ra(f,!0):j.isSliding?Ra(f,!1):k.slidable&&Ja(f,!1);j.noRoom=!1;Ea(f);o=j.isShowing;delete j.isShowing;m=!c&&j.isClosed&&"none"!=k.fxName_open;j.isMoving=!0;j.isVisible=!0;j.isClosed=!1;o&&(j.isHidden=!1);m?(p="center"+("horz"==l.dir?",west,east":""),j.isSliding&&(p+=","+q.oppositeEdge[f]),la(p,!0),za(f,!0),g.show(k.fxName_open,k.fxSettings_open,k.fxSpeed_open,function(){za(f,false);j.isVisible&&d();a()})):(pa(f),d(),a())}})}},ra=function(a,b){var c=P[a],e=ja[a],d=ga[a],g=B[a],k=A[a],j=q[a].side.toLowerCase(),
l=g.resizerClass,m=g.togglerClass,o="-"+a;e.css(j,V["inset"+q[a].side]+Y(a)).removeClass(l+"-closed "+l+o+"-closed").addClass(l+"-open "+l+o+"-open");k.isSliding?e.addClass(l+"-sliding "+l+o+"-sliding"):e.removeClass(l+"-sliding "+l+o+"-sliding");g.resizerDblClickToggle&&e.bind("dblclick",Pa);E(0,e);g.resizable&&f.layout.plugins.draggable?e.draggable("enable").css("cursor",g.resizerCursor).attr("title",g.resizerTip):k.isSliding||e.css("cursor","default");d&&(d.removeClass(m+"-closed "+m+o+"-closed").addClass(m+
"-open "+m+o+"-open").attr("title",g.togglerTip_open),E(0,d),d.children(".content-closed").hide(),d.children(".content-open").css("display","block"));Sa(a,!k.isSliding);f.extend(k,v(c));A.initialized&&(Ia(),Aa(a,!0));if(!b&&(A.initialized||g.triggerEventsOnLoad)&&c.is(":visible"))G("onopen_end",a),k.isShowing&&G("onshow_end",a),A.initialized&&G("onresize_end",a)},db=function(a){function b(){d.isClosed?d.isMoving||da(e,!0):Ra(e,!0)}if(C()){var c=x(a),e=y.call(this,a),d=A[e],a=B[e].slideDelay_open;
c&&c.stopImmediatePropagation();d.isClosed&&c&&"mouseenter"===c.type&&0<a?N.set(e+"_openSlider",b,a):b()}},xa=function(a){function c(){g.isClosed?Ra(d,!1):g.isMoving||sa(d)}if(C()){var e=x(a),d=y.call(this,a),a=B[d],g=A[d],k=g.isMoving?1E3:300;!g.isClosed&&!g.isResizing&&("click"===a.slideTrigger_close?c():a.preventQuickSlideClose&&g.isMoving||a.preventPrematureSlideClose&&e&&f.layout.isMouseOverElem(e,P[d])||(e?N.set(d+"_closeSlider",c,b(a.slideDelay_close,k)):c()))}},za=function(a,b){var c=P[a],
e=A[a],d=B[a],f=B.zIndexes;b?(c.css({zIndex:f.pane_animate}),"south"==a?c.css({top:V.insetTop+V.innerHeight-c.outerHeight()}):"east"==a&&c.css({left:V.insetLeft+V.innerWidth-c.outerWidth()})):(c.css({zIndex:e.isSliding?f.pane_sliding:f.pane_normal}),"south"==a?c.css({top:"auto"}):"east"==a&&!c.css("left").match(/\-99999/)&&c.css({left:"auto"}),o.msie&&(d.fxOpacityFix&&"slide"!=d.fxName_open&&c.css("filter")&&1==c.css("opacity"))&&c[0].style.removeAttribute("filter"))},Ja=function(a,b){var c=B[a],
e=ja[a],d=c.slideTrigger_open.toLowerCase();if(e&&(!b||c.slidable))d.match(/mouseover/)?d=c.slideTrigger_open="mouseenter":d.match(/click|dblclick|mouseenter/)||(d=c.slideTrigger_open="click"),e[b?"bind":"unbind"](d+"."+$,db).css("cursor",b?c.sliderCursor:"default").attr("title",b?c.sliderTip:"")},Ra=function(a,b){function c(b){N.clear(a+"_closeSlider");b.stopPropagation()}var e=B[a],d=A[a],f=B.zIndexes,g=e.slideTrigger_close.toLowerCase(),k=b?"bind":"unbind",j=P[a],l=ja[a];d.isSliding=b;N.clear(a+
"_closeSlider");b&&Ja(a,!1);j.css("zIndex",b?f.pane_sliding:f.pane_normal);l.css("zIndex",b?f.pane_sliding+2:f.resizer_normal);g.match(/click|mouseleave/)||(g=e.slideTrigger_close="mouseleave");l[k](g,xa);"mouseleave"===g&&(j[k]("mouseleave."+$,xa),l[k]("mouseenter."+$,c),j[k]("mouseenter."+$,c));b?"click"===g&&!e.resizable&&(l.css("cursor",b?e.sliderCursor:"default"),l.attr("title",b?e.togglerTip_open:"")):N.clear(a+"_closeSlider")},Ea=function(a,b,c,e){var b=B[a],d=A[a],g=q[a],k=P[a],j=ja[a],l=
"vert"===g.dir,m=!1;if("center"===a||l&&d.noVerticalRoom)(m=0<=d.maxHeight)&&d.noRoom?(pa(a),j&&j.show(),d.isVisible=!0,d.noRoom=!1,l&&(d.noVerticalRoom=!1),R(a)):!m&&!d.noRoom&&(qa(a),j&&j.hide(),d.isVisible=!1,d.noRoom=!0);if("center"!==a)if(d.minSize<=d.maxSize){if(d.size>d.maxSize?Ma(a,d.maxSize,c,e,!0):d.size<d.minSize?Ma(a,d.minSize,c,e,!0):j&&(d.isVisible&&k.is(":visible"))&&(c=g.side.toLowerCase(),e=d.size+V["inset"+g.side],f.layout.cssNum(j,c)!=e&&j.css(c,e)),d.noRoom)d.wasOpen&&b.closable?
b.autoReopen?da(a,!1,!0,!0):d.noRoom=!1:oa(a,d.wasOpen,!0,!0)}else d.noRoom||(d.noRoom=!0,d.wasOpen=!d.isClosed&&!d.isSliding,d.isClosed||(b.closable?sa(a,!0,!0):Va(a,!0)))},ma=function(a,b,c,d){if(C()){var a=y.call(this,a),e=B[a],f=A[a],f=e.livePaneResizing&&!f.isResizing;e.autoResize=!1;Ma(a,b,c,f,d)}},Ma=function(a,d,e,g,k){function j(){for(var a="width"===z?p.outerWidth():p.outerHeight(),a=[{pane:l,count:1,target:d,actual:a,correct:d===a,attempt:d,cssSize:J}],c=a[0],k="Inaccurate size after resizing the "+
l+"-pane.";!c.correct;){thisTry={pane:l,count:c.count+1,target:d};thisTry.attempt=c.actual>d?b(0,c.attempt-(c.actual-d)):b(0,c.attempt+(d-c.actual));thisTry.cssSize=("horz"==q[l].dir?t:u)(P[l],thisTry.attempt);p.css(z,thisTry.cssSize);thisTry.actual="width"==z?p.outerWidth():p.outerHeight();thisTry.correct=d===thisTry.actual;B.showDebugMessages&&(1===a.length&&(K(k,!1),K(c,!1)),K(thisTry,!1));if(3<a.length)break;a.push(thisTry);c=a[a.length-1]}o.size=d;f.extend(o,v(p));o.isVisible&&p.is(":visible")&&
(r&&r.css(x,d+V[E]),Aa(l));!e&&(!F&&A.initialized&&o.isVisible)&&G("onresize_end",l);e||(o.isSliding||Na("horz"==q[l].dir?"":"center",F,g),Ia());c=q.oppositeEdge[l];d<I&&A[c].noRoom&&(D(c),Ea(c,!1,e));B.showDebugMessages&&1<a.length&&K(k+"\nSee the Error Console for details.",!0)}if(C()){var l=y.call(this,a),m=B[l],o=A[l],p=P[l],r=ja[l],x=q[l].side.toLowerCase(),z=q[l].sizeType.toLowerCase(),E="inset"+q[l].side,F=o.isResizing&&!m.triggerEventsDuringLiveResize,H=!0!==k&&m.animatePaneSizing,I,J;U.queue(function(a){D(l);
I=o.size;d=T(l,d);d=b(d,T(l,m.minSize));d=c(d,o.maxSize);if(d<o.minSize)a(),Ea(l,!1,e);else{if(!g&&d===I)return a();!e&&(A.initialized&&o.isVisible)&&G("onresize_start",l);J=("horz"==q[l].dir?t:u)(P[l],d);if(H&&p.is(":visible")){var k=f.layout.effects.size[l]||f.layout.effects.size.all,k=m.fxSettings_size.easing||k.easing,r=B.zIndexes,x={};x[z]=J+"px";o.isMoving=!0;p.css({zIndex:r.pane_animate}).show().animate(x,m.fxSpeed_size,k,function(){p.css({zIndex:o.isSliding?r.pane_sliding:r.pane_normal});
o.isMoving=!1;j();a()})}else p.css(z,J),p.is(":visible")?j():(o.size=d,f.extend(o,v(p))),a()}})}},Na=function(a,c,d){a=(a?a:"east,west,center").split(",");f.each(a,function(a,e){if(P[e]){var g=B[e],k=A[e],j=P[e],l=!0,m={},l={top:Y("north",!0),bottom:Y("south",!0),left:Y("west",!0),right:Y("east",!0),width:0,height:0};l.width=V.innerWidth-l.left-l.right;l.height=V.innerHeight-l.bottom-l.top;l.top+=V.insetTop;l.bottom+=V.insetBottom;l.left+=V.insetLeft;l.right+=V.insetRight;f.extend(k,v(j));if("center"===
e){if(!d&&k.isVisible&&l.width===k.outerWidth&&l.height===k.outerHeight)return!0;f.extend(k,I(e),{maxWidth:l.width,maxHeight:l.height});m=l;m.width=u(j,m.width);m.height=t(j,m.height);l=0<=m.width&&0<=m.height;if(!A.initialized&&g.minWidth>k.outerWidth){var g=g.minWidth-k.outerWidth,o=B.east.minSize||0,p=B.west.minSize||0,q=A.east.size,r=A.west.size,x=q,y=r;0<g&&(A.east.isVisible&&q>o)&&(x=b(q-o,q-g),g-=q-x);0<g&&(A.west.isVisible&&r>p)&&(y=b(r-p,r-g),g-=r-y);if(0===g){q!=o&&Ma("east",x,!0,d,!0);
r!=p&&Ma("west",y,!0,d,!0);Na("center",c,d);return}}}else{k.isVisible&&!k.noVerticalRoom&&f.extend(k,v(j),I(e));if(!d&&!k.noVerticalRoom&&l.height===k.outerHeight)return!0;m.top=l.top;m.bottom=l.bottom;m.height=t(j,l.height);k.maxHeight=m.height;l=0<=k.maxHeight;l||(k.noVerticalRoom=!0)}l?(!c&&A.initialized&&G("onresize_start",e),j.css(m),Ia(e),k.noRoom&&(!k.isClosed&&!k.isHidden)&&Ea(e),k.isVisible&&(f.extend(k,v(j)),A.initialized&&Aa(e))):!k.noRoom&&k.isVisible&&Ea(e);if(!k.isVisible)return!0;"center"===
e&&(k=f.layout.browser,k=k.isIE6||k.msie&&!f.support.boxModel,P.north&&(k||"IFRAME"==A.north.tagName)&&P.north.css("width",u(P.north,V.innerWidth)),P.south&&(k||"IFRAME"==A.south.tagName)&&P.south.css("width",u(P.south,V.innerWidth)));!c&&A.initialized&&G("onresize_end",e)}})},Oa=function(){if(A.initialized){if(U.is(":visible:")&&(f.extend(A.container,v(U)),V.outerHeight)){if(!1===G("onresizeall_start"))return!1;var a,b,c;f.each(["south","north","east","west"],function(a,d){P[d]&&(c=A[d],b=B[d],b.autoResize&&
c.size!=b.size?Ma(d,b.size,!0,!0,!0):(D(d),Ea(d,!1,!0,!0)))});Na("",!0,!0);Ia();b=B;f.each(q.allPanes,function(b,c){(a=P[c])&&A[c].isVisible&&G("onresize_end",c)});G("onresizeall_end")}}else O()},Za=function(a){a=y.call(this,a);if(B[a].resizeChildLayout){var b=P[a],c=Ba[a],d=fa[a],e=F[a];d.child&&!e&&(e=d.child.container,e=F[a]=(e?e.data("layout"):0)||null);e&&e.destroyed&&(e=F[a]=null);e||(e=F[a]=b.data("layout")||(c?c.data("layout"):0)||null);d.child=F[a];e&&e.resizeAll()}},Aa=function(a,c){if(C()){var d=
y.call(this,a),d=d?d.split(","):q.allPanes;f.each(d,function(a,d){function e(a){return b(l.css.paddingBottom,parseInt(a.css("marginBottom"),10)||0)}function f(){var a=B[d].contentIgnoreSelector,a=k.nextAll().not(a||":lt(0)"),b=a.filter(":visible"),c=b.filter(":last");m={top:k[0].offsetTop,height:k.outerHeight(),numFooters:a.length,hiddenFooters:a.length-b.length,spaceBelow:0};m.spaceAbove=m.top;m.bottom=m.top+m.height;m.spaceBelow=c.length?c[0].offsetTop+c.outerHeight()-m.bottom+e(c):e(k)}var g=P[d],
k=Ba[d],j=B[d],l=A[d],m=l.content;if(!g||!k||!g.is(":visible"))return!0;if(!k.length&&(J(d,!1),!k))return;if(!1!==G("onsizecontent_start",d)){if(!l.isMoving&&!l.isResizing||j.liveContentResizing||c||void 0==m.top)f(),0<m.hiddenFooters&&"hidden"===g.css("overflow")&&(g.css("overflow","visible"),f(),g.css("overflow","hidden"));g=l.innerHeight-(m.spaceAbove-l.css.paddingTop)-(m.spaceBelow-l.css.paddingBottom);if(!k.is(":visible")||m.height!=g)ba(k,g,!0),m.height=g;A.initialized&&G("onsizecontent_end",
d)}})}},Ia=function(b){b=(b=y.call(this,b))?b.split(","):q.borderPanes;f.each(b,function(b,c){var d=B[c],e=A[c],g=P[c],k=ja[c],m=ga[c],o;if(g&&k){var p=q[c].dir,r=e.isClosed?"_closed":"_open",v=d["spacing"+r],x=d["togglerAlign"+r],r=d["togglerLength"+r],y;if(0===v)k.hide();else{!e.noRoom&&!e.isHidden&&k.show();"horz"===p?(y=V.innerWidth,e.resizerLength=y,g=f.layout.cssNum(g,"left"),k.css({width:u(k,y),height:t(k,v),left:-9999<g?g:V.insetLeft})):(y=g.outerHeight(),e.resizerLength=y,k.css({height:t(k,
y),width:u(k,v),top:V.insetTop+Y("north",!0)}));E(d,k);if(m){if(0===r||e.isSliding&&d.hideTogglerOnSlide){m.hide();return}m.show();if(!(0<r)||"100%"===r||r>y)r=y,x=0;else if(a(x))switch(x){case "top":case "left":x=0;break;case "bottom":case "right":x=y-r;break;default:x=j((y-r)/2)}else g=parseInt(x,10),x=0<=x?g:y-r+g;if("horz"===p){var z=u(m,r);m.css({width:z,height:t(m,v),left:x,top:0});m.children(".content").each(function(){o=f(this);o.css("marginLeft",j((z-o.outerWidth())/2))})}else{var C=t(m,
r);m.css({height:C,width:u(m,v),top:x,left:0});m.children(".content").each(function(){o=f(this);o.css("marginTop",j((C-o.outerHeight())/2))})}E(0,m)}if(!A.initialized&&(d.initHidden||e.noRoom))k.hide(),m&&m.hide()}}})},rb=function(a){if(C()){var b=y.call(this,a),a=ga[b],c=B[b];a&&(c.closable=!0,a.bind("click."+$,function(a){a.stopPropagation();Pa(b)}).css("visibility","visible").css("cursor","pointer").attr("title",A[b].isClosed?c.togglerTip_closed:c.togglerTip_open).show())}},Sa=function(a,b){f.layout.plugins.buttons&&
f.each(A[a].pins,function(c,d){f.layout.buttons.setPinState(fa,f(d),a,b)})},U=f(this).eq(0);if(!U.length)return B.showErrorMessages&&K(r.errContainerMissing,!0),null;if(U.data("layoutContainer")&&U.data("layout"))return U.data("layout");var P={},Ba={},ja={},ga={},Ga=f([]),V=A.container,$=A.id,fa={options:B,state:A,container:U,panes:P,contents:Ba,resizers:ja,togglers:ga,hide:Va,show:oa,toggle:Pa,open:da,close:sa,slideOpen:db,slideClose:xa,slideToggle:function(a){a=y.call(this,a);Pa(a,!0)},setSizeLimits:D,
_sizePane:Ma,sizePane:ma,sizeContent:Aa,swapPanes:function(a,c){function d(a){var b=P[a],c=Ba[a];return!b?!1:{pane:a,P:b?b[0]:!1,C:c?c[0]:!1,state:f.extend(!0,{},A[a]),options:f.extend(!0,{},B[a])}}function e(a,c){if(a){var d=a.P,g=a.C,k=a.pane,j=q[c],m=j.side.toLowerCase(),o="inset"+j.side,p=f.extend({},A[c]),r=B[c],t={resizerCursor:r.resizerCursor};f.each(["fxName","fxSpeed","fxSettings"],function(a,b){t[b+"_open"]=r[b+"_open"];t[b+"_close"]=r[b+"_close"];t[b+"_size"]=r[b+"_size"]});P[c]=f(d).data({layoutPane:fa[c],
layoutEdge:c}).css(q.hidden).css(j.cssReq);Ba[c]=g?f(g):!1;B[c]=f.extend({},a.options,t);A[c]=f.extend({},a.state);d.className=d.className.replace(RegExp(r.paneClass+"-"+k,"g"),r.paneClass+"-"+c);va(c);j.dir!=q[k].dir?(d=l[c]||0,D(c),d=b(d,A[c].minSize),ma(c,d,!0,!0)):ja[c].css(m,V[o]+(A[c].isVisible?Y(c):0));a.state.isVisible&&!p.isVisible?ra(c,!0):(Ca(c),Ja(c,!0));a=null}}if(C()){var g=y.call(this,a);A[g].edge=c;A[c].edge=g;if(!1===G("onswap_start",g)||!1===G("onswap_start",c))A[g].edge=g,A[c].edge=
c;else{var k=d(g),j=d(c),l={};l[g]=k?k.state.size:0;l[c]=j?j.state.size:0;P[g]=!1;P[c]=!1;A[g]={};A[c]={};ga[g]&&ga[g].remove();ga[c]&&ga[c].remove();ja[g]&&ja[g].remove();ja[c]&&ja[c].remove();ja[g]=ja[c]=ga[g]=ga[c]=!1;e(k,c);e(j,g);k=j=l=null;P[g]&&P[g].css(q.visible);P[c]&&P[c].css(q.visible);Oa();G("onswap_end",g);G("onswap_end",c)}}},initContent:J,addPane:ta,removePane:Qa,createChildLayout:ha,enableClosable:rb,disableClosable:function(a,b){if(C()){var c=y.call(this,a),d=ga[c];d&&(B[c].closable=
!1,A[c].isClosed&&da(c,!1,!0),d.unbind("."+$).css("visibility",b?"hidden":"visible").css("cursor","default").attr("title",""))}},enableSlidable:function(a){if(C()){var a=y.call(this,a),b=ja[a];b&&b.data("draggable")&&(B[a].slidable=!0,s.isClosed&&Ja(a,!0))}},disableSlidable:function(a){if(C()){var a=y.call(this,a),b=ja[a];b&&(B[a].slidable=!1,A[a].isSliding?sa(a,!1,!0):(Ja(a,!1),b.css("cursor","default").attr("title",""),E(null,b[0])))}},enableResizable:function(a){if(C()){var a=y.call(this,a),b=
ja[a],c=B[a];b&&b.data("draggable")&&(c.resizable=!0,b.draggable("enable"),A[a].isClosed||b.css("cursor",c.resizerCursor).attr("title",c.resizerTip))}},disableResizable:function(a){if(C()){var a=y.call(this,a),b=ja[a];b&&b.data("draggable")&&(B[a].resizable=!1,b.draggable("disable").css("cursor","default").attr("title",""),E(null,b[0]))}},allowOverflow:e,resetOverflow:m,destroy:function(a){f(window).unbind("."+$);f(document).unbind("."+$);U.clearQueue().removeData("layout").removeData("layoutContainer").removeClass(B.containerClass).unbind("."+
$);Ga.remove();f.each(q.allPanes,function(b,c){Qa(c,!1,!0,a)});U.data("layoutCSS")&&!U.data("layoutRole")&&U.css(U.data("layoutCSS")).removeData("layoutCSS");"BODY"===V.tagName&&(U=f("html")).data("layoutCSS")&&U.css(U.data("layoutCSS")).removeData("layoutCSS");d(fa,f.layout.onDestroy);S();for(n in fa)n.match(/^(container|options)$/)||delete fa[n];fa.destroyed=!0;return fa},initPanes:C,resizeAll:Oa,runCallbacks:G,hasParentLayout:!1,children:F,north:!1,south:!1,west:!1,east:!1,center:!1};return"cancel"===
function(){ka();var a=B;A.creatingLayout=!0;d(fa,f.layout.onCreate);if(!1===G("onload_start"))return"cancel";var b=U[0],c=V.tagName=b.tagName,e=V.id=b.id,g=V.className=b.className,b=B,k=b.name,j="BODY"===c,l={},m=U.data("parentLayout"),o=U.data("layoutEdge"),p=m&&o;V.selector=U.selector.split(".slice")[0];V.ref=(b.name?b.name+" layout / ":"")+c+(e?"#"+e:g?".["+g+"]":"");U.data({layout:fa,layoutContainer:$}).addClass(b.containerClass);c={destroy:"",initPanes:"",resizeAll:"resizeAll",resize:"resizeAll"};
for(k in c)U.bind("layout"+k.toLowerCase()+"."+$,fa[c[k]||k]);p&&(fa.hasParentLayout=!0,m[o].child=m.children[o]=U.data("layout"));U.data("layoutCSS")||(j?(l=f.extend(z(U,"overflow,position,margin,padding,border"),{height:U.css("height"),overflow:U.css("overflow"),overflowX:U.css("overflowX"),overflowY:U.css("overflowY")}),c=f("html"),c.data("layoutCSS",{height:"auto",overflow:c.css("overflow"),overflowX:c.css("overflowX"),overflowY:c.css("overflowY")})):l=z(U,"overflow,position,margin,padding,border,top,bottom,left,right,width,height,overflow,overflowX,overflowY"),
U.data("layoutCSS",l));try{if(j)f("html").css({height:"100%",overflow:"hidden",overflowX:"hidden",overflowY:"hidden"}),f("body").css({position:"relative",height:"100%",overflow:"hidden",overflowX:"hidden",overflowY:"hidden",margin:0,padding:0,border:"none"}),f.extend(V,v(U));else{var l={overflow:"hidden",overflowX:"hidden",overflowY:"hidden"},q=U.css("position");U.css("height");if(!p&&(!q||!q.match(/fixed|absolute|relative/)))l.position="relative";U.css(l);U.is(":visible")&&(f.extend(V,v(U)),b.showErrorMessages&&
1>V.innerHeight&&K(r.errContainerHeight.replace(/CONTAINER/,V.ref),!0))}}catch(t){}W();f(window).bind("unload."+$,S);d(fa,f.layout.onLoad);a.initPanes&&O();delete A.creatingLayout;return A.initialized}()?null:fa};f.ui||(f.ui={});f.ui.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(a){for(var b=document.cookie,b=b?b.split(";"):[],c,d=0,j=b.length;d<j;d++){c=f.trim(b[d]).split("=");if(c[0]==a)return decodeURIComponent(c[1])}return null},write:function(a,b,c){var d="",f="",j=false,c=c||
{},l=c.expires;if(l&&l.toUTCString)f=l;else if(l===null||typeof l==="number"){f=new Date;if(l>0)f.setDate(f.getDate()+l);else{f.setFullYear(1970);j=true}}f&&(d=d+(";expires="+f.toUTCString()));c.path&&(d=d+(";path="+c.path));c.domain&&(d=d+(";domain="+c.domain));c.secure&&(d=d+";secure");document.cookie=a+"="+(j?"":encodeURIComponent(b))+d},clear:function(a){f.ui.cookie.write(a,"",{expires:-1})}};f.cookie||(f.cookie=function(a,b,c){var d=f.ui.cookie;if(b===null)d.clear(a);else{if(b===void 0)return d.read(a);
d.write(a,b,c)}});f.layout.plugins.stateManagement=!0;f.layout.config.optionRootKeys.push("stateManagement");f.layout.defaults.stateManagement={enabled:!1,autoSave:!0,autoLoad:!0,stateKeys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden",cookie:{name:"",domain:"",path:"",expires:"",secure:!1}};f.layout.optionsMap.layout.push("stateManagement");f.layout.state={saveCookie:function(a,b,c){var d=
a.options,j=d.stateManagement,c=f.extend(true,{},j.cookie,c||null),a=a.state.stateData=a.readState(b||j.stateKeys);f.ui.cookie.write(c.name||d.name||"Layout",f.layout.state.encodeJSON(a),c);return f.extend(true,{},a)},deleteCookie:function(a){a=a.options;f.ui.cookie.clear(a.stateManagement.cookie.name||a.name||"Layout")},readCookie:function(a){a=a.options;return(a=f.ui.cookie.read(a.stateManagement.cookie.name||a.name||"Layout"))?f.layout.state.decodeJSON(a):{}},loadCookie:function(a){var b=f.layout.state.readCookie(a);
if(b){a.state.stateData=f.extend(true,{},b);a.loadState(b)}return b},loadState:function(a,b,c){b=f.layout.transformData(b);if(!f.isEmptyObject(b)){f.extend(true,a.options,b);if(a.state.initialized){var d,j,l,m,u,t=c===false;f.each(f.layout.config.borderPanes,function(c,e){state=a.state[e];j=b[e];if(typeof j=="object"){l=j.size;u=j.initClosed;m=j.initHidden;(d=state.isVisible)||a.sizePane(e,l,false,false);m===true?a.hide(e,t):u===false?a.open(e,false,t):u===true?a.close(e,false,t):m===false&&a.show(e,
false,t);d&&a.sizePane(e,l,false,t)}})}}},readState:function(a,b){var c={},d={isClosed:"initClosed",isHidden:"initHidden"},j=a.state,l=f.layout.config.allPanes,m,u,t;if(!b)b=a.options.stateManagement.stateKeys;f.isArray(b)&&(b=b.join(","));for(var b=b.replace(/__/g,".").split(","),v=0,z=b.length;v<z;v++){m=b[v].split(".");u=m[0];m=m[1];if(!(f.inArray(u,l)<0)){t=j[u][m];if(t!=void 0){m=="isClosed"&&j[u].isSliding&&(t=true);(c[u]||(c[u]={}))[d[m]?d[m]:m]=t}}}return c},encodeJSON:function(a){function b(a){var c=
[],d=0,f,g,j;for(f in a){g=a[f];j=typeof g;j=="string"?g='"'+g+'"':j=="object"&&(g=b(g));c[d++]='"'+f+'":'+g}return"{"+c.join(",")+"}"}return b(a)},decodeJSON:function(a){try{return f.parseJSON?f.parseJSON(a):window.eval("("+a+")")||{}}catch(b){return{}}},_create:function(a){var b=f.layout.state;f.extend(a,{readCookie:function(){return b.readCookie(a)},deleteCookie:function(){b.deleteCookie(a)},saveCookie:function(c,d){return b.saveCookie(a,c,d)},loadCookie:function(){return b.loadCookie(a)},loadState:function(c,
d){b.loadState(a,c,d)},readState:function(c){return b.readState(a,c)},encodeJSON:b.encodeJSON,decodeJSON:b.decodeJSON});a.state.stateData={};var c=a.options.stateManagement;if(c.enabled)c.autoLoad?a.loadCookie():a.state.stateData=a.readCookie()},_unload:function(a){var b=a.options.stateManagement;if(b.enabled)b.autoSave?a.saveCookie():a.state.stateData=a.readState()}};f.layout.onCreate.push(f.layout.state._create);f.layout.onUnload.push(f.layout.state._unload);f.layout.plugins.buttons=!0;f.layout.defaults.autoBindCustomButtons=
!1;f.layout.optionsMap.layout.push("autoBindCustomButtons");m=f.layout.language;f.layout.buttons={init:function(a){var b=a.options.name||"",c;f.each(["toggle","open","close","pin","toggle-slide","open-slide"],function(d,j){f.each(f.layout.config.borderPanes,function(d,l){f(".ui-layout-button-"+j+"-"+l).each(function(){c=f(this).data("layoutName")||f(this).attr("layoutName");(c==void 0||c===b)&&a.bindButton(this,j,l)})})})},get:function(a,b,c,d){var j=f(b),a=a.options,l=a.showErrorMessages;if(j.length)if(f.inArray(c,
f.layout.config.borderPanes)<0){l&&f.layout.msg(m.errButton+m.pane+": "+c,true);j=f("")}else{b=a[c].buttonClass+"-"+d;j.addClass(b+" "+b+"-"+c).data("layoutName",a.name)}else l&&f.layout.msg(m.errButton+m.selector+": "+b,true);return j},bind:function(a,b,c,d){var j=f.layout.buttons;switch(c.toLowerCase()){case "toggle":j.addToggle(a,b,d);break;case "open":j.addOpen(a,b,d);break;case "close":j.addClose(a,b,d);break;case "pin":j.addPin(a,b,d);break;case "toggle-slide":j.addToggle(a,b,d,true);break;
case "open-slide":j.addOpen(a,b,d,true)}return a},addToggle:function(a,b,c,d){f.layout.buttons.get(a,b,c,"toggle").click(function(b){a.toggle(c,!!d);b.stopPropagation()});return a},addOpen:function(a,b,c,d){f.layout.buttons.get(a,b,c,"open").attr("title",m.Open).click(function(b){a.open(c,!!d);b.stopPropagation()});return a},addClose:function(a,b,c){f.layout.buttons.get(a,b,c,"close").attr("title",m.Close).click(function(b){a.close(c);b.stopPropagation()});return a},addPin:function(a,b,c){var d=f.layout.buttons,
j=d.get(a,b,c,"pin");if(j.length){var l=a.state[c];j.click(function(b){d.setPinState(a,f(this),c,l.isSliding||l.isClosed);l.isSliding||l.isClosed?a.open(c):a.close(c);b.stopPropagation()});d.setPinState(a,j,c,!l.isClosed&&!l.isSliding);l.pins.push(b)}return a},setPinState:function(a,b,c,d){var f=b.attr("pin");if(!(f&&d===(f=="down"))){a=a.options[c].buttonClass+"-pin";f=a+"-"+c;c=a+"-up "+f+"-up";a=a+"-down "+f+"-down";b.attr("pin",d?"down":"up").attr("title",d?m.Unpin:m.Pin).removeClass(d?c:a).addClass(d?
a:c)}},syncPinBtns:function(a,b,c){f.each(state[b].pins,function(d,j){f.layout.buttons.setPinState(a,f(j),b,c)})},_load:function(a){var b=f.layout.buttons;f.extend(a,{bindButton:function(c,d,e){return b.bind(a,c,d,e)},addToggleBtn:function(c,d,e){return b.addToggle(a,c,d,e)},addOpenBtn:function(c,d,e){return b.addOpen(a,c,d,e)},addCloseBtn:function(c,d){return b.addClose(a,c,d)},addPinBtn:function(c,d){return b.addPin(a,c,d)}});for(var c=0;c<4;c++)a.state[f.layout.config.borderPanes[c]].pins=[];a.options.autoBindCustomButtons&&
b.init(a)},_unload:function(){}};f.layout.onLoad.push(f.layout.buttons._load);f.layout.plugins.browserZoom=!0;f.layout.defaults.browserZoomCheckInterval=1E3;f.layout.optionsMap.layout.push("browserZoomCheckInterval");f.layout.browserZoom={_init:function(a){f.layout.browserZoom.ratio()!==false&&f.layout.browserZoom._setTimer(a)},_setTimer:function(a){if(!a.destroyed){var b=a.options,c=a.state,d=a.hasParentLayout?5E3:Math.max(b.browserZoomCheckInterval,100);setTimeout(function(){if(!a.destroyed&&b.resizeWithWindow){var d=
f.layout.browserZoom.ratio();if(d!==c.browserZoom){c.browserZoom=d;a.resizeAll()}f.layout.browserZoom._setTimer(a)}},d)}},ratio:function(){function a(b,c){return(parseInt(b,10)/parseInt(c,10)*100).toFixed()}var b=window,c=screen,d=document,j=d.documentElement||d.body,l=f.layout.browser,m=l.version,u,t,v;return l.msie&&m>8||!l.msie?false:c.deviceXDPI?a(c.deviceXDPI,c.systemXDPI):l.webkit&&(u=d.body.getBoundingClientRect)?a(u.left-u.right,d.body.offsetWidth):l.webkit&&(t=b.outerWidth)?a(t,b.innerWidth):
(t=c.width)&&(v=j.clientWidth)?a(t,v):false}};f.layout.onReady.push(f.layout.browserZoom._init)})(j)});define("RepositoryBrowser",["Class","jquery","PubSub","repository-browser-i18n-"+(window&&window.__DEPS__&&window.__DEPS__.lang||"en"),"jstree","jqgrid","jquery-layout"],function(j,f,a,d){function c(a){a.each(function(){f(this).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).each(function(){this.onselectstart=function(){return!1}})})}var b=
[],l=0,m=(new Date).getTime(),g={repositoryManager:null,repositoryFilter:[],objectTypeFilter:[],renditionFilter:["cmis:none"],filter:["url"],element:null,isFloating:!1,verticalPadding:100,horizontalPadding:50,maxHeight:1E3,minHeight:400,minWidth:400,maxWidth:1200,treeWidth:300,listWidth:"auto",pageSize:8,rootPath:"",rootFolderId:"aloha",columns:{icon:{title:"",width:30,sortable:!1,resizable:!1},name:{title:"Name",width:200,sorttype:"text"},url:{title:"URL",width:220,sorttype:"text"},preview:{title:"Preview",
width:150,sorttype:"text"}},i18n:{Browsing:"Browsing",Close:"Close","in":"in","Input search text...":"Input search text...",numerous:"numerous",of:"of","Repository Browser":"Repository Browser",Search:"Search","Searching for":"Searching for",Viewing:"Viewing"}};return j.extend({_cachedRepositoryObjects:{},_searchQuery:null,_orderBy:null,$_grid:null,$_tree:null,$_list:null,_isOpened:!0,_constructor:function(){this.init.apply(this,arguments)},init:function(c){c=f.extend({},g,c,{i18n:d});if(!c.element||
0===c.element.length)c.isFloating=!0,c.element=this._createOverlay();c.maxWidth<c.minWidth&&(c.maxWidth=c.minWidth);f.extend(this,c);this._cachedRepositoryObjects={};this._pagingCount=this._orderBy=this._searchQuery=null;this._pagingOffset=0;this._pagingBtns={first:null,end:null,next:null,prev:null};this._initializeUI();b.push(this);a.pub("repository-browser.initialized",{data:this})},_i18n:function(a){return this.i18n[a]||a},_initializeUI:function(){this.element.attr("data-repository-browser",++m);
this.element.width(this.maxWidth);this.$_grid=this._createGrid(this.element).resize();this._setIntialHeight();this.$_tree=this._createTree(this.$_grid.find(".ui-layout-west"));this.$_list=this._createList(this.$_grid.find(".ui-layout-center"));var a=this,d=this.treeWidth/5;this.$_grid.layout({enableCursorHotkey:!1,west__size:this.treeWidth-1,west__minSize:this.treeWidth-d,west__maxSize:this.treeWidth+d,center__size:"auto",paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",
onresize:function(b,c){"center"===b&&a.$_list.setGridWidth(c.width())}}).sizePane("west",this.treeWidth);c(this.$_grid);this._preloadImages();f(function(){f(window).resize(function(){a._onWindowResized()})});this.element.mousedown(function(){f.each(b,function(a){this.element.css("z-index",99999+a)});f(this).css("z-index",99999+b.length+1)});f(".repository-browser-grid").css("width",this.maxWidth);this.close()},_setIntialHeight:function(){var a=this.maxHeight-f(window).height()+this.verticalPadding;
this.$_grid.height(0<a?Math.max(this.minHeight,this.maxHeight-a):this.maxHeight)},_onWindowResized:function(){var a=this.maxWidth-f(window).width()+this.horizontalPadding,a=0<a?Math.max(this.minWidth,this.maxWidth-a):this.maxWidth;this.element.width(a);this.$_grid.width(a)},_preloadImages:function(){for(var a=this.rootPath+"img/",b="arrow-000-medium.png arrow-180.png arrow-315-medium.png arrow-stop-180.png arrow-stop.png arrow.png control-stop-square-small.png folder-horizontal-open.png folder-open.png magnifier-left.png page.png picture.png sort-alphabet-descending.png sort-alphabet.png".split(" "),
c=b.length;c;)document.createElement("img").src=a+b[--c]},_processRepoResponse:function(a,b,c){var d=[],f;"function"===typeof b&&(c=b,b=void 0);for(f=0;f<a.length;f++)d.push(this._harvestRepoObject(a[f]));c(d,b)},_harvestRepoObject:function(a){++m;this._cachedRepositoryObjects[m]=f.extend(a,{uid:m,loaded:!1});var a=this._cachedRepositoryObjects[m],b;switch(a.baseType){case "folder":b="folder";break;case "document":b="document"}return{data:{title:a.name,attr:{"data-repo-obj":a.uid},icon:b||""},attr:a.type?
{rel:a.type}:void 0,state:a.hasMoreItems||"folder"===a.baseType?"closed":null,resource:a}},_fetchRepoRoot:function(a){this.repositoryManager&&this.getRepoChildren({inFolderId:this.rootFolderId,repositoryFilter:this.repositoryFilter},a)},_getObjectFromCache:function(a){return a&&a.length?this._cachedRepositoryObjects[a.find("a:first").attr("data-repo-obj")]:null},_onTreeNodeSelected:function(a,b){if(!b.args[0].context){var c=this._getObjectFromCache(b.rslt.obj);c&&(this._pagingOffset=0,this._searchQuery=
null,this._currentFolder=c,this._fetchItems(c))}},_createTree:function(a){var b=f('<div class="repository-browser-tree">'),c=f('<div class="repository-browser-tree-header repository-browser-grab-handle">'+this._i18n("Repository Browser")+"</div>");a.append(c,b);b.height(this.$_grid.height()-c.outerHeight(!0));b.bind("loaded.jstree",function(){f(this).find(">ul>li:first").css("padding-top",5);b.jstree("open_node",'li[rel="repository"]')});var d=this;b.bind("select_node.jstree",function(a,b){d._onTreeNodeSelected(a,
b)});b.jstree({types:this.types,rootFolderId:this.rootFolderId,plugins:["themes","json_data","ui","types"],core:{animation:250},themes:{url:this.rootPath+"css/jstree.css",dots:!0,icons:!0,theme:"browser"},json_data:{data:function(a,b){d.repositoryManager?(d.jstree_callback=b,d._fetchSubnodes(a,b)):b()},correct_state:!0},ui:{select_limit:1}});return b},_createGrid:function(a){var b=f('<div class="repository-browser-grid\t\t\t\t             repository-browser-shadow\t\t\t\t\t\t\t repository-browser-rounded-top">\t\t\t\t\t<div class="ui-layout-west"></div>\t\t\t\t\t<div class="ui-layout-center"></div>\t\t\t\t</div>');
a.append(b);return b},_createList:function(a){var b=f('<table id="repository-browser-list-'+ ++m+'" class="repository-browser-list"></table>'),c=[{name:"id",sorttype:"int",firstsortorder:"asc",hidden:!0}],d=[""];f.each(this.columns,function(a,b){d.push(b.title||"&nbsp;");c.push({name:a,width:b.width,sortable:b.sortable,sorttype:b.sorttype,resizable:b.resizable,fixed:b.fixed})});var g="repository-browser-list-page-"+ ++m;a.append(b,f('<div id="'+g+'">'));b.jqGrid({datatype:"local",width:a.width(),
shrinkToFit:!0,colNames:d,colModel:c,caption:"&nbsp;",altRows:!0,altclass:"repository-browser-list-altrow",resizeclass:"repository-browser-list-resizable",pager:"#"+g,viewrecords:!0,onPaging:function(){},loadError:function(){},ondblClickRow:function(){},gridComplete:function(){},loadComplete:function(){}});a.find(".ui-jqgrid-bdiv").height(this.$_grid.height()-(a.find(".ui-jqgrid-titlebar").height()+a.find(".ui-jqgrid-hdiv").height()+a.find(".ui-jqgrid-pager").height()));var j=this;b.click(function(){j.rowClicked.apply(j,
arguments)});a.find(".ui-pg-button").unbind().find(">span.ui-icon").each(function(){var a=this.className.match(/ui\-icon\-seek\-([a-z]+)/)[1];j._pagingBtns[a]=f(this).parent().addClass("ui-state-disabled").click(function(){f(this).hasClass("ui-state-disabled")||j._doPaging(a)})});a.find(".ui-pg-input").parent().hide();a.find(".ui-separator").parent().css("opacity",0).first().hide();this._createTitlebar(a);var l=b[0].p;a.find(".ui-jqgrid-view tr:first th div").each(function(a){!1!==l.colModel[a].sortable&&
(f(this).css("cursor","pointer"),f(this).unbind().click(function(b){b.stopPropagation();j._sortList(l.colModel[a],this)}))});return b},_createTitlebar:function(a){var a=a.find(".ui-jqgrid-titlebar"),b=f('<div class="repository-browser-btns">\t\t\t\t\t<input type="text" class="repository-browser-search-field" />\t\t\t\t\t<span class="repository-browser-btn repository-browser-search-btn">\t\t\t\t\t\t<span class="repository-browser-search-icon"></span>\t\t\t\t\t</span>\t\t\t\t\t<span class="repository-browser-btn repository-browser-close-btn">'+
this._i18n("Close")+'</span>\t\t\t\t\t<div class="repository-browser-clear"></div>\t\t\t\t</div>'),c=this;a.addClass("repository-browser-grab-handle").append(b);a.find(".repository-browser-search-btn").html(this._i18n("Search")).click(function(){c._triggerSearch()});var d=this._i18n("Input search text..."),b=a.find(".repository-browser-search-field");b.val(d).addClass("repository-browser-search-field-empty");b.keypress(function(a){13===a.keyCode&&c._triggerSearch()});b.focus(function(){f(this).val()===
d&&f(this).val("").removeClass("repository-browser-search-field-empty")});b.blur(function(){""===f(this).val()&&f(this).val(d).addClass("repository-browser-search-field-empty")});a.find(".repository-browser-close-btn").click(function(){c.close()});a.find(".repository-browser-btn").mousedown(function(){f(this).addClass("repository-browser-pressed")}).mouseup(function(){f(this).removeClass("repository-browser-pressed")})},_triggerSearch:function(){var a=this.$_grid.find("input.repository-browser-search-field"),
b=a.val();if(f(a).hasClass("aloha-browser-search-field-empty")||""===b)b=null;this._pagingOffset=0;this._searchQuery=b;this._fetchItems(this._currentFolder)},_sortList:function(a,b){this.$_grid.find("span.ui-grid-ico-sort").addClass("ui-state-disabled");a.sortorder="asc"===a.sortorder?"desc":"asc";f(b).find("span.s-ico").show().find(".ui-icon-"+a.sortorder).removeClass("ui-state-disabled");this._setSortOrder(a.name,a.sortorder);this._fetchItems(this._currentFolder)},_doPaging:function(a){switch(a){case "first":this._pagingOffset=
0;break;case "end":this._pagingOffset=0===this._pagingCount%this.pageSize?this._pagingCount-this.pageSize:this._pagingCount-this._pagingCount%this.pageSize;break;case "next":this._pagingOffset+=this.pageSize;break;case "prev":this._pagingOffset-=this.pageSize}this._fetchItems(this._currentFolder)},_setSortOrder:function(a,b){var c={},d=!1,f=this._orderBy||[],g,j,l;c[a]=b||"asc";for(l=0;l<f.length;++l){g=f[l];for(j in g)if(g.hasOwnProperty(j)&&j===a){f.splice(l,1);f.unshift(c);d=!0;break}if(d)break}d&&
f.unshift(c);this._orderBy=f},_listItems:function(a){var b=this.$_list.clearGridData(),c,d;for(c=0;c<a.length;c++)d=a[c].resource,b.addRowData(d.uid,f.extend({id:d.id},this.renderRowCols(d)))},handleTimeout:function(){},_processItems:function(a,b){this._pagingCount=b&&f.isNumeric(b.numItems)?b.numItems:null;this.$_grid.find(".loading").hide();this.$_list.show();this._listItems(a);var c=this._pagingBtns;0>=this._pagingOffset?c.first.add(c.prev).addClass("ui-state-disabled"):c.first.add(c.prev).removeClass("ui-state-disabled");
f.isNumeric(this._pagingCount)?(c.end.addClass("ui-state-disabled"),a.length<this.pageSize?c.next.addClass("ui-state-disabled"):c.next.removeClass("ui-state-disabled")):this._pagingOffset+this.pageSize>=this._pagingCount?c.end.add(c.next).addClass("ui-state-disabled"):c.end.add(c.next).removeClass("ui-state-disabled");var d;0===a.length&&0===this._pagingOffset?d=c=0:(c=this._pagingOffset+1,d=c+a.length-1);this.$_grid.find(".ui-paging-info").html(this._i18n("Viewing")+" "+c+" - "+d+" "+this._i18n("of")+
" "+(f.isNumeric(this._pagingCount)?this._pageingCount:this._i18n("numerous")));b&&b.timeout&&this.handleTimeout()},_createOverlay:function(){0===f(".repository-browser-modal-overlay").length&&f("body").append('<div class="repository-browser-modal-overlay" style="top: -99999px; z-index: 99999;"></div>');var a=this;f(".repository-browser-modal-overlay").click(function(){a.close()});var b=f('<div class="repository-browser-modal-window" style="top: -99999px; z-index: 99999;">');f("body").append(b);return b},
_fetchSubnodes:function(a,b){if(-1===a)this._fetchRepoRoot(b);else{var c;for(c=0;c<a.length;c++){var d=this._getObjectFromCache(a.eq(c));d&&this.fetchChildren(d,b)}}},getRepoChildren:function(a,b){if(this.repositoryManager){var c=this;this.repositoryManager.getChildren(a,function(a){c._processRepoResponse(a,b)})}},queryRepository:function(a,b){if(this.repositoryManager){var c=this;this.repositoryManager.query(a,function(a){c._processRepoResponse(0<a.results?a.items:[],{numItems:a.numItems,hasMoreItems:a.hasMoreItems,
timeout:a.timeout},b)})}},renderRowCols:function(a){var b={};f.each(this.columns,function(c){switch(c){case "icon":b.icon='<div class="repository-browser-icon repository-browser-icon-'+a.type+'"></div>';break;default:b[c]=a[c]||"--"}});return b},onSelect:function(){},fetchChildren:function(a,b){if((!0===a.hasMoreItems||"folder"===a.baseType)&&!1===a.loaded){var c=this;this.getRepoChildren({inFolderId:a.id,repositoryId:a.repositoryId},function(d){c._cachedRepositoryObjects[a.uid].loaded=!0;"function"===
typeof b&&b(d)})}},rowClicked:function(a){a=f(a.target).parent("tr");return a.length?(a=this._cachedRepositoryObjects[a.attr("id")],this.onSelect(a),a):null},getFieldOfHeader:function(a){return a.find("div.ui-jqgrid-sortable").attr("id").replace("jqgh_","")},_fetchItems:function(a){if(a){var b="string"===typeof this._searchQuery;this.$_list.setCaption("string"===typeof this._searchQuery?this._i18n("Searching for")+' "'+this._searchQuery+'" '+this._i18n("in")+" "+a.name:this._i18n("Browsing")+": "+
a.name);this.$_list.hide();this.$_grid.find(".loading").show();var c=this;this.queryRepository({repositoryId:a.repositoryId,inFolderId:a.id,queryString:this._searchQuery,orderBy:this._orderBy,skipCount:this._pagingOffset,maxItems:this.pageSize,objectTypeFilter:this.objectTypeFilter,renditionFilter:this.renditionFilter,filter:this.filter,recursive:b},function(a,b){c._processItems(a,b)})}},setObjectTypeFilter:function(a){this.objectTypeFilter="string"===typeof a?[a]:a},getObjectTypeFilter:function(){return this.objectTypeFilter},
show:function(){this.open()},open:function(){if(!this._isOpened){this._isOpened=!0;var a=this.element;if(this.isFloating){f(".repository-browser-modal-overlay").stop().css({top:0,left:0}).show();a.stop().show();var b=f(window);a.css({left:(b.width()-a.width())/2-30,top:(b.height()-a.height())/3+10}).draggable({handle:a.find(".repository-browser-grab-handle")});this.$_grid.css({marginTop:0,opacity:0}).animate({marginTop:0,opacity:1},1500,"easeOutExpo",function(){f.browser.msie&&f(this).add(a).css("filter",
"progid:DXImageTransform.Microsoft.gradient(enabled=false)")})}else a.stop().show().css({opacity:1,filter:"progid:DXImageTransform.Microsoft.gradient(enabled=false)"});this._onWindowResized();++l}},close:function(){this._isOpened&&(this._isOpened=!1,this.element.fadeOut(250,function(){f(this).css("top",0).hide();(0===l||0===--l)&&f(".repository-browser-modal-overlay").hide()}))},refresh:function(){this._currentFolder&&this._fetchItems(this._currentFolder)}})});define("repository-browser-i18n-de",
[],function(){return{Browsing:"Browsing",Close:"Schließn","in":"in","Input search text...":"Suchtext einfü.gen...",numerous:"zahlreich",of:"von","Repository Browser":"Repository Browser",Search:"Süchen","Searching for":"Suche nach",Viewing:"Anzeige","button.switch-metaview.tooltip":"Zwischen Metaansicht und normaler Ansicht umschalten"}});define("repository-browser-i18n-en",[],function(){return{Browsing:"Browsing",Close:"Close","in":"in","Input search text...":"Input search text...",numerous:"numerous",
of:"of","Repository Browser":"Repository Browser",Search:"Search","Searching for":"Searching for",Viewing:"Viewing","button.switch-metaview.tooltip":"Switch between meta and normal view"}});define("linkbrowser/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link","button.removelink.tooltip":"Remove Link","newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link"},de:!0,fr:!0,pl:!0,ru:!0});define("linkbrowser/linkbrowser-plugin","aloha jquery aloha/plugin aloha/pluginmanager ui/ui ui/button link/link-plugin RepositoryBrowser i18n!linkbrowser/nls/i18n i18n!aloha/nls/i18n".split(" "),
function(j,f,a,d,c,b,l,m,g){var k=m.extend({init:function(a){this._super(a);var d=this;this._linkBrowserButton=c.adopt("linkBrowser",b,{tooltip:g.t("button.addlink.tooltip"),icon:"aloha-icon-tree",scope:"Aloha.continuoustext",click:function(){d.show()}});this._linkBrowserButton.hide();this.url=j.getAlohaUrl()+"/../plugins/extra/linkbrowser/";j.bind("aloha-link-selected",function(){d._linkBrowserButton.show()});j.bind("aloha-link-unselected",function(){d._linkBrowserButton.hide()})},onSelect:function(a){l.hrefField.setItem(a);
var b=j.Selection.getRangeObject(),c=b.startContainer=b.endContainer,d=b.startOffset=b.endOffset;b.select();b.startContainer=b.endContainer=c;b.startOffset=b.endOffset=d;b.select();j.trigger("aloha-link-selected-in-linkbrowser",a);this.close()},renderRowCols:function(a){var b={},c=this.url;a.id.match(/(\d+)\./);f.each(this.columns,function(d){switch(d){case "icon":b.icon='<div class="aloha-browser-icon\t\t\t\t\t\taloha-browser-icon-__page__"></div>';break;case "translations":if(!a.renditions)break;
for(var d=a.renditions,f=d.length,g=[],j;f>0;--f){j=d[f];j.kind=="translation"&&g.push('<img src="'+c+"img/flags/"+j.language+'.png"\t\t\t\t\t\t\t\t\t  alt="'+j.language+'"\t\t\t\t\t\t\t\t\t  title="'+j.filename+'" />')}b.translations=g.join("");break;case "language":b.language=a.language;break;default:b[d]=a[d]||"--"}});return b}});return a.create("linkbrowser",{dependencies:["link"],browser:null,init:function(){this.browser=new k({repositoryManager:j.RepositoryManager,repositoryFilter:[],objectTypeFilter:["website",
"file","image","language"],renditionFilter:["*"],filter:["language"],columns:{icon:{title:"",width:30,sortable:false,resizable:false},name:{title:"Name",width:320,sorttype:"text"},language:{title:"",width:30,sorttype:"text"},translations:{title:"",width:350,sorttype:"text"}},rootPath:j.settings.baseUrl+"/vendor/repository-browser/"})}})});define("imagebrowser/nls/i18n",{root:{"button.addimage.tooltip":"Insert Image","button.removeimage.tooltip":"Remove Image","newimage.defaulttext":"New Image","floatingmenu.tab.img":"Image"}});
define("imagebrowser/imagebrowser-plugin","aloha jquery aloha/plugin aloha/pluginmanager ui/ui ui/button image/image-plugin RepositoryBrowser i18n!imagebrowser/nls/i18n i18n!aloha/nls/i18n".split(" "),function(j,f,a,d,c,b,l,m,g){var k=m.extend({init:function(a){this._super(a);var d=this;this._imageBrowserButton=c.adopt("imageBrowser",b,{tooltip:g.t("button.addimage.tooltip"),icon:"aloha-icon-tree",scope:"Aloha.continuoustext","class":"aloha-imagebrowser-button",click:function(){d.open()}});this._imageBrowserButton.show(false);
this.url=j.getAlohaUrl()+"/../plugins/extra/imagebrowser/";j.bind("aloha-image-selected",function(){d._imageBrowserButton.show(true)});j.bind("aloha-image-unselected",function(){d._imageBrowserButton.show(false)})},onSelect:function(a){if(a.type.match("image")!==null){l.ui.imgSrcField.setItem(a);l.resetSize();this.close()}},listItems:function(a){var b=this,c=this.list.clearGridData();f.each(a,function(){var a=this.resource;a.type.match("image")!==null&&c.addRowData(a.uid,f.extend({id:a.id},b.renderRowCols(a)))})},
renderRowCols:function(a){var b={};a.id.match(/(\d+)\./);f.each(this.columns,function(c){switch(c){case "icon":if(!a.renditions)break;if(a.renditions.length===1&&a.renditions[0].kind==="thumbnail")b.icon='<img width="'+a.renditions[0].width+'" height="'+a.renditions[0].height+' " src="'+a.renditions[0].url+'"/>';break;default:b[c]=a[c]||"--"}});return b}});return a.create("imagebrowser",{dependencies:["image"],browser:null,init:function(){this.browser=new k({repositoryManager:j.RepositoryManager,
repositoryFilter:[],objectTypeFilter:["image"],renditionFilter:["*"],filter:["language"],columns:{icon:{title:"",width:75,sortable:false,resizable:false},name:{title:"Name",width:320,sorttype:"text"}},rootPath:j.settings.baseUrl+"/vendor/repository-browser/"})}})});define("ui/menuButton",["jquery","ui/component","ui/utils","jqueryui"],function(j,f,a){function d(b,f){var k=[];j.each(f,function(e,f){var g=j("<li>");g.append(j("<a>",{href:"javascript:void 0",html:a.makeButtonLabelWithIcon(f)}));f.click&&
g.data("aloha-ui-menubutton-select",function(){b();f.click()});if(f.menu){var l=j("<ul>").appendTo(g);l.append(d(c(l,b),f.menu))}k.push(g[0])});return k}function c(a,b){b=b||j.noop;return function(){a.blur().hide();a.parent().removeClass("aloha-ui-menubutton-pressed");b()}}function b(a,b){var c=b.item.data("aloha-ui-menubutton-select");c&&c(a,b);a.preventDefault()}var l=f.extend({init:function(){this.element=l.makeMenuButton(this)}});l.makeMenuButton=function(f){function g(a){a.hide().parent().removeClass("aloha-ui-menubutton-pressed")}
var k=j("<div>",{"class":"aloha-ui-menubutton-container"}),e=a.makeButtonElement({"class":"aloha-ui-menubutton-expand"}),l=j("<ul>",{"class":"aloha-ui-menubutton-menu"}),o=null,r=null;j.browser.msie&&k.addClass("aloha-ui-menubutton-iehack");f.click?(o=a.makeButton(a.makeButtonElement({"class":"aloha-ui-menubutton-action"}),f).click(f.click),a.makeButton(e,{},!0),r=j("<div>").buttonset().append(o).append(e)):a.makeButton(e,f,!0).addClass("aloha-ui-menubutton-single");if(!f.menu)return k.append(o);
e.click(function(){k.addClass("aloha-ui-menubutton-pressed");f.siblingContainer&&f.siblingContainer.find(".aloha-ui-menubutton-menu").each(function(){this!==l[0]&&g(j(this))});if(l.is(":visible"))g(l);else{l.show().position({my:"left top",at:"left bottom",of:o||e});j(document).bind("click",function(a){j(this).unbind(a);l.hide();k.removeClass("aloha-ui-menubutton-pressed")});return false}});k.append(r||e).append(l);l.append(d(c(l),f.menu));l.hide().menu({select:b});return k};return l});define("ribbon/ribbon-plugin",
["jquery","aloha/plugin","ui/menuButton","ui/utils","jqueryui"],function(j,f,a,d){return f.create("ribbon",{init:function(){if(this.settings.enable||"undefined"===typeof this.settings.enable){var a=this;this._visible=!1;this._toolbar=j("<div>",{"class":"aloha-ribbon-toolbar ui-menubar ui-widget-header ui-helper-clearfix"});var b=d.makeButtonElement({"class":"aloha-ribbon-in"}).button().hide().click(function(){a._toolbar.animate({left:0});j("body").animate({paddingTop:30});b.hide()}).appendTo(this._toolbar);
d.makeButtonElement({"class":"aloha-ribbon-out"}).button().click(function(){a._toolbar.animate({left:-a._toolbar.outerWidth()+b.outerWidth()+10});j("body").animate({paddingTop:0});b.show()}).appendTo(this._toolbar);var f=j("<div>",{"class":"aloha aloha-ribbon"}).appendTo("body");this._icon=j("<div>").prependTo(this._toolbar);this.setIcon("");this._toolbar.appendTo(f);j("body").css({position:"relative",paddingTop:30})}},setIcon:function(a){this._icon&&this._icon.attr("class","aloha-ribbon-icon "+a)},
addButton:function(c){this._toolbar&&(c=j.extend({},c,{siblingContainer:this._toolbar}),this._toolbar.append(a.makeMenuButton(c)))},hide:function(){this._toolbar&&(this._toolbar.hide(),this._visible=!1)},show:function(){this._toolbar&&(this._toolbar.show(),this._visible=!0)},isVisible:function(){return this._visible}})});define("wai-lang/nls/i18n",{root:{"floatingmenu.tab.wai-lang":"Language annotation","button.add-wai-lang-remove.tooltip":"Remove language annotation","button.add-wai-lang.tooltip":"Add language annotation",
insertAnnotation:"ctrl+shift+l"},de:!0,en:!0});define("wai-lang/languages",["aloha","jquery","flag-icons/flag-icons-plugin","aloha/console","wai-lang/wai-lang-plugin"],function(j,f,a,d){var c=f.Deferred();return new (j.AbstractRepository.extend({languageCodes:[],locale:"de",iso:"iso639-1",flags:!1,_constructor:function(){this._super("wai-languages")},init:function(){var a=this,d=j.require("wai-lang/wai-lang-plugin"),f=d.iso639;"de"!==j.settings.locale&&(this.locale="en");"iso639-1"!==f&&(this.iso=
"iso639-2");this.flags=d.flags;this.repositoryName="WaiLanguages";j.require(["wai-lang/"+this.iso+"-"+this.locale],function(d){a.storeLanguageCodes(d);c.resolve()})},markObject:function(){},errorHandler:function(a){d.log("error",this,"Error while loading languages. "+a)},storeLanguageCodes:function(b){var c=this,d=j.getPluginUrl("wai-lang");f.each(b,function(b,f){f.id=b;f.repositoryId=c.repositoryId;f.type="language";c.flags&&(f.url=f.flag?a.path+"/img/flags/"+f.flag+".png":d+"/img/button.png");c.languageCodes.push(new j.RepositoryDocument(f))})},
_searchInLanguageCodes:function(a,c){var d=RegExp("^"+a.queryString,"i"),g,j=[],e,p,o;for(g=0;g<this.languageCodes.length;++g)o=this.languageCodes[g],e=!a.queryString||o.name.match(d),p=!a.objectTypeFilter||!a.objectTypeFilter.length||-1<f.inArray(o.type,a.objectTypeFilter),e&&p&&j.push(o);c.call(this,j)},query:function(a,d){var f=this;c.done(function(){f._searchInLanguageCodes(a,d)})},getObjectById:function(a,c){var d,f;for(d=0;d<this.languageCodes.length;++d)if(f=this.languageCodes[d],f.id===a){c.call(this,
[f]);break}}}))});define("wai-lang/wai-lang-plugin","aloha jquery aloha/plugin ui/ui ui/scopes ui/button ui/toggleButton ui/port-helper-attribute-field i18n!wai-lang/nls/i18n i18n!aloha/nls/i18n wai-lang/languages".split(" "),function(j,f,a,d,c,b,l,m,g){var k=window.GENTICS,e;return a.create("wai-lang",{languages:["en","de"],config:["span"],iso639:"iso639-1",flags:false,objectTypeFilter:["language"],hotKey:{insertAnnotation:g.t("insertAnnotation","ctrl+shift+l")},init:function(){if(this.settings.objectTypeFilter)this.objectTypeFilter=
this.settings.objectTypeFilter;this.settings.hotKey&&f.extend(true,this.hotKey,this.settings.hotKey);this.flags=this.settings.flags==="true"||this.settings.flags===true||this.settings.flags==="1"||this.settings.flags===1?true:false;if(this.settings.iso639)this.iso639=this.settings.iso639;this.createButtons();this.subscribeEvents();this.bindInteractions()},subscribeEvents:function(){var a=this;j.bind("aloha-editable-activated",function(){var b;b=a.getEditableConfig(j.activeEditable.obj);f.inArray("span",
b)!==-1?a._wailangButton.show():a._wailangButton.hide()});j.bind("aloha-selection-changed",function(b,d){var f=a._foundLangMarkupAtSelection=a.findLangMarkup(d);if(f){a._wailangButton.setState(true);c.setScope("wai-lang");e.setTargetObject(f,"lang")}else{a._wailangButton.setState(false);a._foundLangMarkupAtSelection=false;e.setTargetObject(null)}})},createButtons:function(){var a=this;this._wailangButton=d.adopt("wailang",l,{tooltip:g.t("button.add-wai-lang.tooltip"),icon:"aloha-icon aloha-icon-wai-lang",
scope:"Aloha.continuoustext",click:function(){a.addRemoveMarkupToSelection()}});c.createScope("wai-lang","Aloha.continuoustext");e=m({name:"wailangfield",width:320,valueField:"id",minChars:1,scope:"wai-lang"});this.flags?e.setTemplate('<div class="aloha-wai-lang-img-item"><img class="aloha-wai-lang-img" src="{url}" /><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>'):e.setTemplate('<div class="aloha-wai-lang-img-item"><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>');
e.setObjectTypeFilter(this.objectTypeFilter);this._removewailangButton=d.adopt("removewailang",b,{tooltip:g.t("button.add-wai-lang-remove.tooltip"),icon:"aloha-icon aloha-icon-wai-lang-remove",scope:"wai-lang",click:function(){a.removeLangMarkup()}})},findLangMarkup:function(a){a=a||j.Selection.getRangeObject();return j.activeEditable?a.findMarkup(function(){return f(this).hasClass("aloha-wai-lang")||f(this).is("[lang]")},j.activeEditable.obj):null},findLanguageMarkup:function(a){a=a||j.Selection.getRangeObject();
return j.activeEditable?a.findMarkup(function(){return this.nodeName==="SPAN"},j.activeEditable.obj):null},removeLangMarkup:function(){var a=j.Selection.getRangeObject(),b=this.findLangMarkup(a);if(b){k.Utils.Dom.removeFromDOM(b,a,true);a.select();c.setScope("Aloha.continuoustext");e.setTargetObject(null)}},bindInteractions:function(){function a(c){c.obj.bind("keydown",b.hotKey.insertAnnotation,function(){b.insertLanguageAnnotation()});c.obj.find("span[lang]").each(function(){b.makeVisible(this)})}
var b=this;e.addListener("blur",function(){this.getValue()||b.removeMarkup()});j.bind("aloha-editable-created",function(b,c){a(c)})},insertLanguageAnnotation:function(){if(typeof this.findLangMarkup==="function"){if(this.findLangMarkup()){e.foreground();e.focus()}else this.addMarkupToSelection();return false}},makeVisible:function(a){a=f(a);a.addClass("aloha-wai-lang");a.attr("data-gentics-aloha-repository","wai-languages");a.attr("data-gentics-aloha-object-id",a.attr("lang"))},formatLanguageSpan:function(){j.activeEditable&&
(this.findLanguageMarkup(j.Selection.getRangeObject())?this.removeMarkup():this.insertMarkup())},addRemoveMarkupToSelection:function(){this._foundLangMarkupAtSelection?this.removeLangMarkup():this.addMarkupToSelection(false)},addMarkupToSelection:function(){var a=j.Selection.getRangeObject();if(!this.findLangMarkup(a)){e.foreground();c.setScope("wai-lang");a.isCollapsed()&&k.Utils.Dom.extendToWord(a);a.isCollapsed()||k.Utils.Dom.addMarkup(a,f('<span class="aloha-wai-lang"></span>'),false);a.select();
e.focus()}},removeMarkup:function(){var a=this.findLangMarkup(),b;if(a){b=j.Selection.getRangeObject();k.Utils.Dom.removeFromDOM(a,b,true);b.select()}},makeClean:function(a){a.find("span[lang]").each(function(){f(this).removeClass("aloha-wai-lang");f(this).removeAttr("data-gentics-aloha-repository");f(this).removeAttr("data-gentics-aloha-object-id");f(this).attr("xml:lang",f(this).attr("lang"))})}})});define("headerids/nls/i18n",{root:{"headerids.label.target":"Target","headerids.button.reset":"Reset",
"headerids.button.set":"Set",internal_hyperlink:"Internal Hyperlink"},de:!0,en:!0});define("headerids/headerids-plugin",["jquery","aloha/plugin","i18n!headerids/nls/i18n","i18n!aloha/nls/i18n"],function(j,f,a){function d(){var a=[],c=m;b.each(arguments,function(){a.push("."+(""==this?c:c+"-"+this))});return j.trim(a.join(" "))}function c(){var a=[],c=m;b.each(arguments,function(){a.push(""==this?c:c+"-"+this)});return j.trim(a.join(" "))}var b=j,l=window.Aloha,m="aloha-headerids";return f.create("headerids",
{_constructor:function(){this._super("headerids")},config:["true"],init:function(){var a=this;l.bind("aloha-editable-activated",function(b,c){a.check(c.editable.obj)});l.bind("aloha-editable-deactivated",function(b,c){a.check(c.editable.obj)});l.bind("aloha-ready",function(){a.initSidebar(l.Sidebar.right)})},check:function(a){var b=this,c=b.getEditableConfig(a);if(-1===j.inArray("true",c))return!1;j(a).find("h1, h2, h3, h4, h5, h6").not(".aloha-customized").each(function(){b.processH(this)})},processH:function(a){j(a).attr("id",
this.sanitize(j(a).text()))},sanitize:function(a){return a.replace(/[^a-z0-9]+/gi,"_")},initSidebar:function(b){var f=this;f.sidebar=b;b.addPanel({id:c("sidebar-panel"),title:a.t("internal_hyperlink"),content:"",expanded:!0,activeOn:"h1, h2, h3, h4, h5, h6",onInit:function(){var b=this,g=this.setContent('<label class="'+c("label")+'" for="'+c("input")+'">'+a.t("headerids.label.target")+'</label><input id="'+c("input")+'" class="'+c("input")+'" type="text" name="value"/> <button class="'+c("reset-button")+
'">'+a.t("headerids.button.reset")+'</button><button class="'+c("set-button")+'">'+a.t("headerids.button.set")+"</button>").content;g.find(d("set-button")).click(function(){j(b.effective).attr("id",j(d("input")).val());j(b.effective).addClass("aloha-customized")});g.find(d("reset-button")).click(function(){f.processH(b.effective);j(b.effective).removeClass("aloha-customized");b.content.find(d("input")).val(b.effective.attr("id"))})},onActivate:function(a){this.effective=a;this.content.find(d("input")).val(a.attr("id"))}});
b.show()},makeClean:function(a){this.check(a)}})});define("metaview/nls/i18n",{root:{"button.switch-metaview.tooltip":"Switch between meta and normal view"},de:!0,en:!0});define("metaview/metaview-plugin","aloha/plugin ui/ui ui/toggleButton i18n!metaview/nls/i18n i18n!aloha/nls/i18n jquery".split(" "),function(j,f,a,d,c,b){var l=window.Aloha;return j.create("metaview",{_constructor:function(){this._super("metaview")},config:["metaview"],languages:["en","de"],init:function(){var a=this;this.createButtons();
l.bind("aloha-editable-activated",function(){var c;c=a.getEditableConfig(l.activeEditable.obj);if(b.type(c)==="array"&&b.inArray("metaview",c)!==-1){a._toggleMetaViewButton.show(true);b(l.activeEditable.obj).hasClass("aloha-metaview")?a._toggleMetaViewButton.setState(true):a._toggleMetaViewButton.setState(false)}else a._toggleMetaViewButton.show(false)})},buttonClick:function(){if(b(l.activeEditable.obj).hasClass("aloha-metaview")){b(l.activeEditable.obj).removeClass("aloha-metaview");this._toggleMetaViewButton.setState(false)}else{b(l.activeEditable.obj).addClass("aloha-metaview");
this._toggleMetaViewButton.setState(true)}},createButtons:function(){var b=this;this._toggleMetaViewButton=f.adopt("toggleMetaView",a,{tooltip:d.t("button.switch-metaview.tooltip"),icon:"aloha-icon aloha-icon-metaview",scope:"Aloha.continuoustext",click:function(){b.buttonClick()}})}})});define("listenforcer/listenforcer-plugin",["aloha","jquery","aloha/plugin","aloha/console"],function(j,f,a,d){function c(a,c){if(-1!==f.inArray(a[0],b)){a.find(".aloha-end-br").remove();var d=!1;a.find("li").each(function(){if(""!==
f.trim(f(this).text()))return d=!0,!1});d||a.html(c);var j=a.find(">ul,>ol"),e=j.length,p;if(1<e){var o=f(j[0]);for(p=1;p<e;++p)o.append(f(j[p]).find(">li")),f(j[p]).remove()}a.find(">*:not(ul,ol)").remove()}}var b=[];return a.create("listenforcer",{languages:["en","de"],_constructor:function(){this._super("listenforcer")},init:function(){var a=this,b=this.settings.editables||[],g,k,e=b.length;for(k=0;k<e;k++)g=b[k],"string"===typeof g||g.nodeName||g instanceof f?f(g).each(function(){a.addEditableToEnforcementList(this)}):
d.warn("Aloha List Enforcer Plugin",'Object "'+g.toString()+'" can not be used as a jQuery selector with which to register an editable to be list enforced.');j.bind("aloha-editable-activated",function(a,b){c(b.editable.obj,"<ul><li><br /></li></ul>")});j.bind("aloha-editable-deactivated",function(a,b){c(b.editable.obj,"")});j.bind("aloha-smart-content-changed",function(a,b){j.activeEditable&&!0===j.activeEditable.isActive&&c(b.editable.obj,"<ul><li><br /></li></ul>")})},addEditableToEnforcementList:function(a){a&&
b.push(a)}})});Aloha._load&&Aloha._load()})();